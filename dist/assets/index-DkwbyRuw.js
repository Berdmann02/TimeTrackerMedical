var SS=Object.defineProperty;var NS=(e,t,r)=>t in e?SS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var uh=(e,t,r)=>NS(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();function ES(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fh={exports:{}},Bc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zg;function TS(){if(Zg)return Bc;Zg=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,s,l){var o=null;if(l!==void 0&&(o=""+l),s.key!==void 0&&(o=""+s.key),"key"in s){l={};for(var f in s)f!=="key"&&(l[f]=s[f])}else l=s;return s=l.ref,{$$typeof:e,type:n,key:o,ref:s!==void 0?s:null,props:l}}return Bc.Fragment=t,Bc.jsx=r,Bc.jsxs=r,Bc}var Qg;function kS(){return Qg||(Qg=1,fh.exports=TS()),fh.exports}var u=kS(),dh={exports:{}},ht={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jg;function AS(){if(Jg)return ht;Jg=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),g=Symbol.iterator;function y(z){return z===null||typeof z!="object"?null:(z=g&&z[g]||z["@@iterator"],typeof z=="function"?z:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function _(z,te,D){this.props=z,this.context=te,this.refs=b,this.updater=D||S}_.prototype.isReactComponent={},_.prototype.setState=function(z,te){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,te,"setState")},_.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function T(){}T.prototype=_.prototype;function N(z,te,D){this.props=z,this.context=te,this.refs=b,this.updater=D||S}var E=N.prototype=new T;E.constructor=N,w(E,_.prototype),E.isPureReactComponent=!0;var j=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},R=Object.prototype.hasOwnProperty;function A(z,te,D,V,M,B){return D=B.ref,{$$typeof:e,type:z,key:te,ref:D!==void 0?D:null,props:B}}function P(z,te){return A(z.type,te,void 0,void 0,void 0,z.props)}function U(z){return typeof z=="object"&&z!==null&&z.$$typeof===e}function ee(z){var te={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(D){return te[D]})}var W=/\/+/g;function J(z,te){return typeof z=="object"&&z!==null&&z.key!=null?ee(""+z.key):te.toString(36)}function xe(){}function pe(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(xe,xe):(z.status="pending",z.then(function(te){z.status==="pending"&&(z.status="fulfilled",z.value=te)},function(te){z.status==="pending"&&(z.status="rejected",z.reason=te)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function we(z,te,D,V,M){var B=typeof z;(B==="undefined"||B==="boolean")&&(z=null);var K=!1;if(z===null)K=!0;else switch(B){case"bigint":case"string":case"number":K=!0;break;case"object":switch(z.$$typeof){case e:case t:K=!0;break;case x:return K=z._init,we(K(z._payload),te,D,V,M)}}if(K)return M=M(z),K=V===""?"."+J(z,0):V,j(M)?(D="",K!=null&&(D=K.replace(W,"$&/")+"/"),we(M,te,D,"",function(_e){return _e})):M!=null&&(U(M)&&(M=P(M,D+(M.key==null||z&&z.key===M.key?"":(""+M.key).replace(W,"$&/")+"/")+K)),te.push(M)),1;K=0;var oe=V===""?".":V+":";if(j(z))for(var ye=0;ye<z.length;ye++)V=z[ye],B=oe+J(V,ye),K+=we(V,te,D,B,M);else if(ye=y(z),typeof ye=="function")for(z=ye.call(z),ye=0;!(V=z.next()).done;)V=V.value,B=oe+J(V,ye++),K+=we(V,te,D,B,M);else if(B==="object"){if(typeof z.then=="function")return we(pe(z),te,D,V,M);throw te=String(z),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return K}function Q(z,te,D){if(z==null)return z;var V=[],M=0;return we(z,V,"","",function(B){return te.call(D,B,M++)}),V}function ie(z){if(z._status===-1){var te=z._result;te=te(),te.then(function(D){(z._status===0||z._status===-1)&&(z._status=1,z._result=D)},function(D){(z._status===0||z._status===-1)&&(z._status=2,z._result=D)}),z._status===-1&&(z._status=0,z._result=te)}if(z._status===1)return z._result.default;throw z._result}var Ae=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function re(){}return ht.Children={map:Q,forEach:function(z,te,D){Q(z,function(){te.apply(this,arguments)},D)},count:function(z){var te=0;return Q(z,function(){te++}),te},toArray:function(z){return Q(z,function(te){return te})||[]},only:function(z){if(!U(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},ht.Component=_,ht.Fragment=r,ht.Profiler=s,ht.PureComponent=N,ht.StrictMode=n,ht.Suspense=m,ht.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,ht.__COMPILER_RUNTIME={__proto__:null,c:function(z){return F.H.useMemoCache(z)}},ht.cache=function(z){return function(){return z.apply(null,arguments)}},ht.cloneElement=function(z,te,D){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var V=w({},z.props),M=z.key,B=void 0;if(te!=null)for(K in te.ref!==void 0&&(B=void 0),te.key!==void 0&&(M=""+te.key),te)!R.call(te,K)||K==="key"||K==="__self"||K==="__source"||K==="ref"&&te.ref===void 0||(V[K]=te[K]);var K=arguments.length-2;if(K===1)V.children=D;else if(1<K){for(var oe=Array(K),ye=0;ye<K;ye++)oe[ye]=arguments[ye+2];V.children=oe}return A(z.type,M,void 0,void 0,B,V)},ht.createContext=function(z){return z={$$typeof:o,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:l,_context:z},z},ht.createElement=function(z,te,D){var V,M={},B=null;if(te!=null)for(V in te.key!==void 0&&(B=""+te.key),te)R.call(te,V)&&V!=="key"&&V!=="__self"&&V!=="__source"&&(M[V]=te[V]);var K=arguments.length-2;if(K===1)M.children=D;else if(1<K){for(var oe=Array(K),ye=0;ye<K;ye++)oe[ye]=arguments[ye+2];M.children=oe}if(z&&z.defaultProps)for(V in K=z.defaultProps,K)M[V]===void 0&&(M[V]=K[V]);return A(z,B,void 0,void 0,null,M)},ht.createRef=function(){return{current:null}},ht.forwardRef=function(z){return{$$typeof:f,render:z}},ht.isValidElement=U,ht.lazy=function(z){return{$$typeof:x,_payload:{_status:-1,_result:z},_init:ie}},ht.memo=function(z,te){return{$$typeof:h,type:z,compare:te===void 0?null:te}},ht.startTransition=function(z){var te=F.T,D={};F.T=D;try{var V=z(),M=F.S;M!==null&&M(D,V),typeof V=="object"&&V!==null&&typeof V.then=="function"&&V.then(re,Ae)}catch(B){Ae(B)}finally{F.T=te}},ht.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},ht.use=function(z){return F.H.use(z)},ht.useActionState=function(z,te,D){return F.H.useActionState(z,te,D)},ht.useCallback=function(z,te){return F.H.useCallback(z,te)},ht.useContext=function(z){return F.H.useContext(z)},ht.useDebugValue=function(){},ht.useDeferredValue=function(z,te){return F.H.useDeferredValue(z,te)},ht.useEffect=function(z,te,D){var V=F.H;if(typeof D=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return V.useEffect(z,te)},ht.useId=function(){return F.H.useId()},ht.useImperativeHandle=function(z,te,D){return F.H.useImperativeHandle(z,te,D)},ht.useInsertionEffect=function(z,te){return F.H.useInsertionEffect(z,te)},ht.useLayoutEffect=function(z,te){return F.H.useLayoutEffect(z,te)},ht.useMemo=function(z,te){return F.H.useMemo(z,te)},ht.useOptimistic=function(z,te){return F.H.useOptimistic(z,te)},ht.useReducer=function(z,te,D){return F.H.useReducer(z,te,D)},ht.useRef=function(z){return F.H.useRef(z)},ht.useState=function(z){return F.H.useState(z)},ht.useSyncExternalStore=function(z,te,D){return F.H.useSyncExternalStore(z,te,D)},ht.useTransition=function(){return F.H.useTransition()},ht.version="19.1.0",ht}var ev;function um(){return ev||(ev=1,dh.exports=AS()),dh.exports}var C=um();const Cn=ES(C);var hh={exports:{}},Uc={},mh={exports:{}},xh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tv;function CS(){return tv||(tv=1,function(e){function t(Q,ie){var Ae=Q.length;Q.push(ie);e:for(;0<Ae;){var re=Ae-1>>>1,z=Q[re];if(0<s(z,ie))Q[re]=ie,Q[Ae]=z,Ae=re;else break e}}function r(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var ie=Q[0],Ae=Q.pop();if(Ae!==ie){Q[0]=Ae;e:for(var re=0,z=Q.length,te=z>>>1;re<te;){var D=2*(re+1)-1,V=Q[D],M=D+1,B=Q[M];if(0>s(V,Ae))M<z&&0>s(B,V)?(Q[re]=B,Q[M]=Ae,re=M):(Q[re]=V,Q[D]=Ae,re=D);else if(M<z&&0>s(B,Ae))Q[re]=B,Q[M]=Ae,re=M;else break e}}return ie}function s(Q,ie){var Ae=Q.sortIndex-ie.sortIndex;return Ae!==0?Ae:Q.id-ie.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,f=o.now();e.unstable_now=function(){return o.now()-f}}var m=[],h=[],x=1,g=null,y=3,S=!1,w=!1,b=!1,_=!1,T=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function j(Q){for(var ie=r(h);ie!==null;){if(ie.callback===null)n(h);else if(ie.startTime<=Q)n(h),ie.sortIndex=ie.expirationTime,t(m,ie);else break;ie=r(h)}}function F(Q){if(b=!1,j(Q),!w)if(r(m)!==null)w=!0,R||(R=!0,J());else{var ie=r(h);ie!==null&&we(F,ie.startTime-Q)}}var R=!1,A=-1,P=5,U=-1;function ee(){return _?!0:!(e.unstable_now()-U<P)}function W(){if(_=!1,R){var Q=e.unstable_now();U=Q;var ie=!0;try{e:{w=!1,b&&(b=!1,N(A),A=-1),S=!0;var Ae=y;try{t:{for(j(Q),g=r(m);g!==null&&!(g.expirationTime>Q&&ee());){var re=g.callback;if(typeof re=="function"){g.callback=null,y=g.priorityLevel;var z=re(g.expirationTime<=Q);if(Q=e.unstable_now(),typeof z=="function"){g.callback=z,j(Q),ie=!0;break t}g===r(m)&&n(m),j(Q)}else n(m);g=r(m)}if(g!==null)ie=!0;else{var te=r(h);te!==null&&we(F,te.startTime-Q),ie=!1}}break e}finally{g=null,y=Ae,S=!1}ie=void 0}}finally{ie?J():R=!1}}}var J;if(typeof E=="function")J=function(){E(W)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,pe=xe.port2;xe.port1.onmessage=W,J=function(){pe.postMessage(null)}}else J=function(){T(W,0)};function we(Q,ie){A=T(function(){Q(e.unstable_now())},ie)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var ie=3;break;default:ie=y}var Ae=y;y=ie;try{return Q()}finally{y=Ae}},e.unstable_requestPaint=function(){_=!0},e.unstable_runWithPriority=function(Q,ie){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var Ae=y;y=Q;try{return ie()}finally{y=Ae}},e.unstable_scheduleCallback=function(Q,ie,Ae){var re=e.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?re+Ae:re):Ae=re,Q){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=Ae+z,Q={id:x++,callback:ie,priorityLevel:Q,startTime:Ae,expirationTime:z,sortIndex:-1},Ae>re?(Q.sortIndex=Ae,t(h,Q),r(m)===null&&Q===r(h)&&(b?(N(A),A=-1):b=!0,we(F,Ae-re))):(Q.sortIndex=z,t(m,Q),w||S||(w=!0,R||(R=!0,J()))),Q},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(Q){var ie=y;return function(){var Ae=y;y=ie;try{return Q.apply(this,arguments)}finally{y=Ae}}}}(xh)),xh}var rv;function jS(){return rv||(rv=1,mh.exports=CS()),mh.exports}var ph={exports:{}},Xr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av;function FS(){if(av)return Xr;av=1;var e=um();function t(m){var h="https://react.dev/errors/"+m;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)h+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+m+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(m,h,x){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:m,containerInfo:h,implementation:x}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(m,h){if(m==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Xr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Xr.createPortal=function(m,h){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return l(m,h,null,x)},Xr.flushSync=function(m){var h=o.T,x=n.p;try{if(o.T=null,n.p=2,m)return m()}finally{o.T=h,n.p=x,n.d.f()}},Xr.preconnect=function(m,h){typeof m=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(m,h))},Xr.prefetchDNS=function(m){typeof m=="string"&&n.d.D(m)},Xr.preinit=function(m,h){if(typeof m=="string"&&h&&typeof h.as=="string"){var x=h.as,g=f(x,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,S=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;x==="style"?n.d.S(m,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:g,integrity:y,fetchPriority:S}):x==="script"&&n.d.X(m,{crossOrigin:g,integrity:y,fetchPriority:S,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Xr.preinitModule=function(m,h){if(typeof m=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var x=f(h.as,h.crossOrigin);n.d.M(m,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(m)},Xr.preload=function(m,h){if(typeof m=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var x=h.as,g=f(x,h.crossOrigin);n.d.L(m,x,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Xr.preloadModule=function(m,h){if(typeof m=="string")if(h){var x=f(h.as,h.crossOrigin);n.d.m(m,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(m)},Xr.requestFormReset=function(m){n.d.r(m)},Xr.unstable_batchedUpdates=function(m,h){return m(h)},Xr.useFormState=function(m,h,x){return o.H.useFormState(m,h,x)},Xr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Xr.version="19.1.0",Xr}var nv;function RS(){if(nv)return ph.exports;nv=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),ph.exports=FS(),ph.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sv;function DS(){if(sv)return Uc;sv=1;var e=jS(),t=um(),r=RS();function n(a){var i="https://react.dev/errors/"+a;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var i=a,c=a;if(a.alternate)for(;i.return;)i=i.return;else{a=i;do i=a,(i.flags&4098)!==0&&(c=i.return),a=i.return;while(a)}return i.tag===3?c:null}function o(a){if(a.tag===13){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function f(a){if(l(a)!==a)throw Error(n(188))}function m(a){var i=a.alternate;if(!i){if(i=l(a),i===null)throw Error(n(188));return i!==a?null:a}for(var c=a,d=i;;){var p=c.return;if(p===null)break;var v=p.alternate;if(v===null){if(d=p.return,d!==null){c=d;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===c)return f(p),a;if(v===d)return f(p),i;v=v.sibling}throw Error(n(188))}if(c.return!==d.return)c=p,d=v;else{for(var k=!1,L=p.child;L;){if(L===c){k=!0,c=p,d=v;break}if(L===d){k=!0,d=p,c=v;break}L=L.sibling}if(!k){for(L=v.child;L;){if(L===c){k=!0,c=v,d=p;break}if(L===d){k=!0,d=v,c=p;break}L=L.sibling}if(!k)throw Error(n(189))}}if(c.alternate!==d)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:i}function h(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a;for(a=a.child;a!==null;){if(i=h(a),i!==null)return i;a=a.sibling}return null}var x=Object.assign,g=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),E=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function J(a){return a===null||typeof a!="object"?null:(a=W&&a[W]||a["@@iterator"],typeof a=="function"?a:null)}var xe=Symbol.for("react.client.reference");function pe(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===xe?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case w:return"Fragment";case _:return"Profiler";case b:return"StrictMode";case F:return"Suspense";case R:return"SuspenseList";case U:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case S:return"Portal";case E:return(a.displayName||"Context")+".Provider";case N:return(a._context.displayName||"Context")+".Consumer";case j:var i=a.render;return a=a.displayName,a||(a=i.displayName||i.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case A:return i=a.displayName||null,i!==null?i:pe(a.type)||"Memo";case P:i=a._payload,a=a._init;try{return pe(a(i))}catch{}}return null}var we=Array.isArray,Q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae={pending:!1,data:null,method:null,action:null},re=[],z=-1;function te(a){return{current:a}}function D(a){0>z||(a.current=re[z],re[z]=null,z--)}function V(a,i){z++,re[z]=a.current,a.current=i}var M=te(null),B=te(null),K=te(null),oe=te(null);function ye(a,i){switch(V(K,i),V(B,a),V(M,null),i.nodeType){case 9:case 11:a=(a=i.documentElement)&&(a=a.namespaceURI)?Eg(a):0;break;default:if(a=i.tagName,i=i.namespaceURI)i=Eg(i),a=Tg(i,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}D(M),V(M,a)}function _e(){D(M),D(B),D(K)}function ae(a){a.memoizedState!==null&&V(oe,a);var i=M.current,c=Tg(i,a.type);i!==c&&(V(B,a),V(M,c))}function He(a){B.current===a&&(D(M),D(B)),oe.current===a&&(D(oe),Rc._currentValue=Ae)}var Y=Object.prototype.hasOwnProperty,ct=e.unstable_scheduleCallback,$e=e.unstable_cancelCallback,xt=e.unstable_shouldYield,et=e.unstable_requestPaint,Me=e.unstable_now,vt=e.unstable_getCurrentPriorityLevel,De=e.unstable_ImmediatePriority,at=e.unstable_UserBlockingPriority,Ce=e.unstable_NormalPriority,Fe=e.unstable_LowPriority,de=e.unstable_IdlePriority,Te=e.log,qe=e.unstable_setDisableYieldValue,Ke=null,Xe=null;function ut(a){if(typeof Te=="function"&&qe(a),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(Ke,a)}catch{}}var nt=Math.clz32?Math.clz32:zr,lt=Math.log,Xt=Math.LN2;function zr(a){return a>>>=0,a===0?32:31-(lt(a)/Xt|0)|0}var jt=256,Hr=4194304;function Oa(a){var i=a&42;if(i!==0)return i;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function ls(a,i,c){var d=a.pendingLanes;if(d===0)return 0;var p=0,v=a.suspendedLanes,k=a.pingedLanes;a=a.warmLanes;var L=d&134217727;return L!==0?(d=L&~v,d!==0?p=Oa(d):(k&=L,k!==0?p=Oa(k):c||(c=L&~a,c!==0&&(p=Oa(c))))):(L=d&~v,L!==0?p=Oa(L):k!==0?p=Oa(k):c||(c=d&~a,c!==0&&(p=Oa(c)))),p===0?0:i!==0&&i!==p&&(i&v)===0&&(v=p&-p,c=i&-i,v>=c||v===32&&(c&4194048)!==0)?i:p}function tt(a,i){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&i)===0}function Dt(a,i){switch(a){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dr(){var a=jt;return jt<<=1,(jt&4194048)===0&&(jt=256),a}function tn(){var a=Hr;return Hr<<=1,(Hr&62914560)===0&&(Hr=4194304),a}function ca(a){for(var i=[],c=0;31>c;c++)i.push(a);return i}function Vr(a,i){a.pendingLanes|=i,i!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Bi(a,i,c,d,p,v){var k=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var L=a.entanglements,Z=a.expirationTimes,ue=a.hiddenUpdates;for(c=k&~c;0<c;){var Ee=31-nt(c),je=1<<Ee;L[Ee]=0,Z[Ee]=-1;var me=ue[Ee];if(me!==null)for(ue[Ee]=null,Ee=0;Ee<me.length;Ee++){var ve=me[Ee];ve!==null&&(ve.lane&=-536870913)}c&=~je}d!==0&&Io(a,d,0),v!==0&&p===0&&a.tag!==0&&(a.suspendedLanes|=v&~(k&~i))}function Io(a,i,c){a.pendingLanes|=i,a.suspendedLanes&=~i;var d=31-nt(i);a.entangledLanes|=i,a.entanglements[d]=a.entanglements[d]|1073741824|c&4194090}function Po(a,i){var c=a.entangledLanes|=i;for(a=a.entanglements;c;){var d=31-nt(c),p=1<<d;p&i|a[d]&i&&(a[d]|=i),c&=~p}}function Hl(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Vl(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function zo(){var a=ie.p;return a!==0?a:(a=window.event,a===void 0?32:Xg(a.type))}function nf(a,i){var c=ie.p;try{return ie.p=a,i()}finally{ie.p=c}}var gn=Math.random().toString(36).slice(2),Nr="__reactFiber$"+gn,Er="__reactProps$"+gn,cs="__reactContainer$"+gn,Gl="__reactEvents$"+gn,sf="__reactListeners$"+gn,O="__reactHandles$"+gn,X="__reactResources$"+gn,I="__reactMarker$"+gn;function H(a){delete a[Nr],delete a[Er],delete a[Gl],delete a[sf],delete a[O]}function G(a){var i=a[Nr];if(i)return i;for(var c=a.parentNode;c;){if(i=c[cs]||c[Nr]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(a=jg(a);a!==null;){if(c=a[Nr])return c;a=jg(a)}return i}a=c,c=a.parentNode}return null}function q(a){if(a=a[Nr]||a[cs]){var i=a.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return a}return null}function fe(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a.stateNode;throw Error(n(33))}function Se(a){var i=a[X];return i||(i=a[X]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function le(a){a[I]=!0}var he=new Set,ge={};function Oe(a,i){Be(a,i),Be(a+"Capture",i)}function Be(a,i){for(ge[a]=i,a=0;a<i.length;a++)he.add(i[a])}var ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Le={},Pe={};function ot(a){return Y.call(Pe,a)?!0:Y.call(Le,a)?!1:ze.test(a)?Pe[a]=!0:(Le[a]=!0,!1)}function It(a,i,c){if(ot(i))if(c===null)a.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){a.removeAttribute(i);return}}a.setAttribute(i,""+c)}}function Pt(a,i,c){if(c===null)a.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(i);return}a.setAttribute(i,""+c)}}function qt(a,i,c,d){if(d===null)a.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(i,c,""+d)}}var On,os;function Ma(a){if(On===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);On=i&&i[1]||"",os=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+On+a+os}var rn=!1;function Ws(a,i){if(!a||rn)return"";rn=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var je=function(){throw Error()};if(Object.defineProperty(je.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(je,[])}catch(ve){var me=ve}Reflect.construct(a,[],je)}else{try{je.call()}catch(ve){me=ve}a.call(je.prototype)}}else{try{throw Error()}catch(ve){me=ve}(je=a())&&typeof je.catch=="function"&&je.catch(function(){})}}catch(ve){if(ve&&me&&typeof ve.stack=="string")return[ve.stack,me.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=d.DetermineComponentFrameRoot(),k=v[0],L=v[1];if(k&&L){var Z=k.split(`
`),ue=L.split(`
`);for(p=d=0;d<Z.length&&!Z[d].includes("DetermineComponentFrameRoot");)d++;for(;p<ue.length&&!ue[p].includes("DetermineComponentFrameRoot");)p++;if(d===Z.length||p===ue.length)for(d=Z.length-1,p=ue.length-1;1<=d&&0<=p&&Z[d]!==ue[p];)p--;for(;1<=d&&0<=p;d--,p--)if(Z[d]!==ue[p]){if(d!==1||p!==1)do if(d--,p--,0>p||Z[d]!==ue[p]){var Ee=`
`+Z[d].replace(" at new "," at ");return a.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",a.displayName)),Ee}while(1<=d&&0<=p);break}}}finally{rn=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?Ma(c):""}function an(a){switch(a.tag){case 26:case 27:case 5:return Ma(a.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 15:return Ws(a.type,!1);case 11:return Ws(a.type.render,!1);case 1:return Ws(a.type,!0);case 31:return Ma("Activity");default:return""}}function yx(a){try{var i="";do i+=an(a),a=a.return;while(a);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function La(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function wx(a){var i=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function v_(a){var i=wx(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,i),d=""+a[i];if(!a.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,v=c.set;return Object.defineProperty(a,i,{configurable:!0,get:function(){return p.call(this)},set:function(k){d=""+k,v.call(this,k)}}),Object.defineProperty(a,i,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(k){d=""+k},stopTracking:function(){a._valueTracker=null,delete a[i]}}}}function Ho(a){a._valueTracker||(a._valueTracker=v_(a))}function bx(a){if(!a)return!1;var i=a._valueTracker;if(!i)return!0;var c=i.getValue(),d="";return a&&(d=wx(a)?a.checked?"true":"false":a.value),a=d,a!==c?(i.setValue(a),!0):!1}function Vo(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var y_=/[\n"\\]/g;function Ba(a){return a.replace(y_,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function lf(a,i,c,d,p,v,k,L){a.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?a.type=k:a.removeAttribute("type"),i!=null?k==="number"?(i===0&&a.value===""||a.value!=i)&&(a.value=""+La(i)):a.value!==""+La(i)&&(a.value=""+La(i)):k!=="submit"&&k!=="reset"||a.removeAttribute("value"),i!=null?cf(a,k,La(i)):c!=null?cf(a,k,La(c)):d!=null&&a.removeAttribute("value"),p==null&&v!=null&&(a.defaultChecked=!!v),p!=null&&(a.checked=p&&typeof p!="function"&&typeof p!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?a.name=""+La(L):a.removeAttribute("name")}function _x(a,i,c,d,p,v,k,L){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(a.type=v),i!=null||c!=null){if(!(v!=="submit"&&v!=="reset"||i!=null))return;c=c!=null?""+La(c):"",i=i!=null?""+La(i):c,L||i===a.value||(a.value=i),a.defaultValue=i}d=d??p,d=typeof d!="function"&&typeof d!="symbol"&&!!d,a.checked=L?a.checked:!!d,a.defaultChecked=!!d,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(a.name=k)}function cf(a,i,c){i==="number"&&Vo(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function Ui(a,i,c,d){if(a=a.options,i){i={};for(var p=0;p<c.length;p++)i["$"+c[p]]=!0;for(c=0;c<a.length;c++)p=i.hasOwnProperty("$"+a[c].value),a[c].selected!==p&&(a[c].selected=p),p&&d&&(a[c].defaultSelected=!0)}else{for(c=""+La(c),i=null,p=0;p<a.length;p++){if(a[p].value===c){a[p].selected=!0,d&&(a[p].defaultSelected=!0);return}i!==null||a[p].disabled||(i=a[p])}i!==null&&(i.selected=!0)}}function Sx(a,i,c){if(i!=null&&(i=""+La(i),i!==a.value&&(a.value=i),c==null)){a.defaultValue!==i&&(a.defaultValue=i);return}a.defaultValue=c!=null?""+La(c):""}function Nx(a,i,c,d){if(i==null){if(d!=null){if(c!=null)throw Error(n(92));if(we(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),i=c}c=La(i),a.defaultValue=c,d=a.textContent,d===c&&d!==""&&d!==null&&(a.value=d)}function Ii(a,i){if(i){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=i;return}}a.textContent=i}var w_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ex(a,i,c){var d=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?a.setProperty(i,""):i==="float"?a.cssFloat="":a[i]="":d?a.setProperty(i,c):typeof c!="number"||c===0||w_.has(i)?i==="float"?a.cssFloat=c:a[i]=(""+c).trim():a[i]=c+"px"}function Tx(a,i,c){if(i!=null&&typeof i!="object")throw Error(n(62));if(a=a.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?a.setProperty(d,""):d==="float"?a.cssFloat="":a[d]="");for(var p in i)d=i[p],i.hasOwnProperty(p)&&c[p]!==d&&Ex(a,p,d)}else for(var v in i)i.hasOwnProperty(v)&&Ex(a,v,i[v])}function of(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var b_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),__=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Go(a){return __.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var uf=null;function ff(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Pi=null,zi=null;function kx(a){var i=q(a);if(i&&(a=i.stateNode)){var c=a[Er]||null;e:switch(a=i.stateNode,i.type){case"input":if(lf(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Ba(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var d=c[i];if(d!==a&&d.form===a.form){var p=d[Er]||null;if(!p)throw Error(n(90));lf(d,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(i=0;i<c.length;i++)d=c[i],d.form===a.form&&bx(d)}break e;case"textarea":Sx(a,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&Ui(a,!!c.multiple,i,!1)}}}var df=!1;function Ax(a,i,c){if(df)return a(i,c);df=!0;try{var d=a(i);return d}finally{if(df=!1,(Pi!==null||zi!==null)&&(C0(),Pi&&(i=Pi,a=zi,zi=Pi=null,kx(i),a)))for(i=0;i<a.length;i++)kx(a[i])}}function Xl(a,i){var c=a.stateNode;if(c===null)return null;var d=c[Er]||null;if(d===null)return null;c=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(a=a.type,d=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!d;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(n(231,i,typeof c));return c}var Mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hf=!1;if(Mn)try{var $l={};Object.defineProperty($l,"passive",{get:function(){hf=!0}}),window.addEventListener("test",$l,$l),window.removeEventListener("test",$l,$l)}catch{hf=!1}var us=null,mf=null,Xo=null;function Cx(){if(Xo)return Xo;var a,i=mf,c=i.length,d,p="value"in us?us.value:us.textContent,v=p.length;for(a=0;a<c&&i[a]===p[a];a++);var k=c-a;for(d=1;d<=k&&i[c-d]===p[v-d];d++);return Xo=p.slice(a,1<d?1-d:void 0)}function $o(a){var i=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&i===13&&(a=13)):a=i,a===10&&(a=13),32<=a||a===13?a:0}function Yo(){return!0}function jx(){return!1}function oa(a){function i(c,d,p,v,k){this._reactName=c,this._targetInst=p,this.type=d,this.nativeEvent=v,this.target=k,this.currentTarget=null;for(var L in a)a.hasOwnProperty(L)&&(c=a[L],this[L]=c?c(v):v[L]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Yo:jx,this.isPropagationStopped=jx,this}return x(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Yo)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Yo)},persist:function(){},isPersistent:Yo}),i}var Ks={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qo=oa(Ks),Yl=x({},Ks,{view:0,detail:0}),S_=oa(Yl),xf,pf,ql,Wo=x({},Yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vf,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ql&&(ql&&a.type==="mousemove"?(xf=a.screenX-ql.screenX,pf=a.screenY-ql.screenY):pf=xf=0,ql=a),xf)},movementY:function(a){return"movementY"in a?a.movementY:pf}}),Fx=oa(Wo),N_=x({},Wo,{dataTransfer:0}),E_=oa(N_),T_=x({},Yl,{relatedTarget:0}),gf=oa(T_),k_=x({},Ks,{animationName:0,elapsedTime:0,pseudoElement:0}),A_=oa(k_),C_=x({},Ks,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),j_=oa(C_),F_=x({},Ks,{data:0}),Rx=oa(F_),R_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},D_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function M_(a){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(a):(a=O_[a])?!!i[a]:!1}function vf(){return M_}var L_=x({},Yl,{key:function(a){if(a.key){var i=R_[a.key]||a.key;if(i!=="Unidentified")return i}return a.type==="keypress"?(a=$o(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?D_[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vf,charCode:function(a){return a.type==="keypress"?$o(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?$o(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),B_=oa(L_),U_=x({},Wo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dx=oa(U_),I_=x({},Yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vf}),P_=oa(I_),z_=x({},Ks,{propertyName:0,elapsedTime:0,pseudoElement:0}),H_=oa(z_),V_=x({},Wo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),G_=oa(V_),X_=x({},Ks,{newState:0,oldState:0}),$_=oa(X_),Y_=[9,13,27,32],yf=Mn&&"CompositionEvent"in window,Wl=null;Mn&&"documentMode"in document&&(Wl=document.documentMode);var q_=Mn&&"TextEvent"in window&&!Wl,Ox=Mn&&(!yf||Wl&&8<Wl&&11>=Wl),Mx=" ",Lx=!1;function Bx(a,i){switch(a){case"keyup":return Y_.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ux(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Hi=!1;function W_(a,i){switch(a){case"compositionend":return Ux(i);case"keypress":return i.which!==32?null:(Lx=!0,Mx);case"textInput":return a=i.data,a===Mx&&Lx?null:a;default:return null}}function K_(a,i){if(Hi)return a==="compositionend"||!yf&&Bx(a,i)?(a=Cx(),Xo=mf=us=null,Hi=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Ox&&i.locale!=="ko"?null:i.data;default:return null}}var Z_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ix(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i==="input"?!!Z_[a.type]:i==="textarea"}function Px(a,i,c,d){Pi?zi?zi.push(d):zi=[d]:Pi=d,i=M0(i,"onChange"),0<i.length&&(c=new qo("onChange","change",null,c,d),a.push({event:c,listeners:i}))}var Kl=null,Zl=null;function Q_(a){wg(a,0)}function Ko(a){var i=fe(a);if(bx(i))return a}function zx(a,i){if(a==="change")return i}var Hx=!1;if(Mn){var wf;if(Mn){var bf="oninput"in document;if(!bf){var Vx=document.createElement("div");Vx.setAttribute("oninput","return;"),bf=typeof Vx.oninput=="function"}wf=bf}else wf=!1;Hx=wf&&(!document.documentMode||9<document.documentMode)}function Gx(){Kl&&(Kl.detachEvent("onpropertychange",Xx),Zl=Kl=null)}function Xx(a){if(a.propertyName==="value"&&Ko(Zl)){var i=[];Px(i,Zl,a,ff(a)),Ax(Q_,i)}}function J_(a,i,c){a==="focusin"?(Gx(),Kl=i,Zl=c,Kl.attachEvent("onpropertychange",Xx)):a==="focusout"&&Gx()}function e4(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Ko(Zl)}function t4(a,i){if(a==="click")return Ko(i)}function r4(a,i){if(a==="input"||a==="change")return Ko(i)}function a4(a,i){return a===i&&(a!==0||1/a===1/i)||a!==a&&i!==i}var wa=typeof Object.is=="function"?Object.is:a4;function Ql(a,i){if(wa(a,i))return!0;if(typeof a!="object"||a===null||typeof i!="object"||i===null)return!1;var c=Object.keys(a),d=Object.keys(i);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var p=c[d];if(!Y.call(i,p)||!wa(a[p],i[p]))return!1}return!0}function $x(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Yx(a,i){var c=$x(a);a=0;for(var d;c;){if(c.nodeType===3){if(d=a+c.textContent.length,a<=i&&d>=i)return{node:c,offset:i-a};a=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=$x(c)}}function qx(a,i){return a&&i?a===i?!0:a&&a.nodeType===3?!1:i&&i.nodeType===3?qx(a,i.parentNode):"contains"in a?a.contains(i):a.compareDocumentPosition?!!(a.compareDocumentPosition(i)&16):!1:!1}function Wx(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var i=Vo(a.document);i instanceof a.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)a=i.contentWindow;else break;i=Vo(a.document)}return i}function _f(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i&&(i==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||i==="textarea"||a.contentEditable==="true")}var n4=Mn&&"documentMode"in document&&11>=document.documentMode,Vi=null,Sf=null,Jl=null,Nf=!1;function Kx(a,i,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Nf||Vi==null||Vi!==Vo(d)||(d=Vi,"selectionStart"in d&&_f(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Jl&&Ql(Jl,d)||(Jl=d,d=M0(Sf,"onSelect"),0<d.length&&(i=new qo("onSelect","select",null,i,c),a.push({event:i,listeners:d}),i.target=Vi)))}function Zs(a,i){var c={};return c[a.toLowerCase()]=i.toLowerCase(),c["Webkit"+a]="webkit"+i,c["Moz"+a]="moz"+i,c}var Gi={animationend:Zs("Animation","AnimationEnd"),animationiteration:Zs("Animation","AnimationIteration"),animationstart:Zs("Animation","AnimationStart"),transitionrun:Zs("Transition","TransitionRun"),transitionstart:Zs("Transition","TransitionStart"),transitioncancel:Zs("Transition","TransitionCancel"),transitionend:Zs("Transition","TransitionEnd")},Ef={},Zx={};Mn&&(Zx=document.createElement("div").style,"AnimationEvent"in window||(delete Gi.animationend.animation,delete Gi.animationiteration.animation,delete Gi.animationstart.animation),"TransitionEvent"in window||delete Gi.transitionend.transition);function Qs(a){if(Ef[a])return Ef[a];if(!Gi[a])return a;var i=Gi[a],c;for(c in i)if(i.hasOwnProperty(c)&&c in Zx)return Ef[a]=i[c];return a}var Qx=Qs("animationend"),Jx=Qs("animationiteration"),ep=Qs("animationstart"),s4=Qs("transitionrun"),i4=Qs("transitionstart"),l4=Qs("transitioncancel"),tp=Qs("transitionend"),rp=new Map,Tf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Tf.push("scrollEnd");function nn(a,i){rp.set(a,i),Oe(i,[a])}var ap=new WeakMap;function Ua(a,i){if(typeof a=="object"&&a!==null){var c=ap.get(a);return c!==void 0?c:(i={value:a,source:i,stack:yx(i)},ap.set(a,i),i)}return{value:a,source:i,stack:yx(i)}}var Ia=[],Xi=0,kf=0;function Zo(){for(var a=Xi,i=kf=Xi=0;i<a;){var c=Ia[i];Ia[i++]=null;var d=Ia[i];Ia[i++]=null;var p=Ia[i];Ia[i++]=null;var v=Ia[i];if(Ia[i++]=null,d!==null&&p!==null){var k=d.pending;k===null?p.next=p:(p.next=k.next,k.next=p),d.pending=p}v!==0&&np(c,p,v)}}function Qo(a,i,c,d){Ia[Xi++]=a,Ia[Xi++]=i,Ia[Xi++]=c,Ia[Xi++]=d,kf|=d,a.lanes|=d,a=a.alternate,a!==null&&(a.lanes|=d)}function Af(a,i,c,d){return Qo(a,i,c,d),Jo(a)}function $i(a,i){return Qo(a,null,null,i),Jo(a)}function np(a,i,c){a.lanes|=c;var d=a.alternate;d!==null&&(d.lanes|=c);for(var p=!1,v=a.return;v!==null;)v.childLanes|=c,d=v.alternate,d!==null&&(d.childLanes|=c),v.tag===22&&(a=v.stateNode,a===null||a._visibility&1||(p=!0)),a=v,v=v.return;return a.tag===3?(v=a.stateNode,p&&i!==null&&(p=31-nt(c),a=v.hiddenUpdates,d=a[p],d===null?a[p]=[i]:d.push(i),i.lane=c|536870912),v):null}function Jo(a){if(50<Nc)throw Nc=0,Od=null,Error(n(185));for(var i=a.return;i!==null;)a=i,i=a.return;return a.tag===3?a.stateNode:null}var Yi={};function c4(a,i,c,d){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ba(a,i,c,d){return new c4(a,i,c,d)}function Cf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ln(a,i){var c=a.alternate;return c===null?(c=ba(a.tag,i,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=i,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,i=a.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function sp(a,i){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=i,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,i=c.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),a}function e0(a,i,c,d,p,v){var k=0;if(d=a,typeof a=="function")Cf(a)&&(k=1);else if(typeof a=="string")k=uS(a,c,M.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case U:return a=ba(31,c,i,p),a.elementType=U,a.lanes=v,a;case w:return Js(c.children,p,v,i);case b:k=8,p|=24;break;case _:return a=ba(12,c,i,p|2),a.elementType=_,a.lanes=v,a;case F:return a=ba(13,c,i,p),a.elementType=F,a.lanes=v,a;case R:return a=ba(19,c,i,p),a.elementType=R,a.lanes=v,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case T:case E:k=10;break e;case N:k=9;break e;case j:k=11;break e;case A:k=14;break e;case P:k=16,d=null;break e}k=29,c=Error(n(130,a===null?"null":typeof a,"")),d=null}return i=ba(k,c,i,p),i.elementType=a,i.type=d,i.lanes=v,i}function Js(a,i,c,d){return a=ba(7,a,d,i),a.lanes=c,a}function jf(a,i,c){return a=ba(6,a,null,i),a.lanes=c,a}function Ff(a,i,c){return i=ba(4,a.children!==null?a.children:[],a.key,i),i.lanes=c,i.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},i}var qi=[],Wi=0,t0=null,r0=0,Pa=[],za=0,ei=null,Bn=1,Un="";function ti(a,i){qi[Wi++]=r0,qi[Wi++]=t0,t0=a,r0=i}function ip(a,i,c){Pa[za++]=Bn,Pa[za++]=Un,Pa[za++]=ei,ei=a;var d=Bn;a=Un;var p=32-nt(d)-1;d&=~(1<<p),c+=1;var v=32-nt(i)+p;if(30<v){var k=p-p%5;v=(d&(1<<k)-1).toString(32),d>>=k,p-=k,Bn=1<<32-nt(i)+p|c<<p|d,Un=v+a}else Bn=1<<v|c<<p|d,Un=a}function Rf(a){a.return!==null&&(ti(a,1),ip(a,1,0))}function Df(a){for(;a===t0;)t0=qi[--Wi],qi[Wi]=null,r0=qi[--Wi],qi[Wi]=null;for(;a===ei;)ei=Pa[--za],Pa[za]=null,Un=Pa[--za],Pa[za]=null,Bn=Pa[--za],Pa[za]=null}var aa=null,sr=null,Ft=!1,ri=null,vn=!1,Of=Error(n(519));function ai(a){var i=Error(n(418,""));throw rc(Ua(i,a)),Of}function lp(a){var i=a.stateNode,c=a.type,d=a.memoizedProps;switch(i[Nr]=a,i[Er]=d,c){case"dialog":_t("cancel",i),_t("close",i);break;case"iframe":case"object":case"embed":_t("load",i);break;case"video":case"audio":for(c=0;c<Tc.length;c++)_t(Tc[c],i);break;case"source":_t("error",i);break;case"img":case"image":case"link":_t("error",i),_t("load",i);break;case"details":_t("toggle",i);break;case"input":_t("invalid",i),_x(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),Ho(i);break;case"select":_t("invalid",i);break;case"textarea":_t("invalid",i),Nx(i,d.value,d.defaultValue,d.children),Ho(i)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||d.suppressHydrationWarning===!0||Ng(i.textContent,c)?(d.popover!=null&&(_t("beforetoggle",i),_t("toggle",i)),d.onScroll!=null&&_t("scroll",i),d.onScrollEnd!=null&&_t("scrollend",i),d.onClick!=null&&(i.onclick=L0),i=!0):i=!1,i||ai(a)}function cp(a){for(aa=a.return;aa;)switch(aa.tag){case 5:case 13:vn=!1;return;case 27:case 3:vn=!0;return;default:aa=aa.return}}function ec(a){if(a!==aa)return!1;if(!Ft)return cp(a),Ft=!0,!1;var i=a.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||Kd(a.type,a.memoizedProps)),c=!c),c&&sr&&ai(a),cp(a),i===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,i=0;a;){if(a.nodeType===8)if(c=a.data,c==="/$"){if(i===0){sr=ln(a.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++;a=a.nextSibling}sr=null}}else i===27?(i=sr,Ts(a.type)?(a=eh,eh=null,sr=a):sr=i):sr=aa?ln(a.stateNode.nextSibling):null;return!0}function tc(){sr=aa=null,Ft=!1}function op(){var a=ri;return a!==null&&(da===null?da=a:da.push.apply(da,a),ri=null),a}function rc(a){ri===null?ri=[a]:ri.push(a)}var Mf=te(null),ni=null,In=null;function fs(a,i,c){V(Mf,i._currentValue),i._currentValue=c}function Pn(a){a._currentValue=Mf.current,D(Mf)}function Lf(a,i,c){for(;a!==null;){var d=a.alternate;if((a.childLanes&i)!==i?(a.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),a===c)break;a=a.return}}function Bf(a,i,c,d){var p=a.child;for(p!==null&&(p.return=a);p!==null;){var v=p.dependencies;if(v!==null){var k=p.child;v=v.firstContext;e:for(;v!==null;){var L=v;v=p;for(var Z=0;Z<i.length;Z++)if(L.context===i[Z]){v.lanes|=c,L=v.alternate,L!==null&&(L.lanes|=c),Lf(v.return,c,a),d||(k=null);break e}v=L.next}}else if(p.tag===18){if(k=p.return,k===null)throw Error(n(341));k.lanes|=c,v=k.alternate,v!==null&&(v.lanes|=c),Lf(k,c,a),k=null}else k=p.child;if(k!==null)k.return=p;else for(k=p;k!==null;){if(k===a){k=null;break}if(p=k.sibling,p!==null){p.return=k.return,k=p;break}k=k.return}p=k}}function ac(a,i,c,d){a=null;for(var p=i,v=!1;p!==null;){if(!v){if((p.flags&524288)!==0)v=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var k=p.alternate;if(k===null)throw Error(n(387));if(k=k.memoizedProps,k!==null){var L=p.type;wa(p.pendingProps.value,k.value)||(a!==null?a.push(L):a=[L])}}else if(p===oe.current){if(k=p.alternate,k===null)throw Error(n(387));k.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(a!==null?a.push(Rc):a=[Rc])}p=p.return}a!==null&&Bf(i,a,c,d),i.flags|=262144}function a0(a){for(a=a.firstContext;a!==null;){if(!wa(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function si(a){ni=a,In=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Gr(a){return up(ni,a)}function n0(a,i){return ni===null&&si(a),up(a,i)}function up(a,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},In===null){if(a===null)throw Error(n(308));In=i,a.dependencies={lanes:0,firstContext:i},a.flags|=524288}else In=In.next=i;return c}var o4=typeof AbortController<"u"?AbortController:function(){var a=[],i=this.signal={aborted:!1,addEventListener:function(c,d){a.push(d)}};this.abort=function(){i.aborted=!0,a.forEach(function(c){return c()})}},u4=e.unstable_scheduleCallback,f4=e.unstable_NormalPriority,wr={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uf(){return{controller:new o4,data:new Map,refCount:0}}function nc(a){a.refCount--,a.refCount===0&&u4(f4,function(){a.controller.abort()})}var sc=null,If=0,Ki=0,Zi=null;function d4(a,i){if(sc===null){var c=sc=[];If=0,Ki=zd(),Zi={status:"pending",value:void 0,then:function(d){c.push(d)}}}return If++,i.then(fp,fp),i}function fp(){if(--If===0&&sc!==null){Zi!==null&&(Zi.status="fulfilled");var a=sc;sc=null,Ki=0,Zi=null;for(var i=0;i<a.length;i++)(0,a[i])()}}function h4(a,i){var c=[],d={status:"pending",value:null,reason:null,then:function(p){c.push(p)}};return a.then(function(){d.status="fulfilled",d.value=i;for(var p=0;p<c.length;p++)(0,c[p])(i)},function(p){for(d.status="rejected",d.reason=p,p=0;p<c.length;p++)(0,c[p])(void 0)}),d}var dp=Q.S;Q.S=function(a,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&d4(a,i),dp!==null&&dp(a,i)};var ii=te(null);function Pf(){var a=ii.current;return a!==null?a:Wt.pooledCache}function s0(a,i){i===null?V(ii,ii.current):V(ii,i.pool)}function hp(){var a=Pf();return a===null?null:{parent:wr._currentValue,pool:a}}var ic=Error(n(460)),mp=Error(n(474)),i0=Error(n(542)),zf={then:function(){}};function xp(a){return a=a.status,a==="fulfilled"||a==="rejected"}function l0(){}function pp(a,i,c){switch(c=a[c],c===void 0?a.push(i):c!==i&&(i.then(l0,l0),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,vp(a),a;default:if(typeof i.status=="string")i.then(l0,l0);else{if(a=Wt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=i,a.status="pending",a.then(function(d){if(i.status==="pending"){var p=i;p.status="fulfilled",p.value=d}},function(d){if(i.status==="pending"){var p=i;p.status="rejected",p.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,vp(a),a}throw lc=i,ic}}var lc=null;function gp(){if(lc===null)throw Error(n(459));var a=lc;return lc=null,a}function vp(a){if(a===ic||a===i0)throw Error(n(483))}var ds=!1;function Hf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Vf(a,i){a=a.updateQueue,i.updateQueue===a&&(i.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function hs(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function ms(a,i,c){var d=a.updateQueue;if(d===null)return null;if(d=d.shared,(Ot&2)!==0){var p=d.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),d.pending=i,i=Jo(a),np(a,null,c),i}return Qo(a,d,i,c),Jo(a)}function cc(a,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var d=i.lanes;d&=a.pendingLanes,c|=d,i.lanes=c,Po(a,c)}}function Gf(a,i){var c=a.updateQueue,d=a.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var p=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var k={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};v===null?p=v=k:v=v.next=k,c=c.next}while(c!==null);v===null?p=v=i:v=v.next=i}else p=v=i;c={baseState:d.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:d.shared,callbacks:d.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=i:a.next=i,c.lastBaseUpdate=i}var Xf=!1;function oc(){if(Xf){var a=Zi;if(a!==null)throw a}}function uc(a,i,c,d){Xf=!1;var p=a.updateQueue;ds=!1;var v=p.firstBaseUpdate,k=p.lastBaseUpdate,L=p.shared.pending;if(L!==null){p.shared.pending=null;var Z=L,ue=Z.next;Z.next=null,k===null?v=ue:k.next=ue,k=Z;var Ee=a.alternate;Ee!==null&&(Ee=Ee.updateQueue,L=Ee.lastBaseUpdate,L!==k&&(L===null?Ee.firstBaseUpdate=ue:L.next=ue,Ee.lastBaseUpdate=Z))}if(v!==null){var je=p.baseState;k=0,Ee=ue=Z=null,L=v;do{var me=L.lane&-536870913,ve=me!==L.lane;if(ve?(Nt&me)===me:(d&me)===me){me!==0&&me===Ki&&(Xf=!0),Ee!==null&&(Ee=Ee.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var st=a,Qe=L;me=i;var Vt=c;switch(Qe.tag){case 1:if(st=Qe.payload,typeof st=="function"){je=st.call(Vt,je,me);break e}je=st;break e;case 3:st.flags=st.flags&-65537|128;case 0:if(st=Qe.payload,me=typeof st=="function"?st.call(Vt,je,me):st,me==null)break e;je=x({},je,me);break e;case 2:ds=!0}}me=L.callback,me!==null&&(a.flags|=64,ve&&(a.flags|=8192),ve=p.callbacks,ve===null?p.callbacks=[me]:ve.push(me))}else ve={lane:me,tag:L.tag,payload:L.payload,callback:L.callback,next:null},Ee===null?(ue=Ee=ve,Z=je):Ee=Ee.next=ve,k|=me;if(L=L.next,L===null){if(L=p.shared.pending,L===null)break;ve=L,L=ve.next,ve.next=null,p.lastBaseUpdate=ve,p.shared.pending=null}}while(!0);Ee===null&&(Z=je),p.baseState=Z,p.firstBaseUpdate=ue,p.lastBaseUpdate=Ee,v===null&&(p.shared.lanes=0),_s|=k,a.lanes=k,a.memoizedState=je}}function yp(a,i){if(typeof a!="function")throw Error(n(191,a));a.call(i)}function wp(a,i){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)yp(c[a],i)}var Qi=te(null),c0=te(0);function bp(a,i){a=Yn,V(c0,a),V(Qi,i),Yn=a|i.baseLanes}function $f(){V(c0,Yn),V(Qi,Qi.current)}function Yf(){Yn=c0.current,D(Qi),D(c0)}var xs=0,pt=null,zt=null,xr=null,o0=!1,Ji=!1,li=!1,u0=0,fc=0,el=null,m4=0;function fr(){throw Error(n(321))}function qf(a,i){if(i===null)return!1;for(var c=0;c<i.length&&c<a.length;c++)if(!wa(a[c],i[c]))return!1;return!0}function Wf(a,i,c,d,p,v){return xs=v,pt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Q.H=a===null||a.memoizedState===null?n1:s1,li=!1,v=c(d,p),li=!1,Ji&&(v=Sp(i,c,d,p)),_p(a),v}function _p(a){Q.H=p0;var i=zt!==null&&zt.next!==null;if(xs=0,xr=zt=pt=null,o0=!1,fc=0,el=null,i)throw Error(n(300));a===null||Tr||(a=a.dependencies,a!==null&&a0(a)&&(Tr=!0))}function Sp(a,i,c,d){pt=a;var p=0;do{if(Ji&&(el=null),fc=0,Ji=!1,25<=p)throw Error(n(301));if(p+=1,xr=zt=null,a.updateQueue!=null){var v=a.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}Q.H=b4,v=i(c,d)}while(Ji);return v}function x4(){var a=Q.H,i=a.useState()[0];return i=typeof i.then=="function"?dc(i):i,a=a.useState()[0],(zt!==null?zt.memoizedState:null)!==a&&(pt.flags|=1024),i}function Kf(){var a=u0!==0;return u0=0,a}function Zf(a,i,c){i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~c}function Qf(a){if(o0){for(a=a.memoizedState;a!==null;){var i=a.queue;i!==null&&(i.pending=null),a=a.next}o0=!1}xs=0,xr=zt=pt=null,Ji=!1,fc=u0=0,el=null}function ua(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xr===null?pt.memoizedState=xr=a:xr=xr.next=a,xr}function pr(){if(zt===null){var a=pt.alternate;a=a!==null?a.memoizedState:null}else a=zt.next;var i=xr===null?pt.memoizedState:xr.next;if(i!==null)xr=i,zt=a;else{if(a===null)throw pt.alternate===null?Error(n(467)):Error(n(310));zt=a,a={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},xr===null?pt.memoizedState=xr=a:xr=xr.next=a}return xr}function Jf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function dc(a){var i=fc;return fc+=1,el===null&&(el=[]),a=pp(el,a,i),i=pt,(xr===null?i.memoizedState:xr.next)===null&&(i=i.alternate,Q.H=i===null||i.memoizedState===null?n1:s1),a}function f0(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return dc(a);if(a.$$typeof===E)return Gr(a)}throw Error(n(438,String(a)))}function ed(a){var i=null,c=pt.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var d=pt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(p){return p.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=Jf(),pt.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(a),d=0;d<a;d++)c[d]=ee;return i.index++,c}function zn(a,i){return typeof i=="function"?i(a):i}function d0(a){var i=pr();return td(i,zt,a)}function td(a,i,c){var d=a.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=c;var p=a.baseQueue,v=d.pending;if(v!==null){if(p!==null){var k=p.next;p.next=v.next,v.next=k}i.baseQueue=p=v,d.pending=null}if(v=a.baseState,p===null)a.memoizedState=v;else{i=p.next;var L=k=null,Z=null,ue=i,Ee=!1;do{var je=ue.lane&-536870913;if(je!==ue.lane?(Nt&je)===je:(xs&je)===je){var me=ue.revertLane;if(me===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),je===Ki&&(Ee=!0);else if((xs&me)===me){ue=ue.next,me===Ki&&(Ee=!0);continue}else je={lane:0,revertLane:ue.revertLane,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Z===null?(L=Z=je,k=v):Z=Z.next=je,pt.lanes|=me,_s|=me;je=ue.action,li&&c(v,je),v=ue.hasEagerState?ue.eagerState:c(v,je)}else me={lane:je,revertLane:ue.revertLane,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Z===null?(L=Z=me,k=v):Z=Z.next=me,pt.lanes|=je,_s|=je;ue=ue.next}while(ue!==null&&ue!==i);if(Z===null?k=v:Z.next=L,!wa(v,a.memoizedState)&&(Tr=!0,Ee&&(c=Zi,c!==null)))throw c;a.memoizedState=v,a.baseState=k,a.baseQueue=Z,d.lastRenderedState=v}return p===null&&(d.lanes=0),[a.memoizedState,d.dispatch]}function rd(a){var i=pr(),c=i.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var d=c.dispatch,p=c.pending,v=i.memoizedState;if(p!==null){c.pending=null;var k=p=p.next;do v=a(v,k.action),k=k.next;while(k!==p);wa(v,i.memoizedState)||(Tr=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),c.lastRenderedState=v}return[v,d]}function Np(a,i,c){var d=pt,p=pr(),v=Ft;if(v){if(c===void 0)throw Error(n(407));c=c()}else c=i();var k=!wa((zt||p).memoizedState,c);k&&(p.memoizedState=c,Tr=!0),p=p.queue;var L=kp.bind(null,d,p,a);if(hc(2048,8,L,[a]),p.getSnapshot!==i||k||xr!==null&&xr.memoizedState.tag&1){if(d.flags|=2048,tl(9,h0(),Tp.bind(null,d,p,c,i),null),Wt===null)throw Error(n(349));v||(xs&124)!==0||Ep(d,i,c)}return c}function Ep(a,i,c){a.flags|=16384,a={getSnapshot:i,value:c},i=pt.updateQueue,i===null?(i=Jf(),pt.updateQueue=i,i.stores=[a]):(c=i.stores,c===null?i.stores=[a]:c.push(a))}function Tp(a,i,c,d){i.value=c,i.getSnapshot=d,Ap(i)&&Cp(a)}function kp(a,i,c){return c(function(){Ap(i)&&Cp(a)})}function Ap(a){var i=a.getSnapshot;a=a.value;try{var c=i();return!wa(a,c)}catch{return!0}}function Cp(a){var i=$i(a,2);i!==null&&Ta(i,a,2)}function ad(a){var i=ua();if(typeof a=="function"){var c=a;if(a=c(),li){ut(!0);try{c()}finally{ut(!1)}}}return i.memoizedState=i.baseState=a,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zn,lastRenderedState:a},i}function jp(a,i,c,d){return a.baseState=c,td(a,zt,typeof d=="function"?d:zn)}function p4(a,i,c,d,p){if(x0(a))throw Error(n(485));if(a=i.action,a!==null){var v={payload:p,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){v.listeners.push(k)}};Q.T!==null?c(!0):v.isTransition=!1,d(v),c=i.pending,c===null?(v.next=i.pending=v,Fp(i,v)):(v.next=c.next,i.pending=c.next=v)}}function Fp(a,i){var c=i.action,d=i.payload,p=a.state;if(i.isTransition){var v=Q.T,k={};Q.T=k;try{var L=c(p,d),Z=Q.S;Z!==null&&Z(k,L),Rp(a,i,L)}catch(ue){nd(a,i,ue)}finally{Q.T=v}}else try{v=c(p,d),Rp(a,i,v)}catch(ue){nd(a,i,ue)}}function Rp(a,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){Dp(a,i,d)},function(d){return nd(a,i,d)}):Dp(a,i,c)}function Dp(a,i,c){i.status="fulfilled",i.value=c,Op(i),a.state=c,i=a.pending,i!==null&&(c=i.next,c===i?a.pending=null:(c=c.next,i.next=c,Fp(a,c)))}function nd(a,i,c){var d=a.pending;if(a.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=c,Op(i),i=i.next;while(i!==d)}a.action=null}function Op(a){a=a.listeners;for(var i=0;i<a.length;i++)(0,a[i])()}function Mp(a,i){return i}function Lp(a,i){if(Ft){var c=Wt.formState;if(c!==null){e:{var d=pt;if(Ft){if(sr){t:{for(var p=sr,v=vn;p.nodeType!==8;){if(!v){p=null;break t}if(p=ln(p.nextSibling),p===null){p=null;break t}}v=p.data,p=v==="F!"||v==="F"?p:null}if(p){sr=ln(p.nextSibling),d=p.data==="F!";break e}}ai(d)}d=!1}d&&(i=c[0])}}return c=ua(),c.memoizedState=c.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mp,lastRenderedState:i},c.queue=d,c=t1.bind(null,pt,d),d.dispatch=c,d=ad(!1),v=od.bind(null,pt,!1,d.queue),d=ua(),p={state:i,dispatch:null,action:a,pending:null},d.queue=p,c=p4.bind(null,pt,p,v,c),p.dispatch=c,d.memoizedState=a,[i,c,!1]}function Bp(a){var i=pr();return Up(i,zt,a)}function Up(a,i,c){if(i=td(a,i,Mp)[0],a=d0(zn)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=dc(i)}catch(k){throw k===ic?i0:k}else d=i;i=pr();var p=i.queue,v=p.dispatch;return c!==i.memoizedState&&(pt.flags|=2048,tl(9,h0(),g4.bind(null,p,c),null)),[d,v,a]}function g4(a,i){a.action=i}function Ip(a){var i=pr(),c=zt;if(c!==null)return Up(i,c,a);pr(),i=i.memoizedState,c=pr();var d=c.queue.dispatch;return c.memoizedState=a,[i,d,!1]}function tl(a,i,c,d){return a={tag:a,create:c,deps:d,inst:i,next:null},i=pt.updateQueue,i===null&&(i=Jf(),pt.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,i.lastEffect=a),a}function h0(){return{destroy:void 0,resource:void 0}}function Pp(){return pr().memoizedState}function m0(a,i,c,d){var p=ua();d=d===void 0?null:d,pt.flags|=a,p.memoizedState=tl(1|i,h0(),c,d)}function hc(a,i,c,d){var p=pr();d=d===void 0?null:d;var v=p.memoizedState.inst;zt!==null&&d!==null&&qf(d,zt.memoizedState.deps)?p.memoizedState=tl(i,v,c,d):(pt.flags|=a,p.memoizedState=tl(1|i,v,c,d))}function zp(a,i){m0(8390656,8,a,i)}function Hp(a,i){hc(2048,8,a,i)}function Vp(a,i){return hc(4,2,a,i)}function Gp(a,i){return hc(4,4,a,i)}function Xp(a,i){if(typeof i=="function"){a=a();var c=i(a);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return a=a(),i.current=a,function(){i.current=null}}function $p(a,i,c){c=c!=null?c.concat([a]):null,hc(4,4,Xp.bind(null,i,a),c)}function sd(){}function Yp(a,i){var c=pr();i=i===void 0?null:i;var d=c.memoizedState;return i!==null&&qf(i,d[1])?d[0]:(c.memoizedState=[a,i],a)}function qp(a,i){var c=pr();i=i===void 0?null:i;var d=c.memoizedState;if(i!==null&&qf(i,d[1]))return d[0];if(d=a(),li){ut(!0);try{a()}finally{ut(!1)}}return c.memoizedState=[d,i],d}function id(a,i,c){return c===void 0||(xs&1073741824)!==0?a.memoizedState=i:(a.memoizedState=c,a=Z1(),pt.lanes|=a,_s|=a,c)}function Wp(a,i,c,d){return wa(c,i)?c:Qi.current!==null?(a=id(a,c,d),wa(a,i)||(Tr=!0),a):(xs&42)===0?(Tr=!0,a.memoizedState=c):(a=Z1(),pt.lanes|=a,_s|=a,i)}function Kp(a,i,c,d,p){var v=ie.p;ie.p=v!==0&&8>v?v:8;var k=Q.T,L={};Q.T=L,od(a,!1,i,c);try{var Z=p(),ue=Q.S;if(ue!==null&&ue(L,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var Ee=h4(Z,d);mc(a,i,Ee,Ea(a))}else mc(a,i,d,Ea(a))}catch(je){mc(a,i,{then:function(){},status:"rejected",reason:je},Ea())}finally{ie.p=v,Q.T=k}}function v4(){}function ld(a,i,c,d){if(a.tag!==5)throw Error(n(476));var p=Zp(a).queue;Kp(a,p,i,Ae,c===null?v4:function(){return Qp(a),c(d)})}function Zp(a){var i=a.memoizedState;if(i!==null)return i;i={memoizedState:Ae,baseState:Ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zn,lastRenderedState:Ae},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zn,lastRenderedState:c},next:null},a.memoizedState=i,a=a.alternate,a!==null&&(a.memoizedState=i),i}function Qp(a){var i=Zp(a).next.queue;mc(a,i,{},Ea())}function cd(){return Gr(Rc)}function Jp(){return pr().memoizedState}function e1(){return pr().memoizedState}function y4(a){for(var i=a.return;i!==null;){switch(i.tag){case 24:case 3:var c=Ea();a=hs(c);var d=ms(i,a,c);d!==null&&(Ta(d,i,c),cc(d,i,c)),i={cache:Uf()},a.payload=i;return}i=i.return}}function w4(a,i,c){var d=Ea();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},x0(a)?r1(i,c):(c=Af(a,i,c,d),c!==null&&(Ta(c,a,d),a1(c,i,d)))}function t1(a,i,c){var d=Ea();mc(a,i,c,d)}function mc(a,i,c,d){var p={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(x0(a))r1(i,p);else{var v=a.alternate;if(a.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var k=i.lastRenderedState,L=v(k,c);if(p.hasEagerState=!0,p.eagerState=L,wa(L,k))return Qo(a,i,p,0),Wt===null&&Zo(),!1}catch{}finally{}if(c=Af(a,i,p,d),c!==null)return Ta(c,a,d),a1(c,i,d),!0}return!1}function od(a,i,c,d){if(d={lane:2,revertLane:zd(),action:d,hasEagerState:!1,eagerState:null,next:null},x0(a)){if(i)throw Error(n(479))}else i=Af(a,c,d,2),i!==null&&Ta(i,a,2)}function x0(a){var i=a.alternate;return a===pt||i!==null&&i===pt}function r1(a,i){Ji=o0=!0;var c=a.pending;c===null?i.next=i:(i.next=c.next,c.next=i),a.pending=i}function a1(a,i,c){if((c&4194048)!==0){var d=i.lanes;d&=a.pendingLanes,c|=d,i.lanes=c,Po(a,c)}}var p0={readContext:Gr,use:f0,useCallback:fr,useContext:fr,useEffect:fr,useImperativeHandle:fr,useLayoutEffect:fr,useInsertionEffect:fr,useMemo:fr,useReducer:fr,useRef:fr,useState:fr,useDebugValue:fr,useDeferredValue:fr,useTransition:fr,useSyncExternalStore:fr,useId:fr,useHostTransitionStatus:fr,useFormState:fr,useActionState:fr,useOptimistic:fr,useMemoCache:fr,useCacheRefresh:fr},n1={readContext:Gr,use:f0,useCallback:function(a,i){return ua().memoizedState=[a,i===void 0?null:i],a},useContext:Gr,useEffect:zp,useImperativeHandle:function(a,i,c){c=c!=null?c.concat([a]):null,m0(4194308,4,Xp.bind(null,i,a),c)},useLayoutEffect:function(a,i){return m0(4194308,4,a,i)},useInsertionEffect:function(a,i){m0(4,2,a,i)},useMemo:function(a,i){var c=ua();i=i===void 0?null:i;var d=a();if(li){ut(!0);try{a()}finally{ut(!1)}}return c.memoizedState=[d,i],d},useReducer:function(a,i,c){var d=ua();if(c!==void 0){var p=c(i);if(li){ut(!0);try{c(i)}finally{ut(!1)}}}else p=i;return d.memoizedState=d.baseState=p,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:p},d.queue=a,a=a.dispatch=w4.bind(null,pt,a),[d.memoizedState,a]},useRef:function(a){var i=ua();return a={current:a},i.memoizedState=a},useState:function(a){a=ad(a);var i=a.queue,c=t1.bind(null,pt,i);return i.dispatch=c,[a.memoizedState,c]},useDebugValue:sd,useDeferredValue:function(a,i){var c=ua();return id(c,a,i)},useTransition:function(){var a=ad(!1);return a=Kp.bind(null,pt,a.queue,!0,!1),ua().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,i,c){var d=pt,p=ua();if(Ft){if(c===void 0)throw Error(n(407));c=c()}else{if(c=i(),Wt===null)throw Error(n(349));(Nt&124)!==0||Ep(d,i,c)}p.memoizedState=c;var v={value:c,getSnapshot:i};return p.queue=v,zp(kp.bind(null,d,v,a),[a]),d.flags|=2048,tl(9,h0(),Tp.bind(null,d,v,c,i),null),c},useId:function(){var a=ua(),i=Wt.identifierPrefix;if(Ft){var c=Un,d=Bn;c=(d&~(1<<32-nt(d)-1)).toString(32)+c,i=""+i+"R"+c,c=u0++,0<c&&(i+="H"+c.toString(32)),i+=""}else c=m4++,i=""+i+"r"+c.toString(32)+"";return a.memoizedState=i},useHostTransitionStatus:cd,useFormState:Lp,useActionState:Lp,useOptimistic:function(a){var i=ua();i.memoizedState=i.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=od.bind(null,pt,!0,c),c.dispatch=i,[a,i]},useMemoCache:ed,useCacheRefresh:function(){return ua().memoizedState=y4.bind(null,pt)}},s1={readContext:Gr,use:f0,useCallback:Yp,useContext:Gr,useEffect:Hp,useImperativeHandle:$p,useInsertionEffect:Vp,useLayoutEffect:Gp,useMemo:qp,useReducer:d0,useRef:Pp,useState:function(){return d0(zn)},useDebugValue:sd,useDeferredValue:function(a,i){var c=pr();return Wp(c,zt.memoizedState,a,i)},useTransition:function(){var a=d0(zn)[0],i=pr().memoizedState;return[typeof a=="boolean"?a:dc(a),i]},useSyncExternalStore:Np,useId:Jp,useHostTransitionStatus:cd,useFormState:Bp,useActionState:Bp,useOptimistic:function(a,i){var c=pr();return jp(c,zt,a,i)},useMemoCache:ed,useCacheRefresh:e1},b4={readContext:Gr,use:f0,useCallback:Yp,useContext:Gr,useEffect:Hp,useImperativeHandle:$p,useInsertionEffect:Vp,useLayoutEffect:Gp,useMemo:qp,useReducer:rd,useRef:Pp,useState:function(){return rd(zn)},useDebugValue:sd,useDeferredValue:function(a,i){var c=pr();return zt===null?id(c,a,i):Wp(c,zt.memoizedState,a,i)},useTransition:function(){var a=rd(zn)[0],i=pr().memoizedState;return[typeof a=="boolean"?a:dc(a),i]},useSyncExternalStore:Np,useId:Jp,useHostTransitionStatus:cd,useFormState:Ip,useActionState:Ip,useOptimistic:function(a,i){var c=pr();return zt!==null?jp(c,zt,a,i):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:ed,useCacheRefresh:e1},rl=null,xc=0;function g0(a){var i=xc;return xc+=1,rl===null&&(rl=[]),pp(rl,a,i)}function pc(a,i){i=i.props.ref,a.ref=i!==void 0?i:null}function v0(a,i){throw i.$$typeof===g?Error(n(525)):(a=Object.prototype.toString.call(i),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a)))}function i1(a){var i=a._init;return i(a._payload)}function l1(a){function i(se,ne){if(a){var ce=se.deletions;ce===null?(se.deletions=[ne],se.flags|=16):ce.push(ne)}}function c(se,ne){if(!a)return null;for(;ne!==null;)i(se,ne),ne=ne.sibling;return null}function d(se){for(var ne=new Map;se!==null;)se.key!==null?ne.set(se.key,se):ne.set(se.index,se),se=se.sibling;return ne}function p(se,ne){return se=Ln(se,ne),se.index=0,se.sibling=null,se}function v(se,ne,ce){return se.index=ce,a?(ce=se.alternate,ce!==null?(ce=ce.index,ce<ne?(se.flags|=67108866,ne):ce):(se.flags|=67108866,ne)):(se.flags|=1048576,ne)}function k(se){return a&&se.alternate===null&&(se.flags|=67108866),se}function L(se,ne,ce,ke){return ne===null||ne.tag!==6?(ne=jf(ce,se.mode,ke),ne.return=se,ne):(ne=p(ne,ce),ne.return=se,ne)}function Z(se,ne,ce,ke){var Ge=ce.type;return Ge===w?Ee(se,ne,ce.props.children,ke,ce.key):ne!==null&&(ne.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===P&&i1(Ge)===ne.type)?(ne=p(ne,ce.props),pc(ne,ce),ne.return=se,ne):(ne=e0(ce.type,ce.key,ce.props,null,se.mode,ke),pc(ne,ce),ne.return=se,ne)}function ue(se,ne,ce,ke){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==ce.containerInfo||ne.stateNode.implementation!==ce.implementation?(ne=Ff(ce,se.mode,ke),ne.return=se,ne):(ne=p(ne,ce.children||[]),ne.return=se,ne)}function Ee(se,ne,ce,ke,Ge){return ne===null||ne.tag!==7?(ne=Js(ce,se.mode,ke,Ge),ne.return=se,ne):(ne=p(ne,ce),ne.return=se,ne)}function je(se,ne,ce){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=jf(""+ne,se.mode,ce),ne.return=se,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case y:return ce=e0(ne.type,ne.key,ne.props,null,se.mode,ce),pc(ce,ne),ce.return=se,ce;case S:return ne=Ff(ne,se.mode,ce),ne.return=se,ne;case P:var ke=ne._init;return ne=ke(ne._payload),je(se,ne,ce)}if(we(ne)||J(ne))return ne=Js(ne,se.mode,ce,null),ne.return=se,ne;if(typeof ne.then=="function")return je(se,g0(ne),ce);if(ne.$$typeof===E)return je(se,n0(se,ne),ce);v0(se,ne)}return null}function me(se,ne,ce,ke){var Ge=ne!==null?ne.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return Ge!==null?null:L(se,ne,""+ce,ke);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case y:return ce.key===Ge?Z(se,ne,ce,ke):null;case S:return ce.key===Ge?ue(se,ne,ce,ke):null;case P:return Ge=ce._init,ce=Ge(ce._payload),me(se,ne,ce,ke)}if(we(ce)||J(ce))return Ge!==null?null:Ee(se,ne,ce,ke,null);if(typeof ce.then=="function")return me(se,ne,g0(ce),ke);if(ce.$$typeof===E)return me(se,ne,n0(se,ce),ke);v0(se,ce)}return null}function ve(se,ne,ce,ke,Ge){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return se=se.get(ce)||null,L(ne,se,""+ke,Ge);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case y:return se=se.get(ke.key===null?ce:ke.key)||null,Z(ne,se,ke,Ge);case S:return se=se.get(ke.key===null?ce:ke.key)||null,ue(ne,se,ke,Ge);case P:var yt=ke._init;return ke=yt(ke._payload),ve(se,ne,ce,ke,Ge)}if(we(ke)||J(ke))return se=se.get(ce)||null,Ee(ne,se,ke,Ge,null);if(typeof ke.then=="function")return ve(se,ne,ce,g0(ke),Ge);if(ke.$$typeof===E)return ve(se,ne,ce,n0(ne,ke),Ge);v0(ne,ke)}return null}function st(se,ne,ce,ke){for(var Ge=null,yt=null,Ye=ne,Je=ne=0,Ar=null;Ye!==null&&Je<ce.length;Je++){Ye.index>Je?(Ar=Ye,Ye=null):Ar=Ye.sibling;var At=me(se,Ye,ce[Je],ke);if(At===null){Ye===null&&(Ye=Ar);break}a&&Ye&&At.alternate===null&&i(se,Ye),ne=v(At,ne,Je),yt===null?Ge=At:yt.sibling=At,yt=At,Ye=Ar}if(Je===ce.length)return c(se,Ye),Ft&&ti(se,Je),Ge;if(Ye===null){for(;Je<ce.length;Je++)Ye=je(se,ce[Je],ke),Ye!==null&&(ne=v(Ye,ne,Je),yt===null?Ge=Ye:yt.sibling=Ye,yt=Ye);return Ft&&ti(se,Je),Ge}for(Ye=d(Ye);Je<ce.length;Je++)Ar=ve(Ye,se,Je,ce[Je],ke),Ar!==null&&(a&&Ar.alternate!==null&&Ye.delete(Ar.key===null?Je:Ar.key),ne=v(Ar,ne,Je),yt===null?Ge=Ar:yt.sibling=Ar,yt=Ar);return a&&Ye.forEach(function(Fs){return i(se,Fs)}),Ft&&ti(se,Je),Ge}function Qe(se,ne,ce,ke){if(ce==null)throw Error(n(151));for(var Ge=null,yt=null,Ye=ne,Je=ne=0,Ar=null,At=ce.next();Ye!==null&&!At.done;Je++,At=ce.next()){Ye.index>Je?(Ar=Ye,Ye=null):Ar=Ye.sibling;var Fs=me(se,Ye,At.value,ke);if(Fs===null){Ye===null&&(Ye=Ar);break}a&&Ye&&Fs.alternate===null&&i(se,Ye),ne=v(Fs,ne,Je),yt===null?Ge=Fs:yt.sibling=Fs,yt=Fs,Ye=Ar}if(At.done)return c(se,Ye),Ft&&ti(se,Je),Ge;if(Ye===null){for(;!At.done;Je++,At=ce.next())At=je(se,At.value,ke),At!==null&&(ne=v(At,ne,Je),yt===null?Ge=At:yt.sibling=At,yt=At);return Ft&&ti(se,Je),Ge}for(Ye=d(Ye);!At.done;Je++,At=ce.next())At=ve(Ye,se,Je,At.value,ke),At!==null&&(a&&At.alternate!==null&&Ye.delete(At.key===null?Je:At.key),ne=v(At,ne,Je),yt===null?Ge=At:yt.sibling=At,yt=At);return a&&Ye.forEach(function(_S){return i(se,_S)}),Ft&&ti(se,Je),Ge}function Vt(se,ne,ce,ke){if(typeof ce=="object"&&ce!==null&&ce.type===w&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case y:e:{for(var Ge=ce.key;ne!==null;){if(ne.key===Ge){if(Ge=ce.type,Ge===w){if(ne.tag===7){c(se,ne.sibling),ke=p(ne,ce.props.children),ke.return=se,se=ke;break e}}else if(ne.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===P&&i1(Ge)===ne.type){c(se,ne.sibling),ke=p(ne,ce.props),pc(ke,ce),ke.return=se,se=ke;break e}c(se,ne);break}else i(se,ne);ne=ne.sibling}ce.type===w?(ke=Js(ce.props.children,se.mode,ke,ce.key),ke.return=se,se=ke):(ke=e0(ce.type,ce.key,ce.props,null,se.mode,ke),pc(ke,ce),ke.return=se,se=ke)}return k(se);case S:e:{for(Ge=ce.key;ne!==null;){if(ne.key===Ge)if(ne.tag===4&&ne.stateNode.containerInfo===ce.containerInfo&&ne.stateNode.implementation===ce.implementation){c(se,ne.sibling),ke=p(ne,ce.children||[]),ke.return=se,se=ke;break e}else{c(se,ne);break}else i(se,ne);ne=ne.sibling}ke=Ff(ce,se.mode,ke),ke.return=se,se=ke}return k(se);case P:return Ge=ce._init,ce=Ge(ce._payload),Vt(se,ne,ce,ke)}if(we(ce))return st(se,ne,ce,ke);if(J(ce)){if(Ge=J(ce),typeof Ge!="function")throw Error(n(150));return ce=Ge.call(ce),Qe(se,ne,ce,ke)}if(typeof ce.then=="function")return Vt(se,ne,g0(ce),ke);if(ce.$$typeof===E)return Vt(se,ne,n0(se,ce),ke);v0(se,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,ne!==null&&ne.tag===6?(c(se,ne.sibling),ke=p(ne,ce),ke.return=se,se=ke):(c(se,ne),ke=jf(ce,se.mode,ke),ke.return=se,se=ke),k(se)):c(se,ne)}return function(se,ne,ce,ke){try{xc=0;var Ge=Vt(se,ne,ce,ke);return rl=null,Ge}catch(Ye){if(Ye===ic||Ye===i0)throw Ye;var yt=ba(29,Ye,null,se.mode);return yt.lanes=ke,yt.return=se,yt}finally{}}}var al=l1(!0),c1=l1(!1),Ha=te(null),yn=null;function ps(a){var i=a.alternate;V(br,br.current&1),V(Ha,a),yn===null&&(i===null||Qi.current!==null||i.memoizedState!==null)&&(yn=a)}function o1(a){if(a.tag===22){if(V(br,br.current),V(Ha,a),yn===null){var i=a.alternate;i!==null&&i.memoizedState!==null&&(yn=a)}}else gs()}function gs(){V(br,br.current),V(Ha,Ha.current)}function Hn(a){D(Ha),yn===a&&(yn=null),D(br)}var br=te(0);function y0(a){for(var i=a;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||Jd(c)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function ud(a,i,c,d){i=a.memoizedState,c=c(d,i),c=c==null?i:x({},i,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var fd={enqueueSetState:function(a,i,c){a=a._reactInternals;var d=Ea(),p=hs(d);p.payload=i,c!=null&&(p.callback=c),i=ms(a,p,d),i!==null&&(Ta(i,a,d),cc(i,a,d))},enqueueReplaceState:function(a,i,c){a=a._reactInternals;var d=Ea(),p=hs(d);p.tag=1,p.payload=i,c!=null&&(p.callback=c),i=ms(a,p,d),i!==null&&(Ta(i,a,d),cc(i,a,d))},enqueueForceUpdate:function(a,i){a=a._reactInternals;var c=Ea(),d=hs(c);d.tag=2,i!=null&&(d.callback=i),i=ms(a,d,c),i!==null&&(Ta(i,a,c),cc(i,a,c))}};function u1(a,i,c,d,p,v,k){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(d,v,k):i.prototype&&i.prototype.isPureReactComponent?!Ql(c,d)||!Ql(p,v):!0}function f1(a,i,c,d){a=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,d),i.state!==a&&fd.enqueueReplaceState(i,i.state,null)}function ci(a,i){var c=i;if("ref"in i){c={};for(var d in i)d!=="ref"&&(c[d]=i[d])}if(a=a.defaultProps){c===i&&(c=x({},c));for(var p in a)c[p]===void 0&&(c[p]=a[p])}return c}var w0=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function d1(a){w0(a)}function h1(a){console.error(a)}function m1(a){w0(a)}function b0(a,i){try{var c=a.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function x1(a,i,c){try{var d=a.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function dd(a,i,c){return c=hs(c),c.tag=3,c.payload={element:null},c.callback=function(){b0(a,i)},c}function p1(a){return a=hs(a),a.tag=3,a}function g1(a,i,c,d){var p=c.type.getDerivedStateFromError;if(typeof p=="function"){var v=d.value;a.payload=function(){return p(v)},a.callback=function(){x1(i,c,d)}}var k=c.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(a.callback=function(){x1(i,c,d),typeof p!="function"&&(Ss===null?Ss=new Set([this]):Ss.add(this));var L=d.stack;this.componentDidCatch(d.value,{componentStack:L!==null?L:""})})}function _4(a,i,c,d,p){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=c.alternate,i!==null&&ac(i,c,p,!0),c=Ha.current,c!==null){switch(c.tag){case 13:return yn===null?Ld():c.alternate===null&&ir===0&&(ir=3),c.flags&=-257,c.flags|=65536,c.lanes=p,d===zf?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([d]):i.add(d),Ud(a,d,p)),!1;case 22:return c.flags|=65536,d===zf?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([d]):c.add(d)),Ud(a,d,p)),!1}throw Error(n(435,c.tag))}return Ud(a,d,p),Ld(),!1}if(Ft)return i=Ha.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=p,d!==Of&&(a=Error(n(422),{cause:d}),rc(Ua(a,c)))):(d!==Of&&(i=Error(n(423),{cause:d}),rc(Ua(i,c))),a=a.current.alternate,a.flags|=65536,p&=-p,a.lanes|=p,d=Ua(d,c),p=dd(a.stateNode,d,p),Gf(a,p),ir!==4&&(ir=2)),!1;var v=Error(n(520),{cause:d});if(v=Ua(v,c),Sc===null?Sc=[v]:Sc.push(v),ir!==4&&(ir=2),i===null)return!0;d=Ua(d,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,a=p&-p,c.lanes|=a,a=dd(c.stateNode,d,a),Gf(c,a),!1;case 1:if(i=c.type,v=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Ss===null||!Ss.has(v))))return c.flags|=65536,p&=-p,c.lanes|=p,p=p1(p),g1(p,a,c,d),Gf(c,p),!1}c=c.return}while(c!==null);return!1}var v1=Error(n(461)),Tr=!1;function Or(a,i,c,d){i.child=a===null?c1(i,null,c,d):al(i,a.child,c,d)}function y1(a,i,c,d,p){c=c.render;var v=i.ref;if("ref"in d){var k={};for(var L in d)L!=="ref"&&(k[L]=d[L])}else k=d;return si(i),d=Wf(a,i,c,k,v,p),L=Kf(),a!==null&&!Tr?(Zf(a,i,p),Vn(a,i,p)):(Ft&&L&&Rf(i),i.flags|=1,Or(a,i,d,p),i.child)}function w1(a,i,c,d,p){if(a===null){var v=c.type;return typeof v=="function"&&!Cf(v)&&v.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=v,b1(a,i,v,d,p)):(a=e0(c.type,null,d,i,i.mode,p),a.ref=i.ref,a.return=i,i.child=a)}if(v=a.child,!wd(a,p)){var k=v.memoizedProps;if(c=c.compare,c=c!==null?c:Ql,c(k,d)&&a.ref===i.ref)return Vn(a,i,p)}return i.flags|=1,a=Ln(v,d),a.ref=i.ref,a.return=i,i.child=a}function b1(a,i,c,d,p){if(a!==null){var v=a.memoizedProps;if(Ql(v,d)&&a.ref===i.ref)if(Tr=!1,i.pendingProps=d=v,wd(a,p))(a.flags&131072)!==0&&(Tr=!0);else return i.lanes=a.lanes,Vn(a,i,p)}return hd(a,i,c,d,p)}function _1(a,i,c){var d=i.pendingProps,p=d.children,v=a!==null?a.memoizedState:null;if(d.mode==="hidden"){if((i.flags&128)!==0){if(d=v!==null?v.baseLanes|c:c,a!==null){for(p=i.child=a.child,v=0;p!==null;)v=v|p.lanes|p.childLanes,p=p.sibling;i.childLanes=v&~d}else i.childLanes=0,i.child=null;return S1(a,i,d,c)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},a!==null&&s0(i,v!==null?v.cachePool:null),v!==null?bp(i,v):$f(),o1(i);else return i.lanes=i.childLanes=536870912,S1(a,i,v!==null?v.baseLanes|c:c,c)}else v!==null?(s0(i,v.cachePool),bp(i,v),gs(),i.memoizedState=null):(a!==null&&s0(i,null),$f(),gs());return Or(a,i,p,c),i.child}function S1(a,i,c,d){var p=Pf();return p=p===null?null:{parent:wr._currentValue,pool:p},i.memoizedState={baseLanes:c,cachePool:p},a!==null&&s0(i,null),$f(),o1(i),a!==null&&ac(a,i,d,!0),null}function _0(a,i){var c=i.ref;if(c===null)a!==null&&a.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(a===null||a.ref!==c)&&(i.flags|=4194816)}}function hd(a,i,c,d,p){return si(i),c=Wf(a,i,c,d,void 0,p),d=Kf(),a!==null&&!Tr?(Zf(a,i,p),Vn(a,i,p)):(Ft&&d&&Rf(i),i.flags|=1,Or(a,i,c,p),i.child)}function N1(a,i,c,d,p,v){return si(i),i.updateQueue=null,c=Sp(i,d,c,p),_p(a),d=Kf(),a!==null&&!Tr?(Zf(a,i,v),Vn(a,i,v)):(Ft&&d&&Rf(i),i.flags|=1,Or(a,i,c,v),i.child)}function E1(a,i,c,d,p){if(si(i),i.stateNode===null){var v=Yi,k=c.contextType;typeof k=="object"&&k!==null&&(v=Gr(k)),v=new c(d,v),i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=fd,i.stateNode=v,v._reactInternals=i,v=i.stateNode,v.props=d,v.state=i.memoizedState,v.refs={},Hf(i),k=c.contextType,v.context=typeof k=="object"&&k!==null?Gr(k):Yi,v.state=i.memoizedState,k=c.getDerivedStateFromProps,typeof k=="function"&&(ud(i,c,k,d),v.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(k=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),k!==v.state&&fd.enqueueReplaceState(v,v.state,null),uc(i,d,v,p),oc(),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(a===null){v=i.stateNode;var L=i.memoizedProps,Z=ci(c,L);v.props=Z;var ue=v.context,Ee=c.contextType;k=Yi,typeof Ee=="object"&&Ee!==null&&(k=Gr(Ee));var je=c.getDerivedStateFromProps;Ee=typeof je=="function"||typeof v.getSnapshotBeforeUpdate=="function",L=i.pendingProps!==L,Ee||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(L||ue!==k)&&f1(i,v,d,k),ds=!1;var me=i.memoizedState;v.state=me,uc(i,d,v,p),oc(),ue=i.memoizedState,L||me!==ue||ds?(typeof je=="function"&&(ud(i,c,je,d),ue=i.memoizedState),(Z=ds||u1(i,c,Z,d,me,ue,k))?(Ee||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=ue),v.props=d,v.state=ue,v.context=k,d=Z):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{v=i.stateNode,Vf(a,i),k=i.memoizedProps,Ee=ci(c,k),v.props=Ee,je=i.pendingProps,me=v.context,ue=c.contextType,Z=Yi,typeof ue=="object"&&ue!==null&&(Z=Gr(ue)),L=c.getDerivedStateFromProps,(ue=typeof L=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(k!==je||me!==Z)&&f1(i,v,d,Z),ds=!1,me=i.memoizedState,v.state=me,uc(i,d,v,p),oc();var ve=i.memoizedState;k!==je||me!==ve||ds||a!==null&&a.dependencies!==null&&a0(a.dependencies)?(typeof L=="function"&&(ud(i,c,L,d),ve=i.memoizedState),(Ee=ds||u1(i,c,Ee,d,me,ve,Z)||a!==null&&a.dependencies!==null&&a0(a.dependencies))?(ue||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(d,ve,Z),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(d,ve,Z)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||k===a.memoizedProps&&me===a.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||k===a.memoizedProps&&me===a.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=ve),v.props=d,v.state=ve,v.context=Z,d=Ee):(typeof v.componentDidUpdate!="function"||k===a.memoizedProps&&me===a.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||k===a.memoizedProps&&me===a.memoizedState||(i.flags|=1024),d=!1)}return v=d,_0(a,i),d=(i.flags&128)!==0,v||d?(v=i.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:v.render(),i.flags|=1,a!==null&&d?(i.child=al(i,a.child,null,p),i.child=al(i,null,c,p)):Or(a,i,c,p),i.memoizedState=v.state,a=i.child):a=Vn(a,i,p),a}function T1(a,i,c,d){return tc(),i.flags|=256,Or(a,i,c,d),i.child}var md={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xd(a){return{baseLanes:a,cachePool:hp()}}function pd(a,i,c){return a=a!==null?a.childLanes&~c:0,i&&(a|=Va),a}function k1(a,i,c){var d=i.pendingProps,p=!1,v=(i.flags&128)!==0,k;if((k=v)||(k=a!==null&&a.memoizedState===null?!1:(br.current&2)!==0),k&&(p=!0,i.flags&=-129),k=(i.flags&32)!==0,i.flags&=-33,a===null){if(Ft){if(p?ps(i):gs(),Ft){var L=sr,Z;if(Z=L){e:{for(Z=L,L=vn;Z.nodeType!==8;){if(!L){L=null;break e}if(Z=ln(Z.nextSibling),Z===null){L=null;break e}}L=Z}L!==null?(i.memoizedState={dehydrated:L,treeContext:ei!==null?{id:Bn,overflow:Un}:null,retryLane:536870912,hydrationErrors:null},Z=ba(18,null,null,0),Z.stateNode=L,Z.return=i,i.child=Z,aa=i,sr=null,Z=!0):Z=!1}Z||ai(i)}if(L=i.memoizedState,L!==null&&(L=L.dehydrated,L!==null))return Jd(L)?i.lanes=32:i.lanes=536870912,null;Hn(i)}return L=d.children,d=d.fallback,p?(gs(),p=i.mode,L=S0({mode:"hidden",children:L},p),d=Js(d,p,c,null),L.return=i,d.return=i,L.sibling=d,i.child=L,p=i.child,p.memoizedState=xd(c),p.childLanes=pd(a,k,c),i.memoizedState=md,d):(ps(i),gd(i,L))}if(Z=a.memoizedState,Z!==null&&(L=Z.dehydrated,L!==null)){if(v)i.flags&256?(ps(i),i.flags&=-257,i=vd(a,i,c)):i.memoizedState!==null?(gs(),i.child=a.child,i.flags|=128,i=null):(gs(),p=d.fallback,L=i.mode,d=S0({mode:"visible",children:d.children},L),p=Js(p,L,c,null),p.flags|=2,d.return=i,p.return=i,d.sibling=p,i.child=d,al(i,a.child,null,c),d=i.child,d.memoizedState=xd(c),d.childLanes=pd(a,k,c),i.memoizedState=md,i=p);else if(ps(i),Jd(L)){if(k=L.nextSibling&&L.nextSibling.dataset,k)var ue=k.dgst;k=ue,d=Error(n(419)),d.stack="",d.digest=k,rc({value:d,source:null,stack:null}),i=vd(a,i,c)}else if(Tr||ac(a,i,c,!1),k=(c&a.childLanes)!==0,Tr||k){if(k=Wt,k!==null&&(d=c&-c,d=(d&42)!==0?1:Hl(d),d=(d&(k.suspendedLanes|c))!==0?0:d,d!==0&&d!==Z.retryLane))throw Z.retryLane=d,$i(a,d),Ta(k,a,d),v1;L.data==="$?"||Ld(),i=vd(a,i,c)}else L.data==="$?"?(i.flags|=192,i.child=a.child,i=null):(a=Z.treeContext,sr=ln(L.nextSibling),aa=i,Ft=!0,ri=null,vn=!1,a!==null&&(Pa[za++]=Bn,Pa[za++]=Un,Pa[za++]=ei,Bn=a.id,Un=a.overflow,ei=i),i=gd(i,d.children),i.flags|=4096);return i}return p?(gs(),p=d.fallback,L=i.mode,Z=a.child,ue=Z.sibling,d=Ln(Z,{mode:"hidden",children:d.children}),d.subtreeFlags=Z.subtreeFlags&65011712,ue!==null?p=Ln(ue,p):(p=Js(p,L,c,null),p.flags|=2),p.return=i,d.return=i,d.sibling=p,i.child=d,d=p,p=i.child,L=a.child.memoizedState,L===null?L=xd(c):(Z=L.cachePool,Z!==null?(ue=wr._currentValue,Z=Z.parent!==ue?{parent:ue,pool:ue}:Z):Z=hp(),L={baseLanes:L.baseLanes|c,cachePool:Z}),p.memoizedState=L,p.childLanes=pd(a,k,c),i.memoizedState=md,d):(ps(i),c=a.child,a=c.sibling,c=Ln(c,{mode:"visible",children:d.children}),c.return=i,c.sibling=null,a!==null&&(k=i.deletions,k===null?(i.deletions=[a],i.flags|=16):k.push(a)),i.child=c,i.memoizedState=null,c)}function gd(a,i){return i=S0({mode:"visible",children:i},a.mode),i.return=a,a.child=i}function S0(a,i){return a=ba(22,a,null,i),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function vd(a,i,c){return al(i,a.child,null,c),a=gd(i,i.pendingProps.children),a.flags|=2,i.memoizedState=null,a}function A1(a,i,c){a.lanes|=i;var d=a.alternate;d!==null&&(d.lanes|=i),Lf(a.return,i,c)}function yd(a,i,c,d,p){var v=a.memoizedState;v===null?a.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:p}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=d,v.tail=c,v.tailMode=p)}function C1(a,i,c){var d=i.pendingProps,p=d.revealOrder,v=d.tail;if(Or(a,i,d.children,c),d=br.current,(d&2)!==0)d=d&1|2,i.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=i.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&A1(a,c,i);else if(a.tag===19)A1(a,c,i);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}d&=1}switch(V(br,d),p){case"forwards":for(c=i.child,p=null;c!==null;)a=c.alternate,a!==null&&y0(a)===null&&(p=c),c=c.sibling;c=p,c===null?(p=i.child,i.child=null):(p=c.sibling,c.sibling=null),yd(i,!1,p,c,v);break;case"backwards":for(c=null,p=i.child,i.child=null;p!==null;){if(a=p.alternate,a!==null&&y0(a)===null){i.child=p;break}a=p.sibling,p.sibling=c,c=p,p=a}yd(i,!0,c,null,v);break;case"together":yd(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Vn(a,i,c){if(a!==null&&(i.dependencies=a.dependencies),_s|=i.lanes,(c&i.childLanes)===0)if(a!==null){if(ac(a,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(a!==null&&i.child!==a.child)throw Error(n(153));if(i.child!==null){for(a=i.child,c=Ln(a,a.pendingProps),i.child=c,c.return=i;a.sibling!==null;)a=a.sibling,c=c.sibling=Ln(a,a.pendingProps),c.return=i;c.sibling=null}return i.child}function wd(a,i){return(a.lanes&i)!==0?!0:(a=a.dependencies,!!(a!==null&&a0(a)))}function S4(a,i,c){switch(i.tag){case 3:ye(i,i.stateNode.containerInfo),fs(i,wr,a.memoizedState.cache),tc();break;case 27:case 5:ae(i);break;case 4:ye(i,i.stateNode.containerInfo);break;case 10:fs(i,i.type,i.memoizedProps.value);break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(ps(i),i.flags|=128,null):(c&i.child.childLanes)!==0?k1(a,i,c):(ps(i),a=Vn(a,i,c),a!==null?a.sibling:null);ps(i);break;case 19:var p=(a.flags&128)!==0;if(d=(c&i.childLanes)!==0,d||(ac(a,i,c,!1),d=(c&i.childLanes)!==0),p){if(d)return C1(a,i,c);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),V(br,br.current),d)break;return null;case 22:case 23:return i.lanes=0,_1(a,i,c);case 24:fs(i,wr,a.memoizedState.cache)}return Vn(a,i,c)}function j1(a,i,c){if(a!==null)if(a.memoizedProps!==i.pendingProps)Tr=!0;else{if(!wd(a,c)&&(i.flags&128)===0)return Tr=!1,S4(a,i,c);Tr=(a.flags&131072)!==0}else Tr=!1,Ft&&(i.flags&1048576)!==0&&ip(i,r0,i.index);switch(i.lanes=0,i.tag){case 16:e:{a=i.pendingProps;var d=i.elementType,p=d._init;if(d=p(d._payload),i.type=d,typeof d=="function")Cf(d)?(a=ci(d,a),i.tag=1,i=E1(null,i,d,a,c)):(i.tag=0,i=hd(null,i,d,a,c));else{if(d!=null){if(p=d.$$typeof,p===j){i.tag=11,i=y1(null,i,d,a,c);break e}else if(p===A){i.tag=14,i=w1(null,i,d,a,c);break e}}throw i=pe(d)||d,Error(n(306,i,""))}}return i;case 0:return hd(a,i,i.type,i.pendingProps,c);case 1:return d=i.type,p=ci(d,i.pendingProps),E1(a,i,d,p,c);case 3:e:{if(ye(i,i.stateNode.containerInfo),a===null)throw Error(n(387));d=i.pendingProps;var v=i.memoizedState;p=v.element,Vf(a,i),uc(i,d,null,c);var k=i.memoizedState;if(d=k.cache,fs(i,wr,d),d!==v.cache&&Bf(i,[wr],c,!0),oc(),d=k.element,v.isDehydrated)if(v={element:d,isDehydrated:!1,cache:k.cache},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){i=T1(a,i,d,c);break e}else if(d!==p){p=Ua(Error(n(424)),i),rc(p),i=T1(a,i,d,c);break e}else{switch(a=i.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(sr=ln(a.firstChild),aa=i,Ft=!0,ri=null,vn=!0,c=c1(i,null,d,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(tc(),d===p){i=Vn(a,i,c);break e}Or(a,i,d,c)}i=i.child}return i;case 26:return _0(a,i),a===null?(c=Og(i.type,null,i.pendingProps,null))?i.memoizedState=c:Ft||(c=i.type,a=i.pendingProps,d=B0(K.current).createElement(c),d[Nr]=i,d[Er]=a,Lr(d,c,a),le(d),i.stateNode=d):i.memoizedState=Og(i.type,a.memoizedProps,i.pendingProps,a.memoizedState),null;case 27:return ae(i),a===null&&Ft&&(d=i.stateNode=Fg(i.type,i.pendingProps,K.current),aa=i,vn=!0,p=sr,Ts(i.type)?(eh=p,sr=ln(d.firstChild)):sr=p),Or(a,i,i.pendingProps.children,c),_0(a,i),a===null&&(i.flags|=4194304),i.child;case 5:return a===null&&Ft&&((p=d=sr)&&(d=Z4(d,i.type,i.pendingProps,vn),d!==null?(i.stateNode=d,aa=i,sr=ln(d.firstChild),vn=!1,p=!0):p=!1),p||ai(i)),ae(i),p=i.type,v=i.pendingProps,k=a!==null?a.memoizedProps:null,d=v.children,Kd(p,v)?d=null:k!==null&&Kd(p,k)&&(i.flags|=32),i.memoizedState!==null&&(p=Wf(a,i,x4,null,null,c),Rc._currentValue=p),_0(a,i),Or(a,i,d,c),i.child;case 6:return a===null&&Ft&&((a=c=sr)&&(c=Q4(c,i.pendingProps,vn),c!==null?(i.stateNode=c,aa=i,sr=null,a=!0):a=!1),a||ai(i)),null;case 13:return k1(a,i,c);case 4:return ye(i,i.stateNode.containerInfo),d=i.pendingProps,a===null?i.child=al(i,null,d,c):Or(a,i,d,c),i.child;case 11:return y1(a,i,i.type,i.pendingProps,c);case 7:return Or(a,i,i.pendingProps,c),i.child;case 8:return Or(a,i,i.pendingProps.children,c),i.child;case 12:return Or(a,i,i.pendingProps.children,c),i.child;case 10:return d=i.pendingProps,fs(i,i.type,d.value),Or(a,i,d.children,c),i.child;case 9:return p=i.type._context,d=i.pendingProps.children,si(i),p=Gr(p),d=d(p),i.flags|=1,Or(a,i,d,c),i.child;case 14:return w1(a,i,i.type,i.pendingProps,c);case 15:return b1(a,i,i.type,i.pendingProps,c);case 19:return C1(a,i,c);case 31:return d=i.pendingProps,c=i.mode,d={mode:d.mode,children:d.children},a===null?(c=S0(d,c),c.ref=i.ref,i.child=c,c.return=i,i=c):(c=Ln(a.child,d),c.ref=i.ref,i.child=c,c.return=i,i=c),i;case 22:return _1(a,i,c);case 24:return si(i),d=Gr(wr),a===null?(p=Pf(),p===null&&(p=Wt,v=Uf(),p.pooledCache=v,v.refCount++,v!==null&&(p.pooledCacheLanes|=c),p=v),i.memoizedState={parent:d,cache:p},Hf(i),fs(i,wr,p)):((a.lanes&c)!==0&&(Vf(a,i),uc(i,null,null,c),oc()),p=a.memoizedState,v=i.memoizedState,p.parent!==d?(p={parent:d,cache:d},i.memoizedState=p,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=p),fs(i,wr,d)):(d=v.cache,fs(i,wr,d),d!==p.cache&&Bf(i,[wr],c,!0))),Or(a,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(n(156,i.tag))}function Gn(a){a.flags|=4}function F1(a,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!Ig(i)){if(i=Ha.current,i!==null&&((Nt&4194048)===Nt?yn!==null:(Nt&62914560)!==Nt&&(Nt&536870912)===0||i!==yn))throw lc=zf,mp;a.flags|=8192}}function N0(a,i){i!==null&&(a.flags|=4),a.flags&16384&&(i=a.tag!==22?tn():536870912,a.lanes|=i,ll|=i)}function gc(a,i){if(!Ft)switch(a.tailMode){case"hidden":i=a.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?i||a.tail===null?a.tail=null:a.tail.sibling=null:d.sibling=null}}function ar(a){var i=a.alternate!==null&&a.alternate.child===a.child,c=0,d=0;if(i)for(var p=a.child;p!==null;)c|=p.lanes|p.childLanes,d|=p.subtreeFlags&65011712,d|=p.flags&65011712,p.return=a,p=p.sibling;else for(p=a.child;p!==null;)c|=p.lanes|p.childLanes,d|=p.subtreeFlags,d|=p.flags,p.return=a,p=p.sibling;return a.subtreeFlags|=d,a.childLanes=c,i}function N4(a,i,c){var d=i.pendingProps;switch(Df(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ar(i),null;case 1:return ar(i),null;case 3:return c=i.stateNode,d=null,a!==null&&(d=a.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),Pn(wr),_e(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(ec(i)?Gn(i):a===null||a.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,op())),ar(i),null;case 26:return c=i.memoizedState,a===null?(Gn(i),c!==null?(ar(i),F1(i,c)):(ar(i),i.flags&=-16777217)):c?c!==a.memoizedState?(Gn(i),ar(i),F1(i,c)):(ar(i),i.flags&=-16777217):(a.memoizedProps!==d&&Gn(i),ar(i),i.flags&=-16777217),null;case 27:He(i),c=K.current;var p=i.type;if(a!==null&&i.stateNode!=null)a.memoizedProps!==d&&Gn(i);else{if(!d){if(i.stateNode===null)throw Error(n(166));return ar(i),null}a=M.current,ec(i)?lp(i):(a=Fg(p,d,c),i.stateNode=a,Gn(i))}return ar(i),null;case 5:if(He(i),c=i.type,a!==null&&i.stateNode!=null)a.memoizedProps!==d&&Gn(i);else{if(!d){if(i.stateNode===null)throw Error(n(166));return ar(i),null}if(a=M.current,ec(i))lp(i);else{switch(p=B0(K.current),a){case 1:a=p.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:a=p.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":a=p.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":a=p.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":a=p.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof d.is=="string"?p.createElement("select",{is:d.is}):p.createElement("select"),d.multiple?a.multiple=!0:d.size&&(a.size=d.size);break;default:a=typeof d.is=="string"?p.createElement(c,{is:d.is}):p.createElement(c)}}a[Nr]=i,a[Er]=d;e:for(p=i.child;p!==null;){if(p.tag===5||p.tag===6)a.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===i)break e;for(;p.sibling===null;){if(p.return===null||p.return===i)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}i.stateNode=a;e:switch(Lr(a,c,d),c){case"button":case"input":case"select":case"textarea":a=!!d.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Gn(i)}}return ar(i),i.flags&=-16777217,null;case 6:if(a&&i.stateNode!=null)a.memoizedProps!==d&&Gn(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(n(166));if(a=K.current,ec(i)){if(a=i.stateNode,c=i.memoizedProps,d=null,p=aa,p!==null)switch(p.tag){case 27:case 5:d=p.memoizedProps}a[Nr]=i,a=!!(a.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||Ng(a.nodeValue,c)),a||ai(i)}else a=B0(a).createTextNode(d),a[Nr]=i,i.stateNode=a}return ar(i),null;case 13:if(d=i.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(p=ec(i),d!==null&&d.dehydrated!==null){if(a===null){if(!p)throw Error(n(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));p[Nr]=i}else tc(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ar(i),p=!1}else p=op(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=p),p=!0;if(!p)return i.flags&256?(Hn(i),i):(Hn(i),null)}if(Hn(i),(i.flags&128)!==0)return i.lanes=c,i;if(c=d!==null,a=a!==null&&a.memoizedState!==null,c){d=i.child,p=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(p=d.alternate.memoizedState.cachePool.pool);var v=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(v=d.memoizedState.cachePool.pool),v!==p&&(d.flags|=2048)}return c!==a&&c&&(i.child.flags|=8192),N0(i,i.updateQueue),ar(i),null;case 4:return _e(),a===null&&Xd(i.stateNode.containerInfo),ar(i),null;case 10:return Pn(i.type),ar(i),null;case 19:if(D(br),p=i.memoizedState,p===null)return ar(i),null;if(d=(i.flags&128)!==0,v=p.rendering,v===null)if(d)gc(p,!1);else{if(ir!==0||a!==null&&(a.flags&128)!==0)for(a=i.child;a!==null;){if(v=y0(a),v!==null){for(i.flags|=128,gc(p,!1),a=v.updateQueue,i.updateQueue=a,N0(i,a),i.subtreeFlags=0,a=c,c=i.child;c!==null;)sp(c,a),c=c.sibling;return V(br,br.current&1|2),i.child}a=a.sibling}p.tail!==null&&Me()>k0&&(i.flags|=128,d=!0,gc(p,!1),i.lanes=4194304)}else{if(!d)if(a=y0(v),a!==null){if(i.flags|=128,d=!0,a=a.updateQueue,i.updateQueue=a,N0(i,a),gc(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!Ft)return ar(i),null}else 2*Me()-p.renderingStartTime>k0&&c!==536870912&&(i.flags|=128,d=!0,gc(p,!1),i.lanes=4194304);p.isBackwards?(v.sibling=i.child,i.child=v):(a=p.last,a!==null?a.sibling=v:i.child=v,p.last=v)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=Me(),i.sibling=null,a=br.current,V(br,d?a&1|2:a&1),i):(ar(i),null);case 22:case 23:return Hn(i),Yf(),d=i.memoizedState!==null,a!==null?a.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(c&536870912)!==0&&(i.flags&128)===0&&(ar(i),i.subtreeFlags&6&&(i.flags|=8192)):ar(i),c=i.updateQueue,c!==null&&N0(i,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==c&&(i.flags|=2048),a!==null&&D(ii),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Pn(wr),ar(i),null;case 25:return null;case 30:return null}throw Error(n(156,i.tag))}function E4(a,i){switch(Df(i),i.tag){case 1:return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 3:return Pn(wr),_e(),a=i.flags,(a&65536)!==0&&(a&128)===0?(i.flags=a&-65537|128,i):null;case 26:case 27:case 5:return He(i),null;case 13:if(Hn(i),a=i.memoizedState,a!==null&&a.dehydrated!==null){if(i.alternate===null)throw Error(n(340));tc()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 19:return D(br),null;case 4:return _e(),null;case 10:return Pn(i.type),null;case 22:case 23:return Hn(i),Yf(),a!==null&&D(ii),a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 24:return Pn(wr),null;case 25:return null;default:return null}}function R1(a,i){switch(Df(i),i.tag){case 3:Pn(wr),_e();break;case 26:case 27:case 5:He(i);break;case 4:_e();break;case 13:Hn(i);break;case 19:D(br);break;case 10:Pn(i.type);break;case 22:case 23:Hn(i),Yf(),a!==null&&D(ii);break;case 24:Pn(wr)}}function vc(a,i){try{var c=i.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var p=d.next;c=p;do{if((c.tag&a)===a){d=void 0;var v=c.create,k=c.inst;d=v(),k.destroy=d}c=c.next}while(c!==p)}}catch(L){$t(i,i.return,L)}}function vs(a,i,c){try{var d=i.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var v=p.next;d=v;do{if((d.tag&a)===a){var k=d.inst,L=k.destroy;if(L!==void 0){k.destroy=void 0,p=i;var Z=c,ue=L;try{ue()}catch(Ee){$t(p,Z,Ee)}}}d=d.next}while(d!==v)}}catch(Ee){$t(i,i.return,Ee)}}function D1(a){var i=a.updateQueue;if(i!==null){var c=a.stateNode;try{wp(i,c)}catch(d){$t(a,a.return,d)}}}function O1(a,i,c){c.props=ci(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(d){$t(a,i,d)}}function yc(a,i){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var d=a.stateNode;break;case 30:d=a.stateNode;break;default:d=a.stateNode}typeof c=="function"?a.refCleanup=c(d):c.current=d}}catch(p){$t(a,i,p)}}function wn(a,i){var c=a.ref,d=a.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(p){$t(a,i,p)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(p){$t(a,i,p)}else c.current=null}function M1(a){var i=a.type,c=a.memoizedProps,d=a.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(p){$t(a,a.return,p)}}function bd(a,i,c){try{var d=a.stateNode;$4(d,a.type,c,i),d[Er]=i}catch(p){$t(a,a.return,p)}}function L1(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ts(a.type)||a.tag===4}function _d(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||L1(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ts(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Sd(a,i,c){var d=a.tag;if(d===5||d===6)a=a.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(a),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=L0));else if(d!==4&&(d===27&&Ts(a.type)&&(c=a.stateNode,i=null),a=a.child,a!==null))for(Sd(a,i,c),a=a.sibling;a!==null;)Sd(a,i,c),a=a.sibling}function E0(a,i,c){var d=a.tag;if(d===5||d===6)a=a.stateNode,i?c.insertBefore(a,i):c.appendChild(a);else if(d!==4&&(d===27&&Ts(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(E0(a,i,c),a=a.sibling;a!==null;)E0(a,i,c),a=a.sibling}function B1(a){var i=a.stateNode,c=a.memoizedProps;try{for(var d=a.type,p=i.attributes;p.length;)i.removeAttributeNode(p[0]);Lr(i,d,c),i[Nr]=a,i[Er]=c}catch(v){$t(a,a.return,v)}}var Xn=!1,dr=!1,Nd=!1,U1=typeof WeakSet=="function"?WeakSet:Set,kr=null;function T4(a,i){if(a=a.containerInfo,qd=V0,a=Wx(a),_f(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var p=d.anchorOffset,v=d.focusNode;d=d.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var k=0,L=-1,Z=-1,ue=0,Ee=0,je=a,me=null;t:for(;;){for(var ve;je!==c||p!==0&&je.nodeType!==3||(L=k+p),je!==v||d!==0&&je.nodeType!==3||(Z=k+d),je.nodeType===3&&(k+=je.nodeValue.length),(ve=je.firstChild)!==null;)me=je,je=ve;for(;;){if(je===a)break t;if(me===c&&++ue===p&&(L=k),me===v&&++Ee===d&&(Z=k),(ve=je.nextSibling)!==null)break;je=me,me=je.parentNode}je=ve}c=L===-1||Z===-1?null:{start:L,end:Z}}else c=null}c=c||{start:0,end:0}}else c=null;for(Wd={focusedElem:a,selectionRange:c},V0=!1,kr=i;kr!==null;)if(i=kr,a=i.child,(i.subtreeFlags&1024)!==0&&a!==null)a.return=i,kr=a;else for(;kr!==null;){switch(i=kr,v=i.alternate,a=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&v!==null){a=void 0,c=i,p=v.memoizedProps,v=v.memoizedState,d=c.stateNode;try{var st=ci(c.type,p,c.elementType===c.type);a=d.getSnapshotBeforeUpdate(st,v),d.__reactInternalSnapshotBeforeUpdate=a}catch(Qe){$t(c,c.return,Qe)}}break;case 3:if((a&1024)!==0){if(a=i.stateNode.containerInfo,c=a.nodeType,c===9)Qd(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Qd(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=i.sibling,a!==null){a.return=i.return,kr=a;break}kr=i.return}}function I1(a,i,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:ys(a,c),d&4&&vc(5,c);break;case 1:if(ys(a,c),d&4)if(a=c.stateNode,i===null)try{a.componentDidMount()}catch(k){$t(c,c.return,k)}else{var p=ci(c.type,i.memoizedProps);i=i.memoizedState;try{a.componentDidUpdate(p,i,a.__reactInternalSnapshotBeforeUpdate)}catch(k){$t(c,c.return,k)}}d&64&&D1(c),d&512&&yc(c,c.return);break;case 3:if(ys(a,c),d&64&&(a=c.updateQueue,a!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{wp(a,i)}catch(k){$t(c,c.return,k)}}break;case 27:i===null&&d&4&&B1(c);case 26:case 5:ys(a,c),i===null&&d&4&&M1(c),d&512&&yc(c,c.return);break;case 12:ys(a,c);break;case 13:ys(a,c),d&4&&H1(a,c),d&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=M4.bind(null,c),J4(a,c))));break;case 22:if(d=c.memoizedState!==null||Xn,!d){i=i!==null&&i.memoizedState!==null||dr,p=Xn;var v=dr;Xn=d,(dr=i)&&!v?ws(a,c,(c.subtreeFlags&8772)!==0):ys(a,c),Xn=p,dr=v}break;case 30:break;default:ys(a,c)}}function P1(a){var i=a.alternate;i!==null&&(a.alternate=null,P1(i)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(i=a.stateNode,i!==null&&H(i)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var tr=null,fa=!1;function $n(a,i,c){for(c=c.child;c!==null;)z1(a,i,c),c=c.sibling}function z1(a,i,c){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(Ke,c)}catch{}switch(c.tag){case 26:dr||wn(c,i),$n(a,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:dr||wn(c,i);var d=tr,p=fa;Ts(c.type)&&(tr=c.stateNode,fa=!1),$n(a,i,c),Ac(c.stateNode),tr=d,fa=p;break;case 5:dr||wn(c,i);case 6:if(d=tr,p=fa,tr=null,$n(a,i,c),tr=d,fa=p,tr!==null)if(fa)try{(tr.nodeType===9?tr.body:tr.nodeName==="HTML"?tr.ownerDocument.body:tr).removeChild(c.stateNode)}catch(v){$t(c,i,v)}else try{tr.removeChild(c.stateNode)}catch(v){$t(c,i,v)}break;case 18:tr!==null&&(fa?(a=tr,Cg(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),Lc(a)):Cg(tr,c.stateNode));break;case 4:d=tr,p=fa,tr=c.stateNode.containerInfo,fa=!0,$n(a,i,c),tr=d,fa=p;break;case 0:case 11:case 14:case 15:dr||vs(2,c,i),dr||vs(4,c,i),$n(a,i,c);break;case 1:dr||(wn(c,i),d=c.stateNode,typeof d.componentWillUnmount=="function"&&O1(c,i,d)),$n(a,i,c);break;case 21:$n(a,i,c);break;case 22:dr=(d=dr)||c.memoizedState!==null,$n(a,i,c),dr=d;break;default:$n(a,i,c)}}function H1(a,i){if(i.memoizedState===null&&(a=i.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Lc(a)}catch(c){$t(i,i.return,c)}}function k4(a){switch(a.tag){case 13:case 19:var i=a.stateNode;return i===null&&(i=a.stateNode=new U1),i;case 22:return a=a.stateNode,i=a._retryCache,i===null&&(i=a._retryCache=new U1),i;default:throw Error(n(435,a.tag))}}function Ed(a,i){var c=k4(a);i.forEach(function(d){var p=L4.bind(null,a,d);c.has(d)||(c.add(d),d.then(p,p))})}function _a(a,i){var c=i.deletions;if(c!==null)for(var d=0;d<c.length;d++){var p=c[d],v=a,k=i,L=k;e:for(;L!==null;){switch(L.tag){case 27:if(Ts(L.type)){tr=L.stateNode,fa=!1;break e}break;case 5:tr=L.stateNode,fa=!1;break e;case 3:case 4:tr=L.stateNode.containerInfo,fa=!0;break e}L=L.return}if(tr===null)throw Error(n(160));z1(v,k,p),tr=null,fa=!1,v=p.alternate,v!==null&&(v.return=null),p.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)V1(i,a),i=i.sibling}var sn=null;function V1(a,i){var c=a.alternate,d=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:_a(i,a),Sa(a),d&4&&(vs(3,a,a.return),vc(3,a),vs(5,a,a.return));break;case 1:_a(i,a),Sa(a),d&512&&(dr||c===null||wn(c,c.return)),d&64&&Xn&&(a=a.updateQueue,a!==null&&(d=a.callbacks,d!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var p=sn;if(_a(i,a),Sa(a),d&512&&(dr||c===null||wn(c,c.return)),d&4){var v=c!==null?c.memoizedState:null;if(d=a.memoizedState,c===null)if(d===null)if(a.stateNode===null){e:{d=a.type,c=a.memoizedProps,p=p.ownerDocument||p;t:switch(d){case"title":v=p.getElementsByTagName("title")[0],(!v||v[I]||v[Nr]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=p.createElement(d),p.head.insertBefore(v,p.querySelector("head > title"))),Lr(v,d,c),v[Nr]=a,le(v),d=v;break e;case"link":var k=Bg("link","href",p).get(d+(c.href||""));if(k){for(var L=0;L<k.length;L++)if(v=k[L],v.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&v.getAttribute("rel")===(c.rel==null?null:c.rel)&&v.getAttribute("title")===(c.title==null?null:c.title)&&v.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){k.splice(L,1);break t}}v=p.createElement(d),Lr(v,d,c),p.head.appendChild(v);break;case"meta":if(k=Bg("meta","content",p).get(d+(c.content||""))){for(L=0;L<k.length;L++)if(v=k[L],v.getAttribute("content")===(c.content==null?null:""+c.content)&&v.getAttribute("name")===(c.name==null?null:c.name)&&v.getAttribute("property")===(c.property==null?null:c.property)&&v.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&v.getAttribute("charset")===(c.charSet==null?null:c.charSet)){k.splice(L,1);break t}}v=p.createElement(d),Lr(v,d,c),p.head.appendChild(v);break;default:throw Error(n(468,d))}v[Nr]=a,le(v),d=v}a.stateNode=d}else Ug(p,a.type,a.stateNode);else a.stateNode=Lg(p,d,a.memoizedProps);else v!==d?(v===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):v.count--,d===null?Ug(p,a.type,a.stateNode):Lg(p,d,a.memoizedProps)):d===null&&a.stateNode!==null&&bd(a,a.memoizedProps,c.memoizedProps)}break;case 27:_a(i,a),Sa(a),d&512&&(dr||c===null||wn(c,c.return)),c!==null&&d&4&&bd(a,a.memoizedProps,c.memoizedProps);break;case 5:if(_a(i,a),Sa(a),d&512&&(dr||c===null||wn(c,c.return)),a.flags&32){p=a.stateNode;try{Ii(p,"")}catch(ve){$t(a,a.return,ve)}}d&4&&a.stateNode!=null&&(p=a.memoizedProps,bd(a,p,c!==null?c.memoizedProps:p)),d&1024&&(Nd=!0);break;case 6:if(_a(i,a),Sa(a),d&4){if(a.stateNode===null)throw Error(n(162));d=a.memoizedProps,c=a.stateNode;try{c.nodeValue=d}catch(ve){$t(a,a.return,ve)}}break;case 3:if(P0=null,p=sn,sn=U0(i.containerInfo),_a(i,a),sn=p,Sa(a),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Lc(i.containerInfo)}catch(ve){$t(a,a.return,ve)}Nd&&(Nd=!1,G1(a));break;case 4:d=sn,sn=U0(a.stateNode.containerInfo),_a(i,a),Sa(a),sn=d;break;case 12:_a(i,a),Sa(a);break;case 13:_a(i,a),Sa(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Fd=Me()),d&4&&(d=a.updateQueue,d!==null&&(a.updateQueue=null,Ed(a,d)));break;case 22:p=a.memoizedState!==null;var Z=c!==null&&c.memoizedState!==null,ue=Xn,Ee=dr;if(Xn=ue||p,dr=Ee||Z,_a(i,a),dr=Ee,Xn=ue,Sa(a),d&8192)e:for(i=a.stateNode,i._visibility=p?i._visibility&-2:i._visibility|1,p&&(c===null||Z||Xn||dr||oi(a)),c=null,i=a;;){if(i.tag===5||i.tag===26){if(c===null){Z=c=i;try{if(v=Z.stateNode,p)k=v.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{L=Z.stateNode;var je=Z.memoizedProps.style,me=je!=null&&je.hasOwnProperty("display")?je.display:null;L.style.display=me==null||typeof me=="boolean"?"":(""+me).trim()}}catch(ve){$t(Z,Z.return,ve)}}}else if(i.tag===6){if(c===null){Z=i;try{Z.stateNode.nodeValue=p?"":Z.memoizedProps}catch(ve){$t(Z,Z.return,ve)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===a)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=a.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,Ed(a,c))));break;case 19:_a(i,a),Sa(a),d&4&&(d=a.updateQueue,d!==null&&(a.updateQueue=null,Ed(a,d)));break;case 30:break;case 21:break;default:_a(i,a),Sa(a)}}function Sa(a){var i=a.flags;if(i&2){try{for(var c,d=a.return;d!==null;){if(L1(d)){c=d;break}d=d.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var p=c.stateNode,v=_d(a);E0(a,v,p);break;case 5:var k=c.stateNode;c.flags&32&&(Ii(k,""),c.flags&=-33);var L=_d(a);E0(a,L,k);break;case 3:case 4:var Z=c.stateNode.containerInfo,ue=_d(a);Sd(a,ue,Z);break;default:throw Error(n(161))}}catch(Ee){$t(a,a.return,Ee)}a.flags&=-3}i&4096&&(a.flags&=-4097)}function G1(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var i=a;G1(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),a=a.sibling}}function ys(a,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)I1(a,i.alternate,i),i=i.sibling}function oi(a){for(a=a.child;a!==null;){var i=a;switch(i.tag){case 0:case 11:case 14:case 15:vs(4,i,i.return),oi(i);break;case 1:wn(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&O1(i,i.return,c),oi(i);break;case 27:Ac(i.stateNode);case 26:case 5:wn(i,i.return),oi(i);break;case 22:i.memoizedState===null&&oi(i);break;case 30:oi(i);break;default:oi(i)}a=a.sibling}}function ws(a,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,p=a,v=i,k=v.flags;switch(v.tag){case 0:case 11:case 15:ws(p,v,c),vc(4,v);break;case 1:if(ws(p,v,c),d=v,p=d.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(ue){$t(d,d.return,ue)}if(d=v,p=d.updateQueue,p!==null){var L=d.stateNode;try{var Z=p.shared.hiddenCallbacks;if(Z!==null)for(p.shared.hiddenCallbacks=null,p=0;p<Z.length;p++)yp(Z[p],L)}catch(ue){$t(d,d.return,ue)}}c&&k&64&&D1(v),yc(v,v.return);break;case 27:B1(v);case 26:case 5:ws(p,v,c),c&&d===null&&k&4&&M1(v),yc(v,v.return);break;case 12:ws(p,v,c);break;case 13:ws(p,v,c),c&&k&4&&H1(p,v);break;case 22:v.memoizedState===null&&ws(p,v,c),yc(v,v.return);break;case 30:break;default:ws(p,v,c)}i=i.sibling}}function Td(a,i){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(a=i.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&nc(c))}function kd(a,i){a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&nc(a))}function bn(a,i,c,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)X1(a,i,c,d),i=i.sibling}function X1(a,i,c,d){var p=i.flags;switch(i.tag){case 0:case 11:case 15:bn(a,i,c,d),p&2048&&vc(9,i);break;case 1:bn(a,i,c,d);break;case 3:bn(a,i,c,d),p&2048&&(a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&nc(a)));break;case 12:if(p&2048){bn(a,i,c,d),a=i.stateNode;try{var v=i.memoizedProps,k=v.id,L=v.onPostCommit;typeof L=="function"&&L(k,i.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(Z){$t(i,i.return,Z)}}else bn(a,i,c,d);break;case 13:bn(a,i,c,d);break;case 23:break;case 22:v=i.stateNode,k=i.alternate,i.memoizedState!==null?v._visibility&2?bn(a,i,c,d):wc(a,i):v._visibility&2?bn(a,i,c,d):(v._visibility|=2,nl(a,i,c,d,(i.subtreeFlags&10256)!==0)),p&2048&&Td(k,i);break;case 24:bn(a,i,c,d),p&2048&&kd(i.alternate,i);break;default:bn(a,i,c,d)}}function nl(a,i,c,d,p){for(p=p&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var v=a,k=i,L=c,Z=d,ue=k.flags;switch(k.tag){case 0:case 11:case 15:nl(v,k,L,Z,p),vc(8,k);break;case 23:break;case 22:var Ee=k.stateNode;k.memoizedState!==null?Ee._visibility&2?nl(v,k,L,Z,p):wc(v,k):(Ee._visibility|=2,nl(v,k,L,Z,p)),p&&ue&2048&&Td(k.alternate,k);break;case 24:nl(v,k,L,Z,p),p&&ue&2048&&kd(k.alternate,k);break;default:nl(v,k,L,Z,p)}i=i.sibling}}function wc(a,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=a,d=i,p=d.flags;switch(d.tag){case 22:wc(c,d),p&2048&&Td(d.alternate,d);break;case 24:wc(c,d),p&2048&&kd(d.alternate,d);break;default:wc(c,d)}i=i.sibling}}var bc=8192;function sl(a){if(a.subtreeFlags&bc)for(a=a.child;a!==null;)$1(a),a=a.sibling}function $1(a){switch(a.tag){case 26:sl(a),a.flags&bc&&a.memoizedState!==null&&dS(sn,a.memoizedState,a.memoizedProps);break;case 5:sl(a);break;case 3:case 4:var i=sn;sn=U0(a.stateNode.containerInfo),sl(a),sn=i;break;case 22:a.memoizedState===null&&(i=a.alternate,i!==null&&i.memoizedState!==null?(i=bc,bc=16777216,sl(a),bc=i):sl(a));break;default:sl(a)}}function Y1(a){var i=a.alternate;if(i!==null&&(a=i.child,a!==null)){i.child=null;do i=a.sibling,a.sibling=null,a=i;while(a!==null)}}function _c(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];kr=d,W1(d,a)}Y1(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)q1(a),a=a.sibling}function q1(a){switch(a.tag){case 0:case 11:case 15:_c(a),a.flags&2048&&vs(9,a,a.return);break;case 3:_c(a);break;case 12:_c(a);break;case 22:var i=a.stateNode;a.memoizedState!==null&&i._visibility&2&&(a.return===null||a.return.tag!==13)?(i._visibility&=-3,T0(a)):_c(a);break;default:_c(a)}}function T0(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];kr=d,W1(d,a)}Y1(a)}for(a=a.child;a!==null;){switch(i=a,i.tag){case 0:case 11:case 15:vs(8,i,i.return),T0(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,T0(i));break;default:T0(i)}a=a.sibling}}function W1(a,i){for(;kr!==null;){var c=kr;switch(c.tag){case 0:case 11:case 15:vs(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:nc(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,kr=d;else e:for(c=a;kr!==null;){d=kr;var p=d.sibling,v=d.return;if(P1(d),d===c){kr=null;break e}if(p!==null){p.return=v,kr=p;break e}kr=v}}}var A4={getCacheForType:function(a){var i=Gr(wr),c=i.data.get(a);return c===void 0&&(c=a(),i.data.set(a,c)),c}},C4=typeof WeakMap=="function"?WeakMap:Map,Ot=0,Wt=null,bt=null,Nt=0,Mt=0,Na=null,bs=!1,il=!1,Ad=!1,Yn=0,ir=0,_s=0,ui=0,Cd=0,Va=0,ll=0,Sc=null,da=null,jd=!1,Fd=0,k0=1/0,A0=null,Ss=null,Mr=0,Ns=null,cl=null,ol=0,Rd=0,Dd=null,K1=null,Nc=0,Od=null;function Ea(){if((Ot&2)!==0&&Nt!==0)return Nt&-Nt;if(Q.T!==null){var a=Ki;return a!==0?a:zd()}return zo()}function Z1(){Va===0&&(Va=(Nt&536870912)===0||Ft?Dr():536870912);var a=Ha.current;return a!==null&&(a.flags|=32),Va}function Ta(a,i,c){(a===Wt&&(Mt===2||Mt===9)||a.cancelPendingCommit!==null)&&(ul(a,0),Es(a,Nt,Va,!1)),Vr(a,c),((Ot&2)===0||a!==Wt)&&(a===Wt&&((Ot&2)===0&&(ui|=c),ir===4&&Es(a,Nt,Va,!1)),_n(a))}function Q1(a,i,c){if((Ot&6)!==0)throw Error(n(327));var d=!c&&(i&124)===0&&(i&a.expiredLanes)===0||tt(a,i),p=d?R4(a,i):Bd(a,i,!0),v=d;do{if(p===0){il&&!d&&Es(a,i,0,!1);break}else{if(c=a.current.alternate,v&&!j4(c)){p=Bd(a,i,!1),v=!1;continue}if(p===2){if(v=i,a.errorRecoveryDisabledLanes&v)var k=0;else k=a.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){i=k;e:{var L=a;p=Sc;var Z=L.current.memoizedState.isDehydrated;if(Z&&(ul(L,k).flags|=256),k=Bd(L,k,!1),k!==2){if(Ad&&!Z){L.errorRecoveryDisabledLanes|=v,ui|=v,p=4;break e}v=da,da=p,v!==null&&(da===null?da=v:da.push.apply(da,v))}p=k}if(v=!1,p!==2)continue}}if(p===1){ul(a,0),Es(a,i,0,!0);break}e:{switch(d=a,v=p,v){case 0:case 1:throw Error(n(345));case 4:if((i&4194048)!==i)break;case 6:Es(d,i,Va,!bs);break e;case 2:da=null;break;case 3:case 5:break;default:throw Error(n(329))}if((i&62914560)===i&&(p=Fd+300-Me(),10<p)){if(Es(d,i,Va,!bs),ls(d,0,!0)!==0)break e;d.timeoutHandle=kg(J1.bind(null,d,c,da,A0,jd,i,Va,ui,ll,bs,v,2,-0,0),p);break e}J1(d,c,da,A0,jd,i,Va,ui,ll,bs,v,0,-0,0)}}break}while(!0);_n(a)}function J1(a,i,c,d,p,v,k,L,Z,ue,Ee,je,me,ve){if(a.timeoutHandle=-1,je=i.subtreeFlags,(je&8192||(je&16785408)===16785408)&&(Fc={stylesheets:null,count:0,unsuspend:fS},$1(i),je=hS(),je!==null)){a.cancelPendingCommit=je(ig.bind(null,a,i,v,c,d,p,k,L,Z,Ee,1,me,ve)),Es(a,v,k,!ue);return}ig(a,i,v,c,d,p,k,L,Z)}function j4(a){for(var i=a;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var p=c[d],v=p.getSnapshot;p=p.value;try{if(!wa(v(),p))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Es(a,i,c,d){i&=~Cd,i&=~ui,a.suspendedLanes|=i,a.pingedLanes&=~i,d&&(a.warmLanes|=i),d=a.expirationTimes;for(var p=i;0<p;){var v=31-nt(p),k=1<<v;d[v]=-1,p&=~k}c!==0&&Io(a,c,i)}function C0(){return(Ot&6)===0?(Ec(0),!1):!0}function Md(){if(bt!==null){if(Mt===0)var a=bt.return;else a=bt,In=ni=null,Qf(a),rl=null,xc=0,a=bt;for(;a!==null;)R1(a.alternate,a),a=a.return;bt=null}}function ul(a,i){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,q4(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),Md(),Wt=a,bt=c=Ln(a.current,null),Nt=i,Mt=0,Na=null,bs=!1,il=tt(a,i),Ad=!1,ll=Va=Cd=ui=_s=ir=0,da=Sc=null,jd=!1,(i&8)!==0&&(i|=i&32);var d=a.entangledLanes;if(d!==0)for(a=a.entanglements,d&=i;0<d;){var p=31-nt(d),v=1<<p;i|=a[p],d&=~v}return Yn=i,Zo(),c}function eg(a,i){pt=null,Q.H=p0,i===ic||i===i0?(i=gp(),Mt=3):i===mp?(i=gp(),Mt=4):Mt=i===v1?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Na=i,bt===null&&(ir=1,b0(a,Ua(i,a.current)))}function tg(){var a=Q.H;return Q.H=p0,a===null?p0:a}function rg(){var a=Q.A;return Q.A=A4,a}function Ld(){ir=4,bs||(Nt&4194048)!==Nt&&Ha.current!==null||(il=!0),(_s&134217727)===0&&(ui&134217727)===0||Wt===null||Es(Wt,Nt,Va,!1)}function Bd(a,i,c){var d=Ot;Ot|=2;var p=tg(),v=rg();(Wt!==a||Nt!==i)&&(A0=null,ul(a,i)),i=!1;var k=ir;e:do try{if(Mt!==0&&bt!==null){var L=bt,Z=Na;switch(Mt){case 8:Md(),k=6;break e;case 3:case 2:case 9:case 6:Ha.current===null&&(i=!0);var ue=Mt;if(Mt=0,Na=null,fl(a,L,Z,ue),c&&il){k=0;break e}break;default:ue=Mt,Mt=0,Na=null,fl(a,L,Z,ue)}}F4(),k=ir;break}catch(Ee){eg(a,Ee)}while(!0);return i&&a.shellSuspendCounter++,In=ni=null,Ot=d,Q.H=p,Q.A=v,bt===null&&(Wt=null,Nt=0,Zo()),k}function F4(){for(;bt!==null;)ag(bt)}function R4(a,i){var c=Ot;Ot|=2;var d=tg(),p=rg();Wt!==a||Nt!==i?(A0=null,k0=Me()+500,ul(a,i)):il=tt(a,i);e:do try{if(Mt!==0&&bt!==null){i=bt;var v=Na;t:switch(Mt){case 1:Mt=0,Na=null,fl(a,i,v,1);break;case 2:case 9:if(xp(v)){Mt=0,Na=null,ng(i);break}i=function(){Mt!==2&&Mt!==9||Wt!==a||(Mt=7),_n(a)},v.then(i,i);break e;case 3:Mt=7;break e;case 4:Mt=5;break e;case 7:xp(v)?(Mt=0,Na=null,ng(i)):(Mt=0,Na=null,fl(a,i,v,7));break;case 5:var k=null;switch(bt.tag){case 26:k=bt.memoizedState;case 5:case 27:var L=bt;if(!k||Ig(k)){Mt=0,Na=null;var Z=L.sibling;if(Z!==null)bt=Z;else{var ue=L.return;ue!==null?(bt=ue,j0(ue)):bt=null}break t}}Mt=0,Na=null,fl(a,i,v,5);break;case 6:Mt=0,Na=null,fl(a,i,v,6);break;case 8:Md(),ir=6;break e;default:throw Error(n(462))}}D4();break}catch(Ee){eg(a,Ee)}while(!0);return In=ni=null,Q.H=d,Q.A=p,Ot=c,bt!==null?0:(Wt=null,Nt=0,Zo(),ir)}function D4(){for(;bt!==null&&!xt();)ag(bt)}function ag(a){var i=j1(a.alternate,a,Yn);a.memoizedProps=a.pendingProps,i===null?j0(a):bt=i}function ng(a){var i=a,c=i.alternate;switch(i.tag){case 15:case 0:i=N1(c,i,i.pendingProps,i.type,void 0,Nt);break;case 11:i=N1(c,i,i.pendingProps,i.type.render,i.ref,Nt);break;case 5:Qf(i);default:R1(c,i),i=bt=sp(i,Yn),i=j1(c,i,Yn)}a.memoizedProps=a.pendingProps,i===null?j0(a):bt=i}function fl(a,i,c,d){In=ni=null,Qf(i),rl=null,xc=0;var p=i.return;try{if(_4(a,p,i,c,Nt)){ir=1,b0(a,Ua(c,a.current)),bt=null;return}}catch(v){if(p!==null)throw bt=p,v;ir=1,b0(a,Ua(c,a.current)),bt=null;return}i.flags&32768?(Ft||d===1?a=!0:il||(Nt&536870912)!==0?a=!1:(bs=a=!0,(d===2||d===9||d===3||d===6)&&(d=Ha.current,d!==null&&d.tag===13&&(d.flags|=16384))),sg(i,a)):j0(i)}function j0(a){var i=a;do{if((i.flags&32768)!==0){sg(i,bs);return}a=i.return;var c=N4(i.alternate,i,Yn);if(c!==null){bt=c;return}if(i=i.sibling,i!==null){bt=i;return}bt=i=a}while(i!==null);ir===0&&(ir=5)}function sg(a,i){do{var c=E4(a.alternate,a);if(c!==null){c.flags&=32767,bt=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(a=a.sibling,a!==null)){bt=a;return}bt=a=c}while(a!==null);ir=6,bt=null}function ig(a,i,c,d,p,v,k,L,Z){a.cancelPendingCommit=null;do F0();while(Mr!==0);if((Ot&6)!==0)throw Error(n(327));if(i!==null){if(i===a.current)throw Error(n(177));if(v=i.lanes|i.childLanes,v|=kf,Bi(a,c,v,k,L,Z),a===Wt&&(bt=Wt=null,Nt=0),cl=i,Ns=a,ol=c,Rd=v,Dd=p,K1=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,B4(Ce,function(){return fg(),null})):(a.callbackNode=null,a.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=Q.T,Q.T=null,p=ie.p,ie.p=2,k=Ot,Ot|=4;try{T4(a,i,c)}finally{Ot=k,ie.p=p,Q.T=d}}Mr=1,lg(),cg(),og()}}function lg(){if(Mr===1){Mr=0;var a=Ns,i=cl,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=Q.T,Q.T=null;var d=ie.p;ie.p=2;var p=Ot;Ot|=4;try{V1(i,a);var v=Wd,k=Wx(a.containerInfo),L=v.focusedElem,Z=v.selectionRange;if(k!==L&&L&&L.ownerDocument&&qx(L.ownerDocument.documentElement,L)){if(Z!==null&&_f(L)){var ue=Z.start,Ee=Z.end;if(Ee===void 0&&(Ee=ue),"selectionStart"in L)L.selectionStart=ue,L.selectionEnd=Math.min(Ee,L.value.length);else{var je=L.ownerDocument||document,me=je&&je.defaultView||window;if(me.getSelection){var ve=me.getSelection(),st=L.textContent.length,Qe=Math.min(Z.start,st),Vt=Z.end===void 0?Qe:Math.min(Z.end,st);!ve.extend&&Qe>Vt&&(k=Vt,Vt=Qe,Qe=k);var se=Yx(L,Qe),ne=Yx(L,Vt);if(se&&ne&&(ve.rangeCount!==1||ve.anchorNode!==se.node||ve.anchorOffset!==se.offset||ve.focusNode!==ne.node||ve.focusOffset!==ne.offset)){var ce=je.createRange();ce.setStart(se.node,se.offset),ve.removeAllRanges(),Qe>Vt?(ve.addRange(ce),ve.extend(ne.node,ne.offset)):(ce.setEnd(ne.node,ne.offset),ve.addRange(ce))}}}}for(je=[],ve=L;ve=ve.parentNode;)ve.nodeType===1&&je.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<je.length;L++){var ke=je[L];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}V0=!!qd,Wd=qd=null}finally{Ot=p,ie.p=d,Q.T=c}}a.current=i,Mr=2}}function cg(){if(Mr===2){Mr=0;var a=Ns,i=cl,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=Q.T,Q.T=null;var d=ie.p;ie.p=2;var p=Ot;Ot|=4;try{I1(a,i.alternate,i)}finally{Ot=p,ie.p=d,Q.T=c}}Mr=3}}function og(){if(Mr===4||Mr===3){Mr=0,et();var a=Ns,i=cl,c=ol,d=K1;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Mr=5:(Mr=0,cl=Ns=null,ug(a,a.pendingLanes));var p=a.pendingLanes;if(p===0&&(Ss=null),Vl(c),i=i.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(Ke,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=Q.T,p=ie.p,ie.p=2,Q.T=null;try{for(var v=a.onRecoverableError,k=0;k<d.length;k++){var L=d[k];v(L.value,{componentStack:L.stack})}}finally{Q.T=i,ie.p=p}}(ol&3)!==0&&F0(),_n(a),p=a.pendingLanes,(c&4194090)!==0&&(p&42)!==0?a===Od?Nc++:(Nc=0,Od=a):Nc=0,Ec(0)}}function ug(a,i){(a.pooledCacheLanes&=i)===0&&(i=a.pooledCache,i!=null&&(a.pooledCache=null,nc(i)))}function F0(a){return lg(),cg(),og(),fg()}function fg(){if(Mr!==5)return!1;var a=Ns,i=Rd;Rd=0;var c=Vl(ol),d=Q.T,p=ie.p;try{ie.p=32>c?32:c,Q.T=null,c=Dd,Dd=null;var v=Ns,k=ol;if(Mr=0,cl=Ns=null,ol=0,(Ot&6)!==0)throw Error(n(331));var L=Ot;if(Ot|=4,q1(v.current),X1(v,v.current,k,c),Ot=L,Ec(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(Ke,v)}catch{}return!0}finally{ie.p=p,Q.T=d,ug(a,i)}}function dg(a,i,c){i=Ua(c,i),i=dd(a.stateNode,i,2),a=ms(a,i,2),a!==null&&(Vr(a,2),_n(a))}function $t(a,i,c){if(a.tag===3)dg(a,a,c);else for(;i!==null;){if(i.tag===3){dg(i,a,c);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ss===null||!Ss.has(d))){a=Ua(c,a),c=p1(2),d=ms(i,c,2),d!==null&&(g1(c,d,i,a),Vr(d,2),_n(d));break}}i=i.return}}function Ud(a,i,c){var d=a.pingCache;if(d===null){d=a.pingCache=new C4;var p=new Set;d.set(i,p)}else p=d.get(i),p===void 0&&(p=new Set,d.set(i,p));p.has(c)||(Ad=!0,p.add(c),a=O4.bind(null,a,i,c),i.then(a,a))}function O4(a,i,c){var d=a.pingCache;d!==null&&d.delete(i),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,Wt===a&&(Nt&c)===c&&(ir===4||ir===3&&(Nt&62914560)===Nt&&300>Me()-Fd?(Ot&2)===0&&ul(a,0):Cd|=c,ll===Nt&&(ll=0)),_n(a)}function hg(a,i){i===0&&(i=tn()),a=$i(a,i),a!==null&&(Vr(a,i),_n(a))}function M4(a){var i=a.memoizedState,c=0;i!==null&&(c=i.retryLane),hg(a,c)}function L4(a,i){var c=0;switch(a.tag){case 13:var d=a.stateNode,p=a.memoizedState;p!==null&&(c=p.retryLane);break;case 19:d=a.stateNode;break;case 22:d=a.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(i),hg(a,c)}function B4(a,i){return ct(a,i)}var R0=null,dl=null,Id=!1,D0=!1,Pd=!1,fi=0;function _n(a){a!==dl&&a.next===null&&(dl===null?R0=dl=a:dl=dl.next=a),D0=!0,Id||(Id=!0,I4())}function Ec(a,i){if(!Pd&&D0){Pd=!0;do for(var c=!1,d=R0;d!==null;){if(a!==0){var p=d.pendingLanes;if(p===0)var v=0;else{var k=d.suspendedLanes,L=d.pingedLanes;v=(1<<31-nt(42|a)+1)-1,v&=p&~(k&~L),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(c=!0,gg(d,v))}else v=Nt,v=ls(d,d===Wt?v:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(v&3)===0||tt(d,v)||(c=!0,gg(d,v));d=d.next}while(c);Pd=!1}}function U4(){mg()}function mg(){D0=Id=!1;var a=0;fi!==0&&(Y4()&&(a=fi),fi=0);for(var i=Me(),c=null,d=R0;d!==null;){var p=d.next,v=xg(d,i);v===0?(d.next=null,c===null?R0=p:c.next=p,p===null&&(dl=c)):(c=d,(a!==0||(v&3)!==0)&&(D0=!0)),d=p}Ec(a)}function xg(a,i){for(var c=a.suspendedLanes,d=a.pingedLanes,p=a.expirationTimes,v=a.pendingLanes&-62914561;0<v;){var k=31-nt(v),L=1<<k,Z=p[k];Z===-1?((L&c)===0||(L&d)!==0)&&(p[k]=Dt(L,i)):Z<=i&&(a.expiredLanes|=L),v&=~L}if(i=Wt,c=Nt,c=ls(a,a===i?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),d=a.callbackNode,c===0||a===i&&(Mt===2||Mt===9)||a.cancelPendingCommit!==null)return d!==null&&d!==null&&$e(d),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||tt(a,c)){if(i=c&-c,i===a.callbackPriority)return i;switch(d!==null&&$e(d),Vl(c)){case 2:case 8:c=at;break;case 32:c=Ce;break;case 268435456:c=de;break;default:c=Ce}return d=pg.bind(null,a),c=ct(c,d),a.callbackPriority=i,a.callbackNode=c,i}return d!==null&&d!==null&&$e(d),a.callbackPriority=2,a.callbackNode=null,2}function pg(a,i){if(Mr!==0&&Mr!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(F0()&&a.callbackNode!==c)return null;var d=Nt;return d=ls(a,a===Wt?d:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),d===0?null:(Q1(a,d,i),xg(a,Me()),a.callbackNode!=null&&a.callbackNode===c?pg.bind(null,a):null)}function gg(a,i){if(F0())return null;Q1(a,i,!0)}function I4(){W4(function(){(Ot&6)!==0?ct(De,U4):mg()})}function zd(){return fi===0&&(fi=Dr()),fi}function vg(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Go(""+a)}function yg(a,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,a.id&&c.setAttribute("form",a.id),i.parentNode.insertBefore(c,i),a=new FormData(a),c.parentNode.removeChild(c),a}function P4(a,i,c,d,p){if(i==="submit"&&c&&c.stateNode===p){var v=vg((p[Er]||null).action),k=d.submitter;k&&(i=(i=k[Er]||null)?vg(i.formAction):k.getAttribute("formAction"),i!==null&&(v=i,k=null));var L=new qo("action","action",null,d,p);a.push({event:L,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(fi!==0){var Z=k?yg(p,k):new FormData(p);ld(c,{pending:!0,data:Z,method:p.method,action:v},null,Z)}}else typeof v=="function"&&(L.preventDefault(),Z=k?yg(p,k):new FormData(p),ld(c,{pending:!0,data:Z,method:p.method,action:v},v,Z))},currentTarget:p}]})}}for(var Hd=0;Hd<Tf.length;Hd++){var Vd=Tf[Hd],z4=Vd.toLowerCase(),H4=Vd[0].toUpperCase()+Vd.slice(1);nn(z4,"on"+H4)}nn(Qx,"onAnimationEnd"),nn(Jx,"onAnimationIteration"),nn(ep,"onAnimationStart"),nn("dblclick","onDoubleClick"),nn("focusin","onFocus"),nn("focusout","onBlur"),nn(s4,"onTransitionRun"),nn(i4,"onTransitionStart"),nn(l4,"onTransitionCancel"),nn(tp,"onTransitionEnd"),Be("onMouseEnter",["mouseout","mouseover"]),Be("onMouseLeave",["mouseout","mouseover"]),Be("onPointerEnter",["pointerout","pointerover"]),Be("onPointerLeave",["pointerout","pointerover"]),Oe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Oe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Oe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Oe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Oe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Oe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),V4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Tc));function wg(a,i){i=(i&4)!==0;for(var c=0;c<a.length;c++){var d=a[c],p=d.event;d=d.listeners;e:{var v=void 0;if(i)for(var k=d.length-1;0<=k;k--){var L=d[k],Z=L.instance,ue=L.currentTarget;if(L=L.listener,Z!==v&&p.isPropagationStopped())break e;v=L,p.currentTarget=ue;try{v(p)}catch(Ee){w0(Ee)}p.currentTarget=null,v=Z}else for(k=0;k<d.length;k++){if(L=d[k],Z=L.instance,ue=L.currentTarget,L=L.listener,Z!==v&&p.isPropagationStopped())break e;v=L,p.currentTarget=ue;try{v(p)}catch(Ee){w0(Ee)}p.currentTarget=null,v=Z}}}}function _t(a,i){var c=i[Gl];c===void 0&&(c=i[Gl]=new Set);var d=a+"__bubble";c.has(d)||(bg(i,a,2,!1),c.add(d))}function Gd(a,i,c){var d=0;i&&(d|=4),bg(c,a,d,i)}var O0="_reactListening"+Math.random().toString(36).slice(2);function Xd(a){if(!a[O0]){a[O0]=!0,he.forEach(function(c){c!=="selectionchange"&&(V4.has(c)||Gd(c,!1,a),Gd(c,!0,a))});var i=a.nodeType===9?a:a.ownerDocument;i===null||i[O0]||(i[O0]=!0,Gd("selectionchange",!1,i))}}function bg(a,i,c,d){switch(Xg(i)){case 2:var p=pS;break;case 8:p=gS;break;default:p=sh}c=p.bind(null,i,c,a),p=void 0,!hf||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),d?p!==void 0?a.addEventListener(i,c,{capture:!0,passive:p}):a.addEventListener(i,c,!0):p!==void 0?a.addEventListener(i,c,{passive:p}):a.addEventListener(i,c,!1)}function $d(a,i,c,d,p){var v=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var k=d.tag;if(k===3||k===4){var L=d.stateNode.containerInfo;if(L===p)break;if(k===4)for(k=d.return;k!==null;){var Z=k.tag;if((Z===3||Z===4)&&k.stateNode.containerInfo===p)return;k=k.return}for(;L!==null;){if(k=G(L),k===null)return;if(Z=k.tag,Z===5||Z===6||Z===26||Z===27){d=v=k;continue e}L=L.parentNode}}d=d.return}Ax(function(){var ue=v,Ee=ff(c),je=[];e:{var me=rp.get(a);if(me!==void 0){var ve=qo,st=a;switch(a){case"keypress":if($o(c)===0)break e;case"keydown":case"keyup":ve=B_;break;case"focusin":st="focus",ve=gf;break;case"focusout":st="blur",ve=gf;break;case"beforeblur":case"afterblur":ve=gf;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=Fx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=E_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=P_;break;case Qx:case Jx:case ep:ve=A_;break;case tp:ve=H_;break;case"scroll":case"scrollend":ve=S_;break;case"wheel":ve=G_;break;case"copy":case"cut":case"paste":ve=j_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Dx;break;case"toggle":case"beforetoggle":ve=$_}var Qe=(i&4)!==0,Vt=!Qe&&(a==="scroll"||a==="scrollend"),se=Qe?me!==null?me+"Capture":null:me;Qe=[];for(var ne=ue,ce;ne!==null;){var ke=ne;if(ce=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||ce===null||se===null||(ke=Xl(ne,se),ke!=null&&Qe.push(kc(ne,ke,ce))),Vt)break;ne=ne.return}0<Qe.length&&(me=new ve(me,st,null,c,Ee),je.push({event:me,listeners:Qe}))}}if((i&7)===0){e:{if(me=a==="mouseover"||a==="pointerover",ve=a==="mouseout"||a==="pointerout",me&&c!==uf&&(st=c.relatedTarget||c.fromElement)&&(G(st)||st[cs]))break e;if((ve||me)&&(me=Ee.window===Ee?Ee:(me=Ee.ownerDocument)?me.defaultView||me.parentWindow:window,ve?(st=c.relatedTarget||c.toElement,ve=ue,st=st?G(st):null,st!==null&&(Vt=l(st),Qe=st.tag,st!==Vt||Qe!==5&&Qe!==27&&Qe!==6)&&(st=null)):(ve=null,st=ue),ve!==st)){if(Qe=Fx,ke="onMouseLeave",se="onMouseEnter",ne="mouse",(a==="pointerout"||a==="pointerover")&&(Qe=Dx,ke="onPointerLeave",se="onPointerEnter",ne="pointer"),Vt=ve==null?me:fe(ve),ce=st==null?me:fe(st),me=new Qe(ke,ne+"leave",ve,c,Ee),me.target=Vt,me.relatedTarget=ce,ke=null,G(Ee)===ue&&(Qe=new Qe(se,ne+"enter",st,c,Ee),Qe.target=ce,Qe.relatedTarget=Vt,ke=Qe),Vt=ke,ve&&st)t:{for(Qe=ve,se=st,ne=0,ce=Qe;ce;ce=hl(ce))ne++;for(ce=0,ke=se;ke;ke=hl(ke))ce++;for(;0<ne-ce;)Qe=hl(Qe),ne--;for(;0<ce-ne;)se=hl(se),ce--;for(;ne--;){if(Qe===se||se!==null&&Qe===se.alternate)break t;Qe=hl(Qe),se=hl(se)}Qe=null}else Qe=null;ve!==null&&_g(je,me,ve,Qe,!1),st!==null&&Vt!==null&&_g(je,Vt,st,Qe,!0)}}e:{if(me=ue?fe(ue):window,ve=me.nodeName&&me.nodeName.toLowerCase(),ve==="select"||ve==="input"&&me.type==="file")var Ge=zx;else if(Ix(me))if(Hx)Ge=r4;else{Ge=e4;var yt=J_}else ve=me.nodeName,!ve||ve.toLowerCase()!=="input"||me.type!=="checkbox"&&me.type!=="radio"?ue&&of(ue.elementType)&&(Ge=zx):Ge=t4;if(Ge&&(Ge=Ge(a,ue))){Px(je,Ge,c,Ee);break e}yt&&yt(a,me,ue),a==="focusout"&&ue&&me.type==="number"&&ue.memoizedProps.value!=null&&cf(me,"number",me.value)}switch(yt=ue?fe(ue):window,a){case"focusin":(Ix(yt)||yt.contentEditable==="true")&&(Vi=yt,Sf=ue,Jl=null);break;case"focusout":Jl=Sf=Vi=null;break;case"mousedown":Nf=!0;break;case"contextmenu":case"mouseup":case"dragend":Nf=!1,Kx(je,c,Ee);break;case"selectionchange":if(n4)break;case"keydown":case"keyup":Kx(je,c,Ee)}var Ye;if(yf)e:{switch(a){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else Hi?Bx(a,c)&&(Je="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(Je="onCompositionStart");Je&&(Ox&&c.locale!=="ko"&&(Hi||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&Hi&&(Ye=Cx()):(us=Ee,mf="value"in us?us.value:us.textContent,Hi=!0)),yt=M0(ue,Je),0<yt.length&&(Je=new Rx(Je,a,null,c,Ee),je.push({event:Je,listeners:yt}),Ye?Je.data=Ye:(Ye=Ux(c),Ye!==null&&(Je.data=Ye)))),(Ye=q_?W_(a,c):K_(a,c))&&(Je=M0(ue,"onBeforeInput"),0<Je.length&&(yt=new Rx("onBeforeInput","beforeinput",null,c,Ee),je.push({event:yt,listeners:Je}),yt.data=Ye)),P4(je,a,ue,c,Ee)}wg(je,i)})}function kc(a,i,c){return{instance:a,listener:i,currentTarget:c}}function M0(a,i){for(var c=i+"Capture",d=[];a!==null;){var p=a,v=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||v===null||(p=Xl(a,c),p!=null&&d.unshift(kc(a,p,v)),p=Xl(a,i),p!=null&&d.push(kc(a,p,v))),a.tag===3)return d;a=a.return}return[]}function hl(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function _g(a,i,c,d,p){for(var v=i._reactName,k=[];c!==null&&c!==d;){var L=c,Z=L.alternate,ue=L.stateNode;if(L=L.tag,Z!==null&&Z===d)break;L!==5&&L!==26&&L!==27||ue===null||(Z=ue,p?(ue=Xl(c,v),ue!=null&&k.unshift(kc(c,ue,Z))):p||(ue=Xl(c,v),ue!=null&&k.push(kc(c,ue,Z)))),c=c.return}k.length!==0&&a.push({event:i,listeners:k})}var G4=/\r\n?/g,X4=/\u0000|\uFFFD/g;function Sg(a){return(typeof a=="string"?a:""+a).replace(G4,`
`).replace(X4,"")}function Ng(a,i){return i=Sg(i),Sg(a)===i}function L0(){}function Ht(a,i,c,d,p,v){switch(c){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||Ii(a,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&Ii(a,""+d);break;case"className":Pt(a,"class",d);break;case"tabIndex":Pt(a,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Pt(a,c,d);break;case"style":Tx(a,d,v);break;case"data":if(i!=="object"){Pt(a,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||c!=="href")){a.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){a.removeAttribute(c);break}d=Go(""+d),a.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(c==="formAction"?(i!=="input"&&Ht(a,i,"name",p.name,p,null),Ht(a,i,"formEncType",p.formEncType,p,null),Ht(a,i,"formMethod",p.formMethod,p,null),Ht(a,i,"formTarget",p.formTarget,p,null)):(Ht(a,i,"encType",p.encType,p,null),Ht(a,i,"method",p.method,p,null),Ht(a,i,"target",p.target,p,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){a.removeAttribute(c);break}d=Go(""+d),a.setAttribute(c,d);break;case"onClick":d!=null&&(a.onclick=L0);break;case"onScroll":d!=null&&_t("scroll",a);break;case"onScrollEnd":d!=null&&_t("scrollend",a);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(p.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"multiple":a.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":a.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){a.removeAttribute("xlink:href");break}c=Go(""+d),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(c,""+d):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":d===!0?a.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(c,d):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?a.setAttribute(c,d):a.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?a.removeAttribute(c):a.setAttribute(c,d);break;case"popover":_t("beforetoggle",a),_t("toggle",a),It(a,"popover",d);break;case"xlinkActuate":qt(a,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":qt(a,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":qt(a,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":qt(a,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":qt(a,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":qt(a,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":qt(a,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":qt(a,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":qt(a,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":It(a,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=b_.get(c)||c,It(a,c,d))}}function Yd(a,i,c,d,p,v){switch(c){case"style":Tx(a,d,v);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(p.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"children":typeof d=="string"?Ii(a,d):(typeof d=="number"||typeof d=="bigint")&&Ii(a,""+d);break;case"onScroll":d!=null&&_t("scroll",a);break;case"onScrollEnd":d!=null&&_t("scrollend",a);break;case"onClick":d!=null&&(a.onclick=L0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ge.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(p=c.endsWith("Capture"),i=c.slice(2,p?c.length-7:void 0),v=a[Er]||null,v=v!=null?v[c]:null,typeof v=="function"&&a.removeEventListener(i,v,p),typeof d=="function")){typeof v!="function"&&v!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(i,d,p);break e}c in a?a[c]=d:d===!0?a.setAttribute(c,""):It(a,c,d)}}}function Lr(a,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",a),_t("load",a);var d=!1,p=!1,v;for(v in c)if(c.hasOwnProperty(v)){var k=c[v];if(k!=null)switch(v){case"src":d=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:Ht(a,i,v,k,c,null)}}p&&Ht(a,i,"srcSet",c.srcSet,c,null),d&&Ht(a,i,"src",c.src,c,null);return;case"input":_t("invalid",a);var L=v=k=p=null,Z=null,ue=null;for(d in c)if(c.hasOwnProperty(d)){var Ee=c[d];if(Ee!=null)switch(d){case"name":p=Ee;break;case"type":k=Ee;break;case"checked":Z=Ee;break;case"defaultChecked":ue=Ee;break;case"value":v=Ee;break;case"defaultValue":L=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,i));break;default:Ht(a,i,d,Ee,c,null)}}_x(a,v,L,Z,ue,k,p,!1),Ho(a);return;case"select":_t("invalid",a),d=k=v=null;for(p in c)if(c.hasOwnProperty(p)&&(L=c[p],L!=null))switch(p){case"value":v=L;break;case"defaultValue":k=L;break;case"multiple":d=L;default:Ht(a,i,p,L,c,null)}i=v,c=k,a.multiple=!!d,i!=null?Ui(a,!!d,i,!1):c!=null&&Ui(a,!!d,c,!0);return;case"textarea":_t("invalid",a),v=p=d=null;for(k in c)if(c.hasOwnProperty(k)&&(L=c[k],L!=null))switch(k){case"value":d=L;break;case"defaultValue":p=L;break;case"children":v=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(n(91));break;default:Ht(a,i,k,L,c,null)}Nx(a,d,p,v),Ho(a);return;case"option":for(Z in c)if(c.hasOwnProperty(Z)&&(d=c[Z],d!=null))switch(Z){case"selected":a.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Ht(a,i,Z,d,c,null)}return;case"dialog":_t("beforetoggle",a),_t("toggle",a),_t("cancel",a),_t("close",a);break;case"iframe":case"object":_t("load",a);break;case"video":case"audio":for(d=0;d<Tc.length;d++)_t(Tc[d],a);break;case"image":_t("error",a),_t("load",a);break;case"details":_t("toggle",a);break;case"embed":case"source":case"link":_t("error",a),_t("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in c)if(c.hasOwnProperty(ue)&&(d=c[ue],d!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:Ht(a,i,ue,d,c,null)}return;default:if(of(i)){for(Ee in c)c.hasOwnProperty(Ee)&&(d=c[Ee],d!==void 0&&Yd(a,i,Ee,d,c,void 0));return}}for(L in c)c.hasOwnProperty(L)&&(d=c[L],d!=null&&Ht(a,i,L,d,c,null))}function $4(a,i,c,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,v=null,k=null,L=null,Z=null,ue=null,Ee=null;for(ve in c){var je=c[ve];if(c.hasOwnProperty(ve)&&je!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":Z=je;default:d.hasOwnProperty(ve)||Ht(a,i,ve,null,d,je)}}for(var me in d){var ve=d[me];if(je=c[me],d.hasOwnProperty(me)&&(ve!=null||je!=null))switch(me){case"type":v=ve;break;case"name":p=ve;break;case"checked":ue=ve;break;case"defaultChecked":Ee=ve;break;case"value":k=ve;break;case"defaultValue":L=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,i));break;default:ve!==je&&Ht(a,i,me,ve,d,je)}}lf(a,k,L,Z,ue,Ee,v,p);return;case"select":ve=k=L=me=null;for(v in c)if(Z=c[v],c.hasOwnProperty(v)&&Z!=null)switch(v){case"value":break;case"multiple":ve=Z;default:d.hasOwnProperty(v)||Ht(a,i,v,null,d,Z)}for(p in d)if(v=d[p],Z=c[p],d.hasOwnProperty(p)&&(v!=null||Z!=null))switch(p){case"value":me=v;break;case"defaultValue":L=v;break;case"multiple":k=v;default:v!==Z&&Ht(a,i,p,v,d,Z)}i=L,c=k,d=ve,me!=null?Ui(a,!!c,me,!1):!!d!=!!c&&(i!=null?Ui(a,!!c,i,!0):Ui(a,!!c,c?[]:"",!1));return;case"textarea":ve=me=null;for(L in c)if(p=c[L],c.hasOwnProperty(L)&&p!=null&&!d.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:Ht(a,i,L,null,d,p)}for(k in d)if(p=d[k],v=c[k],d.hasOwnProperty(k)&&(p!=null||v!=null))switch(k){case"value":me=p;break;case"defaultValue":ve=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(n(91));break;default:p!==v&&Ht(a,i,k,p,d,v)}Sx(a,me,ve);return;case"option":for(var st in c)if(me=c[st],c.hasOwnProperty(st)&&me!=null&&!d.hasOwnProperty(st))switch(st){case"selected":a.selected=!1;break;default:Ht(a,i,st,null,d,me)}for(Z in d)if(me=d[Z],ve=c[Z],d.hasOwnProperty(Z)&&me!==ve&&(me!=null||ve!=null))switch(Z){case"selected":a.selected=me&&typeof me!="function"&&typeof me!="symbol";break;default:Ht(a,i,Z,me,d,ve)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in c)me=c[Qe],c.hasOwnProperty(Qe)&&me!=null&&!d.hasOwnProperty(Qe)&&Ht(a,i,Qe,null,d,me);for(ue in d)if(me=d[ue],ve=c[ue],d.hasOwnProperty(ue)&&me!==ve&&(me!=null||ve!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(n(137,i));break;default:Ht(a,i,ue,me,d,ve)}return;default:if(of(i)){for(var Vt in c)me=c[Vt],c.hasOwnProperty(Vt)&&me!==void 0&&!d.hasOwnProperty(Vt)&&Yd(a,i,Vt,void 0,d,me);for(Ee in d)me=d[Ee],ve=c[Ee],!d.hasOwnProperty(Ee)||me===ve||me===void 0&&ve===void 0||Yd(a,i,Ee,me,d,ve);return}}for(var se in c)me=c[se],c.hasOwnProperty(se)&&me!=null&&!d.hasOwnProperty(se)&&Ht(a,i,se,null,d,me);for(je in d)me=d[je],ve=c[je],!d.hasOwnProperty(je)||me===ve||me==null&&ve==null||Ht(a,i,je,me,d,ve)}var qd=null,Wd=null;function B0(a){return a.nodeType===9?a:a.ownerDocument}function Eg(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Tg(a,i){if(a===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&i==="foreignObject"?0:a}function Kd(a,i){return a==="textarea"||a==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Zd=null;function Y4(){var a=window.event;return a&&a.type==="popstate"?a===Zd?!1:(Zd=a,!0):(Zd=null,!1)}var kg=typeof setTimeout=="function"?setTimeout:void 0,q4=typeof clearTimeout=="function"?clearTimeout:void 0,Ag=typeof Promise=="function"?Promise:void 0,W4=typeof queueMicrotask=="function"?queueMicrotask:typeof Ag<"u"?function(a){return Ag.resolve(null).then(a).catch(K4)}:kg;function K4(a){setTimeout(function(){throw a})}function Ts(a){return a==="head"}function Cg(a,i){var c=i,d=0,p=0;do{var v=c.nextSibling;if(a.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"){if(0<d&&8>d){c=d;var k=a.ownerDocument;if(c&1&&Ac(k.documentElement),c&2&&Ac(k.body),c&4)for(c=k.head,Ac(c),k=c.firstChild;k;){var L=k.nextSibling,Z=k.nodeName;k[I]||Z==="SCRIPT"||Z==="STYLE"||Z==="LINK"&&k.rel.toLowerCase()==="stylesheet"||c.removeChild(k),k=L}}if(p===0){a.removeChild(v),Lc(i);return}p--}else c==="$"||c==="$?"||c==="$!"?p++:d=c.charCodeAt(0)-48;else d=0;c=v}while(c);Lc(i)}function Qd(a){var i=a.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Qd(c),H(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function Z4(a,i,c,d){for(;a.nodeType===1;){var p=c;if(a.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(d){if(!a[I])switch(i){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(v=a.getAttribute("rel"),v==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(v!==p.rel||a.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||a.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||a.getAttribute("title")!==(p.title==null?null:p.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(v=a.getAttribute("src"),(v!==(p.src==null?null:p.src)||a.getAttribute("type")!==(p.type==null?null:p.type)||a.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&v&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(i==="input"&&a.type==="hidden"){var v=p.name==null?null:""+p.name;if(p.type==="hidden"&&a.getAttribute("name")===v)return a}else return a;if(a=ln(a.nextSibling),a===null)break}return null}function Q4(a,i,c){if(i==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=ln(a.nextSibling),a===null))return null;return a}function Jd(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function J4(a,i){var c=a.ownerDocument;if(a.data!=="$?"||c.readyState==="complete")i();else{var d=function(){i(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),a._reactRetry=d}}function ln(a){for(;a!=null;a=a.nextSibling){var i=a.nodeType;if(i===1||i===3)break;if(i===8){if(i=a.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return a}var eh=null;function jg(a){a=a.previousSibling;for(var i=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return a;i--}else c==="/$"&&i++}a=a.previousSibling}return null}function Fg(a,i,c){switch(i=B0(c),a){case"html":if(a=i.documentElement,!a)throw Error(n(452));return a;case"head":if(a=i.head,!a)throw Error(n(453));return a;case"body":if(a=i.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function Ac(a){for(var i=a.attributes;i.length;)a.removeAttributeNode(i[0]);H(a)}var Ga=new Map,Rg=new Set;function U0(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var qn=ie.d;ie.d={f:eS,r:tS,D:rS,C:aS,L:nS,m:sS,X:lS,S:iS,M:cS};function eS(){var a=qn.f(),i=C0();return a||i}function tS(a){var i=q(a);i!==null&&i.tag===5&&i.type==="form"?Qp(i):qn.r(a)}var ml=typeof document>"u"?null:document;function Dg(a,i,c){var d=ml;if(d&&typeof i=="string"&&i){var p=Ba(i);p='link[rel="'+a+'"][href="'+p+'"]',typeof c=="string"&&(p+='[crossorigin="'+c+'"]'),Rg.has(p)||(Rg.add(p),a={rel:a,crossOrigin:c,href:i},d.querySelector(p)===null&&(i=d.createElement("link"),Lr(i,"link",a),le(i),d.head.appendChild(i)))}}function rS(a){qn.D(a),Dg("dns-prefetch",a,null)}function aS(a,i){qn.C(a,i),Dg("preconnect",a,i)}function nS(a,i,c){qn.L(a,i,c);var d=ml;if(d&&a&&i){var p='link[rel="preload"][as="'+Ba(i)+'"]';i==="image"&&c&&c.imageSrcSet?(p+='[imagesrcset="'+Ba(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(p+='[imagesizes="'+Ba(c.imageSizes)+'"]')):p+='[href="'+Ba(a)+'"]';var v=p;switch(i){case"style":v=xl(a);break;case"script":v=pl(a)}Ga.has(v)||(a=x({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:a,as:i},c),Ga.set(v,a),d.querySelector(p)!==null||i==="style"&&d.querySelector(Cc(v))||i==="script"&&d.querySelector(jc(v))||(i=d.createElement("link"),Lr(i,"link",a),le(i),d.head.appendChild(i)))}}function sS(a,i){qn.m(a,i);var c=ml;if(c&&a){var d=i&&typeof i.as=="string"?i.as:"script",p='link[rel="modulepreload"][as="'+Ba(d)+'"][href="'+Ba(a)+'"]',v=p;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=pl(a)}if(!Ga.has(v)&&(a=x({rel:"modulepreload",href:a},i),Ga.set(v,a),c.querySelector(p)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(jc(v)))return}d=c.createElement("link"),Lr(d,"link",a),le(d),c.head.appendChild(d)}}}function iS(a,i,c){qn.S(a,i,c);var d=ml;if(d&&a){var p=Se(d).hoistableStyles,v=xl(a);i=i||"default";var k=p.get(v);if(!k){var L={loading:0,preload:null};if(k=d.querySelector(Cc(v)))L.loading=5;else{a=x({rel:"stylesheet",href:a,"data-precedence":i},c),(c=Ga.get(v))&&th(a,c);var Z=k=d.createElement("link");le(Z),Lr(Z,"link",a),Z._p=new Promise(function(ue,Ee){Z.onload=ue,Z.onerror=Ee}),Z.addEventListener("load",function(){L.loading|=1}),Z.addEventListener("error",function(){L.loading|=2}),L.loading|=4,I0(k,i,d)}k={type:"stylesheet",instance:k,count:1,state:L},p.set(v,k)}}}function lS(a,i){qn.X(a,i);var c=ml;if(c&&a){var d=Se(c).hoistableScripts,p=pl(a),v=d.get(p);v||(v=c.querySelector(jc(p)),v||(a=x({src:a,async:!0},i),(i=Ga.get(p))&&rh(a,i),v=c.createElement("script"),le(v),Lr(v,"link",a),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(p,v))}}function cS(a,i){qn.M(a,i);var c=ml;if(c&&a){var d=Se(c).hoistableScripts,p=pl(a),v=d.get(p);v||(v=c.querySelector(jc(p)),v||(a=x({src:a,async:!0,type:"module"},i),(i=Ga.get(p))&&rh(a,i),v=c.createElement("script"),le(v),Lr(v,"link",a),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(p,v))}}function Og(a,i,c,d){var p=(p=K.current)?U0(p):null;if(!p)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=xl(c.href),c=Se(p).hoistableStyles,d=c.get(i),d||(d={type:"style",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=xl(c.href);var v=Se(p).hoistableStyles,k=v.get(a);if(k||(p=p.ownerDocument||p,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(a,k),(v=p.querySelector(Cc(a)))&&!v._p&&(k.instance=v,k.state.loading=5),Ga.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ga.set(a,c),v||oS(p,a,c,k.state))),i&&d===null)throw Error(n(528,""));return k}if(i&&d!==null)throw Error(n(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=pl(c),c=Se(p).hoistableScripts,d=c.get(i),d||(d={type:"script",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function xl(a){return'href="'+Ba(a)+'"'}function Cc(a){return'link[rel="stylesheet"]['+a+"]"}function Mg(a){return x({},a,{"data-precedence":a.precedence,precedence:null})}function oS(a,i,c,d){a.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=a.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),Lr(i,"link",c),le(i),a.head.appendChild(i))}function pl(a){return'[src="'+Ba(a)+'"]'}function jc(a){return"script[async]"+a}function Lg(a,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var d=a.querySelector('style[data-href~="'+Ba(c.href)+'"]');if(d)return i.instance=d,le(d),d;var p=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(a.ownerDocument||a).createElement("style"),le(d),Lr(d,"style",p),I0(d,c.precedence,a),i.instance=d;case"stylesheet":p=xl(c.href);var v=a.querySelector(Cc(p));if(v)return i.state.loading|=4,i.instance=v,le(v),v;d=Mg(c),(p=Ga.get(p))&&th(d,p),v=(a.ownerDocument||a).createElement("link"),le(v);var k=v;return k._p=new Promise(function(L,Z){k.onload=L,k.onerror=Z}),Lr(v,"link",d),i.state.loading|=4,I0(v,c.precedence,a),i.instance=v;case"script":return v=pl(c.src),(p=a.querySelector(jc(v)))?(i.instance=p,le(p),p):(d=c,(p=Ga.get(v))&&(d=x({},c),rh(d,p)),a=a.ownerDocument||a,p=a.createElement("script"),le(p),Lr(p,"link",d),a.head.appendChild(p),i.instance=p);case"void":return null;default:throw Error(n(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,I0(d,c.precedence,a));return i.instance}function I0(a,i,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=d.length?d[d.length-1]:null,v=p,k=0;k<d.length;k++){var L=d[k];if(L.dataset.precedence===i)v=L;else if(v!==p)break}v?v.parentNode.insertBefore(a,v.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(a,i.firstChild))}function th(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.title==null&&(a.title=i.title)}function rh(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.integrity==null&&(a.integrity=i.integrity)}var P0=null;function Bg(a,i,c){if(P0===null){var d=new Map,p=P0=new Map;p.set(c,d)}else p=P0,d=p.get(c),d||(d=new Map,p.set(c,d));if(d.has(a))return d;for(d.set(a,null),c=c.getElementsByTagName(a),p=0;p<c.length;p++){var v=c[p];if(!(v[I]||v[Nr]||a==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var k=v.getAttribute(i)||"";k=a+k;var L=d.get(k);L?L.push(v):d.set(k,[v])}}return d}function Ug(a,i,c){a=a.ownerDocument||a,a.head.insertBefore(c,i==="title"?a.querySelector("head > title"):null)}function uS(a,i,c){if(c===1||i.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return a=i.disabled,typeof i.precedence=="string"&&a==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Ig(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var Fc=null;function fS(){}function dS(a,i,c){if(Fc===null)throw Error(n(475));var d=Fc;if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var p=xl(c.href),v=a.querySelector(Cc(p));if(v){a=v._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(d.count++,d=z0.bind(d),a.then(d,d)),i.state.loading|=4,i.instance=v,le(v);return}v=a.ownerDocument||a,c=Mg(c),(p=Ga.get(p))&&th(c,p),v=v.createElement("link"),le(v);var k=v;k._p=new Promise(function(L,Z){k.onload=L,k.onerror=Z}),Lr(v,"link",c),i.instance=v}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(i,a),(a=i.state.preload)&&(i.state.loading&3)===0&&(d.count++,i=z0.bind(d),a.addEventListener("load",i),a.addEventListener("error",i))}}function hS(){if(Fc===null)throw Error(n(475));var a=Fc;return a.stylesheets&&a.count===0&&ah(a,a.stylesheets),0<a.count?function(i){var c=setTimeout(function(){if(a.stylesheets&&ah(a,a.stylesheets),a.unsuspend){var d=a.unsuspend;a.unsuspend=null,d()}},6e4);return a.unsuspend=i,function(){a.unsuspend=null,clearTimeout(c)}}:null}function z0(){if(this.count--,this.count===0){if(this.stylesheets)ah(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var H0=null;function ah(a,i){a.stylesheets=null,a.unsuspend!==null&&(a.count++,H0=new Map,i.forEach(mS,a),H0=null,z0.call(a))}function mS(a,i){if(!(i.state.loading&4)){var c=H0.get(a);if(c)var d=c.get(null);else{c=new Map,H0.set(a,c);for(var p=a.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<p.length;v++){var k=p[v];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(c.set(k.dataset.precedence,k),d=k)}d&&c.set(null,d)}p=i.instance,k=p.getAttribute("data-precedence"),v=c.get(k)||d,v===d&&c.set(null,p),c.set(k,p),this.count++,d=z0.bind(this),p.addEventListener("load",d),p.addEventListener("error",d),v?v.parentNode.insertBefore(p,v.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(p,a.firstChild)),i.state.loading|=4}}var Rc={$$typeof:E,Provider:null,Consumer:null,_currentValue:Ae,_currentValue2:Ae,_threadCount:0};function xS(a,i,c,d,p,v,k,L){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ca(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ca(0),this.hiddenUpdates=ca(null),this.identifierPrefix=d,this.onUncaughtError=p,this.onCaughtError=v,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function Pg(a,i,c,d,p,v,k,L,Z,ue,Ee,je){return a=new xS(a,i,c,k,L,Z,ue,je),i=1,v===!0&&(i|=24),v=ba(3,null,null,i),a.current=v,v.stateNode=a,i=Uf(),i.refCount++,a.pooledCache=i,i.refCount++,v.memoizedState={element:d,isDehydrated:c,cache:i},Hf(v),a}function zg(a){return a?(a=Yi,a):Yi}function Hg(a,i,c,d,p,v){p=zg(p),d.context===null?d.context=p:d.pendingContext=p,d=hs(i),d.payload={element:c},v=v===void 0?null:v,v!==null&&(d.callback=v),c=ms(a,d,i),c!==null&&(Ta(c,a,i),cc(c,a,i))}function Vg(a,i){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<i?c:i}}function nh(a,i){Vg(a,i),(a=a.alternate)&&Vg(a,i)}function Gg(a){if(a.tag===13){var i=$i(a,67108864);i!==null&&Ta(i,a,67108864),nh(a,67108864)}}var V0=!0;function pS(a,i,c,d){var p=Q.T;Q.T=null;var v=ie.p;try{ie.p=2,sh(a,i,c,d)}finally{ie.p=v,Q.T=p}}function gS(a,i,c,d){var p=Q.T;Q.T=null;var v=ie.p;try{ie.p=8,sh(a,i,c,d)}finally{ie.p=v,Q.T=p}}function sh(a,i,c,d){if(V0){var p=ih(d);if(p===null)$d(a,i,d,G0,c),$g(a,d);else if(yS(p,a,i,c,d))d.stopPropagation();else if($g(a,d),i&4&&-1<vS.indexOf(a)){for(;p!==null;){var v=q(p);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var k=Oa(v.pendingLanes);if(k!==0){var L=v;for(L.pendingLanes|=2,L.entangledLanes|=2;k;){var Z=1<<31-nt(k);L.entanglements[1]|=Z,k&=~Z}_n(v),(Ot&6)===0&&(k0=Me()+500,Ec(0))}}break;case 13:L=$i(v,2),L!==null&&Ta(L,v,2),C0(),nh(v,2)}if(v=ih(d),v===null&&$d(a,i,d,G0,c),v===p)break;p=v}p!==null&&d.stopPropagation()}else $d(a,i,d,null,c)}}function ih(a){return a=ff(a),lh(a)}var G0=null;function lh(a){if(G0=null,a=G(a),a!==null){var i=l(a);if(i===null)a=null;else{var c=i.tag;if(c===13){if(a=o(i),a!==null)return a;a=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;a=null}else i!==a&&(a=null)}}return G0=a,null}function Xg(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(vt()){case De:return 2;case at:return 8;case Ce:case Fe:return 32;case de:return 268435456;default:return 32}default:return 32}}var ch=!1,ks=null,As=null,Cs=null,Dc=new Map,Oc=new Map,js=[],vS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $g(a,i){switch(a){case"focusin":case"focusout":ks=null;break;case"dragenter":case"dragleave":As=null;break;case"mouseover":case"mouseout":Cs=null;break;case"pointerover":case"pointerout":Dc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oc.delete(i.pointerId)}}function Mc(a,i,c,d,p,v){return a===null||a.nativeEvent!==v?(a={blockedOn:i,domEventName:c,eventSystemFlags:d,nativeEvent:v,targetContainers:[p]},i!==null&&(i=q(i),i!==null&&Gg(i)),a):(a.eventSystemFlags|=d,i=a.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),a)}function yS(a,i,c,d,p){switch(i){case"focusin":return ks=Mc(ks,a,i,c,d,p),!0;case"dragenter":return As=Mc(As,a,i,c,d,p),!0;case"mouseover":return Cs=Mc(Cs,a,i,c,d,p),!0;case"pointerover":var v=p.pointerId;return Dc.set(v,Mc(Dc.get(v)||null,a,i,c,d,p)),!0;case"gotpointercapture":return v=p.pointerId,Oc.set(v,Mc(Oc.get(v)||null,a,i,c,d,p)),!0}return!1}function Yg(a){var i=G(a.target);if(i!==null){var c=l(i);if(c!==null){if(i=c.tag,i===13){if(i=o(c),i!==null){a.blockedOn=i,nf(a.priority,function(){if(c.tag===13){var d=Ea();d=Hl(d);var p=$i(c,d);p!==null&&Ta(p,c,d),nh(c,d)}});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function X0(a){if(a.blockedOn!==null)return!1;for(var i=a.targetContainers;0<i.length;){var c=ih(a.nativeEvent);if(c===null){c=a.nativeEvent;var d=new c.constructor(c.type,c);uf=d,c.target.dispatchEvent(d),uf=null}else return i=q(c),i!==null&&Gg(i),a.blockedOn=c,!1;i.shift()}return!0}function qg(a,i,c){X0(a)&&c.delete(i)}function wS(){ch=!1,ks!==null&&X0(ks)&&(ks=null),As!==null&&X0(As)&&(As=null),Cs!==null&&X0(Cs)&&(Cs=null),Dc.forEach(qg),Oc.forEach(qg)}function $0(a,i){a.blockedOn===i&&(a.blockedOn=null,ch||(ch=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,wS)))}var Y0=null;function Wg(a){Y0!==a&&(Y0=a,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Y0===a&&(Y0=null);for(var i=0;i<a.length;i+=3){var c=a[i],d=a[i+1],p=a[i+2];if(typeof d!="function"){if(lh(d||c)===null)continue;break}var v=q(c);v!==null&&(a.splice(i,3),i-=3,ld(v,{pending:!0,data:p,method:c.method,action:d},d,p))}}))}function Lc(a){function i(Z){return $0(Z,a)}ks!==null&&$0(ks,a),As!==null&&$0(As,a),Cs!==null&&$0(Cs,a),Dc.forEach(i),Oc.forEach(i);for(var c=0;c<js.length;c++){var d=js[c];d.blockedOn===a&&(d.blockedOn=null)}for(;0<js.length&&(c=js[0],c.blockedOn===null);)Yg(c),c.blockedOn===null&&js.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var p=c[d],v=c[d+1],k=p[Er]||null;if(typeof v=="function")k||Wg(c);else if(k){var L=null;if(v&&v.hasAttribute("formAction")){if(p=v,k=v[Er]||null)L=k.formAction;else if(lh(p)!==null)continue}else L=k.action;typeof L=="function"?c[d+1]=L:(c.splice(d,3),d-=3),Wg(c)}}}function oh(a){this._internalRoot=a}q0.prototype.render=oh.prototype.render=function(a){var i=this._internalRoot;if(i===null)throw Error(n(409));var c=i.current,d=Ea();Hg(c,d,a,i,null,null)},q0.prototype.unmount=oh.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var i=a.containerInfo;Hg(a.current,2,null,a,null,null),C0(),i[cs]=null}};function q0(a){this._internalRoot=a}q0.prototype.unstable_scheduleHydration=function(a){if(a){var i=zo();a={blockedOn:null,target:a,priority:i};for(var c=0;c<js.length&&i!==0&&i<js[c].priority;c++);js.splice(c,0,a),c===0&&Yg(a)}};var Kg=t.version;if(Kg!=="19.1.0")throw Error(n(527,Kg,"19.1.0"));ie.findDOMNode=function(a){var i=a._reactInternals;if(i===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=m(i),a=a!==null?h(a):null,a=a===null?null:a.stateNode,a};var bS={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var W0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!W0.isDisabled&&W0.supportsFiber)try{Ke=W0.inject(bS),Xe=W0}catch{}}return Uc.createRoot=function(a,i){if(!s(a))throw Error(n(299));var c=!1,d="",p=d1,v=h1,k=m1,L=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(p=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(k=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(L=i.unstable_transitionCallbacks)),i=Pg(a,1,!1,null,null,c,d,p,v,k,L,null),a[cs]=i.current,Xd(a),new oh(i)},Uc.hydrateRoot=function(a,i,c){if(!s(a))throw Error(n(299));var d=!1,p="",v=d1,k=h1,L=m1,Z=null,ue=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(v=c.onUncaughtError),c.onCaughtError!==void 0&&(k=c.onCaughtError),c.onRecoverableError!==void 0&&(L=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(Z=c.unstable_transitionCallbacks),c.formState!==void 0&&(ue=c.formState)),i=Pg(a,1,!0,i,c??null,d,p,v,k,L,Z,ue),i.context=zg(null),c=i.current,d=Ea(),d=Hl(d),p=hs(d),p.callback=null,ms(c,p,d),c=d,i.current.lanes=c,Vr(i,c),_n(i),a[cs]=i.current,Xd(a),new q0(i)},Uc.version="19.1.0",Uc}var iv;function OS(){if(iv)return hh.exports;iv=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),hh.exports=DS(),hh.exports}var MS=OS(),Ic={},lv;function LS(){if(lv)return Ic;lv=1,Object.defineProperty(Ic,"__esModule",{value:!0}),Ic.parse=o,Ic.serialize=h;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,l=(()=>{const y=function(){};return y.prototype=Object.create(null),y})();function o(y,S){const w=new l,b=y.length;if(b<2)return w;const _=(S==null?void 0:S.decode)||x;let T=0;do{const N=y.indexOf("=",T);if(N===-1)break;const E=y.indexOf(";",T),j=E===-1?b:E;if(N>j){T=y.lastIndexOf(";",N-1)+1;continue}const F=f(y,T,N),R=m(y,N,F),A=y.slice(F,R);if(w[A]===void 0){let P=f(y,N+1,j),U=m(y,j,P);const ee=_(y.slice(P,U));w[A]=ee}T=j+1}while(T<b);return w}function f(y,S,w){do{const b=y.charCodeAt(S);if(b!==32&&b!==9)return S}while(++S<w);return w}function m(y,S,w){for(;S>w;){const b=y.charCodeAt(--S);if(b!==32&&b!==9)return S+1}return w}function h(y,S,w){const b=(w==null?void 0:w.encode)||encodeURIComponent;if(!e.test(y))throw new TypeError(`argument name is invalid: ${y}`);const _=b(S);if(!t.test(_))throw new TypeError(`argument val is invalid: ${S}`);let T=y+"="+_;if(!w)return T;if(w.maxAge!==void 0){if(!Number.isInteger(w.maxAge))throw new TypeError(`option maxAge is invalid: ${w.maxAge}`);T+="; Max-Age="+w.maxAge}if(w.domain){if(!r.test(w.domain))throw new TypeError(`option domain is invalid: ${w.domain}`);T+="; Domain="+w.domain}if(w.path){if(!n.test(w.path))throw new TypeError(`option path is invalid: ${w.path}`);T+="; Path="+w.path}if(w.expires){if(!g(w.expires)||!Number.isFinite(w.expires.valueOf()))throw new TypeError(`option expires is invalid: ${w.expires}`);T+="; Expires="+w.expires.toUTCString()}if(w.httpOnly&&(T+="; HttpOnly"),w.secure&&(T+="; Secure"),w.partitioned&&(T+="; Partitioned"),w.priority)switch(typeof w.priority=="string"?w.priority.toLowerCase():void 0){case"low":T+="; Priority=Low";break;case"medium":T+="; Priority=Medium";break;case"high":T+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${w.priority}`)}if(w.sameSite)switch(typeof w.sameSite=="string"?w.sameSite.toLowerCase():w.sameSite){case!0:case"strict":T+="; SameSite=Strict";break;case"lax":T+="; SameSite=Lax";break;case"none":T+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${w.sameSite}`)}return T}function x(y){if(y.indexOf("%")===-1)return y;try{return decodeURIComponent(y)}catch{return y}}function g(y){return s.call(y)==="[object Date]"}return Ic}LS();var cv="popstate";function BS(e={}){function t(n,s){let{pathname:l,search:o,hash:f}=n.location;return Bh("",{pathname:l,search:o,hash:f},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:no(s)}return IS(t,r,null,e)}function rr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function dn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function US(){return Math.random().toString(36).substring(2,10)}function ov(e,t){return{usr:e.state,key:e.key,idx:t}}function Bh(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Fl(t):t,state:r,key:t&&t.key||n||US()}}function no({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Fl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function IS(e,t,r,n={}){let{window:s=document.defaultView,v5Compat:l=!1}=n,o=s.history,f="POP",m=null,h=x();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function x(){return(o.state||{idx:null}).idx}function g(){f="POP";let _=x(),T=_==null?null:_-h;h=_,m&&m({action:f,location:b.location,delta:T})}function y(_,T){f="PUSH";let N=Bh(b.location,_,T);h=x()+1;let E=ov(N,h),j=b.createHref(N);try{o.pushState(E,"",j)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(j)}l&&m&&m({action:f,location:b.location,delta:1})}function S(_,T){f="REPLACE";let N=Bh(b.location,_,T);h=x();let E=ov(N,h),j=b.createHref(N);o.replaceState(E,"",j),l&&m&&m({action:f,location:b.location,delta:0})}function w(_){let T=s.location.origin!=="null"?s.location.origin:s.location.href,N=typeof _=="string"?_:no(_);return N=N.replace(/ $/,"%20"),rr(T,`No window.location.(origin|href) available to create URL for href: ${N}`),new URL(N,T)}let b={get action(){return f},get location(){return e(s,o)},listen(_){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(cv,g),m=_,()=>{s.removeEventListener(cv,g),m=null}},createHref(_){return t(s,_)},createURL:w,encodeLocation(_){let T=w(_);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:y,replace:S,go(_){return o.go(_)}};return b}function Ky(e,t,r="/"){return PS(e,t,r,!1)}function PS(e,t,r,n){let s=typeof t=="string"?Fl(t):t,l=es(s.pathname||"/",r);if(l==null)return null;let o=Zy(e);zS(o);let f=null;for(let m=0;f==null&&m<o.length;++m){let h=QS(l);f=KS(o[m],h,n)}return f}function Zy(e,t=[],r=[],n=""){let s=(l,o,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};m.relativePath.startsWith("/")&&(rr(m.relativePath.startsWith(n),`Absolute route path "${m.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(n.length));let h=Zn([n,m.relativePath]),x=r.concat(m);l.children&&l.children.length>0&&(rr(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),Zy(l.children,t,x,h)),!(l.path==null&&!l.index)&&t.push({path:h,score:qS(h,l.index),routesMeta:x})};return e.forEach((l,o)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))s(l,o);else for(let m of Qy(l.path))s(l,o,m)}),t}function Qy(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return s?[l,""]:[l];let o=Qy(n.join("/")),f=[];return f.push(...o.map(m=>m===""?l:[l,m].join("/"))),s&&f.push(...o),f.map(m=>e.startsWith("/")&&m===""?"/":m)}function zS(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:WS(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var HS=/^:[\w-]+$/,VS=3,GS=2,XS=1,$S=10,YS=-2,uv=e=>e==="*";function qS(e,t){let r=e.split("/"),n=r.length;return r.some(uv)&&(n+=YS),t&&(n+=GS),r.filter(s=>!uv(s)).reduce((s,l)=>s+(HS.test(l)?VS:l===""?XS:$S),n)}function WS(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function KS(e,t,r=!1){let{routesMeta:n}=e,s={},l="/",o=[];for(let f=0;f<n.length;++f){let m=n[f],h=f===n.length-1,x=l==="/"?t:t.slice(l.length)||"/",g=du({path:m.relativePath,caseSensitive:m.caseSensitive,end:h},x),y=m.route;if(!g&&h&&r&&!n[n.length-1].route.index&&(g=du({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},x)),!g)return null;Object.assign(s,g.params),o.push({params:s,pathname:Zn([l,g.pathname]),pathnameBase:r3(Zn([l,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(l=Zn([l,g.pathnameBase]))}return o}function du(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=ZS(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let l=s[0],o=l.replace(/(.)\/+$/,"$1"),f=s.slice(1);return{params:n.reduce((h,{paramName:x,isOptional:g},y)=>{if(x==="*"){let w=f[y]||"";o=l.slice(0,l.length-w.length).replace(/(.)\/+$/,"$1")}const S=f[y];return g&&!S?h[x]=void 0:h[x]=(S||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:o,pattern:e}}function ZS(e,t=!1,r=!0){dn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,f,m)=>(n.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function QS(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return dn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function es(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function JS(e,t="/"){let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Fl(e):e;return{pathname:r?r.startsWith("/")?r:e3(r,t):t,search:a3(n),hash:n3(s)}}function e3(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function gh(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function t3(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function fm(e){let t=t3(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function dm(e,t,r,n=!1){let s;typeof e=="string"?s=Fl(e):(s={...e},rr(!s.pathname||!s.pathname.includes("?"),gh("?","pathname","search",s)),rr(!s.pathname||!s.pathname.includes("#"),gh("#","pathname","hash",s)),rr(!s.search||!s.search.includes("#"),gh("#","search","hash",s)));let l=e===""||s.pathname==="",o=l?"/":s.pathname,f;if(o==null)f=r;else{let g=t.length-1;if(!n&&o.startsWith("..")){let y=o.split("/");for(;y[0]==="..";)y.shift(),g-=1;s.pathname=y.join("/")}f=g>=0?t[g]:"/"}let m=JS(s,f),h=o&&o!=="/"&&o.endsWith("/"),x=(l||o===".")&&r.endsWith("/");return!m.pathname.endsWith("/")&&(h||x)&&(m.pathname+="/"),m}var Zn=e=>e.join("/").replace(/\/\/+/g,"/"),r3=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),a3=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,n3=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function s3(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Jy=["POST","PUT","PATCH","DELETE"];new Set(Jy);var i3=["GET",...Jy];new Set(i3);var Rl=C.createContext(null);Rl.displayName="DataRouter";var Ou=C.createContext(null);Ou.displayName="DataRouterState";var e2=C.createContext({isTransitioning:!1});e2.displayName="ViewTransition";var l3=C.createContext(new Map);l3.displayName="Fetchers";var c3=C.createContext(null);c3.displayName="Await";var mn=C.createContext(null);mn.displayName="Navigation";var So=C.createContext(null);So.displayName="Location";var xn=C.createContext({outlet:null,matches:[],isDataRoute:!1});xn.displayName="Route";var hm=C.createContext(null);hm.displayName="RouteError";function o3(e,{relative:t}={}){rr(Dl(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=C.useContext(mn),{hash:s,pathname:l,search:o}=No(e,{relative:t}),f=l;return r!=="/"&&(f=l==="/"?r:Zn([r,l])),n.createHref({pathname:f,search:o,hash:s})}function Dl(){return C.useContext(So)!=null}function as(){return rr(Dl(),"useLocation() may be used only in the context of a <Router> component."),C.useContext(So).location}var t2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function r2(e){C.useContext(mn).static||C.useLayoutEffect(e)}function ta(){let{isDataRoute:e}=C.useContext(xn);return e?_3():u3()}function u3(){rr(Dl(),"useNavigate() may be used only in the context of a <Router> component.");let e=C.useContext(Rl),{basename:t,navigator:r}=C.useContext(mn),{matches:n}=C.useContext(xn),{pathname:s}=as(),l=JSON.stringify(fm(n)),o=C.useRef(!1);return r2(()=>{o.current=!0}),C.useCallback((m,h={})=>{if(dn(o.current,t2),!o.current)return;if(typeof m=="number"){r.go(m);return}let x=dm(m,JSON.parse(l),s,h.relative==="path");e==null&&t!=="/"&&(x.pathname=x.pathname==="/"?t:Zn([t,x.pathname])),(h.replace?r.replace:r.push)(x,h.state,h)},[t,r,l,s,e])}C.createContext(null);function mm(){let{matches:e}=C.useContext(xn),t=e[e.length-1];return t?t.params:{}}function No(e,{relative:t}={}){let{matches:r}=C.useContext(xn),{pathname:n}=as(),s=JSON.stringify(fm(r));return C.useMemo(()=>dm(e,JSON.parse(s),n,t==="path"),[e,s,n,t])}function f3(e,t){return a2(e,t)}function a2(e,t,r,n){var N;rr(Dl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s,static:l}=C.useContext(mn),{matches:o}=C.useContext(xn),f=o[o.length-1],m=f?f.params:{},h=f?f.pathname:"/",x=f?f.pathnameBase:"/",g=f&&f.route;{let E=g&&g.path||"";n2(h,!g||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let y=as(),S;if(t){let E=typeof t=="string"?Fl(t):t;rr(x==="/"||((N=E.pathname)==null?void 0:N.startsWith(x)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${E.pathname}" was given in the \`location\` prop.`),S=E}else S=y;let w=S.pathname||"/",b=w;if(x!=="/"){let E=x.replace(/^\//,"").split("/");b="/"+w.replace(/^\//,"").split("/").slice(E.length).join("/")}let _=!l&&r&&r.matches&&r.matches.length>0?r.matches:Ky(e,{pathname:b});dn(g||_!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),dn(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=p3(_&&_.map(E=>Object.assign({},E,{params:Object.assign({},m,E.params),pathname:Zn([x,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?x:Zn([x,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),o,r,n);return t&&T?C.createElement(So.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},T):T}function d3(){let e=b3(),t=s3(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},l={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=C.createElement(C.Fragment,null,C.createElement("p",null," Hey developer "),C.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",C.createElement("code",{style:l},"ErrorBoundary")," or"," ",C.createElement("code",{style:l},"errorElement")," prop on your route.")),C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:s},r):null,o)}var h3=C.createElement(d3,null),m3=class extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(xn.Provider,{value:this.props.routeContext},C.createElement(hm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function x3({routeContext:e,match:t,children:r}){let n=C.useContext(Rl);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(xn.Provider,{value:e},r)}function p3(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,l=r==null?void 0:r.errors;if(l!=null){let m=s.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);rr(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),s=s.slice(0,Math.min(s.length,m+1))}let o=!1,f=-1;if(r)for(let m=0;m<s.length;m++){let h=s[m];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(f=m),h.route.id){let{loaderData:x,errors:g}=r,y=h.route.loader&&!x.hasOwnProperty(h.route.id)&&(!g||g[h.route.id]===void 0);if(h.route.lazy||y){o=!0,f>=0?s=s.slice(0,f+1):s=[s[0]];break}}}return s.reduceRight((m,h,x)=>{let g,y=!1,S=null,w=null;r&&(g=l&&h.route.id?l[h.route.id]:void 0,S=h.route.errorElement||h3,o&&(f<0&&x===0?(n2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,w=null):f===x&&(y=!0,w=h.route.hydrateFallbackElement||null)));let b=t.concat(s.slice(0,x+1)),_=()=>{let T;return g?T=S:y?T=w:h.route.Component?T=C.createElement(h.route.Component,null):h.route.element?T=h.route.element:T=m,C.createElement(x3,{match:h,routeContext:{outlet:m,matches:b,isDataRoute:r!=null},children:T})};return r&&(h.route.ErrorBoundary||h.route.errorElement||x===0)?C.createElement(m3,{location:r.location,revalidation:r.revalidation,component:S,error:g,children:_(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):_()},null)}function xm(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function g3(e){let t=C.useContext(Rl);return rr(t,xm(e)),t}function v3(e){let t=C.useContext(Ou);return rr(t,xm(e)),t}function y3(e){let t=C.useContext(xn);return rr(t,xm(e)),t}function pm(e){let t=y3(e),r=t.matches[t.matches.length-1];return rr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function w3(){return pm("useRouteId")}function b3(){var n;let e=C.useContext(hm),t=v3("useRouteError"),r=pm("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function _3(){let{router:e}=g3("useNavigate"),t=pm("useNavigate"),r=C.useRef(!1);return r2(()=>{r.current=!0}),C.useCallback(async(s,l={})=>{dn(r.current,t2),r.current&&(typeof s=="number"?e.navigate(s):await e.navigate(s,{fromRouteId:t,...l}))},[e,t])}var fv={};function n2(e,t,r){!t&&!fv[e]&&(fv[e]=!0,dn(!1,r))}C.memo(S3);function S3({routes:e,future:t,state:r}){return a2(e,void 0,r,t)}function kl({to:e,replace:t,state:r,relative:n}){rr(Dl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=C.useContext(mn);dn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=C.useContext(xn),{pathname:o}=as(),f=ta(),m=dm(e,fm(l),o,n==="path"),h=JSON.stringify(m);return C.useEffect(()=>{f(JSON.parse(h),{replace:t,state:r,relative:n})},[f,h,n,t,r]),null}function ha(e){rr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function N3({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:s,static:l=!1}){rr(!Dl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),f=C.useMemo(()=>({basename:o,navigator:s,static:l,future:{}}),[o,s,l]);typeof r=="string"&&(r=Fl(r));let{pathname:m="/",search:h="",hash:x="",state:g=null,key:y="default"}=r,S=C.useMemo(()=>{let w=es(m,o);return w==null?null:{location:{pathname:w,search:h,hash:x,state:g,key:y},navigationType:n}},[o,m,h,x,g,y,n]);return dn(S!=null,`<Router basename="${o}"> is not able to match the URL "${m}${h}${x}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:C.createElement(mn.Provider,{value:f},C.createElement(So.Provider,{children:t,value:S}))}function E3({children:e,location:t}){return f3(Uh(e),t)}function Uh(e,t=[]){let r=[];return C.Children.forEach(e,(n,s)=>{if(!C.isValidElement(n))return;let l=[...t,s];if(n.type===C.Fragment){r.push.apply(r,Uh(n.props.children,l));return}rr(n.type===ha,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),rr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Uh(n.props.children,l)),r.push(o)}),r}var lu="get",cu="application/x-www-form-urlencoded";function Mu(e){return e!=null&&typeof e.tagName=="string"}function T3(e){return Mu(e)&&e.tagName.toLowerCase()==="button"}function k3(e){return Mu(e)&&e.tagName.toLowerCase()==="form"}function A3(e){return Mu(e)&&e.tagName.toLowerCase()==="input"}function C3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function j3(e,t){return e.button===0&&(!t||t==="_self")&&!C3(e)}var K0=null;function F3(){if(K0===null)try{new FormData(document.createElement("form"),0),K0=!1}catch{K0=!0}return K0}var R3=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function vh(e){return e!=null&&!R3.has(e)?(dn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${cu}"`),null):e}function D3(e,t){let r,n,s,l,o;if(k3(e)){let f=e.getAttribute("action");n=f?es(f,t):null,r=e.getAttribute("method")||lu,s=vh(e.getAttribute("enctype"))||cu,l=new FormData(e)}else if(T3(e)||A3(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=e.getAttribute("formaction")||f.getAttribute("action");if(n=m?es(m,t):null,r=e.getAttribute("formmethod")||f.getAttribute("method")||lu,s=vh(e.getAttribute("formenctype"))||vh(f.getAttribute("enctype"))||cu,l=new FormData(f,e),!F3()){let{name:h,type:x,value:g}=e;if(x==="image"){let y=h?`${h}.`:"";l.append(`${y}x`,"0"),l.append(`${y}y`,"0")}else h&&l.append(h,g)}}else{if(Mu(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=lu,n=null,s=cu,o=e}return l&&s==="text/plain"&&(o=l,l=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:l,body:o}}function gm(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function O3(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function M3(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function L3(e,t,r){let n=await Promise.all(e.map(async s=>{let l=t.routes[s.route.id];if(l){let o=await O3(l,r);return o.links?o.links():[]}return[]}));return P3(n.flat(1).filter(M3).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function dv(e,t,r,n,s,l){let o=(m,h)=>r[h]?m.route.id!==r[h].route.id:!0,f=(m,h)=>{var x;return r[h].pathname!==m.pathname||((x=r[h].route.path)==null?void 0:x.endsWith("*"))&&r[h].params["*"]!==m.params["*"]};return l==="assets"?t.filter((m,h)=>o(m,h)||f(m,h)):l==="data"?t.filter((m,h)=>{var g;let x=n.routes[m.route.id];if(!x||!x.hasLoader)return!1;if(o(m,h)||f(m,h))return!0;if(m.route.shouldRevalidate){let y=m.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((g=r[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function B3(e,t,{includeHydrateFallback:r}={}){return U3(e.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let l=[s.module];return s.clientActionModule&&(l=l.concat(s.clientActionModule)),s.clientLoaderModule&&(l=l.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(l=l.concat(s.hydrateFallbackModule)),s.imports&&(l=l.concat(s.imports)),l}).flat(1))}function U3(e){return[...new Set(e)]}function I3(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function P3(e,t){let r=new Set;return new Set(t),e.reduce((n,s)=>{let l=JSON.stringify(I3(s));return r.has(l)||(r.add(l),n.push({key:l,link:s})),n},[])}var z3=new Set([100,101,204,205]);function H3(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&es(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function s2(){let e=C.useContext(Rl);return gm(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function V3(){let e=C.useContext(Ou);return gm(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var vm=C.createContext(void 0);vm.displayName="FrameworkContext";function i2(){let e=C.useContext(vm);return gm(e,"You must render this element inside a <HydratedRouter> element"),e}function G3(e,t){let r=C.useContext(vm),[n,s]=C.useState(!1),[l,o]=C.useState(!1),{onFocus:f,onBlur:m,onMouseEnter:h,onMouseLeave:x,onTouchStart:g}=t,y=C.useRef(null);C.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let b=T=>{T.forEach(N=>{o(N.isIntersecting)})},_=new IntersectionObserver(b,{threshold:.5});return y.current&&_.observe(y.current),()=>{_.disconnect()}}},[e]),C.useEffect(()=>{if(n){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[n]);let S=()=>{s(!0)},w=()=>{s(!1),o(!1)};return r?e!=="intent"?[l,y,{}]:[l,y,{onFocus:Pc(f,S),onBlur:Pc(m,w),onMouseEnter:Pc(h,S),onMouseLeave:Pc(x,w),onTouchStart:Pc(g,S)}]:[!1,y,{}]}function Pc(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function X3({page:e,...t}){let{router:r}=s2(),n=C.useMemo(()=>Ky(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?C.createElement(Y3,{page:e,matches:n,...t}):null}function $3(e){let{manifest:t,routeModules:r}=i2(),[n,s]=C.useState([]);return C.useEffect(()=>{let l=!1;return L3(e,t,r).then(o=>{l||s(o)}),()=>{l=!0}},[e,t,r]),n}function Y3({page:e,matches:t,...r}){let n=as(),{manifest:s,routeModules:l}=i2(),{basename:o}=s2(),{loaderData:f,matches:m}=V3(),h=C.useMemo(()=>dv(e,t,m,s,n,"data"),[e,t,m,s,n]),x=C.useMemo(()=>dv(e,t,m,s,n,"assets"),[e,t,m,s,n]),g=C.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let w=new Set,b=!1;if(t.forEach(T=>{var E;let N=s.routes[T.route.id];!N||!N.hasLoader||(!h.some(j=>j.route.id===T.route.id)&&T.route.id in f&&((E=l[T.route.id])!=null&&E.shouldRevalidate)||N.hasClientLoader?b=!0:w.add(T.route.id))}),w.size===0)return[];let _=H3(e,o);return b&&w.size>0&&_.searchParams.set("_routes",t.filter(T=>w.has(T.route.id)).map(T=>T.route.id).join(",")),[_.pathname+_.search]},[o,f,n,s,h,t,e,l]),y=C.useMemo(()=>B3(x,s),[x,s]),S=$3(x);return C.createElement(C.Fragment,null,g.map(w=>C.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...r})),y.map(w=>C.createElement("link",{key:w,rel:"modulepreload",href:w,...r})),S.map(({key:w,link:b})=>C.createElement("link",{key:w,...b})))}function q3(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var l2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{l2&&(window.__reactRouterVersion="7.5.3")}catch{}function W3({basename:e,children:t,window:r}){let n=C.useRef();n.current==null&&(n.current=BS({window:r,v5Compat:!0}));let s=n.current,[l,o]=C.useState({action:s.action,location:s.location}),f=C.useCallback(m=>{C.startTransition(()=>o(m))},[o]);return C.useLayoutEffect(()=>s.listen(f),[s,f]),C.createElement(N3,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:s})}var c2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ma=C.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:s,reloadDocument:l,replace:o,state:f,target:m,to:h,preventScrollReset:x,viewTransition:g,...y},S){let{basename:w}=C.useContext(mn),b=typeof h=="string"&&c2.test(h),_,T=!1;if(typeof h=="string"&&b&&(_=h,l2))try{let U=new URL(window.location.href),ee=h.startsWith("//")?new URL(U.protocol+h):new URL(h),W=es(ee.pathname,w);ee.origin===U.origin&&W!=null?h=W+ee.search+ee.hash:T=!0}catch{dn(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=o3(h,{relative:s}),[E,j,F]=G3(n,y),R=J3(h,{replace:o,state:f,target:m,preventScrollReset:x,relative:s,viewTransition:g});function A(U){t&&t(U),U.defaultPrevented||R(U)}let P=C.createElement("a",{...y,...F,href:_||N,onClick:T||l?t:A,ref:q3(S,j),target:m,"data-discover":!b&&r==="render"?"true":void 0});return E&&!b?C.createElement(C.Fragment,null,P,C.createElement(X3,{page:N})):P});ma.displayName="Link";var K3=C.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:s=!1,style:l,to:o,viewTransition:f,children:m,...h},x){let g=No(o,{relative:h.relative}),y=as(),S=C.useContext(Ou),{navigator:w,basename:b}=C.useContext(mn),_=S!=null&&nN(g)&&f===!0,T=w.encodeLocation?w.encodeLocation(g).pathname:g.pathname,N=y.pathname,E=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;r||(N=N.toLowerCase(),E=E?E.toLowerCase():null,T=T.toLowerCase()),E&&b&&(E=es(E,b)||E);const j=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let F=N===T||!s&&N.startsWith(T)&&N.charAt(j)==="/",R=E!=null&&(E===T||!s&&E.startsWith(T)&&E.charAt(T.length)==="/"),A={isActive:F,isPending:R,isTransitioning:_},P=F?t:void 0,U;typeof n=="function"?U=n(A):U=[n,F?"active":null,R?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let ee=typeof l=="function"?l(A):l;return C.createElement(ma,{...h,"aria-current":P,className:U,ref:x,style:ee,to:o,viewTransition:f},typeof m=="function"?m(A):m)});K3.displayName="NavLink";var Z3=C.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:s,state:l,method:o=lu,action:f,onSubmit:m,relative:h,preventScrollReset:x,viewTransition:g,...y},S)=>{let w=rN(),b=aN(f,{relative:h}),_=o.toLowerCase()==="get"?"get":"post",T=typeof f=="string"&&c2.test(f),N=E=>{if(m&&m(E),E.defaultPrevented)return;E.preventDefault();let j=E.nativeEvent.submitter,F=(j==null?void 0:j.getAttribute("formmethod"))||o;w(j||E.currentTarget,{fetcherKey:t,method:F,navigate:r,replace:s,state:l,relative:h,preventScrollReset:x,viewTransition:g})};return C.createElement("form",{ref:S,method:_,action:b,onSubmit:n?m:N,...y,"data-discover":!T&&e==="render"?"true":void 0})});Z3.displayName="Form";function Q3(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function o2(e){let t=C.useContext(Rl);return rr(t,Q3(e)),t}function J3(e,{target:t,replace:r,state:n,preventScrollReset:s,relative:l,viewTransition:o}={}){let f=ta(),m=as(),h=No(e,{relative:l});return C.useCallback(x=>{if(j3(x,t)){x.preventDefault();let g=r!==void 0?r:no(m)===no(h);f(e,{replace:g,state:n,preventScrollReset:s,relative:l,viewTransition:o})}},[m,f,h,r,n,t,e,s,l,o])}var eN=0,tN=()=>`__${String(++eN)}__`;function rN(){let{router:e}=o2("useSubmit"),{basename:t}=C.useContext(mn),r=w3();return C.useCallback(async(n,s={})=>{let{action:l,method:o,encType:f,formData:m,body:h}=D3(n,t);if(s.navigate===!1){let x=s.fetcherKey||tN();await e.fetch(x,r,s.action||l,{preventScrollReset:s.preventScrollReset,formData:m,body:h,formMethod:s.method||o,formEncType:s.encType||f,flushSync:s.flushSync})}else await e.navigate(s.action||l,{preventScrollReset:s.preventScrollReset,formData:m,body:h,formMethod:s.method||o,formEncType:s.encType||f,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[e,t,r])}function aN(e,{relative:t}={}){let{basename:r}=C.useContext(mn),n=C.useContext(xn);rr(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),l={...No(e||".",{relative:t})},o=as();if(e==null){l.search=o.search;let f=new URLSearchParams(l.search),m=f.getAll("index");if(m.some(x=>x==="")){f.delete("index"),m.filter(g=>g).forEach(g=>f.append("index",g));let x=f.toString();l.search=x?`?${x}`:""}}return(!e||e===".")&&s.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(l.pathname=l.pathname==="/"?r:Zn([r,l.pathname])),no(l)}function nN(e,t={}){let r=C.useContext(e2);rr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=o2("useViewTransitionState"),s=No(e,{relative:t.relative});if(!r.isTransitioning)return!1;let l=es(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=es(r.nextLocation.pathname,n)||r.nextLocation.pathname;return du(s.pathname,o)!=null||du(s.pathname,l)!=null}new TextEncoder;[...z3];function u2(e,t){return function(){return e.apply(t,arguments)}}const{toString:sN}=Object.prototype,{getPrototypeOf:ym}=Object,{iterator:Lu,toStringTag:f2}=Symbol,Bu=(e=>t=>{const r=sN.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),pn=e=>(e=e.toLowerCase(),t=>Bu(t)===e),Uu=e=>t=>typeof t===e,{isArray:Ol}=Array,so=Uu("undefined");function iN(e){return e!==null&&!so(e)&&e.constructor!==null&&!so(e.constructor)&&ga(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const d2=pn("ArrayBuffer");function lN(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&d2(e.buffer),t}const cN=Uu("string"),ga=Uu("function"),h2=Uu("number"),Iu=e=>e!==null&&typeof e=="object",oN=e=>e===!0||e===!1,ou=e=>{if(Bu(e)!=="object")return!1;const t=ym(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(f2 in e)&&!(Lu in e)},uN=pn("Date"),fN=pn("File"),dN=pn("Blob"),hN=pn("FileList"),mN=e=>Iu(e)&&ga(e.pipe),xN=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ga(e.append)&&((t=Bu(e))==="formdata"||t==="object"&&ga(e.toString)&&e.toString()==="[object FormData]"))},pN=pn("URLSearchParams"),[gN,vN,yN,wN]=["ReadableStream","Request","Response","Headers"].map(pn),bN=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Eo(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),Ol(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{const l=r?Object.getOwnPropertyNames(e):Object.keys(e),o=l.length;let f;for(n=0;n<o;n++)f=l[n],t.call(null,e[f],f,e)}}function m2(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const hi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,x2=e=>!so(e)&&e!==hi;function Ih(){const{caseless:e}=x2(this)&&this||{},t={},r=(n,s)=>{const l=e&&m2(t,s)||s;ou(t[l])&&ou(n)?t[l]=Ih(t[l],n):ou(n)?t[l]=Ih({},n):Ol(n)?t[l]=n.slice():t[l]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&Eo(arguments[n],r);return t}const _N=(e,t,r,{allOwnKeys:n}={})=>(Eo(t,(s,l)=>{r&&ga(s)?e[l]=u2(s,r):e[l]=s},{allOwnKeys:n}),e),SN=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),NN=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},EN=(e,t,r,n)=>{let s,l,o;const f={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),l=s.length;l-- >0;)o=s[l],(!n||n(o,e,t))&&!f[o]&&(t[o]=e[o],f[o]=!0);e=r!==!1&&ym(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},TN=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},kN=e=>{if(!e)return null;if(Ol(e))return e;let t=e.length;if(!h2(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},AN=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ym(Uint8Array)),CN=(e,t)=>{const n=(e&&e[Lu]).call(e);let s;for(;(s=n.next())&&!s.done;){const l=s.value;t.call(e,l[0],l[1])}},jN=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},FN=pn("HTMLFormElement"),RN=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),hv=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),DN=pn("RegExp"),p2=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Eo(r,(s,l)=>{let o;(o=t(s,l,e))!==!1&&(n[l]=o||s)}),Object.defineProperties(e,n)},ON=e=>{p2(e,(t,r)=>{if(ga(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ga(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},MN=(e,t)=>{const r={},n=s=>{s.forEach(l=>{r[l]=!0})};return Ol(e)?n(e):n(String(e).split(t)),r},LN=()=>{},BN=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function UN(e){return!!(e&&ga(e.append)&&e[f2]==="FormData"&&e[Lu])}const IN=e=>{const t=new Array(10),r=(n,s)=>{if(Iu(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[s]=n;const l=Ol(n)?[]:{};return Eo(n,(o,f)=>{const m=r(o,s+1);!so(m)&&(l[f]=m)}),t[s]=void 0,l}}return n};return r(e,0)},PN=pn("AsyncFunction"),zN=e=>e&&(Iu(e)||ga(e))&&ga(e.then)&&ga(e.catch),g2=((e,t)=>e?setImmediate:t?((r,n)=>(hi.addEventListener("message",({source:s,data:l})=>{s===hi&&l===r&&n.length&&n.shift()()},!1),s=>{n.push(s),hi.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ga(hi.postMessage)),HN=typeof queueMicrotask<"u"?queueMicrotask.bind(hi):typeof process<"u"&&process.nextTick||g2,VN=e=>e!=null&&ga(e[Lu]),be={isArray:Ol,isArrayBuffer:d2,isBuffer:iN,isFormData:xN,isArrayBufferView:lN,isString:cN,isNumber:h2,isBoolean:oN,isObject:Iu,isPlainObject:ou,isReadableStream:gN,isRequest:vN,isResponse:yN,isHeaders:wN,isUndefined:so,isDate:uN,isFile:fN,isBlob:dN,isRegExp:DN,isFunction:ga,isStream:mN,isURLSearchParams:pN,isTypedArray:AN,isFileList:hN,forEach:Eo,merge:Ih,extend:_N,trim:bN,stripBOM:SN,inherits:NN,toFlatObject:EN,kindOf:Bu,kindOfTest:pn,endsWith:TN,toArray:kN,forEachEntry:CN,matchAll:jN,isHTMLForm:FN,hasOwnProperty:hv,hasOwnProp:hv,reduceDescriptors:p2,freezeMethods:ON,toObjectSet:MN,toCamelCase:RN,noop:LN,toFiniteNumber:BN,findKey:m2,global:hi,isContextDefined:x2,isSpecCompliantForm:UN,toJSONObject:IN,isAsyncFn:PN,isThenable:zN,setImmediate:g2,asap:HN,isIterable:VN};function ft(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}be.inherits(ft,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:be.toJSONObject(this.config),code:this.code,status:this.status}}});const v2=ft.prototype,y2={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{y2[e]={value:e}});Object.defineProperties(ft,y2);Object.defineProperty(v2,"isAxiosError",{value:!0});ft.from=(e,t,r,n,s,l)=>{const o=Object.create(v2);return be.toFlatObject(e,o,function(m){return m!==Error.prototype},f=>f!=="isAxiosError"),ft.call(o,e.message,t,r,n,s),o.cause=e,o.name=e.name,l&&Object.assign(o,l),o};const GN=null;function Ph(e){return be.isPlainObject(e)||be.isArray(e)}function w2(e){return be.endsWith(e,"[]")?e.slice(0,-2):e}function mv(e,t,r){return e?e.concat(t).map(function(s,l){return s=w2(s),!r&&l?"["+s+"]":s}).join(r?".":""):t}function XN(e){return be.isArray(e)&&!e.some(Ph)}const $N=be.toFlatObject(be,{},null,function(t){return/^is[A-Z]/.test(t)});function Pu(e,t,r){if(!be.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=be.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,_){return!be.isUndefined(_[b])});const n=r.metaTokens,s=r.visitor||x,l=r.dots,o=r.indexes,m=(r.Blob||typeof Blob<"u"&&Blob)&&be.isSpecCompliantForm(t);if(!be.isFunction(s))throw new TypeError("visitor must be a function");function h(w){if(w===null)return"";if(be.isDate(w))return w.toISOString();if(!m&&be.isBlob(w))throw new ft("Blob is not supported. Use a Buffer instead.");return be.isArrayBuffer(w)||be.isTypedArray(w)?m&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function x(w,b,_){let T=w;if(w&&!_&&typeof w=="object"){if(be.endsWith(b,"{}"))b=n?b:b.slice(0,-2),w=JSON.stringify(w);else if(be.isArray(w)&&XN(w)||(be.isFileList(w)||be.endsWith(b,"[]"))&&(T=be.toArray(w)))return b=w2(b),T.forEach(function(E,j){!(be.isUndefined(E)||E===null)&&t.append(o===!0?mv([b],j,l):o===null?b:b+"[]",h(E))}),!1}return Ph(w)?!0:(t.append(mv(_,b,l),h(w)),!1)}const g=[],y=Object.assign($N,{defaultVisitor:x,convertValue:h,isVisitable:Ph});function S(w,b){if(!be.isUndefined(w)){if(g.indexOf(w)!==-1)throw Error("Circular reference detected in "+b.join("."));g.push(w),be.forEach(w,function(T,N){(!(be.isUndefined(T)||T===null)&&s.call(t,T,be.isString(N)?N.trim():N,b,y))===!0&&S(T,b?b.concat(N):[N])}),g.pop()}}if(!be.isObject(e))throw new TypeError("data must be an object");return S(e),t}function xv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function wm(e,t){this._pairs=[],e&&Pu(e,this,t)}const b2=wm.prototype;b2.append=function(t,r){this._pairs.push([t,r])};b2.toString=function(t){const r=t?function(n){return t.call(this,n,xv)}:xv;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function YN(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function _2(e,t,r){if(!t)return e;const n=r&&r.encode||YN;be.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let l;if(s?l=s(t,r):l=be.isURLSearchParams(t)?t.toString():new wm(t,r).toString(n),l){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class pv{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){be.forEach(this.handlers,function(n){n!==null&&t(n)})}}const S2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},qN=typeof URLSearchParams<"u"?URLSearchParams:wm,WN=typeof FormData<"u"?FormData:null,KN=typeof Blob<"u"?Blob:null,ZN={isBrowser:!0,classes:{URLSearchParams:qN,FormData:WN,Blob:KN},protocols:["http","https","file","blob","url","data"]},bm=typeof window<"u"&&typeof document<"u",zh=typeof navigator=="object"&&navigator||void 0,QN=bm&&(!zh||["ReactNative","NativeScript","NS"].indexOf(zh.product)<0),JN=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",eE=bm&&window.location.href||"http://localhost",tE=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:bm,hasStandardBrowserEnv:QN,hasStandardBrowserWebWorkerEnv:JN,navigator:zh,origin:eE},Symbol.toStringTag,{value:"Module"})),Kr={...tE,...ZN};function rE(e,t){return Pu(e,new Kr.classes.URLSearchParams,Object.assign({visitor:function(r,n,s,l){return Kr.isNode&&be.isBuffer(r)?(this.append(n,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function aE(e){return be.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function nE(e){const t={},r=Object.keys(e);let n;const s=r.length;let l;for(n=0;n<s;n++)l=r[n],t[l]=e[l];return t}function N2(e){function t(r,n,s,l){let o=r[l++];if(o==="__proto__")return!0;const f=Number.isFinite(+o),m=l>=r.length;return o=!o&&be.isArray(s)?s.length:o,m?(be.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!f):((!s[o]||!be.isObject(s[o]))&&(s[o]=[]),t(r,n,s[o],l)&&be.isArray(s[o])&&(s[o]=nE(s[o])),!f)}if(be.isFormData(e)&&be.isFunction(e.entries)){const r={};return be.forEachEntry(e,(n,s)=>{t(aE(n),s,r,0)}),r}return null}function sE(e,t,r){if(be.isString(e))try{return(t||JSON.parse)(e),be.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const To={transitional:S2,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,l=be.isObject(t);if(l&&be.isHTMLForm(t)&&(t=new FormData(t)),be.isFormData(t))return s?JSON.stringify(N2(t)):t;if(be.isArrayBuffer(t)||be.isBuffer(t)||be.isStream(t)||be.isFile(t)||be.isBlob(t)||be.isReadableStream(t))return t;if(be.isArrayBufferView(t))return t.buffer;if(be.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let f;if(l){if(n.indexOf("application/x-www-form-urlencoded")>-1)return rE(t,this.formSerializer).toString();if((f=be.isFileList(t))||n.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return Pu(f?{"files[]":t}:t,m&&new m,this.formSerializer)}}return l||s?(r.setContentType("application/json",!1),sE(t)):t}],transformResponse:[function(t){const r=this.transitional||To.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(be.isResponse(t)||be.isReadableStream(t))return t;if(t&&be.isString(t)&&(n&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(f){if(o)throw f.name==="SyntaxError"?ft.from(f,ft.ERR_BAD_RESPONSE,this,null,this.response):f}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Kr.classes.FormData,Blob:Kr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};be.forEach(["delete","get","head","post","put","patch"],e=>{To.headers[e]={}});const iE=be.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),lE=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!r||t[r]&&iE[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},gv=Symbol("internals");function zc(e){return e&&String(e).trim().toLowerCase()}function uu(e){return e===!1||e==null?e:be.isArray(e)?e.map(uu):String(e)}function cE(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const oE=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function yh(e,t,r,n,s){if(be.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!be.isString(t)){if(be.isString(n))return t.indexOf(n)!==-1;if(be.isRegExp(n))return n.test(t)}}function uE(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function fE(e,t){const r=be.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,l,o){return this[n].call(this,t,s,l,o)},configurable:!0})})}let va=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function l(f,m,h){const x=zc(m);if(!x)throw new Error("header name must be a non-empty string");const g=be.findKey(s,x);(!g||s[g]===void 0||h===!0||h===void 0&&s[g]!==!1)&&(s[g||m]=uu(f))}const o=(f,m)=>be.forEach(f,(h,x)=>l(h,x,m));if(be.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(be.isString(t)&&(t=t.trim())&&!oE(t))o(lE(t),r);else if(be.isObject(t)&&be.isIterable(t)){let f={},m,h;for(const x of t){if(!be.isArray(x))throw TypeError("Object iterator must return a key-value pair");f[h=x[0]]=(m=f[h])?be.isArray(m)?[...m,x[1]]:[m,x[1]]:x[1]}o(f,r)}else t!=null&&l(r,t,n);return this}get(t,r){if(t=zc(t),t){const n=be.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return cE(s);if(be.isFunction(r))return r.call(this,s,n);if(be.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=zc(t),t){const n=be.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||yh(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function l(o){if(o=zc(o),o){const f=be.findKey(n,o);f&&(!r||yh(n,n[f],f,r))&&(delete n[f],s=!0)}}return be.isArray(t)?t.forEach(l):l(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const l=r[n];(!t||yh(this,this[l],l,t,!0))&&(delete this[l],s=!0)}return s}normalize(t){const r=this,n={};return be.forEach(this,(s,l)=>{const o=be.findKey(n,l);if(o){r[o]=uu(s),delete r[l];return}const f=t?uE(l):String(l).trim();f!==l&&delete r[l],r[f]=uu(s),n[f]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return be.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&be.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[gv]=this[gv]={accessors:{}}).accessors,s=this.prototype;function l(o){const f=zc(o);n[f]||(fE(s,o),n[f]=!0)}return be.isArray(t)?t.forEach(l):l(t),this}};va.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);be.reduceDescriptors(va.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});be.freezeMethods(va);function wh(e,t){const r=this||To,n=t||r,s=va.from(n.headers);let l=n.data;return be.forEach(e,function(f){l=f.call(r,l,s.normalize(),t?t.status:void 0)}),s.normalize(),l}function E2(e){return!!(e&&e.__CANCEL__)}function Ml(e,t,r){ft.call(this,e??"canceled",ft.ERR_CANCELED,t,r),this.name="CanceledError"}be.inherits(Ml,ft,{__CANCEL__:!0});function T2(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new ft("Request failed with status code "+r.status,[ft.ERR_BAD_REQUEST,ft.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function dE(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function hE(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,l=0,o;return t=t!==void 0?t:1e3,function(m){const h=Date.now(),x=n[l];o||(o=h),r[s]=m,n[s]=h;let g=l,y=0;for(;g!==s;)y+=r[g++],g=g%e;if(s=(s+1)%e,s===l&&(l=(l+1)%e),h-o<t)return;const S=x&&h-x;return S?Math.round(y*1e3/S):void 0}}function mE(e,t){let r=0,n=1e3/t,s,l;const o=(h,x=Date.now())=>{r=x,s=null,l&&(clearTimeout(l),l=null),e.apply(null,h)};return[(...h)=>{const x=Date.now(),g=x-r;g>=n?o(h,x):(s=h,l||(l=setTimeout(()=>{l=null,o(s)},n-g)))},()=>s&&o(s)]}const hu=(e,t,r=3)=>{let n=0;const s=hE(50,250);return mE(l=>{const o=l.loaded,f=l.lengthComputable?l.total:void 0,m=o-n,h=s(m),x=o<=f;n=o;const g={loaded:o,total:f,progress:f?o/f:void 0,bytes:m,rate:h||void 0,estimated:h&&f&&x?(f-o)/h:void 0,event:l,lengthComputable:f!=null,[t?"download":"upload"]:!0};e(g)},r)},vv=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},yv=e=>(...t)=>be.asap(()=>e(...t)),xE=Kr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Kr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Kr.origin),Kr.navigator&&/(msie|trident)/i.test(Kr.navigator.userAgent)):()=>!0,pE=Kr.hasStandardBrowserEnv?{write(e,t,r,n,s,l){const o=[e+"="+encodeURIComponent(t)];be.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),be.isString(n)&&o.push("path="+n),be.isString(s)&&o.push("domain="+s),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function gE(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function vE(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function k2(e,t,r){let n=!gE(t);return e&&(n||r==!1)?vE(e,t):t}const wv=e=>e instanceof va?{...e}:e;function wi(e,t){t=t||{};const r={};function n(h,x,g,y){return be.isPlainObject(h)&&be.isPlainObject(x)?be.merge.call({caseless:y},h,x):be.isPlainObject(x)?be.merge({},x):be.isArray(x)?x.slice():x}function s(h,x,g,y){if(be.isUndefined(x)){if(!be.isUndefined(h))return n(void 0,h,g,y)}else return n(h,x,g,y)}function l(h,x){if(!be.isUndefined(x))return n(void 0,x)}function o(h,x){if(be.isUndefined(x)){if(!be.isUndefined(h))return n(void 0,h)}else return n(void 0,x)}function f(h,x,g){if(g in t)return n(h,x);if(g in e)return n(void 0,h)}const m={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:f,headers:(h,x,g)=>s(wv(h),wv(x),g,!0)};return be.forEach(Object.keys(Object.assign({},e,t)),function(x){const g=m[x]||s,y=g(e[x],t[x],x);be.isUndefined(y)&&g!==f||(r[x]=y)}),r}const A2=e=>{const t=wi({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:l,headers:o,auth:f}=t;t.headers=o=va.from(o),t.url=_2(k2(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),f&&o.set("Authorization","Basic "+btoa((f.username||"")+":"+(f.password?unescape(encodeURIComponent(f.password)):"")));let m;if(be.isFormData(r)){if(Kr.hasStandardBrowserEnv||Kr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((m=o.getContentType())!==!1){const[h,...x]=m?m.split(";").map(g=>g.trim()).filter(Boolean):[];o.setContentType([h||"multipart/form-data",...x].join("; "))}}if(Kr.hasStandardBrowserEnv&&(n&&be.isFunction(n)&&(n=n(t)),n||n!==!1&&xE(t.url))){const h=s&&l&&pE.read(l);h&&o.set(s,h)}return t},yE=typeof XMLHttpRequest<"u",wE=yE&&function(e){return new Promise(function(r,n){const s=A2(e);let l=s.data;const o=va.from(s.headers).normalize();let{responseType:f,onUploadProgress:m,onDownloadProgress:h}=s,x,g,y,S,w;function b(){S&&S(),w&&w(),s.cancelToken&&s.cancelToken.unsubscribe(x),s.signal&&s.signal.removeEventListener("abort",x)}let _=new XMLHttpRequest;_.open(s.method.toUpperCase(),s.url,!0),_.timeout=s.timeout;function T(){if(!_)return;const E=va.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),F={data:!f||f==="text"||f==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:E,config:e,request:_};T2(function(A){r(A),b()},function(A){n(A),b()},F),_=null}"onloadend"in _?_.onloadend=T:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(T)},_.onabort=function(){_&&(n(new ft("Request aborted",ft.ECONNABORTED,e,_)),_=null)},_.onerror=function(){n(new ft("Network Error",ft.ERR_NETWORK,e,_)),_=null},_.ontimeout=function(){let j=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const F=s.transitional||S2;s.timeoutErrorMessage&&(j=s.timeoutErrorMessage),n(new ft(j,F.clarifyTimeoutError?ft.ETIMEDOUT:ft.ECONNABORTED,e,_)),_=null},l===void 0&&o.setContentType(null),"setRequestHeader"in _&&be.forEach(o.toJSON(),function(j,F){_.setRequestHeader(F,j)}),be.isUndefined(s.withCredentials)||(_.withCredentials=!!s.withCredentials),f&&f!=="json"&&(_.responseType=s.responseType),h&&([y,w]=hu(h,!0),_.addEventListener("progress",y)),m&&_.upload&&([g,S]=hu(m),_.upload.addEventListener("progress",g),_.upload.addEventListener("loadend",S)),(s.cancelToken||s.signal)&&(x=E=>{_&&(n(!E||E.type?new Ml(null,e,_):E),_.abort(),_=null)},s.cancelToken&&s.cancelToken.subscribe(x),s.signal&&(s.signal.aborted?x():s.signal.addEventListener("abort",x)));const N=dE(s.url);if(N&&Kr.protocols.indexOf(N)===-1){n(new ft("Unsupported protocol "+N+":",ft.ERR_BAD_REQUEST,e));return}_.send(l||null)})},bE=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const l=function(h){if(!s){s=!0,f();const x=h instanceof Error?h:this.reason;n.abort(x instanceof ft?x:new Ml(x instanceof Error?x.message:x))}};let o=t&&setTimeout(()=>{o=null,l(new ft(`timeout ${t} of ms exceeded`,ft.ETIMEDOUT))},t);const f=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(l):h.removeEventListener("abort",l)}),e=null)};e.forEach(h=>h.addEventListener("abort",l));const{signal:m}=n;return m.unsubscribe=()=>be.asap(f),m}},_E=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},SE=async function*(e,t){for await(const r of NE(e))yield*_E(r,t)},NE=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},bv=(e,t,r,n)=>{const s=SE(e,t);let l=0,o,f=m=>{o||(o=!0,n&&n(m))};return new ReadableStream({async pull(m){try{const{done:h,value:x}=await s.next();if(h){f(),m.close();return}let g=x.byteLength;if(r){let y=l+=g;r(y)}m.enqueue(new Uint8Array(x))}catch(h){throw f(h),h}},cancel(m){return f(m),s.return()}},{highWaterMark:2})},zu=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",C2=zu&&typeof ReadableStream=="function",EE=zu&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),j2=(e,...t)=>{try{return!!e(...t)}catch{return!1}},TE=C2&&j2(()=>{let e=!1;const t=new Request(Kr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),_v=64*1024,Hh=C2&&j2(()=>be.isReadableStream(new Response("").body)),mu={stream:Hh&&(e=>e.body)};zu&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!mu[t]&&(mu[t]=be.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new ft(`Response type '${t}' is not supported`,ft.ERR_NOT_SUPPORT,n)})})})(new Response);const kE=async e=>{if(e==null)return 0;if(be.isBlob(e))return e.size;if(be.isSpecCompliantForm(e))return(await new Request(Kr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(be.isArrayBufferView(e)||be.isArrayBuffer(e))return e.byteLength;if(be.isURLSearchParams(e)&&(e=e+""),be.isString(e))return(await EE(e)).byteLength},AE=async(e,t)=>{const r=be.toFiniteNumber(e.getContentLength());return r??kE(t)},CE=zu&&(async e=>{let{url:t,method:r,data:n,signal:s,cancelToken:l,timeout:o,onDownloadProgress:f,onUploadProgress:m,responseType:h,headers:x,withCredentials:g="same-origin",fetchOptions:y}=A2(e);h=h?(h+"").toLowerCase():"text";let S=bE([s,l&&l.toAbortSignal()],o),w;const b=S&&S.unsubscribe&&(()=>{S.unsubscribe()});let _;try{if(m&&TE&&r!=="get"&&r!=="head"&&(_=await AE(x,n))!==0){let F=new Request(t,{method:"POST",body:n,duplex:"half"}),R;if(be.isFormData(n)&&(R=F.headers.get("content-type"))&&x.setContentType(R),F.body){const[A,P]=vv(_,hu(yv(m)));n=bv(F.body,_v,A,P)}}be.isString(g)||(g=g?"include":"omit");const T="credentials"in Request.prototype;w=new Request(t,{...y,signal:S,method:r.toUpperCase(),headers:x.normalize().toJSON(),body:n,duplex:"half",credentials:T?g:void 0});let N=await fetch(w);const E=Hh&&(h==="stream"||h==="response");if(Hh&&(f||E&&b)){const F={};["status","statusText","headers"].forEach(U=>{F[U]=N[U]});const R=be.toFiniteNumber(N.headers.get("content-length")),[A,P]=f&&vv(R,hu(yv(f),!0))||[];N=new Response(bv(N.body,_v,A,()=>{P&&P(),b&&b()}),F)}h=h||"text";let j=await mu[be.findKey(mu,h)||"text"](N,e);return!E&&b&&b(),await new Promise((F,R)=>{T2(F,R,{data:j,headers:va.from(N.headers),status:N.status,statusText:N.statusText,config:e,request:w})})}catch(T){throw b&&b(),T&&T.name==="TypeError"&&/Load failed|fetch/i.test(T.message)?Object.assign(new ft("Network Error",ft.ERR_NETWORK,e,w),{cause:T.cause||T}):ft.from(T,T&&T.code,e,w)}}),Vh={http:GN,xhr:wE,fetch:CE};be.forEach(Vh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Sv=e=>`- ${e}`,jE=e=>be.isFunction(e)||e===null||e===!1,F2={getAdapter:e=>{e=be.isArray(e)?e:[e];const{length:t}=e;let r,n;const s={};for(let l=0;l<t;l++){r=e[l];let o;if(n=r,!jE(r)&&(n=Vh[(o=String(r)).toLowerCase()],n===void 0))throw new ft(`Unknown adapter '${o}'`);if(n)break;s[o||"#"+l]=n}if(!n){const l=Object.entries(s).map(([f,m])=>`adapter ${f} `+(m===!1?"is not supported by the environment":"is not available in the build"));let o=t?l.length>1?`since :
`+l.map(Sv).join(`
`):" "+Sv(l[0]):"as no adapter specified";throw new ft("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Vh};function bh(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ml(null,e)}function Nv(e){return bh(e),e.headers=va.from(e.headers),e.data=wh.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),F2.getAdapter(e.adapter||To.adapter)(e).then(function(n){return bh(e),n.data=wh.call(e,e.transformResponse,n),n.headers=va.from(n.headers),n},function(n){return E2(n)||(bh(e),n&&n.response&&(n.response.data=wh.call(e,e.transformResponse,n.response),n.response.headers=va.from(n.response.headers))),Promise.reject(n)})}const R2="1.9.0",Hu={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Hu[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Ev={};Hu.transitional=function(t,r,n){function s(l,o){return"[Axios v"+R2+"] Transitional option '"+l+"'"+o+(n?". "+n:"")}return(l,o,f)=>{if(t===!1)throw new ft(s(o," has been removed"+(r?" in "+r:"")),ft.ERR_DEPRECATED);return r&&!Ev[o]&&(Ev[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,o,f):!0}};Hu.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function FE(e,t,r){if(typeof e!="object")throw new ft("options must be an object",ft.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const l=n[s],o=t[l];if(o){const f=e[l],m=f===void 0||o(f,l,e);if(m!==!0)throw new ft("option "+l+" must be "+m,ft.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ft("Unknown option "+l,ft.ERR_BAD_OPTION)}}const fu={assertOptions:FE,validators:Hu},Sn=fu.validators;let mi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new pv,response:new pv}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const l=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?l&&!String(n.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+l):n.stack=l}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=wi(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:l}=r;n!==void 0&&fu.assertOptions(n,{silentJSONParsing:Sn.transitional(Sn.boolean),forcedJSONParsing:Sn.transitional(Sn.boolean),clarifyTimeoutError:Sn.transitional(Sn.boolean)},!1),s!=null&&(be.isFunction(s)?r.paramsSerializer={serialize:s}:fu.assertOptions(s,{encode:Sn.function,serialize:Sn.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),fu.assertOptions(r,{baseUrl:Sn.spelling("baseURL"),withXsrfToken:Sn.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=l&&be.merge(l.common,l[r.method]);l&&be.forEach(["delete","get","head","post","put","patch","common"],w=>{delete l[w]}),r.headers=va.concat(o,l);const f=[];let m=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(r)===!1||(m=m&&b.synchronous,f.unshift(b.fulfilled,b.rejected))});const h=[];this.interceptors.response.forEach(function(b){h.push(b.fulfilled,b.rejected)});let x,g=0,y;if(!m){const w=[Nv.bind(this),void 0];for(w.unshift.apply(w,f),w.push.apply(w,h),y=w.length,x=Promise.resolve(r);g<y;)x=x.then(w[g++],w[g++]);return x}y=f.length;let S=r;for(g=0;g<y;){const w=f[g++],b=f[g++];try{S=w(S)}catch(_){b.call(this,_);break}}try{x=Nv.call(this,S)}catch(w){return Promise.reject(w)}for(g=0,y=h.length;g<y;)x=x.then(h[g++],h[g++]);return x}getUri(t){t=wi(this.defaults,t);const r=k2(t.baseURL,t.url,t.allowAbsoluteUrls);return _2(r,t.params,t.paramsSerializer)}};be.forEach(["delete","get","head","options"],function(t){mi.prototype[t]=function(r,n){return this.request(wi(n||{},{method:t,url:r,data:(n||{}).data}))}});be.forEach(["post","put","patch"],function(t){function r(n){return function(l,o,f){return this.request(wi(f||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}mi.prototype[t]=r(),mi.prototype[t+"Form"]=r(!0)});let RE=class D2{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const n=this;this.promise.then(s=>{if(!n._listeners)return;let l=n._listeners.length;for(;l-- >0;)n._listeners[l](s);n._listeners=null}),this.promise.then=s=>{let l;const o=new Promise(f=>{n.subscribe(f),l=f}).then(s);return o.cancel=function(){n.unsubscribe(l)},o},t(function(l,o,f){n.reason||(n.reason=new Ml(l,o,f),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new D2(function(s){t=s}),cancel:t}}};function DE(e){return function(r){return e.apply(null,r)}}function OE(e){return be.isObject(e)&&e.isAxiosError===!0}const Gh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Gh).forEach(([e,t])=>{Gh[t]=e});function O2(e){const t=new mi(e),r=u2(mi.prototype.request,t);return be.extend(r,mi.prototype,t,{allOwnKeys:!0}),be.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return O2(wi(e,s))},r}const Ve=O2(To);Ve.Axios=mi;Ve.CanceledError=Ml;Ve.CancelToken=RE;Ve.isCancel=E2;Ve.VERSION=R2;Ve.toFormData=Pu;Ve.AxiosError=ft;Ve.Cancel=Ve.CanceledError;Ve.all=function(t){return Promise.all(t)};Ve.spread=DE;Ve.isAxiosError=OE;Ve.mergeConfig=wi;Ve.AxiosHeaders=va;Ve.formToJSON=e=>N2(be.isHTMLForm(e)?new FormData(e):e);Ve.getAdapter=F2.getAdapter;Ve.HttpStatusCode=Gh;Ve.default=Ve;const{Axios:R9,AxiosError:D9,CanceledError:O9,isCancel:M9,CancelToken:L9,VERSION:B9,all:U9,Cancel:I9,isAxiosError:P9,spread:z9,toFormData:H9,AxiosHeaders:V9,HttpStatusCode:G9,formToJSON:X9,getAdapter:$9,mergeConfig:Y9}=Ve,kt="https://time-tracker-medical-backend-production.up.railway.app";class ME{constructor(){uh(this,"TOKEN_KEY","auth_token");uh(this,"USER_KEY","auth_user")}async login(t,r){try{const n=await Ve.post(`${kt}/auth/login`,{email:t,password:r});return localStorage.setItem(this.TOKEN_KEY,n.data.access_token),localStorage.setItem(this.USER_KEY,JSON.stringify(n.data.user)),Ve.defaults.headers.common.Authorization=`Bearer ${n.data.access_token}`,n.data}catch(n){throw console.error("Login failed:",n),n}}logout(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_KEY),delete Ve.defaults.headers.common.Authorization}getCurrentUser(){const t=localStorage.getItem(this.USER_KEY);if(!t)return null;try{return JSON.parse(t)}catch{return null}}getUserRole(){const t=this.getCurrentUser();return(t==null?void 0:t.role)||null}isAdmin(){const t=this.getUserRole();return t==="admin"||t==="admin"}isNurse(){return this.getUserRole()==="nurse"}isPharmacist(){return this.getUserRole()==="pharmacist"}getToken(){return localStorage.getItem(this.TOKEN_KEY)}isAuthenticated(){return!!this.getToken()}initializeAuth(){const t=this.getToken();t&&(Ve.defaults.headers.common.Authorization=`Bearer ${t}`)}}const ka=new ME;ka.initializeAuth();Ve.interceptors.request.use(e=>{const t=ka.getToken();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ve.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=await Ve.post("undefined/auth/refresh"),{access_token:s}=n.data;return localStorage.setItem("auth_token",s),Ve.defaults.headers.common.Authorization=`Bearer ${s}`,t.headers.Authorization=`Bearer ${s}`,Ve(t)}catch(n){return window.location.pathname.includes("/login")||(ka.logout(),window.location.replace("/login")),Promise.reject(n)}}return Promise.reject(e)});const M2=C.createContext(void 0),LE=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState(!0),l=ta();C.useEffect(()=>{(async()=>{try{const h=ka.getCurrentUser();h&&r(h)}catch(h){console.error("Error initializing auth:",h)}finally{s(!1)}})()},[]);const o=async(m,h)=>{try{const x=await ka.login(m,h);r(x.user)}catch(x){throw x}},f=()=>{s(!0);try{ka.logout(),r(null),l("/login")}finally{s(!1)}};return u.jsx(M2.Provider,{value:{user:t,isAuthenticated:!!t,isAdmin:ka.isAdmin(),isNurse:ka.isNurse(),isPharmacist:ka.isPharmacist(),isLoading:n,login:o,logout:f},children:e})},Pr=()=>{const e=C.useContext(M2);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};function BE(){const e=ta(),{login:t}=Pr(),[r,n]=C.useState({email:"",password:"",rememberMe:!1}),[s,l]=C.useState({}),[o,f]=C.useState(!1),[m,h]=C.useState(""),[x,g]=C.useState(!1),y=b=>{const{name:_,value:T,type:N,checked:E}=b.target;n({...r,[_]:N==="checkbox"?E:T}),s[_]&&l({...s,[_]:void 0})},S=()=>{const b={};return r.email?/\S+@\S+\.\S+/.test(r.email)||(b.email="Email is invalid"):b.email="Email is required",r.password||(b.password="Password is required"),l(b),Object.keys(b).length===0},w=async b=>{var _,T,N,E,j,F;if(b.preventDefault(),!(!S()||o)){f(!0),h("");try{await t(r.email,r.password),e("/")}catch(R){if(console.error("Login failed:",R),((_=R.response)==null?void 0:_.status)===401){const A=((E=(N=(T=R.response)==null?void 0:T.data)==null?void 0:N.message)==null?void 0:E.toLowerCase())||"";A.includes("user not found")||A.includes("no account")||A.includes("email")?(n({email:"",password:"",rememberMe:r.rememberMe}),h("No account found with this email address. Please check your email or sign up.")):(n(P=>({...P,password:""})),h("Incorrect password. Please try again."))}else(F=(j=R.response)==null?void 0:j.data)!=null&&F.message?h(R.response.data.message):h("Unable to sign in. Please try again later.")}finally{f(!1)}}};return u.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 flex items-center justify-center",children:u.jsx("div",{className:"container mx-auto px-4 py-8 max-w-md",children:u.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-lg",children:[u.jsxs("div",{className:"flex flex-col items-center mb-8",children:[u.jsx("img",{src:"/logo.png",alt:"MediTrack Time Logo",className:"w-32 h-32 object-contain mb-6"}),u.jsxs("div",{className:"text-center",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Welcome Back"}),u.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Sign in to your account to continue"})]})]}),u.jsxs("form",{className:"space-y-6",onSubmit:w,children:[m&&u.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),m]})}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),u.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:r.email,onChange:y,className:`block w-full pl-3 pr-3 py-2 border rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${s.email?"border-red-300":"border-gray-300"}`,placeholder:"name@example.com"}),s.email&&u.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.email})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{id:"password",name:"password",type:x?"text":"password",autoComplete:"current-password",required:!0,value:r.password,onChange:y,className:`block w-full pl-3 pr-10 py-2 border rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${s.password?"border-red-300":"border-gray-300"}`,placeholder:""}),u.jsx("button",{type:"button",onClick:()=>g(!x),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 focus:outline-none",children:x?u.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):u.jsxs("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),s.password&&u.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.password})]})]}),!1,u.jsx("div",{children:u.jsx("button",{type:"submit",disabled:o,className:"w-full flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-70 transition-colors",children:o?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})})]})]})})})}/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),IE=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),Tv=e=>{const t=IE(e);return t.charAt(0).toUpperCase()+t.slice(1)},L2=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),PE=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=C.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:l,iconNode:o,...f},m)=>C.createElement("svg",{ref:m,...zE,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:L2("lucide",s),...!l&&!PE(f)&&{"aria-hidden":"true"},...f},[...o.map(([h,x])=>C.createElement(h,x)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=(e,t)=>{const r=C.forwardRef(({className:n,...s},l)=>C.createElement(HE,{ref:l,iconNode:t,className:L2(`lucide-${UE(Tv(e))}`,`lucide-${e}`,n),...s}));return r.displayName=Tv(e),r};/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Xh=Rt("activity",VE);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Kt=Rt("arrow-down",GE);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Zt=Rt("arrow-up",XE);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],bi=Rt("building-2",$E);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],qE=Rt("building",YE);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ia=Rt("chevron-down",WE);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Wc=Rt("chevron-left",KE);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],_m=Rt("chevron-right",ZE);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],$h=Rt("clipboard-check",QE);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],io=Rt("clock",JE);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eT=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Yh=Rt("file-text",eT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tT=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],kv=Rt("heart",tT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rT=[["path",{d:"M12 6v4",key:"16clxf"}],["path",{d:"M14 14h-4",key:"esezmu"}],["path",{d:"M14 18h-4",key:"16mqa2"}],["path",{d:"M14 8h-4",key:"z8ypaz"}],["path",{d:"M18 12h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2h2",key:"b1k337"}],["path",{d:"M18 22V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v18",key:"16g51d"}]],aT=Rt("hospital",rT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nT=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],Av=Rt("log-out",nT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sT=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],iT=Rt("menu",sT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Ll=Rt("pencil",lT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cT=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Cv=Rt("pill",cT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],hn=Rt("plus",oT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uT=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],B2=Rt("save",uT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fT=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ts=Rt("search",fT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dT=[["path",{d:"M18 21a6 6 0 0 0-12 0",key:"kaz2du"}],["circle",{cx:"12",cy:"11",r:"4",key:"1gt34v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],hT=Rt("square-user-round",dT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mT=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],xT=Rt("syringe",mT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pT=[["path",{d:"M10 2h4",key:"n1abiw"}],["path",{d:"M4.6 11a8 8 0 0 0 1.7 8.7 8 8 0 0 0 8.7 1.7",key:"10he05"}],["path",{d:"M7.4 7.4a8 8 0 0 1 10.3 1 8 8 0 0 1 .9 10.2",key:"15f7sh"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M12 12v-2",key:"fwoke6"}]],gT=Rt("timer-off",pT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vT=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],yT=Rt("timer",vT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wT=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],bT=Rt("trash-2",wT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _T=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],ko=Rt("trash",_T);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ST=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],U2=Rt("triangle-alert",ST);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NT=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],jv=Rt("user-check",NT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],lo=Rt("user",ET);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TT=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],xu=Rt("users",TT);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kT=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ja=Rt("x",kT),I2=async e=>{try{return(await Ve.post(`${kt}/medical-records`,e)).data}catch(t){throw console.error("Error creating medical record:",t),t}},Sm=async e=>{try{return(await Ve.get(`${kt}/medical-records/patient/${e}`)).data}catch(t){throw console.error(`Error fetching medical records for patient with ID ${e}:`,t),t}},Fv=async e=>{try{return(await Ve.get(`${kt}/medical-records/patient/${e}/latest`)).data}catch(t){throw console.error(`Error fetching latest medical record for patient with ID ${e}:`,t),t}},AT=e=>["medical_records","bp_at_goal","hospital_visited_since_last_review","a1c_at_goal","use_benzo","use_antipsychotic","use_opioids","fall_since_last_visit"].some(r=>r in e),Ao=async()=>{try{return(await Ve.get(`${kt}/patients`)).data}catch(e){throw console.error("Error fetching patients:",e),e}},P2=async e=>{try{return(await Ve.get(`${kt}/patients/${e}`)).data}catch(t){throw console.error(`Error fetching patient with ID ${e}:`,t),t}},CT=async e=>{try{return(await Ve.get(`${kt}/patients/site/${e}`)).data}catch(t){throw console.error(`Error fetching patients for site ID ${e}:`,t),t}},Rv=async e=>{try{return(await Ve.get(`${kt}/patients/site/${e}`)).data}catch(t){throw console.error(`Error fetching patients for site ${e}:`,t),t}},jT=async e=>{try{return(await Ve.post(`${kt}/patients`,e)).data}catch(t){throw console.error("Error creating patient:",t),t}},z2=async(e,t)=>{try{const r={first_name:t.first_name,last_name:t.last_name,birthdate:t.birthdate,gender:t.gender,phone_number:t.phone_number,contact_name:t.contact_name,contact_phone_number:t.contact_phone_number,insurance:t.insurance,is_active:t.is_active,site_name:t.site_name,building:t.building,notes:t.notes};Object.keys(r).forEach(s=>{r[s]===void 0&&delete r[s]}),console.log("Sending update data to API:",r);const n=await Ve.put(`${kt}/patients/${e}`,r);return console.log("API response:",n.data),AT(t)&&await I2({patientId:typeof e=="string"?parseInt(e):e,medical_records:t.medical_records??!1,bpAtGoal:t.bp_at_goal??!1,hospitalVisitSinceLastReview:t.hospital_visited_since_last_review??!1,a1cAtGoal:t.a1c_at_goal??!1,benzodiazepines:t.use_benzo??!1,antipsychotics:t.use_antipsychotic??!1,opioids:t.use_opioids??!1,fallSinceLastVisit:t.fall_since_last_visit??!1}),n.data}catch(r){throw console.error(`Error updating patient with ID ${e}:`,r),r}},FT=async e=>{try{await Ve.delete(`${kt}/patients/${e}`)}catch(t){throw console.error(`Error deleting patient with ID ${e}:`,t),t}},RT=async e=>(await Ve.post(`${kt}/sites`,e)).data,Gs=async()=>(await Ve.get(`${kt}/sites`)).data,DT=async e=>{try{return(await Ve.get(`${kt}/sites/${e}`)).data}catch(t){throw console.error("Error fetching site:",t),t}},OT=async(e,t)=>{try{return(await Ve.put(`${kt}/sites/${e}`,t)).data}catch(r){throw console.error("Error updating site:",r),r}},MT=async e=>{try{await Ve.delete(`${kt}/sites/${e}`)}catch(t){throw console.error("Error deleting site:",t),t}},Nm=async()=>{try{return(await Ve.get(`${kt}/sites/sites-and-buildings`)).data}catch(e){throw console.error("Error fetching sites and buildings:",e),e}},H2=async()=>{try{return(await Ve.get(`${kt}/sites/admin/all`)).data}catch(e){throw console.error("Error fetching all sites for admin:",e),e}},Vu=async e=>(await Ve.get(`${kt}/buildings/site/${e}`)).data,LT=async e=>(await Ve.post(`${kt}/buildings`,e)).data,BT=async(e,t)=>(await Ve.put(`${kt}/buildings/${e}`,t)).data,UT=async e=>{await Ve.delete(`${kt}/buildings/${e}`)},V2=({isOpen:e,onClose:t,onPatientAdded:r,defaultSite:n,defaultSiteId:s})=>{const l={firstName:"",lastName:"",dateOfBirth:"",gender:"M",site_name:n||"",building:"",insurance:"",notes:""},[o,f]=C.useState(l),[m,h]=C.useState(!1),[x,g]=C.useState(null),[y,S]=C.useState([]),[w,b]=C.useState([]),[_,T]=C.useState(!1),[N,E]=C.useState(!1),j=C.useRef(e);C.useEffect(()=>{j.current&&!e&&(f({firstName:"",lastName:"",dateOfBirth:"",gender:"M",site_name:n||"",building:"",insurance:"",notes:""}),g(null),h(!1),S([]),b([])),e&&!j.current&&F(),j.current=e},[e,n,s]);const F=async()=>{T(!0);try{const P=await Gs();if(S(P.filter(U=>U.is_active)),n)f(U=>({...U,site_name:n}));else if(s){const U=P.find(ee=>ee.id===s);U&&f(ee=>({...ee,site_name:U.name}))}}catch(P){console.error("Error fetching sites:",P),g("Failed to load sites. Please try again.")}finally{T(!1)}};C.useEffect(()=>{(async()=>{if(o.site_name){E(!0);try{const U=y.find(ee=>ee.name===o.site_name);if(U){const ee=await Vu(U.id);b(ee.filter(W=>W.is_active))}}catch(U){console.error("Error fetching buildings:",U)}finally{E(!1)}}})()},[o.site_name,y]),C.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]);const R=async P=>{P.preventDefault(),h(!0),g(null);try{const U={first_name:o.firstName,last_name:o.lastName,birthdate:o.dateOfBirth,gender:o.gender,site_name:o.site_name,building:o.building||void 0,insurance:o.insurance,is_active:!0,notes:o.notes};await jT(U),r&&r(),t()}catch(U){console.error("Failed to create patient:",U),g("Failed to create patient. Please try again.")}finally{h(!1)}},A=P=>{const{name:U,value:ee}=P.target;f(W=>{const J={...W,[U]:ee};return U==="site_name"&&(J.building=""),J})};return e?u.jsx("div",{className:"fixed inset-0 backdrop-blur-[2px] bg-gray-500/30 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-4 sm:p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Patient"}),u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Add a new patient record to the system"})]}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500 transition-colors cursor-pointer",children:u.jsx(Ja,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:R,className:"space-y-4",children:[x&&u.jsx("div",{className:"p-3 rounded-lg bg-red-50 border border-red-200",children:u.jsx("p",{className:"text-sm text-red-600",children:x})}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"First Name"}),u.jsx("input",{type:"text",name:"firstName",value:o.firstName,onChange:A,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0,placeholder:"John"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),u.jsx("input",{type:"text",name:"lastName",value:o.lastName,onChange:A,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0,placeholder:"Doe"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),u.jsx("input",{type:"date",name:"dateOfBirth",value:o.dateOfBirth,onChange:A,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200 cursor-pointer appearance-none",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Gender"}),u.jsxs("select",{name:"gender",value:o.gender,onChange:A,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200 cursor-pointer appearance-none",required:!0,children:[u.jsx("option",{value:"M",children:"Male"}),u.jsx("option",{value:"F",children:"Female"}),u.jsx("option",{value:"O",children:"Other"})]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Site"}),u.jsxs("select",{name:"site_name",value:o.site_name,onChange:A,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200 cursor-pointer appearance-none",required:!0,disabled:_,children:[u.jsx("option",{value:"",children:"Select a site"}),y.map(P=>u.jsx("option",{value:P.name,children:P.name},P.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Building"}),u.jsxs("select",{name:"building",value:o.building,onChange:A,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200 cursor-pointer appearance-none",required:!0,disabled:!o.site_name||N,children:[u.jsx("option",{value:"",children:"Select a building"}),w.map(P=>u.jsx("option",{value:P.name,children:P.name},P.id))]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Insurance"}),u.jsx("input",{type:"text",name:"insurance",value:o.insurance,onChange:A,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",placeholder:"Enter insurance information"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Notes"}),u.jsx("textarea",{name:"notes",value:o.notes,onChange:A,rows:3,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",placeholder:"Enter any relevant notes for the patient..."})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:t,disabled:m,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:m,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center min-w-[100px]",children:m?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Creating..."]}):"Create Patient"})]})]})]})})}):null};var G2={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Dv=Cn.createContext&&Cn.createContext(G2),IT=["attr","size","title"];function PT(e,t){if(e==null)return{};var r=zT(e,t),n,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)n=l[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function zT(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function pu(){return pu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pu.apply(this,arguments)}function Ov(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function gu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ov(Object(r),!0).forEach(function(n){HT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ov(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HT(e,t,r){return t=VT(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VT(e){var t=GT(e,"string");return typeof t=="symbol"?t:t+""}function GT(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X2(e){return e&&e.map((t,r)=>Cn.createElement(t.tag,gu({key:r},t.attr),X2(t.child)))}function Ci(e){return t=>Cn.createElement(XT,pu({attr:gu({},e.attr)},t),X2(e.child))}function XT(e){var t=r=>{var{attr:n,size:s,title:l}=e,o=PT(e,IT),f=s||r.size||"1em",m;return r.className&&(m=r.className),e.className&&(m=(m?m+" ":"")+e.className),Cn.createElement("svg",pu({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:m,style:gu(gu({color:e.color||r.color},r.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),l&&Cn.createElement("title",null,l),e.children)};return Dv!==void 0?Cn.createElement(Dv.Consumer,null,r=>t(r)):t(G2)}function Mv(e){return Ci({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function $T(e){return Ci({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(e)}function Lv(e){return Ci({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 492v20H0v-20c0-6.627 5.373-12 12-12h20V120c0-13.255 10.745-24 24-24h88V24c0-13.255 10.745-24 24-24h112c13.255 0 24 10.745 24 24v72h88c13.255 0 24 10.745 24 24v360h20c6.627 0 12 5.373 12 12zM308 192h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12zm-168 64h40c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12zm104 128h-40c-6.627 0-12 5.373-12 12v84h64v-84c0-6.627-5.373-12-12-12zm64-96h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12zm-116 12c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12v-40zM182 96h26v26a6 6 0 0 0 6 6h20a6 6 0 0 0 6-6V96h26a6 6 0 0 0 6-6V70a6 6 0 0 0-6-6h-26V38a6 6 0 0 0-6-6h-20a6 6 0 0 0-6 6v26h-26a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6z"},child:[]}]})(e)}function YT(e){return Ci({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"},child:[]}]})(e)}function Bv(e){return Ci({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"},child:[]}]})(e)}function qT(e){return Ci({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M312 320h136V56c0-13.3-10.7-24-24-24H24C10.7 32 0 42.7 0 56v400c0 13.3 10.7 24 24 24h264V344c0-13.2 10.8-24 24-24zm129 55l-98 98c-4.5 4.5-10.6 7-17 7h-6V352h128v6.1c0 6.3-2.5 12.4-7 16.9z"},child:[]}]})(e)}function WT(e){return Ci({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}const KT=e=>e?Object.values(e).some(t=>t===!0):!1,ZT=async()=>{try{return(await Ve.get(`${kt}/activities`)).data}catch(e){throw console.error("Error fetching activities:",e),e}},QT=async e=>{try{return(await Ve.get(`${kt}/activities/${e}`)).data}catch(t){throw console.error(`Error fetching activity with ID ${e}:`,t),t}},$2=async e=>{try{return(await Ve.get(`${kt}/activities/patient/${e}`)).data}catch(t){throw console.error(`Error fetching activities for patient ${e}:`,t),t}},Y2=async()=>{try{return await ZT()}catch(e){throw console.error("Error fetching activities with details:",e),e}},JT=async e=>{try{const t=KT(e.medical_checks),r={patient_id:e.patient_id,user_id:e.user_id,activity_type:e.activity_type,pharm_flag:t,notes:e.notes||"",site_name:e.site_name,building:e.building||"",service_datetime:e.service_datetime||new Date().toISOString(),service_endtime:e.service_endtime,duration_minutes:Math.max(.01,Number(e.duration_minutes.toFixed(2)))};console.log("Creating activity with data:",r),console.log("Raw input data:",e),console.log("Has medical checks:",t);const s=(await Ve.post(`${kt}/activities`,r)).data;if(t&&e.medical_checks)try{await I2({patientId:e.patient_id,medical_records:e.medical_checks.medical_records,bpAtGoal:e.medical_checks.bp_at_goal,hospitalVisitSinceLastReview:e.medical_checks.hospital_visit,a1cAtGoal:e.medical_checks.a1c_at_goal,benzodiazepines:e.medical_checks.benzodiazepines,antipsychotics:e.medical_checks.antipsychotics,opioids:e.medical_checks.opioids,fallSinceLastVisit:e.medical_checks.fall_since_last_visit}),await z2(e.patient_id,{medical_records:e.medical_checks.medical_records,bp_at_goal:e.medical_checks.bp_at_goal,hospital_visited_since_last_review:e.medical_checks.hospital_visit,a1c_at_goal:e.medical_checks.a1c_at_goal,use_benzo:e.medical_checks.benzodiazepines,use_antipsychotic:e.medical_checks.antipsychotics,use_opioids:e.medical_checks.opioids,fall_since_last_visit:e.medical_checks.fall_since_last_visit}),console.log("Medical record created and patient status updated for activity")}catch(l){console.error("Error creating medical record or updating patient status:",l)}return s}catch(t){throw console.error("Error creating activity:",t),t}},ek=async(e,t)=>{try{return(await Ve.put(`${kt}/activities/${e}`,t)).data}catch(r){throw console.error(`Error updating activity with ID ${e}:`,r),r}},tk=async e=>{try{await Ve.delete(`${kt}/activities/${e}`)}catch(t){throw console.error(`Error deleting activity with ID ${e}:`,t),t}},q2=async()=>{try{return["Assess medical/functional/psychosocial needs","Conduct risk assessment","Coordinate care with other service providers","Discuss & monitor patient condition","Manage care transition","Medications management oversight","Perform medication reconciliation","Provide chroniccondition education","Screen for preventive services","Other"]}catch(e){throw console.error("Error fetching activity types:",e),e}},rk=(e={})=>{const{warningTimeout:t=30*60*1e3,logoutTimeout:r=30*1e3,enabled:n=!0,activityTimeoutOverride:s=0}=e,l=s||t,{logout:o,isAuthenticated:f}=Pr(),[m,h]=C.useState(!1),[x,g]=C.useState(0),y=C.useRef(null),S=C.useRef(null),w=C.useRef(null),b=C.useCallback(()=>{console.log(" Clearing all timers"),y.current&&(clearTimeout(y.current),y.current=null),S.current&&(clearTimeout(S.current),S.current=null),w.current&&(clearInterval(w.current),w.current=null)},[]),_=C.useCallback(()=>{console.log(" Starting inactivity timers"),console.log(`   Warning in ${l}ms, logout in ${l+r}ms`),b(),h(!1),g(0),y.current=window.setTimeout(()=>{console.log(" Warning triggered - showing modal"),h(!0),g(Math.ceil(r/1e3)),w.current=window.setInterval(()=>{g(E=>{const j=E-1;return console.log(` Countdown: ${j}`),j<=0?(w.current&&(clearInterval(w.current),w.current=null),0):j})},1e3),S.current=window.setTimeout(()=>{console.log(" Auto logout triggered"),o(),h(!1),g(0)},r)},l)},[l,r,o,b]),T=C.useCallback(()=>{if(!n||!f){console.log(" Activity ignored - disabled or not authenticated");return}console.log(" User activity detected - resetting timers"),_()},[n,f,_]),N=C.useCallback(()=>{console.log(" Warning dismissed by user"),h(!1),g(0),b(),_()},[b,_]);return C.useEffect(()=>{if(!n||!f){console.log(" Inactivity logout disabled or user not authenticated"),b(),h(!1);return}console.log(" Setting up inactivity tracking");const E=["mousedown","mousemove","keydown","keypress","scroll","touchstart","click","wheel"];let j=null;const F=()=>{j||(T(),j=window.setTimeout(()=>{j=null},1e3))};return E.forEach(R=>{document.addEventListener(R,F,{passive:!0,capture:!0})}),T(),()=>{console.log(" Cleaning up inactivity tracking"),E.forEach(R=>{document.removeEventListener(R,F,{capture:!0})}),j&&clearTimeout(j),b()}},[n,f,T,b]),C.useEffect(()=>()=>{b()},[b]),{showWarning:m,warningCountdown:x,dismissWarning:N}},ak=({isOpen:e,countdown:t,onStayLoggedIn:r,onLogoutNow:n})=>e?u.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:u.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[u.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"}),u.jsxs("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[u.jsx("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:u.jsxs("div",{className:"sm:flex sm:items-start",children:[u.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-yellow-100 sm:mx-0 sm:h-10 sm:w-10",children:u.jsx(U2,{className:"h-6 w-6 text-yellow-600","aria-hidden":"true"})}),u.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left flex-1",children:[u.jsx("h3",{className:"text-base font-semibold leading-6 text-gray-900",children:"Session Timeout Warning"}),u.jsxs("div",{className:"mt-2",children:[u.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"You've been inactive for a while. For your security, we'll log you out automatically."}),u.jsxs("div",{className:"flex items-center justify-center sm:justify-start space-x-2 mb-4",children:[u.jsx(io,{className:"h-5 w-5 text-red-500"}),u.jsxs("span",{className:"text-lg font-bold text-red-600",children:[t," second",t!==1?"s":""," remaining"]})]}),u.jsx("p",{className:"text-sm text-gray-600",children:'Click "Stay Logged In" to continue your session, or "Logout Now" to sign out immediately.'})]})]})]})}),u.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6 gap-3",children:[u.jsx("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 sm:ml-3 sm:w-auto transition-colors duration-200",onClick:r,children:"Stay Logged In"}),u.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 sm:mt-0 sm:w-auto transition-colors duration-200",onClick:n,children:"Logout Now"})]})]})]})}):null,nk=30*60*1e3,sk=2*60*60*1e3,ik=30*1e3,W2=C.createContext(null),lk=()=>{const e=C.useContext(W2);if(!e)throw new Error("useInactivityContext must be used within InactivityLogoutProvider");return e},ck=({children:e})=>{const{logout:t}=Pr(),[r,n]=C.useState(!1),{showWarning:s,warningCountdown:l,dismissWarning:o}=rk({warningTimeout:r?sk:nk,logoutTimeout:ik,enabled:!0}),f=()=>{o()},m=()=>{t()};return u.jsxs(W2.Provider,{value:{setIsModalOpen:n},children:[e,u.jsx(ak,{isOpen:s,countdown:l,onStayLoggedIn:f,onLogoutNow:m})]})},Em=({isOpen:e,onClose:t,onActivityAdded:r,patientId:n,patientName:s,siteName:l,patients:o=[]})=>{const{user:f,isPharmacist:m,isAdmin:h}=Pr(),{setIsModalOpen:x}=lk(),[g,y]=C.useState(o),[S,w]=C.useState([]),[b,_]=C.useState(null),[T,N]=C.useState(!1),[E,j]=C.useState(o.length===0),F=C.useRef(e),[R,A]=C.useState({patientId:n||"",activityType:"",startTime:"",service_endtime:"",notes:"",pausePeriods:[],medicalChecks:{medicalRecords:!1,bpAtGoal:!1,hospitalVisit:!1,a1cAtGoal:!1,benzodiazepines:!1,antipsychotics:!1,opioids:!1,fallSinceLastVisit:!1}}),[P,U]=C.useState({startTime:"",service_endtime:""}),ee=(Ce,Fe)=>{const de=new Date(Ce.getFullYear(),Ce.getMonth(),Ce.getDate()),Te=new Date(Fe.getFullYear(),Fe.getMonth(),Fe.getDate());return Te<de?"End date cannot be earlier than start date":Te>de?"Start date cannot be later than end date":Fe<Ce?"End time cannot be earlier than start time":"Start time cannot be later than end time"},W=()=>{const Ce=new Date,Fe=Ce.getFullYear(),de=String(Ce.getMonth()+1).padStart(2,"0"),Te=String(Ce.getDate()).padStart(2,"0");return`${Fe}-${de}-${Te}`},J=Ce=>{const Fe=new Date(Ce),de=new Date;return Fe.getFullYear()>de.getFullYear()||Fe.getFullYear()===de.getFullYear()&&Fe.getMonth()>de.getMonth()||Fe.getFullYear()===de.getFullYear()&&Fe.getMonth()===de.getMonth()&&Fe.getDate()>de.getDate()},[xe,pe]=C.useState(!1),[we,Q]=C.useState(!1),[ie,Ae]=C.useState(!1),[re,z]=C.useState(!1),[te,D]=C.useState(""),[V,M]=C.useState(0),[B,K]=C.useState(""),oe=()=>({patientId:n||"",activityType:"",startTime:"",service_endtime:"",notes:"",pausePeriods:[],medicalChecks:{medicalRecords:!1,bpAtGoal:!1,hospitalVisit:!1,a1cAtGoal:!1,benzodiazepines:!1,antipsychotics:!1,opioids:!1,fallSinceLastVisit:!1}});C.useEffect(()=>(x(e),()=>x(!1)),[e,x]),C.useEffect(()=>{o.length>0&&(y(o),j(!1))},[o]),C.useEffect(()=>{F.current&&!e&&(A(oe()),pe(!1),Q(!1),Ae(!1),z(!1),D(""),M(0),K(""),_(null),N(!1),U({startTime:"",service_endtime:""})),e&&!F.current&&(A(oe()),pe(!1),Q(!1),Ae(!1),z(!1),D(""),M(0),K(""),_(null),N(!1),ye()),F.current=e},[e,n]),C.useEffect(()=>{e&&(A(oe()),pe(!1),Q(!1),Ae(!1),z(!1),D(""),M(0),K(""),_(null),U({startTime:"",service_endtime:""}))},[n]);const ye=async()=>{j(!0),_(null);try{const[Ce,Fe]=await Promise.all([q2(),o.length>0?Promise.resolve(o):Ao()]);w(Ce),o.length===0&&y(Fe)}catch(Ce){console.error("Error loading initial data:",Ce),_("Failed to load required data. Please try again.")}finally{j(!1)}};C.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[e]);const _e=Ce=>{const{name:Fe,value:de}=Ce.target;if(Fe==="startTime"||Fe==="service_endtime")if(de){if(J(de))return;const qe=Me(de).toISOString(),Ke={...R,[Fe]:qe};let Xe={...P};if(Fe==="startTime"&&Ke.service_endtime){const ut=new Date(qe),nt=new Date(Ke.service_endtime);ut>nt?Xe.startTime=ee(ut,nt):(Xe.startTime="",Xe.service_endtime="")}else if(Fe==="service_endtime"&&Ke.startTime){const ut=new Date(Ke.startTime),nt=new Date(qe);nt<ut?Xe.service_endtime=ee(ut,nt):(Xe.service_endtime="",Xe.startTime="")}U(Xe),A(ut=>({...ut,[Fe]:qe}))}else A(Te=>({...Te,[Fe]:""})),U(Te=>({...Te,[Fe]:""}));else A(Te=>({...Te,[Fe]:de}))},ae=()=>{const Fe=new Date().toISOString();A(de=>({...de,startTime:Fe,service_endtime:""})),pe(!0),Q(!0),Ae(!1),M(0),K(Fe)},He=()=>{if(we){const Ce=new Date,Fe=Ce.toISOString();if(xe){const de=new Date(B).getTime(),Ke=(Ce.getTime()-de)/(1e3*60);M(Xe=>Xe+Ke)}re&&te?(A(de=>({...de,service_endtime:Fe,pausePeriods:[...de.pausePeriods,{start:te,end:Fe}]})),D(""),z(!1)):A(de=>({...de,service_endtime:Fe})),pe(!1),Ae(!0)}},Y=()=>{if(xe&&!re){const Ce=new Date,Fe=Ce.toISOString(),de=new Date(B).getTime(),Ke=(Ce.getTime()-de)/(1e3*60);M(Xe=>Xe+Ke),D(Fe),z(!0),pe(!1)}},ct=()=>{if(re&&te){const Fe=new Date().toISOString();A(de=>({...de,pausePeriods:[...de.pausePeriods,{start:te,end:Fe}]})),D(""),z(!1),pe(!0),K(Fe)}},$e=()=>{if(!R.startTime)return 0;try{let Ce=V;if(xe&&!ie){const Fe=new Date(B).getTime(),qe=(new Date().getTime()-Fe)/(1e3*60);Ce+=qe}return console.log("Time calculation:",{startTime:R.startTime,service_endtime:R.service_endtime||"running",totalElapsedTime:V.toFixed(2),isTracking:xe,isPaused:re,hasStopped:ie,lastResumeTime:B,currentSessionTime:xe&&!ie?((new Date().getTime()-new Date(B).getTime())/(1e3*60)).toFixed(2):"0",totalMinutes:Ce.toFixed(2)}),Math.max(0,Ce)}catch(Ce){return console.error("Error calculating time difference:",Ce),0}};C.useEffect(()=>{R.startTime&&R.service_endtime&&console.log("Form data changed - recalculating time:",{start:new Date(R.startTime).toLocaleString(),end:new Date(R.service_endtime).toLocaleString(),difference:$e()})},[R.startTime,R.service_endtime]),C.useEffect(()=>{let Ce;return we&&!ie&&(Ce=setInterval(()=>{A(Fe=>({...Fe}))},1e3)),()=>{Ce&&clearInterval(Ce)}},[we,ie,xe,re]);const xt=()=>{const Ce=$e();return Ce===0?"0.00 minutes":Ce<1?`${(Math.round(Ce*100)/100).toFixed(2)} minutes`:Ce<60?`${(Math.round(Ce*100)/100).toFixed(2)} minutes`:`${(Math.round(Ce/60*100)/100).toFixed(2)} hours`},et=Ce=>{if(!Ce)return"";try{const Fe=new Date(Ce);if(isNaN(Fe.getTime()))return"";const de=Fe.getFullYear(),Te=String(Fe.getMonth()+1).padStart(2,"0"),qe=String(Fe.getDate()).padStart(2,"0"),Ke=String(Fe.getHours()).padStart(2,"0"),Xe=String(Fe.getMinutes()).padStart(2,"0");return`${de}-${Te}-${qe}T${Ke}:${Xe}`}catch(Fe){return console.error("Error formatting datetime:",Fe),""}},Me=Ce=>{try{const[Fe,de]=Ce.split("T"),[Te,qe,Ke]=Fe.split("-").map(Number),[Xe,ut]=de.split(":").map(Number),nt=new Date;return nt.setFullYear(Te),nt.setMonth(qe-1),nt.setDate(Ke),nt.setHours(Xe),nt.setMinutes(ut),nt.setSeconds(0),nt.setMilliseconds(0),nt}catch(Fe){return console.error("Error creating local date:",Fe),new Date}},vt=async Ce=>{if(Ce.preventDefault(),!(P.startTime||P.service_endtime)){_(null),N(!0);try{const Fe=new Date(R.startTime),Te=(new Date(R.service_endtime).getTime()-Fe.getTime())/(1e3*60),qe={patient_id:parseInt(R.patientId),user_id:(f==null?void 0:f.id)||0,activity_type:R.activityType,service_datetime:R.startTime,service_endtime:R.service_endtime,duration_minutes:Te,site_name:l||"",building:"",notes:R.notes,medical_checks:{medical_records:R.medicalChecks.medicalRecords,bp_at_goal:R.medicalChecks.bpAtGoal,hospital_visit:R.medicalChecks.hospitalVisit,a1c_at_goal:R.medicalChecks.a1cAtGoal,benzodiazepines:R.medicalChecks.benzodiazepines,antipsychotics:R.medicalChecks.antipsychotics,opioids:R.medicalChecks.opioids,fall_since_last_visit:R.medicalChecks.fallSinceLastVisit}};await JT(qe),t(),r&&r()}catch(Fe){console.error("Error creating activity:",Fe),_("Failed to create activity. Please try again.")}finally{N(!1)}}};if(!e)return null;const De=g.find(Ce=>{var Fe;return((Fe=Ce.id)==null?void 0:Fe.toString())===R.patientId}),at=De?`${De.last_name}, ${De.first_name}`:s&&n===R.patientId?s:"";return u.jsx("div",{className:"fixed inset-0 backdrop-blur-[2px] bg-gray-500/30 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-4 sm:p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Add New Activity"}),u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Please fill in all the required information to track an activity."})]}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500 transition-colors cursor-pointer",children:u.jsx(Ja,{className:"h-6 w-6"})})]}),E?u.jsxs("div",{className:"p-8 text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading data..."})]}):b?u.jsxs("div",{className:"p-8 text-center",children:[u.jsx("div",{className:"text-red-600 mb-4 text-5xl",children:"!"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error"}),u.jsx("p",{className:"text-gray-600 mb-4",children:b}),u.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Close"})]}):u.jsxs("form",{onSubmit:vt,className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:[n?u.jsxs("div",{className:"space-y-1.5",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:u.jsxs("span",{className:"flex items-center",children:[u.jsx(Lv,{className:"w-4 h-4 text-gray-400 mr-2"}),"Patient"]})}),u.jsx("input",{type:"text",value:at||s||"",disabled:!0,className:"mt-1 block w-full pl-3 pr-10 py-2.5 text-base border border-gray-300 bg-gray-100 rounded-lg shadow-sm cursor-not-allowed text-gray-500"})]}):u.jsxs("div",{className:"space-y-1.5",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:u.jsxs("span",{className:"flex items-center",children:[u.jsx(Lv,{className:"w-4 h-4 text-gray-400 mr-2"}),"Patient"]})}),u.jsxs("select",{name:"patientId",value:R.patientId,onChange:_e,className:"mt-1 block w-full pl-3 pr-10 py-2.5 text-base border border-gray-300 bg-gray-50 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 rounded-lg shadow-sm cursor-pointer hover:bg-gray-100 transition-colors",required:!0,children:[u.jsx("option",{value:"",children:"Select Patient"}),g.map(Ce=>u.jsxs("option",{value:Ce.id,children:[Ce.last_name,", ",Ce.first_name]},Ce.id))]})]}),u.jsxs("div",{className:"space-y-1.5",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:u.jsxs("span",{className:"flex items-center",children:[u.jsx(Mv,{className:"w-4 h-4 text-gray-400 mr-2"}),"Activity Type"]})}),u.jsxs("select",{name:"activityType",value:R.activityType,onChange:_e,className:"mt-1 block w-full pl-3 pr-10 py-2.5 text-base border border-gray-300 bg-gray-50 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 rounded-lg shadow-sm cursor-pointer hover:bg-gray-100 transition-colors",required:!0,children:[u.jsx("option",{value:"",children:"Select Activity Type"}),S.map(Ce=>u.jsx("option",{value:Ce,children:Ce},Ce))]})]})]}),(m||h)&&u.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg border border-gray-200 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Mv,{className:"w-5 h-5 text-gray-500 mr-2"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Medical Checklist"})]}),u.jsx("span",{className:"text-sm font-normal text-gray-500",children:"* leave blank if not applicable"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("label",{className:"relative flex items-start",children:[u.jsx("div",{className:"flex items-center h-5",children:u.jsx("input",{type:"checkbox",name:"medicalChecks.medicalRecords",checked:R.medicalChecks.medicalRecords,onChange:Ce=>{A(Fe=>({...Fe,medicalChecks:{...Fe.medicalChecks,medicalRecords:Ce.target.checked}}))},className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),u.jsx("div",{className:"ml-3 text-sm",children:u.jsx("span",{className:"text-gray-700",children:"Medical Records"})})]}),u.jsxs("label",{className:"relative flex items-start",children:[u.jsx("div",{className:"flex items-center h-5",children:u.jsx("input",{type:"checkbox",name:"medicalChecks.bpAtGoal",checked:R.medicalChecks.bpAtGoal,onChange:Ce=>{A(Fe=>({...Fe,medicalChecks:{...Fe.medicalChecks,bpAtGoal:Ce.target.checked}}))},className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),u.jsx("div",{className:"ml-3 text-sm",children:u.jsx("span",{className:"text-gray-700",children:"BP at Goal"})})]}),u.jsxs("label",{className:"relative flex items-start",children:[u.jsx("div",{className:"flex items-center h-5",children:u.jsx("input",{type:"checkbox",name:"medicalChecks.hospitalVisit",checked:R.medicalChecks.hospitalVisit,onChange:Ce=>{A(Fe=>({...Fe,medicalChecks:{...Fe.medicalChecks,hospitalVisit:Ce.target.checked}}))},className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),u.jsx("div",{className:"ml-3 text-sm",children:u.jsx("span",{className:"text-gray-700",children:"Hospital Visit Since Last Review"})})]}),u.jsxs("label",{className:"relative flex items-start",children:[u.jsx("div",{className:"flex items-center h-5",children:u.jsx("input",{type:"checkbox",name:"medicalChecks.a1cAtGoal",checked:R.medicalChecks.a1cAtGoal,onChange:Ce=>{A(Fe=>({...Fe,medicalChecks:{...Fe.medicalChecks,a1cAtGoal:Ce.target.checked}}))},className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),u.jsx("div",{className:"ml-3 text-sm",children:u.jsx("span",{className:"text-gray-700",children:"A1C at Goal"})})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("label",{className:"relative flex items-start",children:[u.jsx("div",{className:"flex items-center h-5",children:u.jsx("input",{type:"checkbox",name:"medicalChecks.benzodiazepines",checked:R.medicalChecks.benzodiazepines,onChange:Ce=>{A(Fe=>({...Fe,medicalChecks:{...Fe.medicalChecks,benzodiazepines:Ce.target.checked}}))},className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),u.jsx("div",{className:"ml-3 text-sm",children:u.jsx("span",{className:"text-gray-700",children:"Benzodiazepines"})})]}),u.jsxs("label",{className:"relative flex items-start",children:[u.jsx("div",{className:"flex items-center h-5",children:u.jsx("input",{type:"checkbox",name:"medicalChecks.antipsychotics",checked:R.medicalChecks.antipsychotics,onChange:Ce=>{A(Fe=>({...Fe,medicalChecks:{...Fe.medicalChecks,antipsychotics:Ce.target.checked}}))},className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),u.jsx("div",{className:"ml-3 text-sm",children:u.jsx("span",{className:"text-gray-700",children:"Antipsychotics"})})]}),u.jsxs("label",{className:"relative flex items-start",children:[u.jsx("div",{className:"flex items-center h-5",children:u.jsx("input",{type:"checkbox",name:"medicalChecks.opioids",checked:R.medicalChecks.opioids,onChange:Ce=>{A(Fe=>({...Fe,medicalChecks:{...Fe.medicalChecks,opioids:Ce.target.checked}}))},className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),u.jsx("div",{className:"ml-3 text-sm",children:u.jsx("span",{className:"text-gray-700",children:"Opioids"})})]}),u.jsxs("label",{className:"relative flex items-start",children:[u.jsx("div",{className:"flex items-center h-5",children:u.jsx("input",{type:"checkbox",name:"medicalChecks.fallSinceLastVisit",checked:R.medicalChecks.fallSinceLastVisit,onChange:Ce=>{A(Fe=>({...Fe,medicalChecks:{...Fe.medicalChecks,fallSinceLastVisit:Ce.target.checked}}))},className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),u.jsx("div",{className:"ml-3 text-sm",children:u.jsx("span",{className:"text-gray-700",children:"Fall Since Last Visit"})})]})]})]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200 p-6",children:[u.jsx("div",{className:"flex items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx($T,{className:"w-5 h-5 text-gray-500 mr-2"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Time Tracking"})]})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex justify-center mb-4",children:u.jsxs("button",{type:"button",onClick:ae,disabled:we,className:`inline-flex items-center px-5 py-2.5 rounded-lg text-sm font-medium shadow-sm transition-all cursor-pointer ${we?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-emerald-600 text-white hover:bg-emerald-700 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500"}`,children:[u.jsx(Bv,{className:"w-4 h-4 mr-2"}),we?"Started":"Start Time"]})}),R.startTime&&u.jsxs("div",{className:"space-y-3",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date & Time"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("input",{type:"datetime-local",name:"startTime",value:et(R.startTime),onChange:_e,max:`${W()}T23:59`,onKeyDown:Ce=>{Ce.key!=="Tab"&&!Ce.key.includes("Arrow")&&Ce.preventDefault()},className:"mt-1 block w-full px-3 py-2 text-base border border-gray-300 bg-gray-50 rounded-lg shadow-sm cursor-pointer transition-colors hover:bg-gray-100 [&::-webkit-calendar-picker-indicator]:opacity-100 [&::-webkit-calendar-picker-indicator]:cursor-pointer"}),P.startTime&&u.jsx("p",{className:"text-sm text-red-600 mt-1",children:P.startTime})]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex justify-center mb-4",children:u.jsxs("button",{type:"button",onClick:He,disabled:!we||ie,className:`inline-flex items-center px-5 py-2.5 rounded-lg text-sm font-medium shadow-sm transition-all cursor-pointer ${!we||ie?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-rose-600 text-white hover:bg-rose-700 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500"}`,children:[u.jsx(WT,{className:"w-4 h-4 mr-2"}),ie?"Stopped":"Stop Time"]})}),R.service_endtime&&u.jsxs("div",{className:"space-y-3",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date & Time"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("input",{type:"datetime-local",name:"service_endtime",value:et(R.service_endtime),onChange:_e,max:`${W()}T23:59`,onKeyDown:Ce=>{Ce.key!=="Tab"&&!Ce.key.includes("Arrow")&&Ce.preventDefault()},className:"mt-1 block w-full px-3 py-2 text-base border border-gray-300 bg-gray-50 rounded-lg shadow-sm cursor-pointer transition-colors hover:bg-gray-100 [&::-webkit-calendar-picker-indicator]:opacity-100 [&::-webkit-calendar-picker-indicator]:cursor-pointer"}),P.service_endtime&&u.jsx("p",{className:"text-sm text-red-600 mt-1",children:P.service_endtime})]})]})]})]}),we&&!ie&&u.jsx("div",{className:"flex justify-center mt-6 mb-4",children:re?u.jsxs("button",{type:"button",onClick:ct,className:"inline-flex items-center px-5 py-2.5 rounded-lg text-sm font-medium shadow-sm transition-all cursor-pointer bg-blue-600 text-white hover:bg-blue-700 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[u.jsx(Bv,{className:"w-4 h-4 mr-2"}),"Resume"]}):u.jsxs("button",{type:"button",onClick:Y,disabled:!xe,className:`inline-flex items-center px-5 py-2.5 rounded-lg text-sm font-medium shadow-sm transition-all cursor-pointer ${xe?"bg-yellow-600 text-white hover:bg-yellow-700 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[u.jsx(YT,{className:"w-4 h-4 mr-2"}),"Pause"]})}),R.startTime&&u.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 text-center",children:[u.jsxs("p",{className:"text-sm text-gray-600",children:["Total time: ",u.jsx("span",{className:"font-semibold",children:xt()})]}),R.pausePeriods.length>0&&u.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Paused ",R.pausePeriods.length," time",R.pausePeriods.length>1?"s":""]}),re&&u.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"Currently paused"})]})]}),u.jsxs("div",{className:"space-y-1.5",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:u.jsxs("span",{className:"flex items-center",children:[u.jsx(qT,{className:"w-4 h-4 text-gray-400 mr-2"}),"Additional Notes"]})}),u.jsx("textarea",{name:"notes",value:R.notes,onChange:_e,rows:3,className:"mt-1 block w-full px-3 py-2 text-base border border-gray-300 bg-gray-50 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 rounded-lg shadow-sm resize-none hover:bg-gray-100 transition-colors",placeholder:"Add any relevant details or observations..."})]}),u.jsx("div",{className:"pt-4 border-t border-gray-200",children:u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors shadow-sm",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:T,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors disabled:opacity-70 disabled:cursor-not-allowed",children:T?"Saving...":"Save Activity"})]})})]})]})})})};function Uv(){const e=ta(),{isPharmacist:t,isNurse:r}=Pr(),[n,s]=C.useState(!1),[l,o]=C.useState(!1),[f,m]=C.useState(""),[h,x]=C.useState(""),[g,y]=C.useState(""),[S,w]=C.useState(!0),[b,_]=C.useState(null),[T,N]=C.useState([]),[E,j]=C.useState({}),[F,R]=C.useState(""),[A,P]=C.useState("all"),[U,ee]=C.useState(null),[W,J]=C.useState("asc"),[xe,pe]=C.useState("all"),we=new Date;(we.getMonth()+1).toString(),we.getFullYear().toString();const[Q,ie]=C.useState("all"),[Ae,re]=C.useState("all"),[z,te]=C.useState(!1),[D,V]=C.useState("all"),[M,B]=C.useState([]),K=async()=>{w(!0),_(null);try{const De=await Ao();N(De);const at={};for(const Ce of De)if(Ce.id)try{const Fe=await $2(Ce.id);at[Ce.id]=Fe}catch(Fe){console.error(`Error fetching activities for patient ${Ce.id}:`,Fe),at[Ce.id]=[]}j(at)}catch(De){console.error("Error fetching patients:",De),_("Failed to load patients. Please try again later.")}finally{w(!1)}},oe=async()=>{try{const De=await Nm();B(De)}catch(De){console.error("Error fetching sites and buildings:",De)}};C.useEffect(()=>{K(),oe()},[]);const ye=C.useMemo(()=>M.map(De=>De.site_name),[M]),_e=C.useMemo(()=>{if(xe==="all"){const De=M.flatMap(at=>at.building_names).filter(Boolean);return[...new Set(De)]}else{const De=M.find(at=>at.site_name===xe);return De?De.building_names:[]}},[M,xe]);C.useEffect(()=>{V("all")},[xe]);const ae=["January","February","March","April","May","June","July","August","September","October","November","December"],He=C.useMemo(()=>{const De=new Set;return Object.values(E).forEach(at=>{at.forEach(Ce=>{const Fe=Ce.service_datetime||Ce.created_at;if(Fe){const de=new Date(Fe).getFullYear();De.add(de)}})}),Array.from(De).sort((at,Ce)=>at-Ce)},[E]),Y=De=>`${De.first_name} ${De.last_name}`,ct=De=>De==="name"?"first_name":De,$e=C.useMemo(()=>[...T.filter(at=>{const Fe=Y(at).toLowerCase().includes(F.toLowerCase())||String(at.id).toLowerCase().includes(F.toLowerCase()),de=xe==="all"||at.site_name===xe,Te=D==="all"||at.building===D,qe=()=>Q==="all"&&Ae==="all"?!0:!at.id||!E[at.id]?!1:E[at.id].some(Xe=>{const ut=Xe.service_datetime||Xe.created_at;if(!ut)return!1;const nt=new Date(ut),lt=Q==="all"||nt.getMonth()+1===Number.parseInt(Q),Xt=Ae==="all"||nt.getFullYear()===Number.parseInt(Ae);return lt&&Xt}),Ke=z||at.is_active;return Fe&&de&&Te&&Ke&&qe()})].sort((at,Ce)=>{if(!U)return 0;if(U==="name"){const qe=Y(at),Ke=Y(Ce);return qe<Ke?W==="asc"?-1:1:qe>Ke?W==="asc"?1:-1:0}const Fe=ct(U);if(!Fe)return 0;const de=at[Fe],Te=Ce[Fe];if(de&&Te){if(de<Te)return W==="asc"?-1:1;if(de>Te)return W==="asc"?1:-1}return 0}),[T,F,xe,D,Q,Ae,z,U,W,E]),xt=De=>{U===De?J(W==="asc"?"desc":"asc"):(ee(De),J("asc"))},et=De=>De==="M"?"M":De==="F"?"F":"O",Me=()=>{K()},vt=De=>{var at;m(((at=De.id)==null?void 0:at.toString())||""),x(`${De.last_name}, ${De.first_name}`),y(De.site_name||""),o(!0)};return u.jsxs("div",{className:"h-[calc(100vh-4rem)] bg-gradient-to-b from-gray-50 to-gray-100 flex flex-col",children:[u.jsxs("div",{className:"flex-1 flex flex-col px-4 py-6 max-w-7xl mx-auto w-full overflow-hidden",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-0 mb-4 flex-shrink-0",children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"All Patients"}),!t&&!r&&u.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors whitespace-nowrap cursor-pointer w-full sm:w-auto",children:[u.jsx(hn,{className:"h-4 w-4 mr-2"}),"Add Patient"]})]}),u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-4 flex-shrink-0",children:u.jsxs("div",{className:"flex flex-col space-y-3",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[u.jsxs("div",{className:"relative w-full md:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(ts,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search...",value:F,onChange:De=>R(De.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),u.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:z,onChange:()=>te(!z),className:"sr-only peer"}),u.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"}),u.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:"Show Inactive Patients"})]})]}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Site"}),u.jsxs("div",{className:"relative",children:[u.jsxs("select",{value:xe,onChange:De=>pe(De.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"all",children:"All Sites"}),ye.map(De=>u.jsx("option",{value:De,children:De},De))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-3 w-3 text-gray-500"})})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Building"}),u.jsxs("div",{className:"relative",children:[u.jsxs("select",{value:D,onChange:De=>V(De.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"all",children:xe==="all"?"All Buildings":_e.length===0?`No buildings for ${xe}`:"All Buildings"}),_e.map(De=>u.jsx("option",{value:De,children:De},De))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-3 w-3 text-gray-500"})})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Activity Month"}),u.jsxs("div",{className:"relative",children:[u.jsxs("select",{value:Q,onChange:De=>ie(De.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"all",children:"All Months"}),ae.map((De,at)=>u.jsx("option",{value:at+1,children:De},De))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-3 w-3 text-gray-500"})})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Activity Year"}),u.jsxs("div",{className:"relative",children:[u.jsxs("select",{value:Ae,onChange:De=>re(De.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"all",children:"All Years"}),He.map(De=>u.jsx("option",{value:De,children:De},De))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-3 w-3 text-gray-500"})})]})]})]})]})}),b&&u.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-lg p-4 mb-4 flex-shrink-0",children:[u.jsx("p",{children:b}),u.jsx("button",{onClick:K,className:"mt-2 text-red-600 hover:text-red-800 underline",children:"Try again"})]}),S&&u.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8 flex justify-center items-center max-h-[60vh]",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),u.jsx("div",{className:"text-gray-500",children:"Loading patients data..."})]})}),!S&&!b&&u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 flex flex-col max-h-[60vh] min-h-0",children:[u.jsx("div",{className:"flex-1 overflow-auto min-h-0 table-container",children:u.jsxs("table",{className:"min-w-full",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>xt("name"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Name"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${U==="name"&&W==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${U==="name"&&W==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>xt("birthdate"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Birthdate"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${U==="birthdate"&&W==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${U==="birthdate"&&W==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>xt("gender"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Gender"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${U==="gender"&&W==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${U==="gender"&&W==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>xt("site_name"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Site"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${U==="site_name"&&W==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${U==="site_name"&&W==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>xt("building"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Building"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${U==="building"&&W==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${U==="building"&&W==="desc"?"text-blue-600":"text-gray-300"}`})]})]})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:$e.length>0?$e.map(De=>u.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:u.jsx("button",{onClick:()=>e(`/patientdetails/${De.id}`),className:"inline-flex items-center px-2 py-1 rounded text-blue-600 hover:text-blue-900 hover:underline transition-colors duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer",children:Y(De)})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:De.birthdate?new Date(De.birthdate).toLocaleDateString():""}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:et(De.gender)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:De.is_active?u.jsxs("button",{onClick:()=>vt(De),className:"inline-flex items-center px-2.5 py-1.5 border border-blue-500 text-xs font-medium rounded text-blue-600 bg-white hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer",children:[u.jsx(hn,{className:"h-3 w-3 mr-1"}),"Add Activity"]}):u.jsx("span",{className:"text-xs text-gray-400",children:"Patient Inactive"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:De.site_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:De.building||"-"})]},De.id)):u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No patients found matching your filters"})})})]})}),u.jsxs("div",{className:"flex-shrink-0 bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200",children:[u.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[u.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),u.jsx("button",{className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",u.jsx("span",{className:"font-medium",children:$e.length})," of"," ",u.jsx("span",{className:"font-medium",children:$e.length})," results"]})}),u.jsx("div",{children:u.jsx("p",{className:"text-xs text-gray-500",children:"Scroll to view more patients"})})]})]})]})]}),u.jsx(V2,{isOpen:n,onClose:()=>s(!1),onPatientAdded:Me}),u.jsx(Em,{isOpen:l,onClose:()=>o(!1),onActivityAdded:()=>K(),patientId:f,patientName:h,siteName:g})]})}const ok=({isOpen:e,onClose:t,patientId:r})=>{const[n,s]=C.useState([]),[l,o]=C.useState(!1),[f,m]=C.useState(null);C.useEffect(()=>{e&&r&&h()},[e,r]);const h=async()=>{o(!0),m(null);try{const y=await Sm(r);s(y)}catch(y){console.error("Error fetching medical records:",y),m("Failed to load medical records history")}finally{o(!1)}};if(!e)return null;const x=y=>y?new Date(y).toLocaleString():"N/A",g=y=>({bpAtGoal:"BP at Goal",hospitalVisitSinceLastReview:"Hospital Visit Since Last Review",a1cAtGoal:"A1C at Goal",benzodiazepines:"Benzodiazepines",antipsychotics:"Antipsychotics",opioids:"Opioids",fallSinceLastVisit:"Fall Since Last Visit",medical_records:"Medical Records"})[y]||y;return u.jsx("div",{className:"fixed inset-0 backdrop-blur-[2px] bg-gray-500/30 flex items-center justify-center z-50",onClick:t,children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl h-[90vh] flex flex-col",onClick:y=>y.stopPropagation(),children:[u.jsx("div",{className:"p-6 border-b border-gray-200 flex-shrink-0",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[u.jsx(io,{className:"h-6 w-6 mr-2"}),"Status Update History"]}),u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"View the history of updates to patient status fields."})]}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500 transition-colors cursor-pointer",children:u.jsx(Ja,{className:"h-6 w-6"})})]})}),u.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:l?u.jsx("div",{className:"flex items-center justify-center h-48",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):f?u.jsx("div",{className:"text-center text-red-600 py-8",children:f}):n.length===0?u.jsx("div",{className:"text-center text-gray-500 py-8",children:"No status updates found"}):u.jsx("div",{className:"space-y-4",children:n.map((y,S)=>u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[u.jsxs("div",{className:"flex justify-between items-start mb-3",children:[u.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["Update #",n.length-S]}),u.jsx("span",{className:"text-sm text-gray-500",children:x(y.createdAt)})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries(y).filter(([w])=>w!=="id"&&w!=="patientId"&&w!=="createdAt").map(([w,b])=>u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-gray-600",children:[g(w),":"]}),u.jsx("span",{className:`text-sm font-medium ${b?"text-green-600":"text-red-600"}`,children:b?"Yes":"No"})]},w))})]},y.id||S))})})]})})},Bl=({isOpen:e,onClose:t,onConfirm:r,isDeleting:n,itemName:s="this item"})=>(C.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),e?u.jsx("div",{className:"fixed inset-0 backdrop-blur-[2px] bg-gray-500/30 flex items-center justify-center z-50",children:u.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"flex justify-between items-center mb-6",children:u.jsxs("div",{children:[u.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Delete ",s]}),u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"This action cannot be undone."})]})}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:t,disabled:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),u.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Deleting...":"Delete"})]})]})})}):null),uk=e=>e?new Date(e).toISOString().split("T")[0]:"",Rs=C.memo(({icon:e,label:t,value:r,isEditing:n=!1,onEdit:s,editType:l="text",editOptions:o=[],className:f="",forceReadOnly:m=!1})=>{const h=g=>g==null?"N/A":t==="Birth Date"&&(g instanceof Date||typeof g=="string"&&g.includes("T"))?new Date(g).toLocaleDateString():typeof g=="boolean"?g?"Yes":"No":String(g),x=()=>{if(n&&!m)switch(l){case"date":return u.jsx("input",{type:"date",value:uk(r),onChange:g=>s==null?void 0:s(g.target.value),className:"block w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"});case"select":return u.jsxs("select",{value:String(r),onChange:g=>s==null?void 0:s(g.target.value),className:"block w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[u.jsxs("option",{value:"",children:["Select ",t]}),o.map(g=>u.jsx("option",{value:g,children:g},g))]});case"checkbox":return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm text-gray-600",children:t}),u.jsx("input",{type:"checkbox",checked:!!r,onChange:g=>s==null?void 0:s(g.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})]});case"textarea":return u.jsx("textarea",{value:h(r),onChange:g=>s==null?void 0:s(g.target.value),className:"block w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",rows:4});default:return u.jsx("input",{type:"text",value:h(r),onChange:g=>s==null?void 0:s(g.target.value),className:"block w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})}return u.jsx("span",{className:"text-gray-900",children:h(r)})};return l==="checkbox"&&n?x():u.jsxs("div",{className:`${f}`,children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:[e&&u.jsx("span",{className:"mr-2",children:e}),t]}),u.jsx("div",{className:"mt-1",children:x()})]})}),vu={M:"Male",F:"Female",O:"Other"},fk=e=>e?vu[e]||e:"",dk=e=>{const t=Object.entries(vu).find(([r,n])=>n===e);return t?t[0]:e};function hk(){const e=ta(),{patientId:t=""}=mm(),{isPharmacist:r,isNurse:n}=Pr(),[s,l]=C.useState(!0),[o,f]=C.useState(null),[m,h]=C.useState(null),[x,g]=C.useState(null),[y,S]=C.useState([]),[w,b]=C.useState(!1),[_,T]=C.useState(!1),[N,E]=C.useState(!1),[j,F]=C.useState(!1),[R,A]=C.useState([]),[P,U]=C.useState([]),[ee,W]=C.useState(!1),[J,xe]=C.useState(!1),[pe,we]=C.useState(null),[Q,ie]=C.useState(null),[Ae,re]=C.useState("asc"),z=new Date,te=(z.getMonth()+1).toString(),D=z.getFullYear().toString(),V=C.useMemo(()=>{if(!y)return[D];const de=y.map(Te=>new Date(Te.service_datetime||Te.created_at||new Date).getFullYear().toString());return[...new Set(de)].sort((Te,qe)=>Number(Te)-Number(qe))},[y]),[M,B]=C.useState(te),[K,oe]=C.useState(D),ye=["January","February","March","April","May","June","July","August","September","October","November","December"],_e=async()=>{if(!t){f("No patient ID provided"),l(!1);return}l(!0),f(null);try{const de=await P2(t);console.log("Fetched patient data:",de);try{const Te=await Fv(t);we(Te),Te&&(de.medical_records=Te.medical_records,de.bp_at_goal=Te.bpAtGoal,de.hospital_visited_since_last_review=Te.hospitalVisitSinceLastReview,de.a1c_at_goal=Te.a1cAtGoal,de.use_benzo=Te.benzodiazepines,de.use_antipsychotic=Te.antipsychotics,de.use_opioids=Te.opioids,de.fall_since_last_visit=Te.fallSinceLastVisit)}catch(Te){console.error("Error fetching latest medical record:",Te)}h(de);try{const Te=await $2(t);S(Te)}catch(Te){console.error("Error fetching patient activities:",Te),S([])}}catch(de){console.error("Error fetching patient data:",de),f("Failed to load patient data. Please try again.")}finally{l(!1)}};C.useEffect(()=>{_e()},[t]),C.useEffect(()=>{(async()=>{if(_)try{const Te=await Nm();if(console.log("Fetched sites and buildings:",Te),A(Te),x!=null&&x.site_name){console.log("Current site name:",x.site_name);const qe=Te.find(Ke=>Ke.site_name===x.site_name);console.log("Selected site:",qe),qe&&(console.log("Setting available buildings:",qe.building_names),U(qe.building_names))}}catch(Te){console.error("Error fetching sites and buildings:",Te)}})()},[_,x==null?void 0:x.site_name]);const ae=m?{patient:{...m,site_name:m.site_name||""},activities:y.map(de=>{var Te;return{activityId:((Te=de.id)==null?void 0:Te.toString())||"",activityType:de.activity_type||"",initials:de.user_initials||"N/A",recordDate:(de.service_datetime||de.created_at||new Date().toISOString()).toString(),totalTime:de.duration_minutes,time_spent:de.duration_minutes,duration_minutes:de.duration_minutes}})}:null,He=de=>{e(`/activity/${de}`)},Y=()=>{b(!0)},ct=()=>{t&&_e()},$e=de=>{const Te=de.time_spent,qe=de.duration_minutes;let Ke=0;if(Te!=null&&!isNaN(Number(Te)))Ke=Number(Te);else if(qe!=null&&!isNaN(Number(qe)))Ke=Number(qe);else return"N/A";if(Ke===0)return"0:00";const Xe=Math.round(Ke*60),ut=Math.floor(Xe/3600),nt=Math.floor(Xe%3600/60),lt=Xe%60;return ut>0?`${ut}:${nt.toString().padStart(2,"0")}:${lt.toString().padStart(2,"0")}`:`${nt}:${lt.toString().padStart(2,"0")}`},xt=()=>{T(!0),g(m?{...m}:null)},et=()=>{T(!1),g(m)},Me=async()=>{if(!(!x||!t)){E(!0);try{console.log("Saving patient with data:",x);const de=await z2(t,x);console.log("Patient updated successfully:",de);try{const Te=await Fv(t);we(Te),Te&&(de.medical_records=Te.medical_records,de.bp_at_goal=Te.bpAtGoal,de.hospital_visited_since_last_review=Te.hospitalVisitSinceLastReview,de.a1c_at_goal=Te.a1cAtGoal,de.use_benzo=Te.benzodiazepines,de.use_antipsychotic=Te.antipsychotics,de.use_opioids=Te.opioids,de.fall_since_last_visit=Te.fallSinceLastVisit)}catch(Te){console.error("Error fetching latest medical record:",Te)}h(de),g(de),T(!1)}catch(de){console.error("Error updating patient:",de),f("Failed to save patient. Please try again.")}finally{E(!1)}}},vt=(de,Te)=>{if(!x)return;const qe={...x,[de]:Te};if(de==="site_name"){console.log("Site name changed to:",Te);const Ke=R.find(Xe=>Xe.site_name===Te);console.log("Found site:",Ke),Ke&&(console.log("Setting available buildings for new site:",Ke.building_names),U(Ke.building_names),qe.building="")}g(qe)},De=de=>{Q===de?re(Ae==="asc"?"desc":"asc"):(ie(de),re("asc"))},at=C.useMemo(()=>y?y.filter(Te=>Te.id!==void 0).map(Te=>({activityId:Te.id.toString(),activityType:Te.activity_type,initials:Te.user_initials||"N/A",recordDate:(Te.service_datetime||Te.created_at||new Date().toISOString()).toString(),totalTime:Te.duration_minutes,time_spent:Te.duration_minutes,duration_minutes:Te.duration_minutes})).filter(Te=>{const qe=new Date(Te.recordDate),Ke=M==="all"||qe.getMonth()+1===Number.parseInt(M),Xe=K==="all"||qe.getFullYear()===Number.parseInt(K);return Ke&&Xe}).sort((Te,qe)=>{if(!Q)return Number(qe.activityId)-Number(Te.activityId);let Ke=Te[Q],Xe=qe[Q];return Q==="recordDate"&&(Ke=new Date(Te.recordDate).getTime(),Xe=new Date(qe.recordDate).getTime()),Ke<Xe?Ae==="asc"?-1:1:Ke>Xe?Ae==="asc"?1:-1:0}):[],[y,M,K,Q,Ae]),Ce=async()=>{if(t){xe(!0);try{await FT(t),e("/patients")}catch(de){console.error("Error deleting patient:",de),alert("Failed to delete patient. Please try again.")}finally{xe(!1)}}};if(s)return u.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading patient data..."})]})});if(o||!ae)return u.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md text-center max-w-md",children:[u.jsx("div",{className:"text-red-600 mb-4 text-5xl",children:"!"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Patient"}),u.jsx("p",{className:"text-gray-600 mb-4",children:o||"Patient data not found"}),u.jsx("button",{onClick:()=>e("/patients"),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Return to Patients List"})]})});const Fe=m?`${m.last_name}, ${m.first_name}`:"";return u.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:[u.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:()=>e("/patients"),className:"p-1.5 rounded-full text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer",title:"Back to All Patients",children:u.jsx(Wc,{className:"h-5 w-5"})}),u.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Patient Details"})]}),u.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:_?u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:Me,disabled:N,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer w-full sm:w-auto",children:[u.jsx(B2,{className:"h-4 w-4 mr-2"}),N?"Saving...":"Save Changes"]}),!r&&u.jsxs("button",{onClick:()=>W(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors cursor-pointer w-full sm:w-auto",children:[u.jsx(ko,{className:"h-4 w-4 mr-2"}),"Delete Patient"]}),u.jsxs("button",{onClick:et,className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 cursor-pointer w-full sm:w-auto",children:[u.jsx(Ja,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):!n&&u.jsxs("button",{onClick:xt,className:"inline-flex items-center justify-center px-4 py-2 border border-blue-600 rounded-md shadow-sm text-sm font-medium text-blue-600 bg-white hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-150 ease-in-out cursor-pointer w-full sm:w-auto",children:[u.jsx(Ll,{className:"w-4 h-4 mr-2"}),"Edit Patient"]})})]}),u.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8",children:u.jsx("div",{className:"p-6",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[u.jsx(lo,{className:"w-5 h-5 text-blue-600"}),"Basic Information"]}),_?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Inactive"}),u.jsx("button",{type:"button",role:"switch","aria-checked":x==null?void 0:x.is_active,onClick:()=>!r&&vt("is_active",!(x!=null&&x.is_active)),disabled:r,className:`${x!=null&&x.is_active?"bg-blue-600":"bg-gray-200"} ${r?"opacity-50 cursor-not-allowed":"cursor-pointer"} relative inline-flex h-6 w-11 flex-shrink-0 rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${!r&&"focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}`,title:r?"Pharmacists cannot change patient active status":"Toggle patient active status",children:u.jsx("span",{"aria-hidden":"true",className:`${x!=null&&x.is_active?"translate-x-5":"translate-x-0"} pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out`})}),u.jsx("span",{className:"text-sm text-gray-600",children:"Active"})]}):u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ae!=null&&ae.patient.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ae!=null&&ae.patient.is_active?"Active":"Inactive"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[u.jsxs("div",{className:"lg:col-span-1",children:[u.jsx(Rs,{label:"First Name",value:_?x==null?void 0:x.first_name:ae==null?void 0:ae.patient.first_name,isEditing:_,editType:"text",onEdit:de=>vt("first_name",de),forceReadOnly:r}),u.jsx("div",{className:"mt-6",children:u.jsx(Rs,{label:"Last Name",value:_?x==null?void 0:x.last_name:ae==null?void 0:ae.patient.last_name,isEditing:_,editType:"text",onEdit:de=>vt("last_name",de),forceReadOnly:r})}),u.jsx("div",{className:"mt-6",children:u.jsx(Rs,{label:"Birth Date",value:_?x==null?void 0:x.birthdate:ae==null?void 0:ae.patient.birthdate,isEditing:_,editType:"date",onEdit:de=>vt("birthdate",de),forceReadOnly:r})})]}),u.jsxs("div",{className:"lg:col-span-1",children:[u.jsx(Rs,{label:"Site Name",value:_?x==null?void 0:x.site_name:ae==null?void 0:ae.patient.site_name,isEditing:_,editType:"select",editOptions:R.map(de=>de.site_name),onEdit:de=>vt("site_name",de),forceReadOnly:r}),u.jsx("div",{className:"mt-6",children:u.jsx(Rs,{label:"Building",value:_?x==null?void 0:x.building:ae==null?void 0:ae.patient.building,isEditing:_,editType:"select",editOptions:P,onEdit:de=>vt("building",de),forceReadOnly:r})})]}),u.jsxs("div",{className:"lg:col-span-1",children:[u.jsx(Rs,{label:"Gender",value:_?x!=null&&x.gender?vu[x.gender]:"":fk(ae==null?void 0:ae.patient.gender),isEditing:_,editType:"select",editOptions:Object.values(vu),onEdit:de=>vt("gender",dk(de)),forceReadOnly:r}),u.jsx("div",{className:"mt-6",children:u.jsx(Rs,{label:"Insurance",value:_?x==null?void 0:x.insurance:ae==null?void 0:ae.patient.insurance,isEditing:_,editType:"text",onEdit:de=>vt("insurance",de)})})]}),u.jsx("div",{className:"lg:col-span-1 md:col-span-2 lg:row-span-2",children:u.jsx(Rs,{label:"Notes",value:_?x==null?void 0:x.notes:ae==null?void 0:ae.patient.notes,isEditing:_,editType:"textarea",onEdit:de=>vt("notes",de),className:"h-full"})})]})]}),u.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 mb-4",children:[u.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[u.jsx(kv,{className:"w-5 h-5 text-blue-600"}),"Patient Status"]}),u.jsxs("button",{onClick:()=>F(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-md transition-colors w-full sm:w-auto justify-center sm:justify-start",children:[u.jsx(io,{className:"w-4 h-4 text-gray-500"}),u.jsx("span",{children:"Last Updated"}),u.jsx("span",{className:"text-blue-600 font-medium",children:pe!=null&&pe.createdAt?new Date(pe.createdAt).toLocaleDateString():"N/A"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsx("div",{children:u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx($h,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Medical Records:"}),u.jsx("span",{className:`text-sm font-medium ${ae!=null&&ae.patient.medical_records?"text-green-600":"text-red-600"}`,children:ae!=null&&ae.patient.medical_records?"Yes":"No"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(kv,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-gray-600",children:"BP at Goal:"}),u.jsx("span",{className:`text-sm font-medium ${ae!=null&&ae.patient.bp_at_goal?"text-green-600":"text-red-600"}`,children:ae!=null&&ae.patient.bp_at_goal?"Yes":"No"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(aT,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Hospital Visit Since Last Review:"}),u.jsx("span",{className:`text-sm font-medium ${ae!=null&&ae.patient.hospital_visited_since_last_review?"text-green-600":"text-red-600"}`,children:ae!=null&&ae.patient.hospital_visited_since_last_review?"Yes":"No"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Yh,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-gray-600",children:"A1C at Goal:"}),u.jsx("span",{className:`text-sm font-medium ${ae!=null&&ae.patient.a1c_at_goal?"text-green-600":"text-red-600"}`,children:ae!=null&&ae.patient.a1c_at_goal?"Yes":"No"})]})]})}),u.jsx("div",{children:u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Cv,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Benzodiazepines:"}),u.jsx("span",{className:`text-sm font-medium ${ae!=null&&ae.patient.use_benzo?"text-green-600":"text-red-600"}`,children:ae!=null&&ae.patient.use_benzo?"Yes":"No"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(xT,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Antipsychotics:"}),u.jsx("span",{className:`text-sm font-medium ${ae!=null&&ae.patient.use_antipsychotic?"text-green-600":"text-red-600"}`,children:ae!=null&&ae.patient.use_antipsychotic?"Yes":"No"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Cv,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Opioids:"}),u.jsx("span",{className:`text-sm font-medium ${ae!=null&&ae.patient.use_opioids?"text-green-600":"text-red-600"}`,children:ae!=null&&ae.patient.use_opioids?"Yes":"No"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(U2,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Fall Since Last Visit:"}),u.jsx("span",{className:`text-sm font-medium ${ae!=null&&ae.patient.fall_since_last_visit?"text-green-600":"text-red-600"}`,children:ae!=null&&ae.patient.fall_since_last_visit?"Yes":"No"})]})]})})]})]})]})})}),u.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6",children:[u.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[u.jsx(Xh,{className:"w-5 h-5 text-blue-600"}),"Activities"]}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[u.jsxs("div",{className:"flex flex-row gap-3",children:[u.jsxs("div",{className:"relative min-w-0 flex-1 w-full sm:w-32",children:[u.jsxs("select",{value:M,onChange:de=>B(de.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"all",children:"All Months"}),ye.map((de,Te)=>u.jsx("option",{value:Te+1,children:de},de))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-4 w-4 text-gray-500"})})]}),u.jsxs("div",{className:"relative min-w-0 flex-1 w-full sm:w-28",children:[u.jsxs("select",{value:K,onChange:de=>{oe(de.target.value),B("all")},className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"all",children:"All Years"}),V.map(de=>u.jsx("option",{value:de,children:de},de))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-4 w-4 text-gray-500"})})]})]}),(ae==null?void 0:ae.patient.is_active)&&u.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 border border-blue-600 rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-150 ease-in-out cursor-pointer w-full sm:w-auto whitespace-nowrap",onClick:Y,children:[u.jsx(hn,{className:"w-4 h-4 mr-2"}),"Add Activity"]})]})]}),at.length>0?u.jsx("div",{className:"overflow-x-auto ring-1 ring-gray-200 rounded-lg",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>De("activityId"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"hidden sm:inline",children:"Activity #"}),u.jsx("span",{className:"sm:hidden",children:"#"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${Q==="activityId"&&Ae==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${Q==="activityId"&&Ae==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>De("activityType"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"hidden sm:inline",children:"Activity Type"}),u.jsx("span",{className:"sm:hidden",children:"Type"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${Q==="activityType"&&Ae==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${Q==="activityType"&&Ae==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>De("initials"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Initials"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${Q==="initials"&&Ae==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${Q==="initials"&&Ae==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>De("recordDate"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"hidden sm:inline",children:"Activity Date"}),u.jsx("span",{className:"sm:hidden",children:"Date"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${Q==="recordDate"&&Ae==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${Q==="recordDate"&&Ae==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>De("totalTime"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"hidden sm:inline",children:"Total Time"}),u.jsx("span",{className:"sm:hidden",children:"Time"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${Q==="totalTime"&&Ae==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${Q==="totalTime"&&Ae==="desc"?"text-blue-600":"text-gray-300"}`})]})]})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:at.map(de=>u.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150 cursor-pointer",onClick:()=>He(de.activityId),children:[u.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm font-medium",children:u.jsx("span",{className:"text-blue-600 hover:text-blue-900 hover:underline",children:de.activityId})}),u.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900",children:u.jsx("div",{className:"truncate max-w-32 sm:max-w-none",title:de.activityType,children:de.activityType})}),u.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:de.initials}),u.jsxs("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[u.jsx("div",{className:"hidden sm:block",children:new Date(de.recordDate).toLocaleDateString()}),u.jsx("div",{className:"sm:hidden",children:new Date(de.recordDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),u.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:$e(de)})]},de.activityId))})]})}):u.jsx("div",{className:"text-center py-8 bg-gray-50 rounded-lg border border-gray-200",children:u.jsx("p",{className:"text-gray-600",children:M==="all"?"No activities found for this patient.":`No activities found for this patient in ${ye[parseInt(M)-1]} ${K==="all"?"":K}.`})})]})})]}),u.jsx(ok,{isOpen:j,onClose:()=>F(!1),patientId:t}),u.jsx(Em,{isOpen:w,onClose:()=>b(!1),onActivityAdded:ct,patientId:t,patientName:Fe}),u.jsx(Bl,{isOpen:ee,onClose:()=>W(!1),onConfirm:Ce,isDeleting:J,itemName:`patient "${m==null?void 0:m.first_name} ${m==null?void 0:m.last_name}"`})]})}const Ds=C.memo(({icon:e,label:t,value:r,startTime:n,service_endtime:s,isEditing:l=!1,onEdit:o,onStartTimeEdit:f,onEndTimeEdit:m,editOptions:h=[],editType:x="text",calculateTimeDifference:g=()=>0,placeholder:y,helperText:S,activity:w,userFullName:b})=>{const _=T=>{if(T===0)return"0:00";const N=Math.round(T*60),E=Math.floor(N/3600),j=Math.floor(N%3600/60),F=N%60;return E>0?`${E}:${j.toString().padStart(2,"0")}:${F.toString().padStart(2,"0")}`:`${j}:${F.toString().padStart(2,"0")}`};return u.jsxs("div",{className:"flex items-start space-x-3 py-3 px-2",children:[u.jsx(e,{className:"h-5 w-5 text-gray-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t}),l&&x!=="readonly"?u.jsxs("div",{className:"space-y-2 w-full",children:[x==="text"&&u.jsx("input",{type:"text",value:String(r||""),onChange:T=>o==null?void 0:o(T.target.value),placeholder:y,className:"block w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"}),x==="number"&&u.jsx("input",{type:"number",value:Number(r)||0,onChange:T=>o==null?void 0:o(parseFloat(T.target.value)||0),placeholder:y,step:"0.01",min:"0",className:"block w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"}),x==="select"&&u.jsxs("select",{value:String(r||""),onChange:T=>o==null?void 0:o(T.target.value),className:"block w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[u.jsxs("option",{value:"",children:["Select ",t]}),h==null?void 0:h.map(T=>u.jsx("option",{value:T,children:T},T))]}),x==="boolean"&&u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",checked:!!r,onChange:T=>o==null?void 0:o(T.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),u.jsx("span",{className:"ml-2 text-sm text-gray-700",children:r?"Yes":"No"})]}),x==="datetime"&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Start Time"}),u.jsx("input",{type:"datetime-local",value:n?(()=>{try{const T=new Date(n),N=T.getTimezoneOffset();return new Date(T.getTime()-N*60*1e3).toISOString().slice(0,16)}catch{return""}})():"",onChange:T=>{if(T.target.value){const N=new Date(T.target.value);N.setSeconds(0,0),f==null||f(N.toISOString())}},className:"block w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"End Time"}),u.jsx("input",{type:"datetime-local",value:s?(()=>{try{const T=new Date(s),N=T.getTimezoneOffset();return new Date(T.getTime()-N*60*1e3).toISOString().slice(0,16)}catch{return""}})():"",onChange:T=>{if(T.target.value){const N=new Date(T.target.value);N.setSeconds(0,0),m==null||m(N.toISOString())}},className:"block w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})]}):u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-sm sm:text-base text-gray-900 font-medium break-words",children:r==null?"N/A":typeof r=="number"&&t==="Total Time"||typeof r=="number"?_(r):t==="Personnel Initials"?u.jsxs("div",{className:"relative inline-block group",children:[u.jsx("span",{children:(w==null?void 0:w.user_initials)||(w==null?void 0:w.personnel_initials)||String(r).replace("0","")}),(w==null?void 0:w.user_id)&&u.jsx("div",{className:"absolute left-0 -top-2 transform -translate-y-full opacity-0 group-hover:opacity-100 transition-opacity duration-200 ease-in-out pointer-events-none z-10",children:u.jsx("div",{className:"bg-gray-800 text-white px-3 py-2 rounded-lg text-sm whitespace-nowrap shadow-lg",children:b})})]}):r}),(n||s)&&u.jsxs("div",{className:"text-xs sm:text-sm text-gray-600 space-y-1",children:[n&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(yT,{className:"h-4 w-4 flex-shrink-0"}),u.jsxs("span",{className:"truncate",children:["Start: ",new Date(n).toLocaleString()]})]}),s&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(gT,{className:"h-4 w-4 flex-shrink-0"}),u.jsxs("span",{className:"truncate",children:["End: ",new Date(s).toLocaleString()]})]})]})]}),S&&u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:S})]})]})}),mk=()=>{const{activityId:e}=mm(),t=ta(),{isPharmacist:r,isNurse:n}=Pr(),[s,l]=C.useState(!0),[o,f]=C.useState(null),[m,h]=C.useState(null),[x,g]=C.useState(null),[y,S]=C.useState(""),[w,b]=C.useState(!1),[_,T]=C.useState(!1),[N,E]=C.useState(null),[j,F]=C.useState(!1),[R,A]=C.useState([]),[P,U]=C.useState(!1),[ee,W]=C.useState(!1),[J,xe]=C.useState([]),[pe,we]=C.useState([]),[Q,ie]=C.useState("");C.useEffect(()=>{(async()=>{if(!e){f("No activity ID provided"),l(!1);return}try{l(!0),f(null);const K=await QT(e);if(Array.isArray(K)){f("Unexpected data format");return}if(h(K),E(K),K.patient_id)try{const oe=await P2(K.patient_id);g(oe),S(`${oe.first_name} ${oe.last_name}`)}catch(oe){console.error("Error fetching patient data:",oe),S("Unknown Patient")}try{const oe=await q2();A(oe)}catch(oe){console.error("Error fetching activity types:",oe)}try{const oe=await Gs();xe(oe)}catch(oe){console.error("Error fetching sites:",oe)}}catch(K){console.error("Error fetching activity data:",K),f("Failed to load activity data. Please try again.")}finally{l(!1)}})()},[e]),C.useEffect(()=>{(async()=>{if(!(!(N!=null&&N.site_name)||!J.length))try{const K=J.find(oe=>oe.name===N.site_name);if(K){const oe=await Vu(K.id);we(oe)}}catch(K){console.error("Error fetching buildings:",K)}})()},[N==null?void 0:N.site_name,J]);const Ae=()=>{const B=window.scrollY;T(!0),setTimeout(()=>{window.scrollTo({top:B,behavior:"auto"})},0)},re=()=>{T(!1),E(m)},z=()=>{if(!N)return 0;const B=N.service_datetime||N.created_at,K=N.service_endtime;if(B&&K){const oe=new Date(B),ae=(new Date(K).getTime()-oe.getTime())/(1e3*60);return Math.max(0,Number(ae.toFixed(2)))}return N.time_spent!==void 0&&typeof N.time_spent=="number"?N.time_spent:N.duration_minutes!==void 0&&typeof N.duration_minutes=="number"?N.duration_minutes:0},te=async()=>{if(!(!e||!N)){F(!0);try{let B=0;const K=N.service_datetime||N.created_at,oe=N.service_endtime;if(K&&oe){const He=new Date(K),ct=new Date(oe).getTime()-He.getTime();B=Math.max(0,Number((ct/(1e3*60)).toFixed(2)))}else{const He=Number(N.time_spent),Y=Number(N.duration_minutes),ct=Number(m==null?void 0:m.time_spent),$e=Number(m==null?void 0:m.duration_minutes);!isNaN(He)&&He>0?B=He:!isNaN(Y)&&Y>0?B=Y:!isNaN(ct)&&ct>0?B=ct:!isNaN($e)&&$e>0&&(B=$e)}const ye=B>0?B:.01,_e={patient_id:N.patient_id,user_id:N.user_id,activity_type:N.activity_type,pharm_flag:!!(N.pharm_flag||N.is_pharmacist),notes:N.notes||"",site_name:N.site_name||"",building:N.building||N.building_name||"",service_datetime:N.service_datetime||N.created_at||new Date().toISOString(),service_endtime:N.service_endtime||new Date().toISOString(),duration_minutes:Number(ye.toFixed(2))};console.log("Updating activity with data:",_e);const ae=await ek(e,_e);h(ae),E(ae),T(!1)}catch(B){console.error("Error updating activity:",B),alert("Failed to update activity. Please try again.")}finally{F(!1)}}},D=(B,K)=>{N&&E(oe=>{if(!oe)return oe;const ye={...oe,[B]:K};if(B==="service_datetime"||B==="service_endtime"){const _e=B==="service_datetime"?K:ye.service_datetime||ye.created_at,ae=B==="service_endtime"?K:ye.service_endtime;if(_e&&ae){const He=new Date(_e);new Date(ae)<He?ie("Warning: End time is before start time."):ie("")}else ie("")}if(B==="service_datetime"||B==="created_at"||B==="service_endtime"){const _e=B==="service_datetime"||B==="created_at"?K:ye.service_datetime||ye.created_at,ae=B==="service_endtime"?K:ye.service_endtime;if(_e&&ae){const He=new Date(_e),ct=new Date(ae).getTime()-He.getTime(),$e=Math.max(0,Number((ct/(1e3*60)).toFixed(2)));ye.time_spent=$e,ye.duration_minutes=$e}}return ye})},V=async()=>{if(!(!e||!m))try{b(!0),await tk(e),m.patient_id?t(`/patientdetails/${m.patient_id}`):t("/patients")}catch(B){console.error("Error deleting activity:",B),alert("Failed to delete activity. Please try again."),b(!1)}},M=()=>{m&&m.patient_id?t(`/patientdetails/${m.patient_id}`):t("/patients")};return s?u.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading activity data..."})]})}):o||!m||!N?u.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md text-center max-w-md",children:[u.jsx("div",{className:"text-red-600 mb-4 text-5xl",children:"!"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Activity"}),u.jsx("p",{className:"text-gray-600 mb-4",children:o||"Activity data not found"}),u.jsx("button",{onClick:()=>t("/patients"),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Return to Patients List"})]})}):u.jsxs("div",{className:"min-h-screen bg-gray-100 py-4 sm:py-8",children:[u.jsx(Bl,{isOpen:ee,onClose:()=>W(!1),onConfirm:V,isDeleting:w,itemName:`Activity #${e}`}),u.jsx("div",{className:"max-w-5xl mx-auto px-4",children:u.jsxs("div",{className:"bg-white shadow rounded-lg",children:[u.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-5 border-b border-gray-200",children:u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[u.jsx("button",{onClick:M,className:"p-1.5 rounded-full text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer flex-shrink-0",title:"Back",children:u.jsx(Wc,{className:"h-5 w-5"})}),u.jsxs("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:["Activity #",e," Details"]})]}),u.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 sm:ml-auto",children:_?u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",onClick:te,disabled:j||!!Q,className:`inline-flex items-center justify-center px-4 sm:px-6 py-2 sm:py-2.5 rounded-lg text-sm sm:text-base font-medium shadow-sm transition-all w-full sm:w-auto ${j||Q?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:j?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):"Save Changes"}),u.jsxs("button",{onClick:re,className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 cursor-pointer w-full sm:w-auto",children:[u.jsx(Ja,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):!n&&!r?u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:Ae,className:"inline-flex items-center justify-center px-4 py-2 border border-blue-600 rounded-md shadow-sm text-sm font-medium text-blue-600 bg-white hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-150 ease-in-out cursor-pointer w-full sm:w-auto",children:[u.jsx(Ll,{className:"w-4 h-4 mr-2"}),"Edit Activity"]}),u.jsxs("button",{onClick:()=>W(!0),disabled:w,className:`inline-flex items-center justify-center px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium w-full sm:w-auto ${w?"text-gray-400 cursor-not-allowed":"text-red-700 hover:bg-red-50 cursor-pointer"} bg-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500`,children:[u.jsx(bT,{className:"h-4 w-4 mr-2"}),"Delete"]})]}):null})]})}),u.jsxs("div",{className:"p-4 sm:p-6",children:[u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-6",children:[u.jsx(Ds,{icon:io,label:"Date and Time of Service",value:"",startTime:(()=>{const B=N.service_datetime||N.created_at;return B?typeof B=="string"?B:B.toISOString():""})(),service_endtime:N.service_endtime?String(N.service_endtime):"",isEditing:_,editType:"datetime",onStartTimeEdit:B=>{D("service_datetime",B)},onEndTimeEdit:B=>D("service_endtime",B),calculateTimeDifference:z}),u.jsx(Ds,{icon:lo,label:"Patient Name",value:y||"Unknown Patient",isEditing:_,editType:"readonly",calculateTimeDifference:z}),u.jsx(Ds,{icon:bi,label:"Site Name",value:N.site_name||"CP Greater San Antonio",startTime:N.site_start_time,service_endtime:N.site_end_time,isEditing:_,editType:"readonly",calculateTimeDifference:z}),u.jsx(Ds,{icon:bi,label:"Building",value:N.building||N.building_name||"Main Medical Center",isEditing:_,editType:"readonly",calculateTimeDifference:z}),u.jsx(Ds,{icon:xu,label:"Personnel Initials",value:N.personnel_initials||N.user_initials||"Unknown",startTime:N.personnel_start_time,service_endtime:N.personnel_end_time,isEditing:!1,editType:"readonly",onStartTimeEdit:B=>D("personnel_start_time",B),onEndTimeEdit:B=>D("personnel_end_time",B),activity:m,userFullName:N.user_initials||"Unknown"}),u.jsx(Ds,{icon:$h,label:"Activity Type",value:N.activity_type||"",startTime:N.activity_start_time,service_endtime:N.activity_end_time,isEditing:_,editType:"select",editOptions:R,onEdit:B=>D("activity_type",B),onStartTimeEdit:B=>D("activity_start_time",B),onEndTimeEdit:B=>D("activity_end_time",B),calculateTimeDifference:z}),u.jsx(Ds,{icon:io,label:"Total Time",value:Number(N.duration_minutes||N.time_spent||0),isEditing:_,editType:"readonly",calculateTimeDifference:z}),u.jsx(Ds,{icon:$h,label:"Notes",value:N.notes||"",startTime:N.notes_start_time,service_endtime:N.notes_end_time,isEditing:_,editType:"text",onEdit:B=>D("notes",B),onStartTimeEdit:B=>D("notes_start_time",B),onEndTimeEdit:B=>D("notes_end_time",B),calculateTimeDifference:z})]}),Q&&u.jsx("div",{className:"text-red-600 text-sm font-medium mb-2 px-2",children:Q})]})]})})]})},xk=async()=>{var e,t;try{return(await Ve.get(`${kt}/users`)).data}catch(r){if(console.error("Error fetching users:",r),Ve.isAxiosError(r)){if((t=(e=r.response)==null?void 0:e.data)!=null&&t.message)throw new Error(r.response.data.message);if(r.request)throw new Error("No response from server")}throw new Error("Failed to fetch users")}},pk=async e=>{var t,r;try{return(await Ve.post(`${kt}/users`,e)).data}catch(n){if(console.error("Error creating user:",n),Ve.isAxiosError(n)){if((r=(t=n.response)==null?void 0:t.data)!=null&&r.message)throw new Error(n.response.data.message);if(n.request)throw new Error("No response from server")}throw new Error("Failed to create user")}},gk=async(e,t)=>{var r,n;try{return(await Ve.put(`${kt}/users/${e}`,t)).data}catch(s){if(console.error(`Error updating user with ID ${e}:`,s),Ve.isAxiosError(s)){if((n=(r=s.response)==null?void 0:r.data)!=null&&n.message)throw new Error(s.response.data.message);if(s.request)throw new Error("No response from server")}throw new Error("Failed to update user")}},K2=async e=>{var t,r;try{await Ve.delete(`${kt}/users/${e}`)}catch(n){if(console.error(`Error deleting user with ID ${e}:`,n),Ve.isAxiosError(n)){if((r=(t=n.response)==null?void 0:t.data)!=null&&r.message)throw new Error(n.response.data.message);if(n.request)throw new Error("No response from server")}throw new Error("Failed to delete user")}},qh=async e=>{try{return(await Ve.get(`${kt}/users/site/${e}`)).data}catch(t){throw console.error(`Error fetching users for site ID ${e}:`,t),t}},Z2=({isOpen:e,onClose:t,onUserAdded:r,defaultPrimarySite:n,defaultPrimarySiteId:s})=>{const l={firstName:"",lastName:"",email:"",password:"",confirmPassword:"",role:"nurse",primarySiteId:s?s.toString():"",assignedSiteIds:s?[s.toString()]:[]},[o,f]=C.useState(l),[m,h]=C.useState([]),[x,g]=C.useState(!1),[y,S]=C.useState(!1),[w,b]=C.useState(null),[_,T]=C.useState(null),N=C.useRef(e);C.useEffect(()=>{N.current&&!e&&(f(l),b(null),S(!1)),e&&!N.current&&E(),N.current=e},[e,n,s]);const E=async()=>{g(!0),T(null);try{const A=ka.getCurrentUser(),ee=(ka.isAdmin()?await H2():await Gs()).filter(W=>W.is_active);if(h(ee),s)f(W=>({...W,primarySiteId:s.toString(),assignedSiteIds:[s.toString()]}));else if(n){const W=ee.find(J=>J.name===n);W&&f(J=>({...J,primarySiteId:W.id.toString(),assignedSiteIds:[W.id.toString()]}))}}catch(A){T("Failed to load sites. Please try again."),console.error("Error loading sites:",A)}finally{g(!1)}};C.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]);const j=async A=>{if(A.preventDefault(),S(!0),b(null),o.password!==o.confirmPassword){b("Oops! Your passwords do not match. Please try again."),S(!1);return}try{const P={first_name:o.firstName,last_name:o.lastName,email:o.email,password:o.password,role:o.role,primarysite_id:parseInt(o.primarySiteId),assignedsites_ids:o.assignedSiteIds.map(U=>parseInt(U))};await pk(P),r&&r(),t()}catch(P){console.error("Failed to create user:",P),b(P instanceof Error?P.message:"Failed to create user. Please try again."),S(!1)}},F=A=>{const{name:P,value:U}=A.target;f(ee=>{if(P==="primarySiteId"){let W=[...ee.assignedSiteIds];return ee.primarySiteId&&(W=W.filter(J=>J!==ee.primarySiteId)),U&&W.push(U),{...ee,[P]:U,assignedSiteIds:W}}return{...ee,[P]:U}})},R=A=>{f(P=>{let U=P.assignedSiteIds.includes(A)?P.assignedSiteIds.filter(ee=>ee!==A):[...P.assignedSiteIds,A];return A===P.primarySiteId&&!U.includes(A)?{...P,primarySiteId:"",assignedSiteIds:U}:{...P,assignedSiteIds:U}})};return e?u.jsx("div",{className:"fixed inset-0 backdrop-blur-[2px] bg-gray-500/30 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-4 sm:p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New User"}),u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Add a new user account to the system"})]}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500 transition-colors cursor-pointer",children:u.jsx(Ja,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:j,className:"space-y-4",children:[w&&u.jsx("div",{className:"p-3 rounded-lg bg-red-50 border border-red-200",children:u.jsx("p",{className:"text-sm text-red-600",children:w})}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"First Name"}),u.jsx("input",{type:"text",name:"firstName",value:o.firstName,onChange:F,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0,placeholder:"John"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),u.jsx("input",{type:"text",name:"lastName",value:o.lastName,onChange:F,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0,placeholder:"Doe"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),u.jsx("input",{type:"email",name:"email",value:o.email,onChange:F,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0,placeholder:"user@example.com"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Password"}),u.jsx("input",{type:"password",name:"password",value:o.password,onChange:F,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),u.jsx("input",{type:"password",name:"confirmPassword",value:o.confirmPassword,onChange:F,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Primary Site"}),u.jsxs("select",{name:"primarySiteId",value:o.primarySiteId,onChange:F,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200 cursor-pointer appearance-none",required:!0,disabled:x,children:[u.jsx("option",{value:"",children:"Select a primary site"}),m.map(A=>u.jsx("option",{value:A.id,children:A.name},A.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Assigned Sites"}),u.jsx("div",{className:"border border-gray-300 rounded-lg h-[180px] overflow-y-auto",children:x?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):_?u.jsxs("div",{className:"p-4 text-center",children:[u.jsx("p",{className:"text-red-500 text-sm mb-2",children:_}),u.jsx("button",{onClick:E,className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"Try Again"})]}):u.jsx("div",{className:"p-2 space-y-1",children:m.map(A=>u.jsxs("label",{className:"flex items-center px-2 py-1.5 hover:bg-gray-50 rounded cursor-pointer text-sm",children:[u.jsx("input",{type:"checkbox",checked:o.assignedSiteIds.includes(A.id.toString()),onChange:()=>R(A.id.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-1"}),u.jsx("span",{className:"ml-2 text-gray-700",children:A.name})]},A.id))})}),u.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Selected: ",o.assignedSiteIds.length," sites"]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Role"}),u.jsxs("select",{name:"role",value:o.role,onChange:F,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200 cursor-pointer appearance-none",required:!0,children:[u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"pharmacist",children:"Pharmacist"}),u.jsx("option",{value:"nurse",children:"Nurse"})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:t,disabled:y,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center min-w-[100px]",children:y?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Creating..."]}):"Create User"})]})]})]})})}):null},Q2=({isOpen:e,onClose:t,onUserUpdated:r,user:n})=>{const s={firstName:"",lastName:"",email:"",role:"nurse",primarySiteId:"",assignedSiteIds:[],newPassword:"",confirmPassword:""},[l,o]=C.useState(s),[f,m]=C.useState([]),[h,x]=C.useState(!1),[g,y]=C.useState(!1),[S,w]=C.useState(null),[b,_]=C.useState(null),T=C.useRef(e);C.useEffect(()=>{T.current&&!e&&(o(s),w(null),y(!1),m([]),_(null)),T.current=e},[e]),C.useEffect(()=>{n&&e&&(o({firstName:n.firstName||"",lastName:n.lastName||"",email:n.email,role:n.role,primarySiteId:"",assignedSiteIds:[],newPassword:"",confirmPassword:""}),w(null),y(!1),N())},[n,e]);const N=async()=>{x(!0),_(null);try{const R=ka.getCurrentUser(),U=(ka.isAdmin()?await H2():await Gs()).filter(ee=>ee.is_active);if(m(U),n){const ee=U.find(J=>J.name===n.primarySite),W=U.filter(J=>{var xe;return(xe=n.assignedSites)==null?void 0:xe.includes(J.name)});o(J=>({...J,primarySiteId:ee?ee.id.toString():"",assignedSiteIds:W.map(xe=>xe.id.toString())}))}}catch(R){_("Failed to load sites. Please try again."),console.error("Error loading sites:",R)}finally{x(!1)}};C.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]);const E=async R=>{if(R.preventDefault(),!!(n!=null&&n.id)){y(!0),w(null);try{if(l.newPassword||l.confirmPassword){if(!l.newPassword){w("Current password is required to change password"),y(!1);return}if(l.newPassword!==l.confirmPassword){w("New password and confirm password do not match"),y(!1);return}if(l.newPassword.length<6){w("New password must be at least 6 characters long"),y(!1);return}}const A={first_name:l.firstName,last_name:l.lastName,email:l.email,role:l.role,primarysite_id:parseInt(l.primarySiteId),assignedsites_ids:l.assignedSiteIds.map(P=>parseInt(P))};l.newPassword&&(A.new_password=l.newPassword),await gk(n.id,A),r&&r(),t()}catch(A){console.error("Failed to update user:",A),w(A instanceof Error?A.message:"Failed to update user. Please try again."),y(!1)}}},j=R=>{const{name:A,value:P}=R.target;o(U=>{if(A==="primarySiteId"){let ee=[...U.assignedSiteIds];return U.primarySiteId&&(ee=ee.filter(W=>W!==U.primarySiteId)),P&&ee.push(P),{...U,[A]:P,assignedSiteIds:ee}}return{...U,[A]:P}})},F=R=>{o(A=>{let P=A.assignedSiteIds.includes(R)?A.assignedSiteIds.filter(U=>U!==R):[...A.assignedSiteIds,R];return R===A.primarySiteId&&!P.includes(R)?{...A,primarySiteId:"",assignedSiteIds:P}:{...A,assignedSiteIds:P}})};return e?u.jsx("div",{className:"fixed inset-0 backdrop-blur-[2px] bg-gray-500/30 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-4 sm:p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit User"}),u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Update user information"})]}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500 transition-colors cursor-pointer",children:u.jsx(Ja,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:E,className:"space-y-4",children:[S&&u.jsx("div",{className:"p-3 rounded-lg bg-red-50 border border-red-200",children:u.jsx("p",{className:"text-sm text-red-600",children:S})}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"First Name"}),u.jsx("input",{type:"text",name:"firstName",value:l.firstName,onChange:j,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0,placeholder:"John"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),u.jsx("input",{type:"text",name:"lastName",value:l.lastName,onChange:j,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0,placeholder:"Doe"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),u.jsx("input",{type:"email",name:"email",value:l.email,onChange:j,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0,placeholder:"user@example.com"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"New Password"}),u.jsx("input",{type:"password",name:"newPassword",value:l.newPassword,onChange:j,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",placeholder:""}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to keep current password"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),u.jsx("input",{type:"password",name:"confirmPassword",value:l.confirmPassword,onChange:j,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",placeholder:""})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Primary Site"}),u.jsxs("select",{name:"primarySiteId",value:l.primarySiteId,onChange:j,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200 cursor-pointer appearance-none",required:!0,disabled:h,children:[u.jsx("option",{value:"",children:"Select a primary site"}),f.map(R=>u.jsx("option",{value:R.id,children:R.name},R.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Assigned Sites"}),u.jsx("div",{className:"border border-gray-300 rounded-lg h-[180px] overflow-y-auto",children:h?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):b?u.jsxs("div",{className:"p-4 text-center",children:[u.jsx("p",{className:"text-red-500 text-sm mb-2",children:b}),u.jsx("button",{onClick:N,className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"Try Again"})]}):u.jsx("div",{className:"p-2 space-y-1",children:f.map(R=>u.jsxs("label",{className:"flex items-center px-2 py-1.5 hover:bg-gray-50 rounded cursor-pointer text-sm",children:[u.jsx("input",{type:"checkbox",checked:l.assignedSiteIds.includes(R.id.toString()),onChange:()=>F(R.id.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-1"}),u.jsx("span",{className:"ml-2 text-gray-700",children:R.name})]},R.id))})}),u.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Selected: ",l.assignedSiteIds.length," sites"]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Role"}),u.jsxs("select",{name:"role",value:l.role,onChange:j,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200 cursor-pointer appearance-none",required:!0,children:[u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"pharmacist",children:"Pharmacist"}),u.jsx("option",{value:"nurse",children:"Nurse"})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:t,disabled:g,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:g,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center min-w-[100px]",children:g?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Updating..."]}):"Update User"})]})]})]})})}):null};function vk(){ta();const{user:e}=Pr(),[t,r]=C.useState(!1),[n,s]=C.useState(!1),[l,o]=C.useState(null),[f,m]=C.useState(!1),[h,x]=C.useState(null),[g,y]=C.useState(!1),[S,w]=C.useState(!0),[b,_]=C.useState(null),[T,N]=C.useState([]),[E,j]=C.useState(""),[F,R]=C.useState("all"),[A,P]=C.useState("name"),[U,ee]=C.useState("asc");C.useEffect(()=>{W()},[]);const W=async()=>{try{w(!0);const D=(await xk()).map(V=>({...V,isActive:!0}));N(D)}catch(te){_("Failed to fetch users"),console.error("Error fetching users:",te)}finally{w(!1)}},J=te=>{A===te?ee(U==="asc"?"desc":"asc"):(P(te),ee("asc"))},xe=T.filter(te=>{const D=te.email.toLowerCase().includes(E.toLowerCase())||te.name.toLowerCase().includes(E.toLowerCase()),V=F==="all"||te.role===F;return D&&V}).sort((te,D)=>{const V=e&&te.email===e.email,M=e&&D.email===e.email;if(V&&!M)return-1;if(!V&&M)return 1;let B,K;switch(A){case"name":B=te.name,K=D.name;break;case"email":B=te.email,K=D.email;break;case"role":B=te.role,K=D.role;break;case"primarysite":B=te.primary_site||"",K=D.primary_site||"";break;default:B=te.name,K=D.name}return typeof B=="string"&&typeof K=="string"&&(B=B.toLowerCase(),K=K.toLowerCase()),B<K?U==="asc"?-1:1:B>K?U==="asc"?1:-1:0}),pe=te=>e&&te.email===e.email,we=te=>{const D=T.find(V=>V.id===te);if(D&&D.id){const V=D.name.split(" "),M=V[0]||"",B=V.slice(1).join(" ")||"";o({id:D.id.toString(),email:D.email,firstName:M,lastName:B,role:D.role,primarySite:D.primary_site,assignedSites:D.assigned_sites}),s(!0)}},Q=()=>{W()},ie=te=>{const D=T.find(V=>V.id===te);D&&(x(D),m(!0))},Ae=async()=>{if(h!=null&&h.id){y(!0);try{await K2(h.id),N(T.filter(te=>te.id!==h.id)),m(!1)}catch(te){console.error("Error deleting user:",te),te instanceof Error?_(`Failed to delete user: ${te.message}`):_("Failed to delete user. Please try again.")}finally{y(!1),x(null)}}},re=()=>{r(!0)},z=()=>{W(),r(!1)};return S?u.jsx("div",{className:"h-[calc(100vh-4rem)] bg-gradient-to-b from-gray-50 to-gray-100 flex flex-col",children:u.jsxs("div",{className:"flex-1 flex flex-col px-4 py-6 max-w-7xl mx-auto w-full overflow-hidden",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-0 mb-4 flex-shrink-0",children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"User Management"}),u.jsxs("button",{onClick:re,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors whitespace-nowrap cursor-pointer w-full sm:w-auto",children:[u.jsx(hn,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-4 flex-shrink-0",children:u.jsx("div",{className:"flex flex-col space-y-3",children:u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[u.jsxs("div",{className:"relative w-full md:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(ts,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search...",value:E,onChange:te=>j(te.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),u.jsxs("div",{className:"relative w-full md:w-48",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Role"}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:F,onChange:te=>R(te.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"all",children:"All Roles"}),u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"nurse",children:"Nurse"}),u.jsx("option",{value:"pharmacist",children:"Pharmacist"})]})})]})]})})}),u.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8 flex justify-center items-center max-h-[60vh]",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),u.jsx("div",{className:"text-gray-500",children:"Loading users data..."})]})})]})}):u.jsxs("div",{className:"h-[calc(100vh-4rem)] bg-gradient-to-b from-gray-50 to-gray-100 flex flex-col",children:[u.jsxs("div",{className:"flex-1 flex flex-col px-4 py-6 max-w-7xl mx-auto w-full overflow-hidden",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-0 mb-4 flex-shrink-0",children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"User Management"}),u.jsxs("button",{onClick:re,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors whitespace-nowrap cursor-pointer w-full sm:w-auto",children:[u.jsx(hn,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-4 flex-shrink-0",children:u.jsx("div",{className:"flex flex-col space-y-3",children:u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[u.jsxs("div",{className:"relative w-full md:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(ts,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search...",value:E,onChange:te=>j(te.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),u.jsxs("div",{className:"relative w-full md:w-48",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Role"}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:F,onChange:te=>R(te.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"all",children:"All Roles"}),u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"nurse",children:"Nurse"}),u.jsx("option",{value:"pharmacist",children:"Pharmacist"})]})})]})]})})}),b&&u.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-lg p-4 mb-4 flex-shrink-0",children:[u.jsx("p",{children:b}),u.jsx("button",{onClick:W,className:"mt-2 text-red-600 hover:text-red-800 underline",children:"Try again"})]}),!b&&u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 flex flex-col max-h-[60vh] min-h-0",children:[u.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:u.jsxs("table",{className:"min-w-full",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>J("name"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Name"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${A==="name"&&U==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${A==="name"&&U==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>J("email"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Email"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${A==="email"&&U==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${A==="email"&&U==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>J("role"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Role"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${A==="role"&&U==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${A==="role"&&U==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>J("primarysite"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Primary Site"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${A==="primarysite"&&U==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${A==="primarysite"&&U==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[xe.map(te=>u.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${pe(te)?"bg-blue-50":""}`,children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(lo,{className:"h-5 w-5 text-gray-400 mr-2"}),u.jsx("span",{children:te.name}),pe(te)&&u.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"You"})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:te.email}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.jsx("div",{className:"flex items-center",children:u.jsx("span",{className:"capitalize",children:te.role})})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:te.primary_site||"Not assigned"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{onClick:()=>we(te.id),className:"text-blue-600 hover:text-blue-900 transition-colors cursor-pointer",title:"Edit user",children:u.jsx(Ll,{className:"h-4 w-4"})}),!pe(te)&&u.jsx("button",{onClick:()=>ie(te.id),className:"text-red-600 hover:text-red-900 transition-colors cursor-pointer",title:"Delete user",children:u.jsx(ko,{className:"h-4 w-4"})})]})})]},te.id)),xe.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No users found matching your filters"})})]})]})}),u.jsxs("div",{className:"flex-shrink-0 bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200",children:[u.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[u.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),u.jsx("button",{className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",u.jsx("span",{className:"font-medium",children:xe.length})," of"," ",u.jsx("span",{className:"font-medium",children:xe.length})," results"]})}),u.jsx("div",{children:u.jsx("p",{className:"text-xs text-gray-500",children:"Scroll to view more users"})})]})]})]})]}),u.jsx(Z2,{isOpen:t,onClose:()=>r(!1),onUserAdded:z}),u.jsx(Q2,{isOpen:n,onClose:()=>s(!1),onUserUpdated:Q,user:l}),u.jsx(Bl,{isOpen:f,onClose:()=>m(!1),onConfirm:Ae,isDeleting:g,itemName:h?h.name:"user"})]})}let yk={data:""},wk=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||yk,bk=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,_k=/\/\*[^]*?\*\/|  +/g,Iv=/\n+/g,Ms=(e,t)=>{let r="",n="",s="";for(let l in e){let o=e[l];l[0]=="@"?l[1]=="i"?r=l+" "+o+";":n+=l[1]=="f"?Ms(o,l):l+"{"+Ms(o,l[1]=="k"?"":t)+"}":typeof o=="object"?n+=Ms(o,t?t.replace(/([^,])+/g,f=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,m=>/&/.test(m)?m.replace(/&/g,f):f?f+" "+m:m)):l):o!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Ms.p?Ms.p(l,o):l+":"+o+";")}return r+(t&&s?t+"{"+s+"}":s)+n},Wn={},J2=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+J2(e[r]);return t}return e},Sk=(e,t,r,n,s)=>{let l=J2(e),o=Wn[l]||(Wn[l]=(m=>{let h=0,x=11;for(;h<m.length;)x=101*x+m.charCodeAt(h++)>>>0;return"go"+x})(l));if(!Wn[o]){let m=l!==e?e:(h=>{let x,g,y=[{}];for(;x=bk.exec(h.replace(_k,""));)x[4]?y.shift():x[3]?(g=x[3].replace(Iv," ").trim(),y.unshift(y[0][g]=y[0][g]||{})):y[0][x[1]]=x[2].replace(Iv," ").trim();return y[0]})(e);Wn[o]=Ms(s?{["@keyframes "+o]:m}:m,r?"":"."+o)}let f=r&&Wn.g?Wn.g:null;return r&&(Wn.g=Wn[o]),((m,h,x,g)=>{g?h.data=h.data.replace(g,m):h.data.indexOf(m)===-1&&(h.data=x?m+h.data:h.data+m)})(Wn[o],t,n,f),o},Nk=(e,t,r)=>e.reduce((n,s,l)=>{let o=t[l];if(o&&o.call){let f=o(r),m=f&&f.props&&f.props.className||/^go/.test(f)&&f;o=m?"."+m:f&&typeof f=="object"?f.props?"":Ms(f,""):f===!1?"":f}return n+s+(o??"")},"");function Gu(e){let t=this||{},r=e.call?e(t.p):e;return Sk(r.unshift?r.raw?Nk(r,[].slice.call(arguments,1),t.p):r.reduce((n,s)=>Object.assign(n,s&&s.call?s(t.p):s),{}):r,wk(t.target),t.g,t.o,t.k)}let ew,Wh,Kh;Gu.bind({g:1});let rs=Gu.bind({k:1});function Ek(e,t,r,n){Ms.p=t,ew=e,Wh=r,Kh=n}function Xs(e,t){let r=this||{};return function(){let n=arguments;function s(l,o){let f=Object.assign({},l),m=f.className||s.className;r.p=Object.assign({theme:Wh&&Wh()},f),r.o=/ *go\d+/.test(m),f.className=Gu.apply(r,n)+(m?" "+m:"");let h=e;return e[0]&&(h=f.as||e,delete f.as),Kh&&h[0]&&Kh(f),ew(h,f)}return s}}var Tk=e=>typeof e=="function",Zh=(e,t)=>Tk(e)?e(t):e,kk=(()=>{let e=0;return()=>(++e).toString()})(),Ak=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),Ck=20,tw=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,Ck)};case 1:return{...e,toasts:e.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:r}=t;return tw(e,{type:e.toasts.find(l=>l.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(l=>l.id===n||n===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let s=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+s}))}}},jk=[],_h={toasts:[],pausedAt:void 0},Tm=e=>{_h=tw(_h,e),jk.forEach(t=>{t(_h)})},Fk=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||kk()}),Co=e=>(t,r)=>{let n=Fk(t,e,r);return Tm({type:2,toast:n}),n.id},pa=(e,t)=>Co("blank")(e,t);pa.error=Co("error");pa.success=Co("success");pa.loading=Co("loading");pa.custom=Co("custom");pa.dismiss=e=>{Tm({type:3,toastId:e})};pa.remove=e=>Tm({type:4,toastId:e});pa.promise=(e,t,r)=>{let n=pa.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let l=t.success?Zh(t.success,s):void 0;return l?pa.success(l,{id:n,...r,...r==null?void 0:r.success}):pa.dismiss(n),s}).catch(s=>{let l=t.error?Zh(t.error,s):void 0;l?pa.error(l,{id:n,...r,...r==null?void 0:r.error}):pa.dismiss(n)}),e};var Rk=rs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Dk=rs`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ok=rs`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Mk=Xs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Rk} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Dk} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Ok} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Lk=rs`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Bk=Xs("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${Lk} 1s linear infinite;
`,Uk=rs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Ik=rs`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Pk=Xs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Uk} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Ik} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,zk=Xs("div")`
  position: absolute;
`,Hk=Xs("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Vk=rs`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Gk=Xs("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Vk} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Xk=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?C.createElement(Gk,null,t):t:r==="blank"?null:C.createElement(Hk,null,C.createElement(Bk,{...n}),r!=="loading"&&C.createElement(zk,null,r==="error"?C.createElement(Mk,{...n}):C.createElement(Pk,{...n})))},$k=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Yk=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,qk="0%{opacity:0;} 100%{opacity:1;}",Wk="0%{opacity:1;} 100%{opacity:0;}",Kk=Xs("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Zk=Xs("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Qk=(e,t)=>{let r=e.includes("top")?1:-1,[n,s]=Ak()?[qk,Wk]:[$k(r),Yk(r)];return{animation:t?`${rs(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${rs(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};C.memo(({toast:e,position:t,style:r,children:n})=>{let s=e.height?Qk(e.position||t||"top-center",e.visible):{opacity:0},l=C.createElement(Xk,{toast:e}),o=C.createElement(Zk,{...e.ariaProps},Zh(e.message,e));return C.createElement(Kk,{className:e.className,style:{...s,...r,...e.style}},typeof n=="function"?n({icon:l,message:o}):C.createElement(C.Fragment,null,l,o))});Ek(C.createElement);Gu`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;const Jk=e=>e.charAt(0).toUpperCase()+e.slice(1),Pv=({isOpen:e,onClose:t,onSiteAdded:r})=>{const[n,s]=C.useState(!1),l=C.useRef(e),o={name:"",address:"",city:"",state:"",zip:""},[f,m]=C.useState(o);C.useEffect(()=>{l.current&&!e&&(m(o),s(!1)),l.current=e},[e]);const h=g=>{const{name:y,value:S}=g.target;let w=S;y==="name"||y==="city"?w=Jk(S):y==="state"&&(w=S.toUpperCase()),m(b=>({...b,[y]:w}))},x=async g=>{g.preventDefault(),s(!0);try{const y={...f,is_active:!0};await RT(y),pa.success("Site created successfully"),r(),t()}catch(y){console.error("Error creating site:",y),pa.error("Failed to create site")}finally{s(!1)}};return e?u.jsx("div",{className:"fixed inset-0 backdrop-blur-[2px] bg-gray-500/30 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-4 sm:p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:"Add New Site"}),u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Please fill in all the required information to create a new site."})]}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500 transition-colors cursor-pointer",children:u.jsx(Ja,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:x,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Site Name"}),u.jsx("input",{name:"name",type:"text",value:f.name,onChange:h,required:!0,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",placeholder:"Enter site name"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Address"}),u.jsx("input",{name:"address",type:"text",value:f.address,onChange:h,required:!0,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",placeholder:"Enter street address"})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"City"}),u.jsx("input",{name:"city",type:"text",value:f.city,onChange:h,required:!0,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",placeholder:"Enter city"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"State"}),u.jsx("input",{name:"state",type:"text",value:f.state,onChange:h,required:!0,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",placeholder:"Enter state"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"ZIP Code"}),u.jsx("input",{name:"zip",type:"text",value:f.zip,onChange:h,required:!0,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",placeholder:"Enter ZIP code"})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:t,disabled:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center min-w-[100px]",children:n?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Creating..."]}):"Create Site"})]})]})]})})}):null},e6=()=>{const e=ta(),[t,r]=C.useState([]),[n,s]=C.useState(!0),[l,o]=C.useState(!1),[f,m]=C.useState(""),[h,x]=C.useState("name"),[g,y]=C.useState("asc"),[S,w]=C.useState(!1),b=async()=>{try{const F=await Gs();r(F)}catch(F){console.error("Error fetching sites:",F)}finally{s(!1)}};C.useEffect(()=>{b()},[]);const _=F=>{e(`/sites/${F}`)},T=F=>F.charAt(0).toUpperCase()+F.slice(1),E=[...t.filter(F=>{const R=F.name.toLowerCase().includes(f.toLowerCase())||F.address.toLowerCase().includes(f.toLowerCase())||F.city.toLowerCase().includes(f.toLowerCase())||F.state.toLowerCase().includes(f.toLowerCase())||F.zip.toLowerCase().includes(f.toLowerCase()),A=S||F.is_active;return R&&A})].sort((F,R)=>{let A=F[h],P=R[h];return typeof A=="boolean"&&(A=A?"1":"0"),typeof P=="boolean"&&(P=P?"1":"0"),A===void 0&&(A=""),P===void 0&&(P=""),typeof A=="string"&&typeof P=="string"&&(A=A.toLowerCase(),P=P.toLowerCase()),A<P?g==="asc"?-1:1:A>P?g==="asc"?1:-1:0}),j=F=>{h===F?y(g==="asc"?"desc":"asc"):(x(F),y("asc"))};return n?u.jsx("div",{className:"h-[calc(100vh-4rem)] bg-gradient-to-b from-gray-50 to-gray-100 flex flex-col",children:u.jsxs("div",{className:"flex-1 flex flex-col px-4 py-6 max-w-7xl mx-auto w-full overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sites"}),u.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors whitespace-nowrap cursor-pointer",children:[u.jsx(hn,{className:"h-4 w-4 mr-2"}),"Add Site"]})]}),u.jsx(Pv,{isOpen:l,onClose:()=>o(!1),onSiteAdded:b}),u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-4 flex-shrink-0",children:u.jsx("div",{className:"flex flex-col space-y-3",children:u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[u.jsxs("div",{className:"relative w-full md:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(ts,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search...",value:f,onChange:F=>m(F.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),u.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:S,onChange:()=>w(!S),className:"sr-only peer"}),u.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"}),u.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:"Show Inactive Sites"})]})]})})}),u.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8 flex justify-center items-center max-h-[60vh]",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),u.jsx("div",{className:"text-gray-500",children:"Loading sites data..."})]})})]})}):u.jsx("div",{className:"h-[calc(100vh-4rem)] bg-gradient-to-b from-gray-50 to-gray-100 flex flex-col",children:u.jsxs("div",{className:"flex-1 flex flex-col px-4 py-6 max-w-7xl mx-auto w-full overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sites"}),u.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors whitespace-nowrap cursor-pointer",children:[u.jsx(hn,{className:"h-4 w-4 mr-2"}),"Add Site"]})]}),u.jsx(Pv,{isOpen:l,onClose:()=>o(!1),onSiteAdded:b}),u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-4 flex-shrink-0",children:u.jsx("div",{className:"flex flex-col space-y-3",children:u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[u.jsxs("div",{className:"relative w-full md:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(ts,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search...",value:f,onChange:F=>m(F.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),u.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:S,onChange:()=>w(!S),className:"sr-only peer"}),u.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"}),u.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:"Show Inactive Sites"})]})]})})}),u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 flex flex-col max-h-[60vh] min-h-0",children:[u.jsx("div",{className:"flex-1 overflow-auto min-h-0 table-container",children:u.jsxs("table",{className:"min-w-full",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("name"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Name"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${h==="name"&&g==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${h==="name"&&g==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("address"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Address"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${h==="address"&&g==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${h==="address"&&g==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("city"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"City"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${h==="city"&&g==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${h==="city"&&g==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("state"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"State"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${h==="state"&&g==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${h==="state"&&g==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("zip"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"ZIP"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${h==="zip"&&g==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${h==="zip"&&g==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("is_active"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Status"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${h==="is_active"&&g==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${h==="is_active"&&g==="desc"?"text-blue-600":"text-gray-300"}`})]})]})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.length>0?E.map(F=>u.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>_(F.id),children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600 hover:text-blue-900 hover:underline",children:T(F.name)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F.address}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F.city}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F.state}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F.zip}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${F.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:F.is_active?"Active":"Inactive"})})]},F.id)):u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No sites found"})})})]})}),u.jsxs("div",{className:"flex-shrink-0 bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200",children:[u.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[u.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),u.jsx("button",{className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",u.jsx("span",{className:"font-medium",children:E.length})," of"," ",u.jsx("span",{className:"font-medium",children:E.length})," results"]})}),u.jsx("div",{children:u.jsx("p",{className:"text-xs text-gray-500",children:"Scroll to view more sites"})})]})]})]})]})})},t6=["All","1","2","3","4","5","6","7","8","9","10","11","12"],r6=["All","January","February","March","April","May","June","July","August","September","October","November","December"],a6=()=>{const e=ta(),[t,r]=C.useState(""),[n,s]=C.useState("All"),[l,o]=C.useState("All"),[f,m]=C.useState([]),h=new Date,[x,g]=C.useState("All"),[y,S]=C.useState("All"),[w,b]=C.useState("id"),[_,T]=C.useState("desc"),[N,E]=C.useState(!1),[j,F]=C.useState([]),[R,A]=C.useState(!0),[P,U]=C.useState(null),ee=C.useMemo(()=>{const M=j.map(K=>{const oe=K.service_datetime||K.created_at;if(!oe)return null;const ye=new Date(oe).getFullYear();return isNaN(ye)?null:ye}).filter(K=>K!==null),B=Array.from(new Set(M)).sort((K,oe)=>K-oe);return B.length===0&&B.push(h.getFullYear()),B},[j]),W=M=>{if(!M)return 0;const B=new Date(M);return isNaN(B.getTime())?0:B.getTime()},J=async()=>{try{const M=await Nm();m(M)}catch(M){console.error("Error fetching sites and buildings:",M)}},xe=C.useMemo(()=>f.map(M=>M.site_name),[f]),pe=C.useMemo(()=>{if(n==="All"){const M=f.flatMap(B=>B.building_names).filter(Boolean);return[...new Set(M)]}else{const M=f.find(B=>B.site_name===n);return M?M.building_names:[]}},[f,n]);C.useEffect(()=>{o("All")},[n]);const we=async()=>{try{A(!0);const M=await Y2();F(M),U(null)}catch(M){console.error("Error fetching activities:",M),U("Failed to load activities")}finally{A(!1)}};C.useEffect(()=>{we()},[]),C.useEffect(()=>{J()},[]);const Q=M=>{if(!M)return"N/A";const B=typeof M=="string"?new Date(M):M;return isNaN(B.getTime())?"N/A":B.toLocaleDateString()},ie=M=>{const B=M.time_spent,K=M.duration_minutes;let oe=0;if(B!=null&&!isNaN(Number(B)))oe=Number(B);else if(K!=null&&!isNaN(Number(K)))oe=Number(K);else return"N/A";if(oe===0)return"0:00";const ye=Math.round(oe*60),_e=Math.floor(ye/3600),ae=Math.floor(ye%3600/60),He=ye%60;return _e>0?`${_e}:${ae.toString().padStart(2,"0")}:${He.toString().padStart(2,"0")}`:`${ae}:${He.toString().padStart(2,"0")}`},re=[...j.filter(M=>{var Y;const B=((Y=M.patient_name)==null?void 0:Y.toLowerCase().includes(t.toLowerCase()))||!1||String(M.id).includes(t),K=n==="All"||M.site_name===n,oe=l==="All"||M.building===l||M.building_name===l,ye=M.service_datetime||M.created_at;if(!ye)return B&&K&&oe;const _e=new Date(ye);if(isNaN(_e.getTime()))return B&&K&&oe;const ae=x==="All"||_e.getMonth()+1===Number(x),He=y==="All"||_e.getFullYear()===Number(y);return B&&K&&oe&&ae&&He})].sort((M,B)=>{let K=M[w],oe=B[w];return(w==="service_datetime"||w==="created_at")&&(K=W(M.service_datetime||M.created_at),oe=W(B.service_datetime||B.created_at)),typeof K=="boolean"&&(K=K?"1":"0"),typeof oe=="boolean"&&(oe=oe?"1":"0"),K===void 0&&(K=""),oe===void 0&&(oe=""),typeof K=="string"&&typeof oe=="string"&&(K=K.toLowerCase(),oe=oe.toLowerCase()),K<oe?_==="asc"?-1:1:K>oe?_==="asc"?1:-1:0}),z=M=>{w===M?T(_==="asc"?"desc":"asc"):(b(M),T("asc"))},te=async()=>{await we()},D=M=>{e(`/activity/${M}`)},V=M=>{e(`/patientdetails/${M}`)};return u.jsxs("div",{className:"h-[calc(100vh-4rem)] bg-gradient-to-b from-gray-50 to-gray-100 flex flex-col",children:[u.jsxs("div",{className:"flex-1 flex flex-col px-4 py-6 max-w-7xl mx-auto w-full overflow-hidden",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-0 mb-4 flex-shrink-0",children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Medical Activities"}),u.jsxs("button",{onClick:()=>E(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors whitespace-nowrap cursor-pointer w-full sm:w-auto",children:[u.jsx(hn,{className:"h-4 w-4 mr-2"}),"Add Activity"]})]}),u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-4 flex-shrink-0",children:u.jsxs("div",{className:"flex flex-col space-y-3",children:[u.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:u.jsxs("div",{className:"relative w-full md:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(ts,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search...",value:t,onChange:M=>r(M.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Site"}),u.jsxs("div",{className:"relative",children:[u.jsxs("select",{value:n,onChange:M=>s(M.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"All",children:"All Sites"}),xe.map(M=>u.jsx("option",{value:M,children:M},M))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-3 w-3 text-gray-500"})})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Building"}),u.jsxs("div",{className:"relative",children:[u.jsxs("select",{value:l,onChange:M=>o(M.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"All",children:"All Buildings"}),pe.map(M=>u.jsx("option",{value:M,children:M},M))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-3 w-3 text-gray-500"})})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Month"}),u.jsxs("div",{className:"relative",children:[u.jsxs("select",{value:x,onChange:M=>g(M.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"All",children:"All Months"}),t6.slice(1).map((M,B)=>u.jsx("option",{value:M,children:r6[B+1]},M))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-3 w-3 text-gray-500"})})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Year"}),u.jsxs("div",{className:"relative",children:[u.jsxs("select",{value:y,onChange:M=>S(M.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"All",children:"All Years"}),ee.map(M=>u.jsx("option",{value:M.toString(),children:M},M))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-3 w-3 text-gray-500"})})]})]})]})]})}),P&&u.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-lg p-4 mb-4 flex-shrink-0",children:[u.jsx("p",{children:P}),u.jsx("button",{onClick:we,className:"mt-2 text-red-600 hover:text-red-800 underline",children:"Try again"})]}),R&&u.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8 flex justify-center items-center max-h-[60vh]",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),u.jsx("div",{className:"text-gray-500",children:"Loading activities data..."})]})}),!R&&!P&&u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 flex flex-col max-h-[60vh] min-h-0",children:[u.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>z("id"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Activity #"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${w==="id"&&_==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${w==="id"&&_==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>z("patient_name"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Patient Name"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${w==="patient_name"&&_==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${w==="patient_name"&&_==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>z("activity_type"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Activity Type"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${w==="activity_type"&&_==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${w==="activity_type"&&_==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>z("user_initials"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Initials"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${w==="user_initials"&&_==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${w==="user_initials"&&_==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>z("service_datetime"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Record Date"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${w==="service_datetime"&&_==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${w==="service_datetime"&&_==="desc"?"text-blue-600":"text-gray-300"}`})]})]})}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>z("duration_minutes"),children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:"Total Time"}),u.jsxs("div",{className:"ml-1 flex",children:[u.jsx(Zt,{className:`h-3 w-3 ${w==="duration_minutes"&&_==="asc"?"text-blue-600":"text-gray-300"}`}),u.jsx(Kt,{className:`h-3 w-3 ${w==="duration_minutes"&&_==="desc"?"text-blue-600":"text-gray-300"}`})]})]})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:re.map(M=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:u.jsx("button",{onClick:()=>D(M.id),className:"inline-flex items-center px-2 py-1 rounded text-blue-600 hover:text-blue-900 hover:underline transition-colors duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer",children:M.id})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:u.jsx("button",{onClick:B=>{B.stopPropagation(),V(M.patient_id)},className:"inline-flex items-center px-2 py-1 rounded text-blue-600 hover:text-blue-900 hover:underline transition-colors duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer",children:M.patient_name})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:M.activity_type}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:M.user_initials||"N/A"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Q(M.service_datetime)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ie(M)})]},M.id))})]})}),u.jsxs("div",{className:"flex-shrink-0 bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200",children:[u.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[u.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),u.jsx("button",{className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",u.jsx("span",{className:"font-medium",children:re.length})," of"," ",u.jsx("span",{className:"font-medium",children:re.length})," results"]})}),u.jsx("div",{children:u.jsx("p",{className:"text-xs text-gray-500",children:"Scroll to view more activities"})})]})]})]})]}),u.jsx(Em,{isOpen:N,onClose:()=>E(!1),onActivityAdded:te,siteName:n==="All"?f.length>1?f[1].site_name:"CP Greater San Antonio":n})]})},Xu=()=>u.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-80 backdrop-blur-sm flex items-center justify-center z-50",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"}),u.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var co={};co.version="0.18.5";var Fa=1200,_i=1252,n6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],km={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$u=function(e){n6.indexOf(e)!=-1&&(_i=km[0]=e)};function s6(){$u(1252)}var Za=function(e){Fa=e,$u(e)};function Yu(){Za(1200),s6()}function yu(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function i6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function rw(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var bl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?i6(e.slice(2)):t==254&&r==255?rw(e.slice(2)):t==65279?e.slice(1):e},$c=function(t){return String.fromCharCode(t)},Qh=function(t){return String.fromCharCode(t)},Et;function l6(e){Et=e,Za=function(t){Fa=t,$u(t)},bl=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?Et.utils.decode(1200,yu(t.slice(2))):t},$c=function(r){return Fa===1200?String.fromCharCode(r):Et.utils.decode(Fa,[r&255,r>>8])[0]},Qh=function(r){return Et.utils.decode(_i,[r])[0]},Fw()}var Ls="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function oo(e){for(var t="",r=0,n=0,s=0,l=0,o=0,f=0,m=0,h=0;h<e.length;)r=e.charCodeAt(h++),l=r>>2,n=e.charCodeAt(h++),o=(r&3)<<4|n>>4,s=e.charCodeAt(h++),f=(n&15)<<2|s>>6,m=s&63,isNaN(n)?f=m=64:isNaN(s)&&(m=64),t+=Ls.charAt(l)+Ls.charAt(o)+Ls.charAt(f)+Ls.charAt(m);return t}function Ra(e){var t="",r=0,n=0,s=0,l=0,o=0,f=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)l=Ls.indexOf(e.charAt(h++)),o=Ls.indexOf(e.charAt(h++)),r=l<<2|o>>4,t+=String.fromCharCode(r),f=Ls.indexOf(e.charAt(h++)),n=(o&15)<<4|f>>2,f!==64&&(t+=String.fromCharCode(n)),m=Ls.indexOf(e.charAt(h++)),s=(f&3)<<6|m,m!==64&&(t+=String.fromCharCode(s));return t}var gt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ns=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ps(e){return gt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function zv(e){return gt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ca=function(t){return gt?ns(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function jo(e){if(typeof ArrayBuffer>"u")return Ca(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function $s(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function c6(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Am(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Am(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Fr=gt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ns(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function o6(e){for(var t=[],r=0,n=e.length+250,s=Ps(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var f=e.charCodeAt(++l)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|f>>6&15|(o&3)<<4,s[r++]=128|f&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Ps(65535),n=65530)}return t.push(s.slice(0,r)),Fr(t)}var Qr=/\u0000/g,Yc=/[\u0001-\u0006]/g;function Sl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function on(e,t){var r=""+e;return r.length>=t?r:lr("0",t-r.length)+r}function Cm(e,t){var r=""+e;return r.length>=t?r:lr(" ",t-r.length)+r}function wu(e,t){var r=""+e;return r.length>=t?r:r+lr(" ",t-r.length)}function u6(e,t){var r=""+Math.round(e);return r.length>=t?r:lr("0",t-r.length)+r}function f6(e,t){var r=""+e;return r.length>=t?r:lr("0",t-r.length)+r}var Hv=Math.pow(2,32);function gl(e,t){if(e>Hv||e<-Hv)return u6(e,t);var r=Math.round(e);return f6(r,t)}function bu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Vv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function d6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Gv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},h6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _u(e,t,r){for(var n=e<0?-1:1,s=e*n,l=0,o=1,f=0,m=1,h=0,x=0,g=Math.floor(s);h<t&&(g=Math.floor(s),f=g*o+l,x=g*h+m,!(s-g<5e-8));)s=1/(s-g),l=o,o=f,m=h,h=x;if(x>t&&(h>t?(x=m,f=l):(x=h,f=o)),!r)return[0,n*f,x];var y=Math.floor(n*f/x);return[y,n*f-y*x,x]}function Bs(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),l=0,o=[],f={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),t&&t.date1904&&(n+=1462),f.u>.9999&&(f.u=0,++s==86400&&(f.T=s=0,++n,++f.D)),n===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),o=[m.getFullYear(),m.getMonth()+1,m.getDate()],l=m.getDay(),n<60&&(l=(l+6)%7),r&&(l=y6(m,o))}return f.y=o[0],f.m=o[1],f.d=o[2],f.S=s%60,s=Math.floor(s/60),f.M=s%60,s=Math.floor(s/60),f.H=s,f.q=l,f}var aw=new Date(1899,11,31,0,0,0),m6=aw.getTime(),x6=new Date(1900,2,1,0,0,0);function nw(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=x6&&(r+=24*60*60*1e3),(r-(m6+(e.getTimezoneOffset()-aw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function jm(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function p6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function g6(e){var t=e<0?12:11,r=jm(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function v6(e){var t=jm(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function uo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=g6(e):t===10?r=e.toFixed(10).substr(0,12):r=v6(e),jm(p6(r.toUpperCase()))}function Si(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):uo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Da(14,nw(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function y6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function w6(e,t,r,n){var s="",l=0,o=0,f=r.y,m,h=0;switch(e){case 98:f=r.y+543;case 121:switch(t.length){case 1:case 2:m=f%100,h=2;break;default:m=f%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:m=r.m,h=t.length;break;case 3:return Sh[r.m-1][1];case 5:return Sh[r.m-1][0];default:return Sh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:m=r.d,h=t.length;break;case 3:return Vv[r.q][0];default:return Vv[r.q][1]}break;case 104:switch(t.length){case 1:case 2:m=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:m=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:m=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?on(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(s=on(l,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":m=r.D*24+r.H;break;case"[m]":case"[mm]":m=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":m=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:m=f,h=1;break}var x=h>0?on(m,h):"";return x}function Us(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var sw=/%/g;function b6(e,t,r){var n=t.replace(sw,""),s=t.length-n.length;return Qn(e,n,r*Math.pow(10,2*s))+lr("%",s)}function _6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Qn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function iw(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+iw(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(n+1+(s+l)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,m,h,x){return m+h+x.substr(0,(s+l)%s)+"."+x.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var lw=/# (\?+)( ?)\/( ?)(\d+)/;function S6(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),l=Math.floor(s/n),o=s-l*n,f=n;return r+(l===0?"":""+l)+" "+(o===0?lr(" ",e[1].length+1+e[4].length):Cm(o,e[1].length)+e[2]+"/"+e[3]+on(f,e[4].length))}function N6(e,t,r){return r+(t===0?"":""+t)+lr(" ",e[1].length+2+e[4].length)}var cw=/^#*0*\.([0#]+)/,ow=/\).*[0#]/,uw=/\(###\) ###\\?-####/;function na(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Xv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function $v(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function E6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function T6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function $a(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ow)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$a("n",n,r):"("+$a("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return _6(e,t,r);if(t.indexOf("%")!==-1)return b6(e,t,r);if(t.indexOf("E")!==-1)return iw(t,r);if(t.charCodeAt(0)===36)return"$"+$a(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,o,f,m=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+gl(m,t.length);if(t.match(/^[#?]+$/))return s=gl(r,0),s==="0"&&(s=""),s.length>t.length?s:na(t.substr(0,t.length-s.length))+s;if(l=t.match(lw))return S6(l,m,h);if(t.match(/^#+0+$/))return h+gl(m,t.length-t.indexOf("0"));if(l=t.match(cw))return s=Xv(r,l[1].length).replace(/^([^\.]+)$/,"$1."+na(l[1])).replace(/\.$/,"."+na(l[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+lr("0",na(l[1]).length-b.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return h+Xv(m,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return h+Us(gl(m,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$a(e,t,-r):Us(""+(Math.floor(r)+E6(r,l[1].length)))+"."+on($v(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return $a(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Sl($a(e,t.replace(/[\\-]/g,""),r)),o=0,Sl(Sl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<s.length?s.charAt(o++):w==="0"?"0":""}));if(t.match(uw))return s=$a(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var x="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),f=_u(m,Math.pow(10,o)-1,!1),s=""+h,x=Qn("n",l[1],f[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),s+=x+l[2]+"/"+l[3],x=wu(f[2],o),x.length<l[4].length&&(x=na(l[4].substr(l[4].length-x.length))+x),s+=x,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),f=_u(m,Math.pow(10,o)-1,!0),h+(f[0]||(f[1]?"":"0"))+" "+(f[1]?Cm(f[1],o)+l[2]+"/"+l[3]+wu(f[2],o):lr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=gl(r,0),t.length<=s.length?s:na(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=t.indexOf(".")-o,y=t.length-s.length-g;return na(t.substr(0,g)+s+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=$v(r,l[1].length),r<0?"-"+$a(e,t,-r):Us(T6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?on(0,3-w.length):"")+w})+"."+on(o,l[1].length);switch(t){case"###,##0.00":return $a(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var S=Us(gl(m,0));return S!=="0"?h+S:"";case"###,###.00":return $a(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return $a(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function k6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Qn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function A6(e,t,r){var n=t.replace(sw,""),s=t.length-n.length;return Qn(e,n,r*Math.pow(10,2*s))+lr("%",s)}function fw(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+fw(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(n+1+(s+l)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,m,h,x){return m+h+x.substr(0,(s+l)%s)+"."+x.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Tn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ow)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Tn("n",n,r):"("+Tn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return k6(e,t,r);if(t.indexOf("%")!==-1)return A6(e,t,r);if(t.indexOf("E")!==-1)return fw(t,r);if(t.charCodeAt(0)===36)return"$"+Tn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,o,f,m=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+on(m,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:na(t.substr(0,t.length-s.length))+s;if(l=t.match(lw))return N6(l,m,h);if(t.match(/^#+0+$/))return h+on(m,t.length-t.indexOf("0"));if(l=t.match(cw))return s=(""+r).replace(/^([^\.]+)$/,"$1."+na(l[1])).replace(/\.$/,"."+na(l[1])),s=s.replace(/\.(\d*)$/,function(w,b){return"."+b+lr("0",na(l[1]).length-b.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return h+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return h+Us(""+m);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Tn(e,t,-r):Us(""+r)+"."+lr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return Tn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Sl(Tn(e,t.replace(/[\\-]/g,""),r)),o=0,Sl(Sl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<s.length?s.charAt(o++):w==="0"?"0":""}));if(t.match(uw))return s=Tn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var x="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),f=_u(m,Math.pow(10,o)-1,!1),s=""+h,x=Qn("n",l[1],f[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),s+=x+l[2]+"/"+l[3],x=wu(f[2],o),x.length<l[4].length&&(x=na(l[4].substr(l[4].length-x.length))+x),s+=x,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),f=_u(m,Math.pow(10,o)-1,!0),h+(f[0]||(f[1]?"":"0"))+" "+(f[1]?Cm(f[1],o)+l[2]+"/"+l[3]+wu(f[2],o):lr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:na(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=t.indexOf(".")-o,y=t.length-s.length-g;return na(t.substr(0,g)+s+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Tn(e,t,-r):Us(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?on(0,3-w.length):"")+w})+"."+on(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var S=Us(""+m);return S!=="0"?h+S:"";default:if(t.match(/\.[0#?]*$/))return Tn(e,t.slice(0,t.lastIndexOf(".")),r)+na(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Qn(e,t,r){return(r|0)===r?Tn(e,t,r):$a(e,t,r)}function C6(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var dw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ji(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":bu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(dw))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function j6(e,t,r,n){for(var s=[],l="",o=0,f="",m="t",h,x,g,y="H";o<e.length;)switch(f=e.charAt(o)){case"G":if(!bu(e,o))throw new Error("unrecognized character "+f+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(g=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(g);s[s.length]={t:"t",v:l},++o;break;case"\\":var S=e.charAt(++o),w=S==="("||S===")"?S:"t";s[s.length]={t:w,v:S},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(h==null&&(h=Bs(t,r,e.charAt(o+1)==="2"),h==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},m=f,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=Bs(t,r),h==null))return"";for(l=f;++o<e.length&&e.charAt(o).toLowerCase()===f;)l+=f;f==="m"&&m.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=y),s[s.length]={t:f,v:l},m=f;break;case"A":case"a":case"":var b={t:f,v:f};if(h==null&&(h=Bs(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(b.v=h.H>=12?"P":"A"),b.t="T",y="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(b.v=h.H>=12?"PM":"AM"),b.t="T",o+=5,y="h"):e.substr(o,5).toUpperCase()==="/"?(h!=null&&(b.v=h.H>=12?"":""),b.t="T",o+=5,y="h"):(b.t="t",++o),h==null&&b.t==="T")return"";s[s.length]=b,m=f;break;case"[":for(l=f;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(dw)){if(h==null&&(h=Bs(t,r),h==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},m=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",ji(e)||(s[s.length]={t:"t",v:l}));break;case".":if(h!=null){for(l=f;++o<e.length&&(f=e.charAt(o))==="0";)l+=f;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=f;++o<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(o))>-1;)l+=f;s[s.length]={t:"n",v:l};break;case"?":for(l=f;e.charAt(++o)===f;)l+=f;s[s.length]={t:f,v:l},m=f;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":f,v:f},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=f;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:f,v:f},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+e);s[s.length]={t:"t",v:f},++o;break}var _=0,T=0,N;for(o=s.length-1,m="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=y,m="h",_<1&&(_=1);break;case"s":(N=s[o].v.match(/\.0+$/))&&(T=Math.max(T,N[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":m=s[o].t;break;case"m":m==="s"&&(s[o].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&s[o].v.match(/[Hh]/)&&(_=1),_<2&&s[o].v.match(/[Mm]/)&&(_=2),_<3&&s[o].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var E="",j;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=w6(s[o].t.charCodeAt(0),s[o].v,h,T),s[o].t="t";break;case"n":case"?":for(j=o+1;s[j]!=null&&((f=s[j].t)==="?"||f==="D"||(f===" "||f==="t")&&s[j+1]!=null&&(s[j+1].t==="?"||s[j+1].t==="t"&&s[j+1].v==="/")||s[o].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(s[j].v==="/"||s[j].v===" "&&s[j+1]!=null&&s[j+1].t=="?"));)s[o].v+=s[j].v,s[j]={v:"",t:";"},++j;E+=s[o].v,o=j-1;break;case"G":s[o].t="t",s[o].v=Si(t,r);break}var F="",R,A;if(E.length>0){E.charCodeAt(0)==40?(R=t<0&&E.charCodeAt(0)===45?-t:t,A=Qn("n",E,R)):(R=t<0&&n>1?-t:t,A=Qn("n",E,R),R<0&&s[0]&&s[0].t=="t"&&(A=A.substr(1),s[0].v="-"+s[0].v)),j=A.length-1;var P=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){P=o;break}var U=s.length;if(P===s.length&&A.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(j>=s[o].v.length-1?(j-=s[o].v.length,s[o].v=A.substr(j+1,s[o].v.length)):j<0?s[o].v="":(s[o].v=A.substr(0,j+1),j=-1),s[o].t="t",U=o);j>=0&&U<s.length&&(s[U].v=A.substr(0,j+1)+s[U].v)}else if(P!==s.length&&A.indexOf("E")===-1){for(j=A.indexOf(".")-1,o=P;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(x=s[o].v.indexOf(".")>-1&&o===P?s[o].v.indexOf(".")-1:s[o].v.length-1,F=s[o].v.substr(x+1);x>=0;--x)j>=0&&(s[o].v.charAt(x)==="0"||s[o].v.charAt(x)==="#")&&(F=A.charAt(j--)+F);s[o].v=F,s[o].t="t",U=o}for(j>=0&&U<s.length&&(s[U].v=A.substr(0,j+1)+s[U].v),j=A.indexOf(".")+1,o=P;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==P)){for(x=s[o].v.indexOf(".")>-1&&o===P?s[o].v.indexOf(".")+1:0,F=s[o].v.substr(0,x);x<s[o].v.length;++x)j<A.length&&(F+=A.charAt(j++));s[o].v=F,s[o].t="t",U=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(R=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=Qn(s[o].t,s[o].v,R),s[o].t="t");var ee="";for(o=0;o!==s.length;++o)s[o]!=null&&(ee+=s[o].v);return ee}var Yv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function qv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function F6(e,t){var r=C6(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Yv),f=r[1].match(Yv);return qv(t,o)?[n,r[0]]:qv(t,f)?[n,r[1]]:[n,r[o!=null&&f!=null?2:1]]}return[n,l]}function Da(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ze)[e],n==null&&(n=r.table&&r.table[Gv[e]]||Ze[Gv[e]]),n==null&&(n=h6[e]||"General");break}if(bu(n,0))return Si(t,r);t instanceof Date&&(t=nw(t,r.date1904));var s=F6(n,t);if(bu(s[1]))return Si(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return j6(s[1],t,r,s[0])}function jn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ze[r]==null){t<0&&(t=r);continue}if(Ze[r]==e){t=r;break}}t<0&&(t=391)}return Ze[t]=e,t}function Fo(e){for(var t=0;t!=392;++t)e[t]!==void 0&&jn(e[t],t)}function Ul(){Ze=d6()}var hw={format:Da,load:jn,_table:Ze,load_table:Fo,parse_date_code:Bs,is_date:ji,get_table:function(){return hw._table=Ze}},R6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},mw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function D6(e){var t=typeof e=="number"?Ze[e]:e;return t=t.replace(mw,"(\\d+)"),new RegExp("^"+t+"$")}function O6(e,t,r){var n=-1,s=-1,l=-1,o=-1,f=-1,m=-1;(t.match(mw)||[]).forEach(function(g,y){var S=parseInt(r[y+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=S;break;case"d":l=S;break;case"h":o=S;break;case"s":m=S;break;case"m":o>=0?f=S:s=S;break}}),m>=0&&f==-1&&s>=0&&(f=s,s=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var x=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return o==-1&&f==-1&&m==-1?h:n==-1&&s==-1&&l==-1?x:h+"T"+x}var M6=function(){var e={};e.version="1.2.0";function t(){for(var A=0,P=new Array(256),U=0;U!=256;++U)A=U,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,P[U]=A;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(A){var P=0,U=0,ee=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ee=0;ee!=256;++ee)W[ee]=A[ee];for(ee=0;ee!=256;++ee)for(U=A[ee],P=256+ee;P<4096;P+=256)U=W[P]=U>>>8^A[U&255];var J=[];for(ee=1;ee!=16;++ee)J[ee-1]=typeof Int32Array<"u"?W.subarray(ee*256,ee*256+256):W.slice(ee*256,ee*256+256);return J}var s=n(r),l=s[0],o=s[1],f=s[2],m=s[3],h=s[4],x=s[5],g=s[6],y=s[7],S=s[8],w=s[9],b=s[10],_=s[11],T=s[12],N=s[13],E=s[14];function j(A,P){for(var U=P^-1,ee=0,W=A.length;ee<W;)U=U>>>8^r[(U^A.charCodeAt(ee++))&255];return~U}function F(A,P){for(var U=P^-1,ee=A.length-15,W=0;W<ee;)U=E[A[W++]^U&255]^N[A[W++]^U>>8&255]^T[A[W++]^U>>16&255]^_[A[W++]^U>>>24]^b[A[W++]]^w[A[W++]]^S[A[W++]]^y[A[W++]]^g[A[W++]]^x[A[W++]]^h[A[W++]]^m[A[W++]]^f[A[W++]]^o[A[W++]]^l[A[W++]]^r[A[W++]];for(ee+=15;W<ee;)U=U>>>8^r[(U^A[W++])&255];return~U}function R(A,P){for(var U=P^-1,ee=0,W=A.length,J=0,xe=0;ee<W;)J=A.charCodeAt(ee++),J<128?U=U>>>8^r[(U^J)&255]:J<2048?(U=U>>>8^r[(U^(192|J>>6&31))&255],U=U>>>8^r[(U^(128|J&63))&255]):J>=55296&&J<57344?(J=(J&1023)+64,xe=A.charCodeAt(ee++)&1023,U=U>>>8^r[(U^(240|J>>8&7))&255],U=U>>>8^r[(U^(128|J>>2&63))&255],U=U>>>8^r[(U^(128|xe>>6&15|(J&3)<<4))&255],U=U>>>8^r[(U^(128|xe&63))&255]):(U=U>>>8^r[(U^(224|J>>12&15))&255],U=U>>>8^r[(U^(128|J>>6&63))&255],U=U>>>8^r[(U^(128|J&63))&255]);return~U}return e.table=r,e.bstr=j,e.buf=F,e.str=R,e}(),We=function(){var t={};t.version="1.2.1";function r(O,X){for(var I=O.split("/"),H=X.split("/"),G=0,q=0,fe=Math.min(I.length,H.length);G<fe;++G){if(q=I[G].length-H[G].length)return q;if(I[G]!=H[G])return I[G]<H[G]?-1:1}return I.length-H.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var X=O.lastIndexOf("/");return X===-1?O:O.slice(0,X+1)}function s(O){if(O.charAt(O.length-1)=="/")return s(O.slice(0,-1));var X=O.lastIndexOf("/");return X===-1?O:O.slice(X+1)}function l(O,X){typeof X=="string"&&(X=new Date(X));var I=X.getHours();I=I<<6|X.getMinutes(),I=I<<5|X.getSeconds()>>>1,O.write_shift(2,I);var H=X.getFullYear()-1980;H=H<<4|X.getMonth()+1,H=H<<5|X.getDate(),O.write_shift(2,H)}function o(O){var X=O.read_shift(2)&65535,I=O.read_shift(2)&65535,H=new Date,G=I&31;I>>>=5;var q=I&15;I>>>=4,H.setMilliseconds(0),H.setFullYear(I+1980),H.setMonth(q-1),H.setDate(G);var fe=X&31;X>>>=5;var Se=X&63;return X>>>=6,H.setHours(X),H.setMinutes(Se),H.setSeconds(fe<<1),H}function f(O){Ur(O,0);for(var X={},I=0;O.l<=O.length-4;){var H=O.read_shift(2),G=O.read_shift(2),q=O.l+G,fe={};switch(H){case 21589:I=O.read_shift(1),I&1&&(fe.mtime=O.read_shift(4)),G>5&&(I&2&&(fe.atime=O.read_shift(4)),I&4&&(fe.ctime=O.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3));break}O.l=q,X[H]=fe}return X}var m;function h(){return m||(m={})}function x(O,X){if(O[0]==80&&O[1]==75)return tn(O,X);if((O[0]|32)==109&&(O[1]|32)==105)return nf(O,X);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var I=3,H=512,G=0,q=0,fe=0,Se=0,le=0,he=[],ge=O.slice(0,512);Ur(ge,0);var Oe=g(ge);switch(I=Oe[0],I){case 3:H=512;break;case 4:H=4096;break;case 0:if(Oe[1]==0)return tn(O,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}H!==512&&(ge=O.slice(0,H),Ur(ge,28));var Be=O.slice(0,H);y(ge,I);var ze=ge.read_shift(4,"i");if(I===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);ge.l+=4,fe=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),Se=ge.read_shift(4,"i"),G=ge.read_shift(4,"i"),le=ge.read_shift(4,"i"),q=ge.read_shift(4,"i");for(var Le=-1,Pe=0;Pe<109&&(Le=ge.read_shift(4,"i"),!(Le<0));++Pe)he[Pe]=Le;var ot=S(O,H);_(le,q,ot,H,he);var It=N(ot,fe,he,H);It[fe].name="!Directory",G>0&&Se!==xe&&(It[Se].name="!MiniFAT"),It[he[0]].name="!FAT",It.fat_addrs=he,It.ssz=H;var Pt={},qt=[],On=[],os=[];E(fe,It,ot,qt,G,Pt,On,Se),w(On,os,qt),qt.shift();var Ma={FileIndex:On,FullPaths:os};return X&&X.raw&&(Ma.raw={header:Be,sectors:ot}),Ma}function g(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(pe,"Header Signature: "),O.l+=16;var X=O.read_shift(2,"u");return[O.read_shift(2,"u"),X]}function y(O,X){var I=9;switch(O.l+=2,I=O.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function S(O,X){for(var I=Math.ceil(O.length/X)-1,H=[],G=1;G<I;++G)H[G-1]=O.slice(G*X,(G+1)*X);return H[I-1]=O.slice(I*X),H}function w(O,X,I){for(var H=0,G=0,q=0,fe=0,Se=0,le=I.length,he=[],ge=[];H<le;++H)he[H]=ge[H]=H,X[H]=I[H];for(;Se<ge.length;++Se)H=ge[Se],G=O[H].L,q=O[H].R,fe=O[H].C,he[H]===H&&(G!==-1&&he[G]!==G&&(he[H]=he[G]),q!==-1&&he[q]!==q&&(he[H]=he[q])),fe!==-1&&(he[fe]=H),G!==-1&&H!=he[H]&&(he[G]=he[H],ge.lastIndexOf(G)<Se&&ge.push(G)),q!==-1&&H!=he[H]&&(he[q]=he[H],ge.lastIndexOf(q)<Se&&ge.push(q));for(H=1;H<le;++H)he[H]===H&&(q!==-1&&he[q]!==q?he[H]=he[q]:G!==-1&&he[G]!==G&&(he[H]=he[G]));for(H=1;H<le;++H)if(O[H].type!==0){if(Se=H,Se!=he[Se])do Se=he[Se],X[H]=X[Se]+"/"+X[H];while(Se!==0&&he[Se]!==-1&&Se!=he[Se]);he[H]=-1}for(X[0]+="/",H=1;H<le;++H)O[H].type!==2&&(X[H]+="/")}function b(O,X,I){for(var H=O.start,G=O.size,q=[],fe=H;I&&G>0&&fe>=0;)q.push(X.slice(fe*J,fe*J+J)),G-=J,fe=di(I,fe*4);return q.length===0?Ne(0):Fr(q).slice(0,O.size)}function _(O,X,I,H,G){var q=xe;if(O===xe){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var fe=I[O],Se=(H>>>2)-1;if(!fe)return;for(var le=0;le<Se&&(q=di(fe,le*4))!==xe;++le)G.push(q);_(di(fe,H-4),X-1,I,H,G)}}function T(O,X,I,H,G){var q=[],fe=[];G||(G=[]);var Se=H-1,le=0,he=0;for(le=X;le>=0;){G[le]=!0,q[q.length]=le,fe.push(O[le]);var ge=I[Math.floor(le*4/H)];if(he=le*4&Se,H<4+he)throw new Error("FAT boundary crossed: "+le+" 4 "+H);if(!O[ge])break;le=di(O[ge],he)}return{nodes:q,data:iy([fe])}}function N(O,X,I,H){var G=O.length,q=[],fe=[],Se=[],le=[],he=H-1,ge=0,Oe=0,Be=0,ze=0;for(ge=0;ge<G;++ge)if(Se=[],Be=ge+X,Be>=G&&(Be-=G),!fe[Be]){le=[];var Le=[];for(Oe=Be;Oe>=0;){Le[Oe]=!0,fe[Oe]=!0,Se[Se.length]=Oe,le.push(O[Oe]);var Pe=I[Math.floor(Oe*4/H)];if(ze=Oe*4&he,H<4+ze)throw new Error("FAT boundary crossed: "+Oe+" 4 "+H);if(!O[Pe]||(Oe=di(O[Pe],ze),Le[Oe]))break}q[Be]={nodes:Se,data:iy([le])}}return q}function E(O,X,I,H,G,q,fe,Se){for(var le=0,he=H.length?2:0,ge=X[O].data,Oe=0,Be=0,ze;Oe<ge.length;Oe+=128){var Le=ge.slice(Oe,Oe+128);Ur(Le,64),Be=Le.read_shift(2),ze=Zu(Le,0,Be-he),H.push(ze);var Pe={name:ze,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},ot=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);ot!==0&&(Pe.ct=j(Le,Le.l-8));var It=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);It!==0&&(Pe.mt=j(Le,Le.l-8)),Pe.start=Le.read_shift(4,"i"),Pe.size=Le.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=xe,Pe.name=""),Pe.type===5?(le=Pe.start,G>0&&le!==xe&&(X[le].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",X[Pe.start]===void 0&&(X[Pe.start]=T(I,Pe.start,X.fat_addrs,X.ssz)),X[Pe.start].name=Pe.name,Pe.content=X[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:le!==xe&&Pe.start!==xe&&X[le]&&(Pe.content=b(Pe,X[le].data,(X[Se]||{}).data))),Pe.content&&Ur(Pe.content,0),q[ze]=Pe,fe.push(Pe)}}function j(O,X){return new Date((jr(O,X+4)/1e7*Math.pow(2,32)+jr(O,X)/1e7-11644473600)*1e3)}function F(O,X){return h(),x(m.readFileSync(O),X)}function R(O,X){var I=X&&X.type;switch(I||gt&&Buffer.isBuffer(O)&&(I="buffer"),I||"base64"){case"file":return F(O,X);case"base64":return x(Ca(Ra(O)),X);case"binary":return x(Ca(O),X)}return x(O,X)}function A(O,X){var I=X||{},H=I.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=H+"/",O.FileIndex[0]={name:H,type:5}),I.CLSID&&(O.FileIndex[0].clsid=I.CLSID),P(O)}function P(O){var X="Sh33tJ5";if(!We.find(O,"/"+X)){var I=Ne(4);I[0]=55,I[1]=I[3]=50,I[2]=54,O.FileIndex.push({name:X,type:2,content:I,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+X),U(O)}}function U(O,X){A(O);for(var I=!1,H=!1,G=O.FullPaths.length-1;G>=0;--G){var q=O.FileIndex[G];switch(q.type){case 0:H?I=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(q.R*q.L*q.C)&&(I=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!X)){var fe=new Date(1987,1,19),Se=0,le=Object.create?Object.create(null):{},he=[];for(G=0;G<O.FullPaths.length;++G)le[O.FullPaths[G]]=!0,O.FileIndex[G].type!==0&&he.push([O.FullPaths[G],O.FileIndex[G]]);for(G=0;G<he.length;++G){var ge=n(he[G][0]);H=le[ge],H||(he.push([ge,{name:s(ge).replace("/",""),type:1,clsid:Q,ct:fe,mt:fe,content:null}]),le[ge]=!0)}for(he.sort(function(ze,Le){return r(ze[0],Le[0])}),O.FullPaths=[],O.FileIndex=[],G=0;G<he.length;++G)O.FullPaths[G]=he[G][0],O.FileIndex[G]=he[G][1];for(G=0;G<he.length;++G){var Oe=O.FileIndex[G],Be=O.FullPaths[G];if(Oe.name=s(Be).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||Q,G===0)Oe.C=he.length>1?1:-1,Oe.size=0,Oe.type=5;else if(Be.slice(-1)=="/"){for(Se=G+1;Se<he.length&&n(O.FullPaths[Se])!=Be;++Se);for(Oe.C=Se>=he.length?-1:Se,Se=G+1;Se<he.length&&n(O.FullPaths[Se])!=n(Be);++Se);Oe.R=Se>=he.length?-1:Se,Oe.type=1}else n(O.FullPaths[G+1]||"")==n(Be)&&(Oe.R=G+1),Oe.type=2}}}function ee(O,X){var I=X||{};if(I.fileType=="mad")return gn(O,I);switch(U(O),I.fileType){case"zip":return Vr(O,I)}var H=function(ze){for(var Le=0,Pe=0,ot=0;ot<ze.FileIndex.length;++ot){var It=ze.FileIndex[ot];if(It.content){var Pt=It.content.length;Pt>0&&(Pt<4096?Le+=Pt+63>>6:Pe+=Pt+511>>9)}}for(var qt=ze.FullPaths.length+3>>2,On=Le+7>>3,os=Le+127>>7,Ma=On+Pe+qt+os,rn=Ma+127>>7,Ws=rn<=109?0:Math.ceil((rn-109)/127);Ma+rn+Ws+127>>7>rn;)Ws=++rn<=109?0:Math.ceil((rn-109)/127);var an=[1,Ws,rn,os,qt,Pe,Le,0];return ze.FileIndex[0].size=Le<<6,an[7]=(ze.FileIndex[0].start=an[0]+an[1]+an[2]+an[3]+an[4]+an[5])+(an[6]+7>>3),an}(O),G=Ne(H[7]<<9),q=0,fe=0;{for(q=0;q<8;++q)G.write_shift(1,we[q]);for(q=0;q<8;++q)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),q=0;q<3;++q)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,H[2]),G.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:xe),G.write_shift(4,H[3]),G.write_shift(-4,H[1]?H[0]-1:xe),G.write_shift(4,H[1]),q=0;q<109;++q)G.write_shift(-4,q<H[2]?H[1]+q:-1)}if(H[1])for(fe=0;fe<H[1];++fe){for(;q<236+fe*127;++q)G.write_shift(-4,q<H[2]?H[1]+q:-1);G.write_shift(-4,fe===H[1]-1?xe:fe+1)}var Se=function(ze){for(fe+=ze;q<fe-1;++q)G.write_shift(-4,q+1);ze&&(++q,G.write_shift(-4,xe))};for(fe=q=0,fe+=H[1];q<fe;++q)G.write_shift(-4,ie.DIFSECT);for(fe+=H[2];q<fe;++q)G.write_shift(-4,ie.FATSECT);Se(H[3]),Se(H[4]);for(var le=0,he=0,ge=O.FileIndex[0];le<O.FileIndex.length;++le)ge=O.FileIndex[le],ge.content&&(he=ge.content.length,!(he<4096)&&(ge.start=fe,Se(he+511>>9)));for(Se(H[6]+7>>3);G.l&511;)G.write_shift(-4,ie.ENDOFCHAIN);for(fe=q=0,le=0;le<O.FileIndex.length;++le)ge=O.FileIndex[le],ge.content&&(he=ge.content.length,!(!he||he>=4096)&&(ge.start=fe,Se(he+63>>6)));for(;G.l&511;)G.write_shift(-4,ie.ENDOFCHAIN);for(q=0;q<H[4]<<2;++q){var Oe=O.FullPaths[q];if(!Oe||Oe.length===0){for(le=0;le<17;++le)G.write_shift(4,0);for(le=0;le<3;++le)G.write_shift(4,-1);for(le=0;le<12;++le)G.write_shift(4,0);continue}ge=O.FileIndex[q],q===0&&(ge.start=ge.size?ge.start-1:xe);var Be=q===0&&I.root||ge.name;if(he=2*(Be.length+1),G.write_shift(64,Be,"utf16le"),G.write_shift(2,he),G.write_shift(1,ge.type),G.write_shift(1,ge.color),G.write_shift(-4,ge.L),G.write_shift(-4,ge.R),G.write_shift(-4,ge.C),ge.clsid)G.write_shift(16,ge.clsid,"hex");else for(le=0;le<4;++le)G.write_shift(4,0);G.write_shift(4,ge.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,ge.start),G.write_shift(4,ge.size),G.write_shift(4,0)}for(q=1;q<O.FileIndex.length;++q)if(ge=O.FileIndex[q],ge.size>=4096)if(G.l=ge.start+1<<9,gt&&Buffer.isBuffer(ge.content))ge.content.copy(G,G.l,0,ge.size),G.l+=ge.size+511&-512;else{for(le=0;le<ge.size;++le)G.write_shift(1,ge.content[le]);for(;le&511;++le)G.write_shift(1,0)}for(q=1;q<O.FileIndex.length;++q)if(ge=O.FileIndex[q],ge.size>0&&ge.size<4096)if(gt&&Buffer.isBuffer(ge.content))ge.content.copy(G,G.l,0,ge.size),G.l+=ge.size+63&-64;else{for(le=0;le<ge.size;++le)G.write_shift(1,ge.content[le]);for(;le&63;++le)G.write_shift(1,0)}if(gt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function W(O,X){var I=O.FullPaths.map(function(le){return le.toUpperCase()}),H=I.map(function(le){var he=le.split("/");return he[he.length-(le.slice(-1)=="/"?2:1)]}),G=!1;X.charCodeAt(0)===47?(G=!0,X=I[0].slice(0,-1)+X):G=X.indexOf("/")!==-1;var q=X.toUpperCase(),fe=G===!0?I.indexOf(q):H.indexOf(q);if(fe!==-1)return O.FileIndex[fe];var Se=!q.match(Yc);for(q=q.replace(Qr,""),Se&&(q=q.replace(Yc,"!")),fe=0;fe<I.length;++fe)if((Se?I[fe].replace(Yc,"!"):I[fe]).replace(Qr,"")==q||(Se?H[fe].replace(Yc,"!"):H[fe]).replace(Qr,"")==q)return O.FileIndex[fe];return null}var J=64,xe=-2,pe="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:xe,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ae(O,X,I){h();var H=ee(O,I);m.writeFileSync(X,H)}function re(O){for(var X=new Array(O.length),I=0;I<O.length;++I)X[I]=String.fromCharCode(O[I]);return X.join("")}function z(O,X){var I=ee(O,X);switch(X&&X.type||"buffer"){case"file":return h(),m.writeFileSync(X.filename,I),I;case"binary":return typeof I=="string"?I:re(I);case"base64":return oo(typeof I=="string"?I:re(I));case"buffer":if(gt)return Buffer.isBuffer(I)?I:ns(I);case"array":return typeof I=="string"?Ca(I):I}return I}var te;function D(O){try{var X=O.InflateRaw,I=new X;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)te=O;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function V(O,X){if(!te)return Dt(O,X);var I=te.InflateRaw,H=new I,G=H._processChunk(O.slice(O.l),H._finishFlushFlag);return O.l+=H.bytesRead,G}function M(O){return te?te.deflateRawSync(O):lt(O)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ye(O){var X=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(X>>16|X>>8|X)&255}for(var _e=typeof Uint8Array<"u",ae=_e?new Uint8Array(256):[],He=0;He<256;++He)ae[He]=ye(He);function Y(O,X){var I=ae[O&255];return X<=8?I>>>8-X:(I=I<<8|ae[O>>8&255],X<=16?I>>>16-X:(I=I<<8|ae[O>>16&255],I>>>24-X))}function ct(O,X){var I=X&7,H=X>>>3;return(O[H]|(I<=6?0:O[H+1]<<8))>>>I&3}function $e(O,X){var I=X&7,H=X>>>3;return(O[H]|(I<=5?0:O[H+1]<<8))>>>I&7}function xt(O,X){var I=X&7,H=X>>>3;return(O[H]|(I<=4?0:O[H+1]<<8))>>>I&15}function et(O,X){var I=X&7,H=X>>>3;return(O[H]|(I<=3?0:O[H+1]<<8))>>>I&31}function Me(O,X){var I=X&7,H=X>>>3;return(O[H]|(I<=1?0:O[H+1]<<8))>>>I&127}function vt(O,X,I){var H=X&7,G=X>>>3,q=(1<<I)-1,fe=O[G]>>>H;return I<8-H||(fe|=O[G+1]<<8-H,I<16-H)||(fe|=O[G+2]<<16-H,I<24-H)||(fe|=O[G+3]<<24-H),fe&q}function De(O,X,I){var H=X&7,G=X>>>3;return H<=5?O[G]|=(I&7)<<H:(O[G]|=I<<H&255,O[G+1]=(I&7)>>8-H),X+3}function at(O,X,I){var H=X&7,G=X>>>3;return I=(I&1)<<H,O[G]|=I,X+1}function Ce(O,X,I){var H=X&7,G=X>>>3;return I<<=H,O[G]|=I&255,I>>>=8,O[G+1]=I,X+8}function Fe(O,X,I){var H=X&7,G=X>>>3;return I<<=H,O[G]|=I&255,I>>>=8,O[G+1]=I&255,O[G+2]=I>>>8,X+16}function de(O,X){var I=O.length,H=2*I>X?2*I:X+5,G=0;if(I>=X)return O;if(gt){var q=zv(H);if(O.copy)O.copy(q);else for(;G<O.length;++G)q[G]=O[G];return q}else if(_e){var fe=new Uint8Array(H);if(fe.set)fe.set(O);else for(;G<I;++G)fe[G]=O[G];return fe}return O.length=H,O}function Te(O){for(var X=new Array(O),I=0;I<O;++I)X[I]=0;return X}function qe(O,X,I){var H=1,G=0,q=0,fe=0,Se=0,le=O.length,he=_e?new Uint16Array(32):Te(32);for(q=0;q<32;++q)he[q]=0;for(q=le;q<I;++q)O[q]=0;le=O.length;var ge=_e?new Uint16Array(le):Te(le);for(q=0;q<le;++q)he[G=O[q]]++,H<G&&(H=G),ge[q]=0;for(he[0]=0,q=1;q<=H;++q)he[q+16]=Se=Se+he[q-1]<<1;for(q=0;q<le;++q)Se=O[q],Se!=0&&(ge[q]=he[Se+16]++);var Oe=0;for(q=0;q<le;++q)if(Oe=O[q],Oe!=0)for(Se=Y(ge[q],H)>>H-Oe,fe=(1<<H+4-Oe)-1;fe>=0;--fe)X[Se|fe<<Oe]=Oe&15|q<<4;return H}var Ke=_e?new Uint16Array(512):Te(512),Xe=_e?new Uint16Array(32):Te(32);if(!_e){for(var ut=0;ut<512;++ut)Ke[ut]=0;for(ut=0;ut<32;++ut)Xe[ut]=0}(function(){for(var O=[],X=0;X<32;X++)O.push(5);qe(O,Xe,32);var I=[];for(X=0;X<=143;X++)I.push(8);for(;X<=255;X++)I.push(9);for(;X<=279;X++)I.push(7);for(;X<=287;X++)I.push(8);qe(I,Ke,288)})();var nt=function(){for(var X=_e?new Uint8Array(32768):[],I=0,H=0;I<oe.length-1;++I)for(;H<oe[I+1];++H)X[H]=I;for(;H<32768;++H)X[H]=29;var G=_e?new Uint8Array(259):[];for(I=0,H=0;I<K.length-1;++I)for(;H<K[I+1];++H)G[H]=I;function q(Se,le){for(var he=0;he<Se.length;){var ge=Math.min(65535,Se.length-he),Oe=he+ge==Se.length;for(le.write_shift(1,+Oe),le.write_shift(2,ge),le.write_shift(2,~ge&65535);ge-- >0;)le[le.l++]=Se[he++]}return le.l}function fe(Se,le){for(var he=0,ge=0,Oe=_e?new Uint16Array(32768):[];ge<Se.length;){var Be=Math.min(65535,Se.length-ge);if(Be<10){for(he=De(le,he,+(ge+Be==Se.length)),he&7&&(he+=8-(he&7)),le.l=he/8|0,le.write_shift(2,Be),le.write_shift(2,~Be&65535);Be-- >0;)le[le.l++]=Se[ge++];he=le.l*8;continue}he=De(le,he,+(ge+Be==Se.length)+2);for(var ze=0;Be-- >0;){var Le=Se[ge];ze=(ze<<5^Le)&32767;var Pe=-1,ot=0;if((Pe=Oe[ze])&&(Pe|=ge&-32768,Pe>ge&&(Pe-=32768),Pe<ge))for(;Se[Pe+ot]==Se[ge+ot]&&ot<250;)++ot;if(ot>2){Le=G[ot],Le<=22?he=Ce(le,he,ae[Le+1]>>1)-1:(Ce(le,he,3),he+=5,Ce(le,he,ae[Le-23]>>5),he+=3);var It=Le<8?0:Le-4>>2;It>0&&(Fe(le,he,ot-K[Le]),he+=It),Le=X[ge-Pe],he=Ce(le,he,ae[Le]>>3),he-=3;var Pt=Le<4?0:Le-2>>1;Pt>0&&(Fe(le,he,ge-Pe-oe[Le]),he+=Pt);for(var qt=0;qt<ot;++qt)Oe[ze]=ge&32767,ze=(ze<<5^Se[ge])&32767,++ge;Be-=ot-1}else Le<=143?Le=Le+48:he=at(le,he,1),he=Ce(le,he,ae[Le]),Oe[ze]=ge&32767,++ge}he=Ce(le,he,0)-1}return le.l=(he+7)/8|0,le.l}return function(le,he){return le.length<8?q(le,he):fe(le,he)}}();function lt(O){var X=Ne(50+Math.floor(O.length*1.1)),I=nt(O,X);return X.slice(0,I)}var Xt=_e?new Uint16Array(32768):Te(32768),zr=_e?new Uint16Array(32768):Te(32768),jt=_e?new Uint16Array(128):Te(128),Hr=1,Oa=1;function ls(O,X){var I=et(O,X)+257;X+=5;var H=et(O,X)+1;X+=5;var G=xt(O,X)+4;X+=4;for(var q=0,fe=_e?new Uint8Array(19):Te(19),Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,he=_e?new Uint8Array(8):Te(8),ge=_e?new Uint8Array(8):Te(8),Oe=fe.length,Be=0;Be<G;++Be)fe[B[Be]]=q=$e(O,X),le<q&&(le=q),he[q]++,X+=3;var ze=0;for(he[0]=0,Be=1;Be<=le;++Be)ge[Be]=ze=ze+he[Be-1]<<1;for(Be=0;Be<Oe;++Be)(ze=fe[Be])!=0&&(Se[Be]=ge[ze]++);var Le=0;for(Be=0;Be<Oe;++Be)if(Le=fe[Be],Le!=0){ze=ae[Se[Be]]>>8-Le;for(var Pe=(1<<7-Le)-1;Pe>=0;--Pe)jt[ze|Pe<<Le]=Le&7|Be<<3}var ot=[];for(le=1;ot.length<I+H;)switch(ze=jt[Me(O,X)],X+=ze&7,ze>>>=3){case 16:for(q=3+ct(O,X),X+=2,ze=ot[ot.length-1];q-- >0;)ot.push(ze);break;case 17:for(q=3+$e(O,X),X+=3;q-- >0;)ot.push(0);break;case 18:for(q=11+Me(O,X),X+=7;q-- >0;)ot.push(0);break;default:ot.push(ze),le<ze&&(le=ze);break}var It=ot.slice(0,I),Pt=ot.slice(I);for(Be=I;Be<286;++Be)It[Be]=0;for(Be=H;Be<30;++Be)Pt[Be]=0;return Hr=qe(It,Xt,286),Oa=qe(Pt,zr,30),X}function tt(O,X){if(O[0]==3&&!(O[1]&3))return[Ps(X),2];for(var I=0,H=0,G=zv(X||1<<18),q=0,fe=G.length>>>0,Se=0,le=0;(H&1)==0;){if(H=$e(O,I),I+=3,H>>>1)H>>1==1?(Se=9,le=5):(I=ls(O,I),Se=Hr,le=Oa);else{I&7&&(I+=8-(I&7));var he=O[I>>>3]|O[(I>>>3)+1]<<8;if(I+=32,he>0)for(!X&&fe<q+he&&(G=de(G,q+he),fe=G.length);he-- >0;)G[q++]=O[I>>>3],I+=8;continue}for(;;){!X&&fe<q+32767&&(G=de(G,q+32767),fe=G.length);var ge=vt(O,I,Se),Oe=H>>>1==1?Ke[ge]:Xt[ge];if(I+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)G[q++]=Oe;else{if(Oe==256)break;Oe-=257;var Be=Oe<8?0:Oe-4>>2;Be>5&&(Be=0);var ze=q+K[Oe];Be>0&&(ze+=vt(O,I,Be),I+=Be),ge=vt(O,I,le),Oe=H>>>1==1?Xe[ge]:zr[ge],I+=Oe&15,Oe>>>=4;var Le=Oe<4?0:Oe-2>>1,Pe=oe[Oe];for(Le>0&&(Pe+=vt(O,I,Le),I+=Le),!X&&fe<ze&&(G=de(G,ze+100),fe=G.length);q<ze;)G[q]=G[q-Pe],++q}}}return X?[G,I+7>>>3]:[G.slice(0,q),I+7>>>3]}function Dt(O,X){var I=O.slice(O.l||0),H=tt(I,X);return O.l+=H[1],H[0]}function Dr(O,X){if(O)typeof console<"u"&&console.error(X);else throw new Error(X)}function tn(O,X){var I=O;Ur(I,0);var H=[],G=[],q={FileIndex:H,FullPaths:G};A(q,{root:X.root});for(var fe=I.length-4;(I[fe]!=80||I[fe+1]!=75||I[fe+2]!=5||I[fe+3]!=6)&&fe>=0;)--fe;I.l=fe+4,I.l+=4;var Se=I.read_shift(2);I.l+=6;var le=I.read_shift(4);for(I.l=le,fe=0;fe<Se;++fe){I.l+=20;var he=I.read_shift(4),ge=I.read_shift(4),Oe=I.read_shift(2),Be=I.read_shift(2),ze=I.read_shift(2);I.l+=8;var Le=I.read_shift(4),Pe=f(I.slice(I.l+Oe,I.l+Oe+Be));I.l+=Oe+Be+ze;var ot=I.l;I.l=Le+4,ca(I,he,ge,q,Pe),I.l=ot}return q}function ca(O,X,I,H,G){O.l+=2;var q=O.read_shift(2),fe=O.read_shift(2),Se=o(O);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var le=O.read_shift(4),he=O.read_shift(4),ge=O.read_shift(4),Oe=O.read_shift(2),Be=O.read_shift(2),ze="",Le=0;Le<Oe;++Le)ze+=String.fromCharCode(O[O.l++]);if(Be){var Pe=f(O.slice(O.l,O.l+Be));(Pe[21589]||{}).mt&&(Se=Pe[21589].mt),((G||{})[21589]||{}).mt&&(Se=G[21589].mt)}O.l+=Be;var ot=O.slice(O.l,O.l+he);switch(fe){case 8:ot=V(O,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var It=!1;q&8&&(le=O.read_shift(4),le==134695760&&(le=O.read_shift(4),It=!0),he=O.read_shift(4),ge=O.read_shift(4)),he!=X&&Dr(It,"Bad compressed size: "+X+" != "+he),ge!=I&&Dr(It,"Bad uncompressed size: "+I+" != "+ge),Er(H,ze,ot,{unsafe:!0,mt:Se})}function Vr(O,X){var I=X||{},H=[],G=[],q=Ne(1),fe=I.compression?8:0,Se=0,le=0,he=0,ge=0,Oe=0,Be=O.FullPaths[0],ze=Be,Le=O.FileIndex[0],Pe=[],ot=0;for(le=1;le<O.FullPaths.length;++le)if(ze=O.FullPaths[le].slice(Be.length),Le=O.FileIndex[le],!(!Le.size||!Le.content||ze=="Sh33tJ5")){var It=ge,Pt=Ne(ze.length);for(he=0;he<ze.length;++he)Pt.write_shift(1,ze.charCodeAt(he)&127);Pt=Pt.slice(0,Pt.l),Pe[Oe]=M6.buf(Le.content,0);var qt=Le.content;fe==8&&(qt=M(qt)),q=Ne(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,Se),q.write_shift(2,fe),Le.mt?l(q,Le.mt):q.write_shift(4,0),q.write_shift(-4,Pe[Oe]),q.write_shift(4,qt.length),q.write_shift(4,Le.content.length),q.write_shift(2,Pt.length),q.write_shift(2,0),ge+=q.length,H.push(q),ge+=Pt.length,H.push(Pt),ge+=qt.length,H.push(qt),q=Ne(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,Se),q.write_shift(2,fe),q.write_shift(4,0),q.write_shift(-4,Pe[Oe]),q.write_shift(4,qt.length),q.write_shift(4,Le.content.length),q.write_shift(2,Pt.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,It),ot+=q.l,G.push(q),ot+=Pt.length,G.push(Pt),++Oe}return q=Ne(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Oe),q.write_shift(2,Oe),q.write_shift(4,ot),q.write_shift(4,ge),q.write_shift(2,0),Fr([Fr(H),Fr(G),q])}var Bi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Io(O,X){if(O.ctype)return O.ctype;var I=O.name||"",H=I.match(/\.([^\.]+)$/);return H&&Bi[H[1]]||X&&(H=(I=X).match(/[\.\\]([^\.\\])+$/),H&&Bi[H[1]])?Bi[H[1]]:"application/octet-stream"}function Po(O){for(var X=oo(O),I=[],H=0;H<X.length;H+=76)I.push(X.slice(H,H+76));return I.join(`\r
`)+`\r
`}function Hl(O){var X=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var ge=he.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],H=X.split(`\r
`),G=0;G<H.length;++G){var q=H[G];if(q.length==0){I.push("");continue}for(var fe=0;fe<q.length;){var Se=76,le=q.slice(fe,fe+Se);le.charAt(Se-1)=="="?Se--:le.charAt(Se-2)=="="?Se-=2:le.charAt(Se-3)=="="&&(Se-=3),le=q.slice(fe,fe+Se),fe+=Se,fe<q.length&&(le+="="),I.push(le)}}return I.join(`\r
`)}function Vl(O){for(var X=[],I=0;I<O.length;++I){for(var H=O[I];I<=O.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+O[++I];X.push(H)}for(var G=0;G<X.length;++G)X[G]=X[G].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return Ca(X.join(`\r
`))}function zo(O,X,I){for(var H="",G="",q="",fe,Se=0;Se<10;++Se){var le=X[Se];if(!le||le.match(/^\s*$/))break;var he=le.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":H=he[2].trim();break;case"content-type":q=he[2].trim();break;case"content-transfer-encoding":G=he[2].trim();break}}switch(++Se,G.toLowerCase()){case"base64":fe=Ca(Ra(X.slice(Se).join("")));break;case"quoted-printable":fe=Vl(X.slice(Se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var ge=Er(O,H.slice(I.length),fe,{unsafe:!0});q&&(ge.ctype=q)}function nf(O,X){if(re(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=X&&X.root||"",H=(gt&&Buffer.isBuffer(O)?O.toString("binary"):re(O)).split(`\r
`),G=0,q="";for(G=0;G<H.length;++G)if(q=H[G],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),I||(I=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),q.slice(0,I.length)!=I););var fe=(H[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var Se="--"+(fe[1]||""),le=[],he=[],ge={FileIndex:le,FullPaths:he};A(ge);var Oe,Be=0;for(G=0;G<H.length;++G){var ze=H[G];ze!==Se&&ze!==Se+"--"||(Be++&&zo(ge,H.slice(Oe,G),I),Oe=G)}return ge}function gn(O,X){var I=X||{},H=I.boundary||"SheetJS";H="------="+H;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],q=O.FullPaths[0],fe=q,Se=O.FileIndex[0],le=1;le<O.FullPaths.length;++le)if(fe=O.FullPaths[le].slice(q.length),Se=O.FileIndex[le],!(!Se.size||!Se.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ot){return"_x"+ot.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ot){return"_u"+ot.charCodeAt(0).toString(16)+"_"});for(var he=Se.content,ge=gt&&Buffer.isBuffer(he)?he.toString("binary"):re(he),Oe=0,Be=Math.min(1024,ge.length),ze=0,Le=0;Le<=Be;++Le)(ze=ge.charCodeAt(Le))>=32&&ze<128&&++Oe;var Pe=Oe>=Be*4/5;G.push(H),G.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+fe),G.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),G.push("Content-Type: "+Io(Se,fe)),G.push(""),G.push(Pe?Hl(ge):Po(ge))}return G.push(H+`--\r
`),G.join(`\r
`)}function Nr(O){var X={};return A(X,O),X}function Er(O,X,I,H){var G=H&&H.unsafe;G||A(O);var q=!G&&We.find(O,X);if(!q){var fe=O.FullPaths[0];X.slice(0,fe.length)==fe?fe=X:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+X).replace("//","/")),q={name:s(X),type:2},O.FileIndex.push(q),O.FullPaths.push(fe),G||We.utils.cfb_gc(O)}return q.content=I,q.size=I?I.length:0,H&&(H.CLSID&&(q.clsid=H.CLSID),H.mt&&(q.mt=H.mt),H.ct&&(q.ct=H.ct)),q}function cs(O,X){A(O);var I=We.find(O,X);if(I){for(var H=0;H<O.FileIndex.length;++H)if(O.FileIndex[H]==I)return O.FileIndex.splice(H,1),O.FullPaths.splice(H,1),!0}return!1}function Gl(O,X,I){A(O);var H=We.find(O,X);if(H){for(var G=0;G<O.FileIndex.length;++G)if(O.FileIndex[G]==H)return O.FileIndex[G].name=s(I),O.FullPaths[G]=I,!0}return!1}function sf(O){U(O,!0)}return t.find=W,t.read=R,t.parse=x,t.write=z,t.writeFile=Ae,t.utils={cfb_new:Nr,cfb_add:Er,cfb_del:cs,cfb_mov:Gl,cfb_gc:sf,ReadShift:Kc,CheckField:Rw,prep_blob:Ur,bconcat:Fr,use_zlib:D,_deflateRaw:lt,_inflateRaw:Dt,consts:ie},t}();let Is;function L6(e){Is=e}function B6(e){return typeof e=="string"?jo(e):Array.isArray(e)?c6(e):e}function Ro(e,t,r){if(typeof Is<"u"&&Is.writeFileSync)return r?Is.writeFileSync(e,t,r):Is.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=jo(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?An(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([B6(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var f=File(e);return f.open("w"),f.encoding="binary",Array.isArray(t)&&(t=$s(t)),f.write(t),f.close(),t}catch(m){if(!m.message||!m.message.match(/onstruct/))throw m}throw new Error("cannot save file "+e)}function U6(e){if(typeof Is<"u")return Is.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ur(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Wv(e,t){for(var r=[],n=ur(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function qu(e){for(var t=[],r=ur(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Wu(e){for(var t=[],r=ur(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function I6(e){for(var t=[],r=ur(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Su=new Date(1899,11,30,0,0,0);function Sr(e,t){var r=e.getTime(),n=Su.getTime()+(e.getTimezoneOffset()-Su.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var xw=new Date,P6=Su.getTime()+(xw.getTimezoneOffset()-Su.getTimezoneOffset())*6e4,Kv=xw.getTimezoneOffset();function Ku(e){var t=new Date;return t.setTime(e*24*60*60*1e3+P6),t.getTimezoneOffset()!==Kv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Kv)*6e4),t}function z6(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(r=1,l>3&&(n=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[l],10)}return t}var Zv=new Date("2017-02-19T19:06:09.000Z"),pw=isNaN(Zv.getFullYear())?new Date("2/19/17"):Zv,H6=pw.getFullYear()==2017;function er(e,t){var r=new Date(e);if(H6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(pw.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Ni(e,t){if(gt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return An(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return An(rw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return An(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return An(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Yt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Yt(e[r]));return t}function lr(e,t){for(var r="";r.length<t;)r+=e;return r}function un(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,l){return r=-r,l}),!isNaN(t=Number(n)))?t/r:t}var V6=["january","february","march","april","may","june","july","august","september","october","november","december"];function Al(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&V6.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||l>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var G6=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var l=r.split(n),o=[l[0]],f=1;f<l.length;++f)o.push(s),o.push(l[f]);return o}}();function gw(e){return e?e.content&&e.type?Ni(e.content,!0):e.data?bl(e.data):e.asNodeBuffer&&gt?bl(e.asNodeBuffer().toString("binary")):e.asBinary?bl(e.asBinary()):e._data&&e._data.getContent?bl(Ni(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function vw(e){if(!e)return null;if(e.data)return yu(e.data);if(e.asNodeBuffer&&gt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?yu(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function X6(e){return e&&e.name.slice(-4)===".bin"?vw(e):gw(e)}function Wa(e,t){for(var r=e.FullPaths||ur(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function Fm(e,t){var r=Wa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function vr(e,t,r){if(!r)return X6(Fm(e,t));if(!t)return null;try{return vr(e,t)}catch{return null}}function ja(e,t,r){if(!r)return gw(Fm(e,t));if(!t)return null;try{return ja(e,t)}catch{return null}}function $6(e,t,r){return vw(Fm(e,t))}function Qv(e){for(var t=e.FullPaths||ur(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function mt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return gt?n=ns(r):n=o6(r),We.utils.cfb_add(e,t,n)}We.utils.cfb_add(e,t,r)}else e.file(t,r)}function Rm(){return We.utils.cfb_new()}function yw(e,t){switch(t.type){case"base64":return We.read(e,{type:"base64"});case"binary":return We.read(e,{type:"binary"});case"buffer":case"array":return We.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function qc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var mr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Y6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Jv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,q6=/<[^>]*>/g,ra=mr.match(Jv)?Jv:q6,W6=/<\w*:/,K6=/<(\/?)\w+:/;function it(e,t,r){for(var n={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var o=e.match(Y6),f=0,m="",h=0,x="",g="",y=1;if(o)for(h=0;h!=o.length;++h){for(g=o[h],l=0;l!=g.length&&g.charCodeAt(l)!==61;++l);for(x=g.slice(0,l).trim();g.charCodeAt(l+1)==32;)++l;for(y=(s=g.charCodeAt(l+1))==34||s==39?1:0,m=g.slice(l+1+y,g.length-y),f=0;f!=x.length&&x.charCodeAt(f)!==58;++f);if(f===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),n[x]=m,n[x.toLowerCase()]=m;else{var S=(f===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(f+1);if(n[S]&&x.slice(f-3,f)=="ext")continue;n[S]=m,n[S.toLowerCase()]=m}}return n}function Rn(e){return e.replace(K6,"<$1")}var ww={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Dm=qu(ww),Tt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(f,m){return ww[f]||String.fromCharCode(parseInt(m,f.indexOf("x")>-1?16:10))||f}).replace(t,function(f,m){return String.fromCharCode(parseInt(m,16))});var o=s.indexOf("]]>");return r(s.slice(0,l))+s.slice(l+9,o)+r(s.slice(o+3))}}(),Om=/[&<>'"]/g,Z6=/[\u0000-\u0008\u000b-\u001f]/g;function Ut(e){var t=e+"";return t.replace(Om,function(r){return Dm[r]}).replace(Z6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ey(e){return Ut(e).replace(/ /g,"_x0020_")}var bw=/[\u0000-\u001f]/g;function Mm(e){var t=e+"";return t.replace(Om,function(r){return Dm[r]}).replace(/\n/g,"<br/>").replace(bw,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Q6(e){var t=e+"";return t.replace(Om,function(r){return Dm[r]}).replace(bw,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ty=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function J6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Qt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Nh(e){for(var t="",r=0,n=0,s=0,l=0,o=0,f=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(l=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|l&63);continue}o=e.charCodeAt(r++),f=((n&7)<<18|(s&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(f>>>10&1023)),t+=String.fromCharCode(56320+(f&1023))}return t}function ry(e){var t=Ps(2*e.length),r,n,s=1,l=0,o=0,f;for(n=0;n<e.length;n+=s)s=1,(f=e.charCodeAt(n))<128?r=f:f<224?(r=(f&31)*64+(e.charCodeAt(n+1)&63),s=2):f<240?(r=(f&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(f&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function ay(e){return ns(e,"binary").toString("utf8")}var Z0="foo bar baz",Gt=gt&&(ay(Z0)==Nh(Z0)&&ay||ry(Z0)==Nh(Z0)&&ry)||Nh,An=gt?function(e){return ns(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},fo=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),_w=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),eA=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),tA=/<\/?(?:vt:)?variant>/g,rA=/<(?:vt:)([^>]*)>([\s\S]*)</;function ny(e,t){var r=it(e),n=e.match(eA(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(l){var o=l.replace(tA,"").match(rA);o&&s.push({v:Gt(o[2]),t:o[1]})}),s}var Sw=/(^\s|\s$|\n)/;function Ir(e,t){return"<"+e+(t.match(Sw)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ho(e){return ur(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ue(e,t,r){return"<"+e+(r!=null?ho(r):"")+(t!=null?(t.match(Sw)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Jh(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function aA(e,t){switch(typeof e){case"string":var r=Ue("vt:lpwstr",Ut(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ue((e|0)==e?"vt:i4":"vt:r8",Ut(String(e)));case"boolean":return Ue("vt:bool",e?"true":"false")}if(e instanceof Date)return Ue("vt:filetime",Jh(e));throw new Error("Unable to serialize "+e)}function Lm(e){if(gt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Gt($s(Am(e)));throw new Error("Bad input format: expected Buffer or string")}var mo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_r={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Fi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Aa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function nA(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,l=5;l>=0;--l)s=s*256+e[t+l];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function sA(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,o=n?-t:t;isFinite(o)?o==0?s=l=0:(s=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var f=0;f<=5;++f,l/=256)e[r+f]=l&255;e[r+6]=(s&15)<<4|l&15,e[r+7]=s>>4|n}var sy=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,l=e[0][n].length;s<l;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},iy=gt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ns(t)})):sy(e)}:sy,ly=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Kn(e,s)));return n.join("").replace(Qr,"")},Zu=gt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Qr,""):ly(e,t,r)}:ly,cy=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},Nw=gt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):cy(e,t,r)}:cy,oy=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(wl(e,s)));return n.join("")},Il=gt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):oy(t,r,n)}:oy,Ew=function(e,t){var r=jr(e,t);return r>0?Il(e,t+4,t+4+r-1):""},Bm=Ew,Tw=function(e,t){var r=jr(e,t);return r>0?Il(e,t+4,t+4+r-1):""},Um=Tw,kw=function(e,t){var r=2*jr(e,t);return r>0?Il(e,t+4,t+4+r-1):""},Im=kw,Aw=function(t,r){var n=jr(t,r);return n>0?Zu(t,r+4,r+4+n):""},Pm=Aw,Cw=function(e,t){var r=jr(e,t);return r>0?Il(e,t+4,t+4+r):""},zm=Cw,jw=function(e,t){return nA(e,t)},Nu=jw,Hm=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};gt&&(Bm=function(t,r){if(!Buffer.isBuffer(t))return Ew(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Um=function(t,r){if(!Buffer.isBuffer(t))return Tw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Im=function(t,r){if(!Buffer.isBuffer(t))return kw(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Pm=function(t,r){if(!Buffer.isBuffer(t))return Aw(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},zm=function(t,r){if(!Buffer.isBuffer(t))return Cw(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Nu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):jw(t,r)},Hm=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function Fw(){Zu=function(e,t,r){return Et.utils.decode(1200,e.slice(t,r)).replace(Qr,"")},Il=function(e,t,r){return Et.utils.decode(65001,e.slice(t,r))},Bm=function(e,t){var r=jr(e,t);return r>0?Et.utils.decode(_i,e.slice(t+4,t+4+r-1)):""},Um=function(e,t){var r=jr(e,t);return r>0?Et.utils.decode(Fa,e.slice(t+4,t+4+r-1)):""},Im=function(e,t){var r=2*jr(e,t);return r>0?Et.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Pm=function(e,t){var r=jr(e,t);return r>0?Et.utils.decode(1200,e.slice(t+4,t+4+r)):""},zm=function(e,t){var r=jr(e,t);return r>0?Et.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof Et<"u"&&Fw();var wl=function(e,t){return e[t]},Kn=function(e,t){return e[t+1]*256+e[t]},iA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},jr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},di=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},lA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Kc(e,t){var r="",n,s,l=[],o,f,m,h;switch(t){case"dbcs":if(h=this.l,gt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)r+=String.fromCharCode(Kn(this,h)),h+=2;e*=2;break;case"utf8":r=Il(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Zu(this,this.l,this.l+e);break;case"wstr":if(typeof Et<"u")r=Et.utils.decode(Fa,this.slice(this.l,this.l+2*e));else return Kc.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Bm(this,this.l),e=4+jr(this,this.l);break;case"lpstr-cp":r=Um(this,this.l),e=4+jr(this,this.l);break;case"lpwstr":r=Im(this,this.l),e=4+2*jr(this,this.l);break;case"lpp4":e=4+jr(this,this.l),r=Pm(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+jr(this,this.l),r=zm(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=wl(this,this.l+e++))!==0;)l.push($c(o));r=l.join("");break;case"_wstr":for(e=0,r="";(o=Kn(this,this.l+e))!==0;)l.push($c(o)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",h=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(h)!==-1)return o=wl(this,h),this.l=h+1,f=Kc.call(this,e-m,o?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push($c(Kn(this,h))),h+=2}r=l.join(""),e*=2;break;case"cpstr":if(typeof Et<"u"){r=Et.utils.decode(Fa,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",h=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(h)!==-1)return o=wl(this,h),this.l=h+1,f=Kc.call(this,e-m,o?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push($c(wl(this,h))),h+=1}r=l.join("");break;default:switch(e){case 1:return n=wl(this,this.l),this.l++,n;case 2:return n=(t==="i"?iA:Kn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?di:lA)(this,this.l),this.l+=4,n):(s=jr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Nu(this,this.l):s=Nu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Nw(this,this.l,e);break}}return this.l+=e,r}var cA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},oA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},uA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function fA(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)uA(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){if(typeof Et<"u"&&_i==874)for(s=0;s!=t.length;++s){var l=Et.utils.encode(_i,t.charAt(s));this[this.l+s]=l[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var f=t.charCodeAt(s);this[this.l++]=f&255,this[this.l++]=f>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,cA(this,t,this.l);break;case 8:if(n=8,r==="f"){sA(this,t,this.l);break}case 16:break;case-4:n=4,oA(this,t,this.l);break}return this.l+=n,this}function Rw(e,t){var r=Nw(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ur(e,t){e.l=t,e.read_shift=Kc,e.chk=Rw,e.write_shift=fA}function ea(e,t){e.l+=t}function Ne(e){var t=Ps(e);return Ur(t,0),t}function ss(e,t,r){if(e){var n,s,l;Ur(e,e.l||0);for(var o=e.length,f=0,m=0;e.l<o;){f=e.read_shift(1),f&128&&(f=(f&127)+((e.read_shift(1)&127)<<7));var h=wo[f]||wo[65535];for(n=e.read_shift(1),l=n&127,s=1;s<4&&n&128;++s)l+=((n=e.read_shift(1))&127)<<7*s;m=e.l+l;var x=h.f&&h.f(e,l,r);if(e.l=m,t(x,h,f))return}}}function ya(){var e=[],t=gt?256:2048,r=function(h){var x=Ne(h);return Ur(x,0),x},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(h){return n&&h<n.length-n.l?n:(s(),n=r(Math.max(h+1,t)))},o=function(){return s(),Fr(e)},f=function(h){s(),n=h,n.l==null&&(n.l=n.length),l(t)};return{next:l,push:f,end:o,_bufs:e}}function Re(e,t,r,n){var s=+t,l;if(!isNaN(s)){n||(n=wo[s].p||(r||[]).length||0),l=1+(s>=128?1:0)+1,n>=128&&++l,n>=16384&&++l,n>=2097152&&++l;var o=e.next(l);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var f=0;f!=4;++f)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Hm(r)&&e.push(r)}}function Zc(e,t,r){var n=Yt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function uy(e,t,r){var n=Yt(e);return n.s=Zc(n.s,t.s,r),n.e=Zc(n.e,t.s,r),n}function Qc(e,t){if(e.cRel&&e.c<0)for(e=Yt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Yt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=rt(e);return!e.cRel&&e.cRel!=null&&(r=mA(r)),!e.rRel&&e.rRel!=null&&(r=dA(r)),r}function Eh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Jt(e.s.c)+":"+(e.e.cRel?"":"$")+Jt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+cr(e.s.r)+":"+(e.e.rRel?"":"$")+cr(e.e.r):Qc(e.s,t.biff)+":"+Qc(e.e,t.biff)}function Vm(e){return parseInt(hA(e),10)-1}function cr(e){return""+(e+1)}function dA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hA(e){return e.replace(/\$(\d+)$/,"$1")}function Gm(e){for(var t=xA(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Jt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function mA(e){return e.replace(/^([A-Z])/,"$$$1")}function xA(e){return e.replace(/^\$([A-Z])/,"$1")}function pA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function nr(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function rt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function la(e){var t=e.indexOf(":");return t==-1?{s:nr(e),e:nr(e)}:{s:nr(e.slice(0,t)),e:nr(e.slice(t+1))}}function dt(e,t){return typeof t>"u"||typeof t=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=rt(e)),typeof t!="string"&&(t=rt(t)),e==t?e:e+":"+t)}function St(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,l=e.length;for(r=0;n<l&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<l&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=l&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=l&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function fy(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Da(e.z,r?Sr(t):t)}catch{}try{return e.w=Da((e.XF||{}).numFmtId||(r?14:0),r?Sr(t):t)}catch{return""+t}}function Fn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?is[e.v]||e.v:t==null?fy(e,e.v):fy(e,t))}function Ys(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Dw(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,l=e||(s?[]:{}),o=0,f=0;if(l&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var m=typeof n.origin=="string"?nr(n.origin):n.origin;o=m.r,f=m.c}l["!ref"]||(l["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var x=St(l["!ref"]);h.s.c=x.s.c,h.s.r=x.s.r,h.e.c=Math.max(h.e.c,x.e.c),h.e.r=Math.max(h.e.r,x.e.r),o==-1&&(h.e.r=o=x.e.r+1)}for(var g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=t[g].length;++y)if(!(typeof t[g][y]>"u")){var S={v:t[g][y]},w=o+g,b=f+y;if(h.s.r>w&&(h.s.r=w),h.s.c>b&&(h.s.c=b),h.e.r<w&&(h.e.r=w),h.e.c<b&&(h.e.c=b),t[g][y]&&typeof t[g][y]=="object"&&!Array.isArray(t[g][y])&&!(t[g][y]instanceof Date))S=t[g][y];else if(Array.isArray(S.v)&&(S.f=t[g][y][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(n.nullError)S.t="e",S.v=0;else if(n.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=n.dateNF||Ze[14],n.cellDates?(S.t="d",S.w=Da(S.z,Sr(S.v))):(S.t="n",S.v=Sr(S.v),S.w=Da(S.z,S.v))):S.t="s";if(s)l[w]||(l[w]=[]),l[w][b]&&l[w][b].z&&(S.z=l[w][b].z),l[w][b]=S;else{var _=rt({c:b,r:w});l[_]&&l[_].z&&(S.z=l[_].z),l[_]=S}}}return h.s.c<1e7&&(l["!ref"]=dt(h)),l}function Pl(e,t){return Dw(null,e,t)}function gA(e){return e.read_shift(4,"i")}function fn(e,t){return t||(t=Ne(4)),t.write_shift(4,e),t}function Jr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Rr(e,t){var r=!1;return t==null&&(r=!0,t=Ne(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function vA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function yA(e,t){return t||(t=Ne(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Xm(e,t){var r=e.l,n=e.read_shift(1),s=Jr(e),l=[],o={t:s,h:s};if((n&1)!==0){for(var f=e.read_shift(4),m=0;m!=f;++m)l.push(vA(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function wA(e,t){var r=!1;return t==null&&(r=!0,t=Ne(15+4*e.t.length)),t.write_shift(1,0),Rr(e.t,t),r?t.slice(0,t.l):t}var bA=Xm;function _A(e,t){var r=!1;return t==null&&(r=!0,t=Ne(23+4*e.t.length)),t.write_shift(1,1),Rr(e.t,t),t.write_shift(4,1),yA({},t),r?t.slice(0,t.l):t}function en(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ri(e,t){return t==null&&(t=Ne(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Di(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Oi(e,t){return t==null&&(t=Ne(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var SA=Jr,Ow=Rr;function $m(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Eu(e,t){var r=!1;return t==null&&(r=!0,t=Ne(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var NA=Jr,em=$m,Ym=Eu;function qm(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?Nu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):di(t,0)>>2;return r?s/100:s}function Mw(e,t){t==null&&(t=Ne(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Lw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function EA(e,t){return t||(t=Ne(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Mi=Lw,zl=EA;function Zr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ei(e,t){return(t||Ne(8)).write_shift(8,e,"f")}function TA(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),f=e.read_shift(1),m=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var h=xi[s];h&&(t.rgb=po(h));break;case 2:t.rgb=po([o,f,m]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function Tu(e,t){if(t||(t=Ne(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function kA(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function AA(e,t){t||(t=Ne(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Bw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function CA(e){return Bw(e,1)}function jA(e){return Bw(e,2)}var Wm=2,xa=3,Q0=11,dy=12,ku=19,J0=64,FA=65,RA=71,DA=4108,OA=4126,Cr=80,Uw=81,MA=[Cr,Uw],tm={1:{n:"CodePage",t:Wm},2:{n:"Category",t:Cr},3:{n:"PresentationFormat",t:Cr},4:{n:"ByteCount",t:xa},5:{n:"LineCount",t:xa},6:{n:"ParagraphCount",t:xa},7:{n:"SlideCount",t:xa},8:{n:"NoteCount",t:xa},9:{n:"HiddenCount",t:xa},10:{n:"MultimediaClipCount",t:xa},11:{n:"ScaleCrop",t:Q0},12:{n:"HeadingPairs",t:DA},13:{n:"TitlesOfParts",t:OA},14:{n:"Manager",t:Cr},15:{n:"Company",t:Cr},16:{n:"LinksUpToDate",t:Q0},17:{n:"CharacterCount",t:xa},19:{n:"SharedDoc",t:Q0},22:{n:"HyperlinksChanged",t:Q0},23:{n:"AppVersion",t:xa,p:"version"},24:{n:"DigSig",t:FA},26:{n:"ContentType",t:Cr},27:{n:"ContentStatus",t:Cr},28:{n:"Language",t:Cr},29:{n:"Version",t:Cr},255:{},2147483648:{n:"Locale",t:ku},2147483651:{n:"Behavior",t:ku},1919054434:{}},rm={1:{n:"CodePage",t:Wm},2:{n:"Title",t:Cr},3:{n:"Subject",t:Cr},4:{n:"Author",t:Cr},5:{n:"Keywords",t:Cr},6:{n:"Comments",t:Cr},7:{n:"Template",t:Cr},8:{n:"LastAuthor",t:Cr},9:{n:"RevNumber",t:Cr},10:{n:"EditTime",t:J0},11:{n:"LastPrinted",t:J0},12:{n:"CreatedDate",t:J0},13:{n:"ModifiedDate",t:J0},14:{n:"PageCount",t:xa},15:{n:"WordCount",t:xa},16:{n:"CharCount",t:xa},17:{n:"Thumbnail",t:RA},18:{n:"Application",t:Cr},19:{n:"DocSecurity",t:xa},255:{},2147483648:{n:"Locale",t:ku},2147483651:{n:"Behavior",t:ku},1919054434:{}},hy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},LA=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function BA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var UA=BA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),xi=Yt(UA),is={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Iw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},am={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},eu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Km(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function IA(e){var t=Km();if(!e||!e.match)return t;var r={};if((e.match(ra)||[]).forEach(function(n){var s=it(n);switch(s[0].replace(W6,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[am[s.ContentType]]!==void 0&&t[am[s.ContentType]].push(s.PartName);break}}),t.xmlns!==_r.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Pw(e,t){var r=I6(am),n=[],s;n[n.length]=mr,n[n.length]=Ue("Types",null,{xmlns:_r.CT,"xmlns:xsd":_r.xsd,"xmlns:xsi":_r.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(m){return Ue("Default",null,{Extension:m[0],ContentType:m[1]})}));var l=function(m){e[m]&&e[m].length>0&&(s=e[m][0],n[n.length]=Ue("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:eu[m][t.bookType]||eu[m].xlsx}))},o=function(m){(e[m]||[]).forEach(function(h){n[n.length]=Ue("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:eu[m][t.bookType]||eu[m].xlsx})})},f=function(m){(e[m]||[]).forEach(function(h){n[n.length]=Ue("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[m][0]})})};return l("workbooks"),o("sheets"),o("charts"),f("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(f),f("vba"),f("comments"),f("threadedcomments"),f("drawings"),o("metadata"),f("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var wt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xo(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Jc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ra)||[]).forEach(function(s){var l=it(s);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var f=l.TargetMode==="External"?l.Target:qc(l.Target,t);r[f]=o,n[l.Id]=o}}),r["!id"]=n,r}function Nl(e){var t=[mr,Ue("Relationships",null,{xmlns:_r.RELS})];return ur(e["!id"]).forEach(function(r){t[t.length]=Ue("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Bt(e,t,r,n,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[wt.HLINK,wt.XPATH,wt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var PA="application/vnd.oasis.opendocument.spreadsheet";function zA(e,t){for(var r=Lm(e),n,s;n=mo.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=it(n[0],!1),s.path=="/"&&s.type!==PA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function HA(e){var t=[mr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function my(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function VA(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function GA(e){var t=[mr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(my(e[r][0],e[r][1])),t.push(VA("",e[r][0]));return t.push(my("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function zw(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+co.version+"</meta:generator></office:meta></office:document-meta>"}var Qa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],XA=function(){for(var e=new Array(Qa.length),t=0;t<Qa.length;++t){var r=Qa[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Hw(e){var t={};e=Gt(e);for(var r=0;r<Qa.length;++r){var n=Qa[r],s=e.match(XA[r]);s!=null&&s.length>0&&(t[n[1]]=Tt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=er(t[n[1]]))}return t}function Th(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Ut(t),n[n.length]=r?Ue(e,t,r):Ir(e,t))}function Vw(e,t){var r=t||{},n=[mr,Ue("cp:coreProperties",null,{"xmlns:cp":_r.CORE_PROPS,"xmlns:dc":_r.dc,"xmlns:dcterms":_r.dcterms,"xmlns:dcmitype":_r.dcmitype,"xmlns:xsi":_r.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Th("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Jh(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Th("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Jh(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var l=0;l!=Qa.length;++l){var o=Qa[l],f=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;f===!0?f="1":f===!1?f="0":typeof f=="number"&&(f=String(f)),f!=null&&Th(o[0],f,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var pi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Gw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Xw(e,t,r,n){var s=[];if(typeof e=="string")s=ny(e,n);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(x){return{v:x}}));var o=typeof t=="string"?ny(t,n).map(function(x){return x.v}):t,f=0,m=0;if(o.length>0)for(var h=0;h!==s.length;h+=2){switch(m=+s[h+1].v,s[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=m,r.SheetNames=o.slice(f,f+m);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=m,r.DefinedNames=o.slice(f,f+m);break;case"Charts":case"Diagramme":r.Chartsheets=m,r.ChartNames=o.slice(f,f+m);break}f+=m}}function $A(e,t,r){var n={};return t||(t={}),e=Gt(e),pi.forEach(function(s){var l=(e.match(fo(s[0]))||[])[1];switch(s[2]){case"string":l&&(t[s[1]]=Tt(l));break;case"bool":t[s[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Xw(n.HeadingPairs,n.TitlesOfParts,t,r),t}function $w(e){var t=[],r=Ue;return e||(e={}),e.Application="SheetJS",t[t.length]=mr,t[t.length]=Ue("Properties",null,{xmlns:_r.EXT_PROPS,"xmlns:vt":_r.vt}),pi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Ut(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ut(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var YA=/<[^>]+>[^<]*/g;function qA(e,t){var r={},n="",s=e.match(YA);if(s)for(var l=0;l!=s.length;++l){var o=s[l],f=it(o);switch(f[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Tt(f.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var m=o.split(">"),h=m[0].slice(4),x=m[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=Tt(x);break;case"bool":r[n]=Qt(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(x,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(x);break;case"filetime":case"date":r[n]=er(x);break;case"cy":case"error":r[n]=Tt(x);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,m)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function Yw(e){var t=[mr,Ue("Properties",null,{xmlns:_r.CUST_PROPS,"xmlns:vt":_r.vt})];if(!e)return t.join("");var r=1;return ur(e).forEach(function(s){++r,t[t.length]=Ue("property",aA(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ut(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var nm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},kh;function WA(e,t,r){kh||(kh=qu(nm)),t=kh[t]||t,e[t]=r}function KA(e,t){var r=[];return ur(nm).map(function(n){for(var s=0;s<Qa.length;++s)if(Qa[s][1]==n)return Qa[s];for(s=0;s<pi.length;++s)if(pi[s][1]==n)return pi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Ir(nm[n[1]]||n[1],s))}}),Ue("DocumentProperties",r.join(""),{xmlns:Aa.o})}function ZA(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&ur(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<Qa.length;++o)if(l==Qa[o][1])return;for(o=0;o<pi.length;++o)if(l==pi[o][1])return;for(o=0;o<r.length;++o)if(l==r[o])return;var f=e[l],m="string";typeof f=="number"?(m="float",f=String(f)):f===!0||f===!1?(m="boolean",f=f?"1":"0"):f=String(f),s.push(Ue(ey(l),f,{"dt:dt":m}))}}),t&&ur(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=t[l],f="string";typeof o=="number"?(f="float",o=String(o)):o===!0||o===!1?(f="boolean",o=o?"1":"0"):o instanceof Date?(f="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Ue(ey(l),o,{"dt:dt":f}))}}),"<"+n+' xmlns="'+Aa.o+'">'+s.join("")+"</"+n+">"}function Zm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function QA(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var l=n/Math.pow(2,32)|0;l>0&&(n=n%Math.pow(2,32),s+=l);var o=Ne(8);return o.write_shift(4,n),o.write_shift(4,s),o}function qw(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function Ww(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Kw(e,t,r){return t===31?Ww(e):qw(e,t,r)}function sm(e,t,r){return Kw(e,t,r===!1?0:4)}function JA(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Kw(e,t,0)}function e5(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Qr,""),e.l-s&2&&(e.l+=2)}return r}function t5(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Qr,"");return r}function r5(e){var t=e.l,r=Au(e,Uw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Au(e,xa);return[r,n]}function a5(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(r5(e));return r}function xy(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var l=e.read_shift(4),o=e.read_shift(4);n[l]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Qr,"").replace(Yc,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Zw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function n5(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Au(e,t,r){var n=e.read_shift(2),s,l=r||{};if(e.l+=2,t!==dy&&n!==t&&MA.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===dy?n:t){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return qw(e,n,4).replace(Qr,"");case 31:return Ww(e);case 64:return Zm(e);case 65:return Zw(e);case 71:return n5(e);case 80:return sm(e,n,!l.raw).replace(Qr,"");case 81:return JA(e,n).replace(Qr,"");case 4108:return a5(e);case 4126:case 4127:return n==4127?e5(e):t5(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function py(e,t){var r=Ne(4),n=Ne(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ne(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=QA(t);break;case 31:case 80:for(n=Ne(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Fr([r,n])}function gy(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),l=[],o=0,f=0,m=-1,h={};for(o=0;o!=s;++o){var x=e.read_shift(4),g=e.read_shift(4);l[o]=[x,g+r]}l.sort(function(N,E){return N[1]-E[1]});var y={};for(o=0;o!=s;++o){if(e.l!==l[o][1]){var S=!0;if(o>0&&t)switch(t[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,S=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],S=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],S=!1);break}if((!t||o==0)&&e.l<=l[o][1]&&(S=!1,e.l=l[o][1]),S)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(t){var w=t[l[o][0]];if(y[w.n]=Au(e,w.t,{raw:!0}),w.p==="version"&&(y[w.n]=String(y[w.n]>>16)+"."+("0000"+String(y[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(y[w.n]){case 0:y[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Za(f=y[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[w.n])}}else if(l[o][0]===1){if(f=y.CodePage=Au(e,Wm),Za(f),m!==-1){var b=e.l;e.l=l[m][1],h=xy(e,f),e.l=b}}else if(l[o][0]===0){if(f===0){m=o,e.l=l[o+1][1];continue}h=xy(e,f)}else{var _=h[l[o][0]],T;switch(e[e.l]){case 65:e.l+=4,T=Zw(e);break;case 30:e.l+=4,T=sm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,T=sm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,T=e.read_shift(4,"i");break;case 19:e.l+=4,T=e.read_shift(4);break;case 5:e.l+=4,T=e.read_shift(8,"f");break;case 11:e.l+=4,T=hr(e,4);break;case 64:e.l+=4,T=er(Zm(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[_]=T}}return e.l=r+n,y}var Qw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function s5(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function vy(e,t,r){var n=Ne(8),s=[],l=[],o=8,f=0,m=Ne(8),h=Ne(8);if(m.write_shift(4,2),m.write_shift(4,1200),h.write_shift(4,1),l.push(m),s.push(h),o+=8+m.length,!t){h=Ne(8),h.write_shift(4,0),s.unshift(h);var x=[Ne(4)];for(x[0].write_shift(4,e.length),f=0;f<e.length;++f){var g=e[f][0];for(m=Ne(8+2*(g.length+1)+(g.length%2?0:2)),m.write_shift(4,f+2),m.write_shift(4,g.length+1),m.write_shift(0,g,"dbcs");m.l!=m.length;)m.write_shift(1,0);x.push(m)}m=Fr(x),l.unshift(m),o+=8+m.length}for(f=0;f<e.length;++f)if(!(t&&!t[e[f][0]])&&!(Qw.indexOf(e[f][0])>-1||Gw.indexOf(e[f][0])>-1)&&e[f][1]!=null){var y=e[f][1],S=0;if(t){S=+t[e[f][0]];var w=r[S];if(w.p=="version"&&typeof y=="string"){var b=y.split(".");y=(+b[0]<<16)+(+b[1]||0)}m=py(w.t,y)}else{var _=s5(y);_==-1&&(_=31,y=String(y)),m=py(_,y)}l.push(m),h=Ne(8),h.write_shift(4,t?S:2+f),s.push(h),o+=8+m.length}var T=8*(l.length+1);for(f=0;f<l.length;++f)s[f].write_shift(4,T),T+=l[f].length;return n.write_shift(4,o),n.write_shift(4,l.length),Fr([n].concat(s).concat(l))}function yy(e,t,r){var n=e.content;if(!n)return{};Ur(n,0);var s,l,o,f,m=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),x=n.read_shift(16);if(x!==We.utils.consts.HEADER_CLSID&&x!==r)throw new Error("Bad PropertySet CLSID "+x);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=n.read_shift(16),f=n.read_shift(4),s===1&&f!==n.l)throw new Error("Length mismatch: "+f+" !== "+n.l);s===2&&(o=n.read_shift(16),m=n.read_shift(4));var g=gy(n,t),y={SystemIdentifier:h};for(var S in g)y[S]=g[S];if(y.FMTID=l,s===1)return y;if(m-n.l==2&&(n.l+=2),n.l!==m)throw new Error("Length mismatch 2: "+n.l+" !== "+m);var w;try{w=gy(n,null)}catch{}for(S in w)y[S]=w[S];return y.FMTID=[l,o],y}function wy(e,t,r,n,s,l){var o=Ne(s?68:48),f=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,We.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var m=vy(e,r,n);if(f.push(m),s){var h=vy(s,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+m.length),f.push(h)}return Fr(f)}function Os(e,t){return e.read_shift(t),null}function i5(e,t){t||(t=Ne(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function l5(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function hr(e,t){return e.read_shift(t)===1}function sa(e,t){return t||(t=Ne(2)),t.write_shift(2,+!!e),t}function yr(e){return e.read_shift(2,"u")}function Ka(e,t){return t||(t=Ne(2)),t.write_shift(2,e),t}function Jw(e,t){return l5(e,t,yr)}function c5(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function eb(e,t,r){return r||(r=Ne(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Do(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont",l=Fa;if(r&&r.biff>=8&&(Fa=1200),!r||r.biff==8){var o=e.read_shift(1);o&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var f=n?e.read_shift(n,s):"";return Fa=l,f}function o5(e){var t=Fa;Fa=1200;var r=e.read_shift(2),n=e.read_shift(1),s=n&4,l=n&8,o=1+(n&1),f=0,m,h={};l&&(f=e.read_shift(2)),s&&(m=e.read_shift(4));var x=o==2?"dbcs-cont":"sbcs-cont",g=r===0?"":e.read_shift(r,x);return l&&(e.l+=4*f),s&&(e.l+=m),h.t=g,l||(h.raw="<t>"+h.t+"</t>",h.r=h.t),Fa=t,h}function u5(e){var t=e.t||"",r=Ne(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ne(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Fr(s)}function Ti(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Oo(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ti(e,n,r)}function Li(e,t,r){if(r.biff>5)return Oo(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function tb(e,t,r){return r||(r=Ne(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function f5(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function d5(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Qr,"");return n&&(e.l+=24),s}function h5(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(Qr,"");return r+o}function m5(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return d5(e);case"0303000000000000c000000000000046":return h5(e);default:throw new Error("Unsupported Moniker "+r)}}function tu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Qr,""):"";return r}function by(e,t){t||(t=Ne(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function x5(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var l,o,f,m,h="",x,g;s&16&&(l=tu(e,r-e.l)),s&128&&(o=tu(e,r-e.l)),(s&257)===257&&(f=tu(e,r-e.l)),(s&257)===1&&(m=m5(e,r-e.l)),s&8&&(h=tu(e,r-e.l)),s&32&&(x=e.read_shift(16)),s&64&&(g=Zm(e)),e.l=r;var y=o||f||m||"";y&&h&&(y+="#"+h),y||(y="#"+h),s&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var S={Target:y};return x&&(S.guid=x),g&&(S.time=g),l&&(S.Tooltip=l),S}function p5(e){var t=Ne(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),l=s>-1?31:23;switch(n.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(l==28)n=n.slice(1),by(n,t);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var f=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(f.length+1)),r=0;r<f.length;++r)t.write_shift(2,f.charCodeAt(r));t.write_shift(2,0),l&8&&by(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var m=0;n.slice(m*3,m*3+3)=="../"||n.slice(m*3,m*3+3)=="..\\";)++m;for(t.write_shift(2,m),t.write_shift(4,n.length-3*m+1),r=0;r<n.length-3*m;++r)t.write_shift(1,n.charCodeAt(r+3*m)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function rb(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function ab(e,t){var r=rb(e);return r[3]=0,r}function Dn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ki(e,t,r,n){return n||(n=Ne(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function g5(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function v5(e,t,r){return t===0?"":Li(e,t,r)}function y5(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),l=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,l,o]}function nb(e){var t=e.read_shift(2),r=qm(e);return[t,r]}function w5(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Do(e,t,r),l=e.read_shift(2);if(n-=e.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return e.l+=l,s}function Qu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function sb(e,t){return t||(t=Ne(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ib(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var b5=ib;function lb(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function _5(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function S5(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function $r(e){e.l+=2,e.l+=e.read_shift(2)}var N5={0:$r,4:$r,5:$r,6:$r,7:S5,8:$r,9:$r,10:$r,11:$r,12:$r,13:_5,14:$r,15:$r,16:$r,17:$r,18:$r,19:$r,20:$r,21:lb};function E5(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(N5[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function ru(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Qm(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=Ne(s);return l.write_shift(2,n),l.write_shift(2,t),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function T5(e,t){return t===0||e.read_shift(2),1200}function k5(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=Li(e,0,r);return e.read_shift(t+n-e.l),s}function A5(e,t){var r=!t||t.biff==8,n=Ne(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function C5(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function j5(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=Do(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:l,name:o}}function F5(e,t){var r=!t||t.biff>=8?2:1,n=Ne(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function R5(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),l=[],o=0;o!=s&&e.l<r;++o)l.push(o5(e));return l.Count=n,l.Unique=s,l}function D5(e,t){var r=Ne(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=u5(e[s]);var l=Fr([r].concat(n));return l.parts=[r.length].concat(n.map(function(o){return o.length})),l}function O5(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function M5(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function L5(e){var t=g5(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function B5(e){return e.read_shift(2),e.read_shift(4)}function _y(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,s]}function U5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),f=e.read_shift(2),m=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:l,CurTab:o,FirstTab:f,Selected:m,TabRatio:h}}function I5(){var e=Ne(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function P5(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function z5(e){var t=Ne(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function H5(){}function V5(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Do(e,0,r),n}function G5(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,l=Ne(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),n||l.write_shift(1,1),l.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),l}function X5(e){var t=Dn(e);return t.isst=e.read_shift(4),t}function $5(e,t,r,n){var s=Ne(10);return ki(e,t,n,s),s.write_shift(4,r),s}function Y5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Dn(e);r.biff==2&&e.l++;var l=Oo(e,n-e.l,r);return s.val=l,s}function q5(e,t,r,n,s){var l=!s||s.biff==8,o=Ne(8+ +l+(1+l)*r.length);return ki(e,t,n,o),o.write_shift(2,r.length),l&&o.write_shift(1,1),o.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),o}function W5(e,t,r){var n=e.read_shift(2),s=Li(e,0,r);return[n,s]}function K5(e,t,r,n){var s=r&&r.biff==5;n||(n=Ne(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var l=n.length>n.l?n.slice(0,n.l):n;return l.l==null&&(l.l=l.length),l}var Z5=Li;function Sy(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,l=e.read_shift(s),o=e.read_shift(s),f=e.read_shift(2),m=e.read_shift(2);return e.l=n,{s:{r:l,c:f},e:{r:o,c:m}}}function Q5(e,t){var r=t.biff==8||!t.biff?4:2,n=Ne(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function J5(e){var t=e.read_shift(2),r=e.read_shift(2),n=nb(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function e8(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(nb(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:l}}function t8(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:l}}function r8(e,t,r,n){var s={},l=e.read_shift(4),o=e.read_shift(4),f=e.read_shift(4),m=e.read_shift(2);return s.patternType=LA[f>>26],n.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=f&127,s.icvBottom=f>>7&127,s.icvDiag=f>>14&127,s.dgDiag=f>>21&15,s.icvFore=m&127,s.icvBack=m>>7&127,s.fsxButton=m>>14&1),s}function a8(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=r8(e,t,n.fStyle,r),n}function Ny(e,t,r,n){var s=r&&r.biff==5;n||(n=Ne(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),n.write_shift(4,l),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function n8(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function s8(e){var t=Ne(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Ey(e,t,r){var n=Dn(e);(r.biff==2||t==9)&&++e.l;var s=c5(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function i8(e,t,r,n,s,l){var o=Ne(8);return ki(e,t,n,o),eb(r,l,o),o}function l8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Dn(e),s=Zr(e);return n.val=s,n}function c8(e,t,r,n){var s=Ne(14);return ki(e,t,n,s),Ei(r,s),s}var Ty=v5;function o8(e,t,r){var n=e.l+t,s=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=Ti(e,l),f=[];n>e.l;)f.push(Oo(e));return[l,s,o,f]}function ky(e,t,r){var n=e.read_shift(2),s,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=w5(e,t-2,r)),l.body=s||e.read_shift(t-2),typeof s=="string"&&(l.Name=s),l}var u8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ay(e,t,r){var n=e.l+t,s=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),f=e.read_shift(r&&r.biff==2?1:2),m=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),m=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var h=Ti(e,o,r);s&32&&(h=u8[h.charCodeAt(0)]);var x=n-e.l;r&&r.biff==2&&--x;var g=n==e.l||f===0||!(x>0)?[]:ER(e,x,r,f);return{chKey:l,Name:h,itab:m,rgce:g}}function cb(e,t,r){if(r.biff<8)return f8(e,t,r);for(var n=[],s=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)n.push(y5(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function f8(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Do(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function d8(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),l=Ti(e,n,r),o=Ti(e,s,r);return[l,o]}function h8(e,t,r){var n=ib(e);e.l++;var s=e.read_shift(1);return t-=8,[TR(e,t,r),s,n]}function Cy(e,t,r){var n=b5(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,SR(e,t,r)]}function m8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function x8(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),f=Li(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},f,o,l]}}function p8(e,t,r){return x8(e,t,r)}function g8(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Qu(e));return r}function v8(e){var t=Ne(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)sb(e[r],t);return t}function y8(e,t,r){if(r&&r.biff<8)return b8(e,t,r);var n=lb(e),s=E5(e,t-22,n[1]);return{cmo:n,ft:s}}var w8={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function b8(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((w8[n]||ea)(e,t,r)),{cmo:[s,n,l],ft:o}}function _8(e,t,r){var n=e.l,s="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=f5(e,6,r);var f=e.read_shift(2);e.read_shift(2),yr(e,2);var m=e.read_shift(2);e.l+=m;for(var h=1;h<e.lens.length-1;++h){if(e.l-n!=e.lens[h])throw new Error("TxO: bad continue record");var x=e[e.l],g=Ti(e,e.lens[h+1]-e.lens[h]-1);if(s+=g,s.length>=(x?f:2*f))break}if(s.length!==f&&s.length!==f*2)throw new Error("cchText: "+f+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function S8(e,t){var r=Qu(e);e.l+=16;var n=x5(e,t-24);return[r,n]}function N8(e){var t=Ne(24),r=nr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Fr([t,p5(e[1])])}function E8(e,t){e.read_shift(2);var r=Qu(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Qr,""),[r,n]}function T8(e){var t=e[1].Tooltip,r=Ne(10+2*(t.length+1));r.write_shift(2,2048);var n=nr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function k8(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=hy[r]||r,r=e.read_shift(2),t[1]=hy[r]||r,t}function A8(e){return e||(e=Ne(4)),e.write_shift(2,1),e.write_shift(2,1),e}function C8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ab(e));return r}function j8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ab(e));return r}function F8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function ob(e,t,r){if(!r.cellStyles)return ea(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),f=e.read_shift(n),m=e.read_shift(2);n==2&&(e.l+=2);var h={s,e:l,w:o,ixfe:f,flags:m};return(r.biff>=5||!r.biff)&&(h.level=m>>8&7),h}function R8(e,t){var r=Ne(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function D8(e,t){var r={};return t<32||(e.l+=16,r.header=Zr(e),r.footer=Zr(e),e.l+=2),r}function O8(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function M8(e){for(var t=Ne(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var L8=Dn,B8=Jw,U8=Oo;function I8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function P8(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Dn(e);++e.l;var s=Li(e,t-7,r);return n.t="str",n.val=s,n}function z8(e){var t=Dn(e);++e.l;var r=Zr(e);return t.t="n",t.val=r,t}function H8(e,t,r){var n=Ne(15);return Uo(n,e,t),n.write_shift(8,r,"f"),n}function V8(e){var t=Dn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function G8(e,t,r){var n=Ne(9);return Uo(n,e,t),n.write_shift(2,r),n}function X8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function $8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Y8(e,t,r){var n=e.l+t,s=Dn(e),l=e.read_shift(2),o=Ti(e,l,r);return e.l=n,s.t="str",s.val=o,s}var q8=[2,3,48,49,131,139,140,245],im=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=qu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(f,m){var h=[],x=Ps(1);switch(m.type){case"base64":x=Ca(Ra(f));break;case"binary":x=Ca(f);break;case"buffer":case"array":x=f;break}Ur(x,0);var g=x.read_shift(1),y=!!(g&136),S=!1,w=!1;switch(g){case 2:break;case 3:break;case 48:S=!0,y=!0;break;case 49:S=!0,y=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var b=0,_=521;g==2&&(b=x.read_shift(2)),x.l+=3,g!=2&&(b=x.read_shift(4)),b>1048576&&(b=1e6),g!=2&&(_=x.read_shift(2));var T=x.read_shift(2),N=m.codepage||1252;g!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(N=e[x[x.l]]),x.l+=1,x.l+=2),w&&(x.l+=36);for(var E=[],j={},F=Math.min(x.length,g==2?521:_-10-(S?264:0)),R=w?32:11;x.l<F&&x[x.l]!=13;)switch(j={},j.name=Et.utils.decode(N,x.slice(x.l,x.l+R)).replace(/[\u0000\r\n].*$/g,""),x.l+=R,j.type=String.fromCharCode(x.read_shift(1)),g!=2&&!w&&(j.offset=x.read_shift(4)),j.len=x.read_shift(1),g==2&&(j.offset=x.read_shift(2)),j.dec=x.read_shift(1),j.name.length&&E.push(j),g!=2&&(x.l+=w?13:14),j.type){case"B":(!S||j.len!=8)&&m.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(x[x.l]!==13&&(x.l=_-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=_;var A=0,P=0;for(h[0]=[],P=0;P!=E.length;++P)h[0][P]=E[P].name;for(;b-- >0;){if(x[x.l]===42){x.l+=T;continue}for(++x.l,h[++A]=[],P=0,P=0;P!=E.length;++P){var U=x.slice(x.l,x.l+E[P].len);x.l+=E[P].len,Ur(U,0);var ee=Et.utils.decode(N,U);switch(E[P].type){case"C":ee.trim().length&&(h[A][P]=ee.replace(/\s+$/,""));break;case"D":ee.length===8?h[A][P]=new Date(+ee.slice(0,4),+ee.slice(4,6)-1,+ee.slice(6,8)):h[A][P]=ee;break;case"F":h[A][P]=parseFloat(ee.trim());break;case"+":case"I":h[A][P]=w?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(ee.trim().toUpperCase()){case"Y":case"T":h[A][P]=!0;break;case"N":case"F":h[A][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ee+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));h[A][P]="##MEMO##"+(w?parseInt(ee.trim(),10):U.read_shift(4));break;case"N":ee=ee.replace(/\u0000/g,"").trim(),ee&&ee!="."&&(h[A][P]=+ee||0);break;case"@":h[A][P]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":h[A][P]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":h[A][P]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[A][P]=-U.read_shift(-8,"f");break;case"B":if(S&&E[P].len==8){h[A][P]=U.read_shift(8,"f");break}case"G":case"P":U.l+=E[P].len;break;case"0":if(E[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[P].type)}}}if(g!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return m&&m.sheetRows&&(h=h.slice(0,m.sheetRows)),m.DBF=E,h}function n(f,m){var h=m||{};h.dateNF||(h.dateNF="yyyymmdd");var x=Pl(r(f,h),h);return x["!cols"]=h.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete h.DBF,x}function s(f,m){try{return Ys(n(f,m),m)}catch(h){if(m&&m.WTF)throw h}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(f,m){var h=m||{};if(+h.codepage>=0&&Za(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var x=ya(),g=Du(f,{header:1,raw:!0,cellDates:!0}),y=g[0],S=g.slice(1),w=f["!cols"]||[],b=0,_=0,T=0,N=1;for(b=0;b<y.length;++b){if(((w[b]||{}).DBF||{}).name){y[b]=w[b].DBF.name,++T;continue}if(y[b]!=null){if(++T,typeof y[b]=="number"&&(y[b]=y[b].toString(10)),typeof y[b]!="string")throw new Error("DBF Invalid column name "+y[b]+" |"+typeof y[b]+"|");if(y.indexOf(y[b])!==b){for(_=0;_<1024;++_)if(y.indexOf(y[b]+"_"+_)==-1){y[b]+="_"+_;break}}}}var E=St(f["!ref"]),j=[],F=[],R=[];for(b=0;b<=E.e.c-E.s.c;++b){var A="",P="",U=0,ee=[];for(_=0;_<S.length;++_)S[_][b]!=null&&ee.push(S[_][b]);if(ee.length==0||y[b]==null){j[b]="?";continue}for(_=0;_<ee.length;++_){switch(typeof ee[_]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=ee[_]instanceof Date?"D":"C";break;default:P="C"}U=Math.max(U,String(ee[_]).length),A=A&&A!=P?"C":P}U>250&&(U=250),P=((w[b]||{}).DBF||{}).type,P=="C"&&w[b].DBF.len>U&&(U=w[b].DBF.len),A=="B"&&P=="N"&&(A="N",R[b]=w[b].DBF.dec,U=w[b].DBF.len),F[b]=A=="C"||P=="N"?U:l[A]||0,N+=F[b],j[b]=A}var W=x.next(32);for(W.write_shift(4,318902576),W.write_shift(4,S.length),W.write_shift(2,296+32*T),W.write_shift(2,N),b=0;b<4;++b)W.write_shift(4,0);for(W.write_shift(4,0|(+t[_i]||3)<<8),b=0,_=0;b<y.length;++b)if(y[b]!=null){var J=x.next(32),xe=(y[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);J.write_shift(1,xe,"sbcs"),J.write_shift(1,j[b]=="?"?"C":j[b],"sbcs"),J.write_shift(4,_),J.write_shift(1,F[b]||l[j[b]]||0),J.write_shift(1,R[b]||0),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(1,0),J.write_shift(4,0),J.write_shift(4,0),_+=F[b]||l[j[b]]||0}var pe=x.next(264);for(pe.write_shift(4,13),b=0;b<65;++b)pe.write_shift(4,0);for(b=0;b<S.length;++b){var we=x.next(N);for(we.write_shift(1,0),_=0;_<y.length;++_)if(y[_]!=null)switch(j[_]){case"L":we.write_shift(1,S[b][_]==null?63:S[b][_]?84:70);break;case"B":we.write_shift(8,S[b][_]||0,"f");break;case"N":var Q="0";for(typeof S[b][_]=="number"&&(Q=S[b][_].toFixed(R[_]||0)),T=0;T<F[_]-Q.length;++T)we.write_shift(1,32);we.write_shift(1,Q,"sbcs");break;case"D":S[b][_]?(we.write_shift(4,("0000"+S[b][_].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(S[b][_].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+S[b][_].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(S[b][_]!=null?S[b][_]:"").slice(0,F[_]);for(we.write_shift(1,ie,"sbcs"),T=0;T<F[_]-ie.length;++T)we.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),ub=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ur(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,S){var w=e[S];return typeof w=="number"?Qh(w):w},n=function(y,S,w){var b=S.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?y:Qh(b)};e["|"]=254;function s(y,S){switch(S.type){case"base64":return l(Ra(y),S);case"binary":return l(y,S);case"buffer":return l(gt&&Buffer.isBuffer(y)?y.toString("binary"):$s(y),S);case"array":return l(Ni(y),S)}throw new Error("Unrecognized type "+S.type)}function l(y,S){var w=y.split(/[\n\r]+/),b=-1,_=-1,T=0,N=0,E=[],j=[],F=null,R={},A=[],P=[],U=[],ee=0,W;for(+S.codepage>=0&&Za(+S.codepage);T!==w.length;++T){ee=0;var J=w[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),xe=J.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),pe=xe[0],we;if(J.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":xe[1].charAt(0)=="P"&&j.push(J.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,ie=!1,Ae=!1,re=!1,z=-1,te=-1;for(N=1;N<xe.length;++N)switch(xe[N].charAt(0)){case"A":break;case"X":_=parseInt(xe[N].slice(1))-1,ie=!0;break;case"Y":for(b=parseInt(xe[N].slice(1))-1,ie||(_=0),W=E.length;W<=b;++W)E[W]=[];break;case"K":we=xe[N].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(un(we))?isNaN(Al(we).getDate())||(we=er(we)):(we=un(we),F!==null&&ji(F)&&(we=Ku(we))),typeof Et<"u"&&typeof we=="string"&&(S||{}).type!="string"&&(S||{}).codepage&&(we=Et.utils.decode(S.codepage,we)),Q=!0;break;case"E":re=!0;var D=El(xe[N].slice(1),{r:b,c:_});E[b][_]=[E[b][_],D];break;case"S":Ae=!0,E[b][_]=[E[b][_],"S5S"];break;case"G":break;case"R":z=parseInt(xe[N].slice(1))-1;break;case"C":te=parseInt(xe[N].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+J)}if(Q&&(E[b][_]&&E[b][_].length==2?E[b][_][0]=we:E[b][_]=we,F=null),Ae){if(re)throw new Error("SYLK shared formula cannot have own formula");var V=z>-1&&E[z][te];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");E[b][_][1]=Ab(V[1],{r:b-z,c:_-te})}break;case"F":var M=0;for(N=1;N<xe.length;++N)switch(xe[N].charAt(0)){case"X":_=parseInt(xe[N].slice(1))-1,++M;break;case"Y":for(b=parseInt(xe[N].slice(1))-1,W=E.length;W<=b;++W)E[W]=[];break;case"M":ee=parseInt(xe[N].slice(1))/20;break;case"F":break;case"G":break;case"P":F=j[parseInt(xe[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=xe[N].slice(1).split(" "),W=parseInt(U[0],10);W<=parseInt(U[1],10);++W)ee=parseInt(U[2],10),P[W-1]=ee===0?{hidden:!0}:{wch:ee},zs(P[W-1]);break;case"C":_=parseInt(xe[N].slice(1))-1,P[_]||(P[_]={});break;case"R":b=parseInt(xe[N].slice(1))-1,A[b]||(A[b]={}),ee>0?(A[b].hpt=ee,A[b].hpx=jl(ee)):ee===0&&(A[b].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+J)}M<1&&(F=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+J)}}return A.length>0&&(R["!rows"]=A),P.length>0&&(R["!cols"]=P),S&&S.sheetRows&&(E=E.slice(0,S.sheetRows)),[E,R]}function o(y,S){var w=s(y,S),b=w[0],_=w[1],T=Pl(b,S);return ur(_).forEach(function(N){T[N]=_[N]}),T}function f(y,S){return Ys(o(y,S),S)}function m(y,S,w,b){var _="C;Y"+(w+1)+";X"+(b+1)+";K";switch(y.t){case"n":_+=y.v||0,y.f&&!y.F&&(_+=";E"+nx(y.f,{r:w,c:b}));break;case"b":_+=y.v?"TRUE":"FALSE";break;case"e":_+=y.w||y.v;break;case"d":_+='"'+(y.w||y.v)+'"';break;case"s":_+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function h(y,S){S.forEach(function(w,b){var _="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?_+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=go(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=vo(w.wpx)),typeof w.wch=="number"&&(_+=Math.round(w.wch))),_.charAt(_.length-1)!=" "&&y.push(_)})}function x(y,S){S.forEach(function(w,b){var _="F;";w.hidden?_+="M0;":w.hpt?_+="M"+20*w.hpt+";":w.hpx&&(_+="M"+20*yo(w.hpx)+";"),_.length>2&&y.push(_+"R"+(b+1))})}function g(y,S){var w=["ID;PWXL;N;E"],b=[],_=St(y["!ref"]),T,N=Array.isArray(y),E=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),y["!cols"]&&h(w,y["!cols"]),y["!rows"]&&x(w,y["!rows"]),w.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var j=_.s.r;j<=_.e.r;++j)for(var F=_.s.c;F<=_.e.c;++F){var R=rt({r:j,c:F});T=N?(y[j]||[])[F]:y[R],!(!T||T.v==null&&(!T.f||T.F))&&b.push(m(T,y,j,F))}return w.join(E)+E+b.join(E)+E+"E"+E}return{to_workbook:f,to_sheet:o,from_sheet:g}}(),fb=function(){function e(l,o){switch(o.type){case"base64":return t(Ra(l),o);case"binary":return t(l,o);case"buffer":return t(gt&&Buffer.isBuffer(l)?l.toString("binary"):$s(l),o);case"array":return t(Ni(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var f=l.split(`
`),m=-1,h=-1,x=0,g=[];x!==f.length;++x){if(f[x].trim()==="BOT"){g[++m]=[],h=0;continue}if(!(m<0)){var y=f[x].trim().split(","),S=y[0],w=y[1];++x;for(var b=f[x]||"";(b.match(/["]/g)||[]).length&1&&x<f.length-1;)b+=`
`+f[++x];switch(b=b.trim(),+S){case-1:if(b==="BOT"){g[++m]=[],h=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?g[m][h]=!0:b==="FALSE"?g[m][h]=!1:isNaN(un(w))?isNaN(Al(w).getDate())?g[m][h]=w:g[m][h]=er(w):g[m][h]=un(w),++h;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),g[m][h++]=b!==""?b:null;break}if(b==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(l,o){return Pl(e(l,o),o)}function n(l,o){return Ys(r(l,o),o)}var s=function(){var l=function(m,h,x,g,y){m.push(h),m.push(x+","+g),m.push('"'+y.replace(/"/g,'""')+'"')},o=function(m,h,x,g){m.push(h+","+x),m.push(h==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(m){var h=[],x=St(m["!ref"]),g,y=Array.isArray(m);l(h,"TABLE",0,1,"sheetjs"),l(h,"VECTORS",0,x.e.r-x.s.r+1,""),l(h,"TUPLES",0,x.e.c-x.s.c+1,""),l(h,"DATA",0,0,"");for(var S=x.s.r;S<=x.e.r;++S){o(h,-1,0,"BOT");for(var w=x.s.c;w<=x.e.c;++w){var b=rt({r:S,c:w});if(g=y?(m[S]||[])[w]:m[b],!g){o(h,1,0,"");continue}switch(g.t){case"n":var _=g.w;!_&&g.v!=null&&(_=g.v),_==null?g.f&&!g.F?o(h,1,0,"="+g.f):o(h,1,0,""):o(h,0,_,"V");break;case"b":o(h,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Da(g.z||Ze[14],Sr(er(g.v)))),o(h,0,g.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var T=`\r
`,N=h.join(T);return N}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),db=function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,y){for(var S=g.split(`
`),w=-1,b=-1,_=0,T=[];_!==S.length;++_){var N=S[_].trim().split(":");if(N[0]==="cell"){var E=nr(N[1]);if(T.length<=E.r)for(w=T.length;w<=E.r;++w)T[w]||(T[w]=[]);switch(w=E.r,b=E.c,N[2]){case"t":T[w][b]=e(N[3]);break;case"v":T[w][b]=+N[3];break;case"vtf":var j=N[N.length-1];case"vtc":switch(N[3]){case"nl":T[w][b]=!!+N[4];break;default:T[w][b]=+N[4];break}N[2]=="vtf"&&(T[w][b]=[T[w][b],j])}}}return y&&y.sheetRows&&(T=T.slice(0,y.sheetRows)),T}function n(g,y){return Pl(r(g,y),y)}function s(g,y){return Ys(n(g,y),y)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function h(g){if(!g||!g["!ref"])return"";for(var y=[],S=[],w,b="",_=la(g["!ref"]),T=Array.isArray(g),N=_.s.r;N<=_.e.r;++N)for(var E=_.s.c;E<=_.e.c;++E)if(b=rt({r:N,c:E}),w=T?(g[N]||[])[E]:g[b],!(!w||w.v==null||w.t==="z")){switch(S=["cell",b,"t"],w.t){case"s":case"str":S.push(t(w.v));break;case"n":w.f?(S[2]="vtf",S[3]="n",S[4]=w.v,S[5]=t(w.f)):(S[2]="v",S[3]=w.v);break;case"b":S[2]="vt"+(w.f?"f":"c"),S[3]="nl",S[4]=w.v?"1":"0",S[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var j=Sr(er(w.v));S[2]="vtc",S[3]="nd",S[4]=""+j,S[5]=w.w||Da(w.z||Ze[14],j);break;case"e":continue}y.push(S.join(":"))}return y.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function x(g){return[l,o,f,o,h(g),m].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:x}}(),Cl=function(){function e(x,g,y,S,w){w.raw?g[y][S]=x:x===""||(x==="TRUE"?g[y][S]=!0:x==="FALSE"?g[y][S]=!1:isNaN(un(x))?isNaN(Al(x).getDate())?g[y][S]=x:g[y][S]=er(x):g[y][S]=un(x))}function t(x,g){var y=g||{},S=[];if(!x||x.length===0)return S;for(var w=x.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var _=10,T=0,N=0;N<=b;++N)T=w[N].indexOf(" "),T==-1?T=w[N].length:T++,_=Math.max(_,T);for(N=0;N<=b;++N){S[N]=[];var E=0;for(e(w[N].slice(0,_).trim(),S,N,E,y),E=1;E<=(w[N].length-_)/10+1;++E)e(w[N].slice(_+(E-1)*10,_+E*10).trim(),S,N,E,y)}return y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(x){for(var g={},y=!1,S=0,w=0;S<x.length;++S)(w=x.charCodeAt(S))==34?y=!y:!y&&w in r&&(g[w]=(g[w]||0)+1);w=[];for(S in g)Object.prototype.hasOwnProperty.call(g,S)&&w.push([g[S],S]);if(!w.length){g=n;for(S in g)Object.prototype.hasOwnProperty.call(g,S)&&w.push([g[S],S])}return w.sort(function(b,_){return b[0]-_[0]||n[b[1]]-n[_[1]]}),r[w.pop()[1]]||44}function l(x,g){var y=g||{},S="",w=y.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(S=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(S=x.charAt(4),x=x.slice(6)):S=s(x.slice(0,1024)):y&&y.FS?S=y.FS:S=s(x.slice(0,1024));var _=0,T=0,N=0,E=0,j=0,F=S.charCodeAt(0),R=!1,A=0,P=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var U=y.dateNF!=null?D6(y.dateNF):null;function ee(){var W=x.slice(E,j),J={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)J.t="z";else if(y.raw)J.t="s",J.v=W;else if(W.trim().length===0)J.t="s",J.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(J.t="s",J.v=W.slice(2,-1).replace(/""/g,'"')):oF(W)?(J.t="n",J.f=W.slice(1)):(J.t="s",J.v=W);else if(W=="TRUE")J.t="b",J.v=!0;else if(W=="FALSE")J.t="b",J.v=!1;else if(!isNaN(N=un(W)))J.t="n",y.cellText!==!1&&(J.w=W),J.v=N;else if(!isNaN(Al(W).getDate())||U&&W.match(U)){J.z=y.dateNF||Ze[14];var xe=0;U&&W.match(U)&&(W=O6(W,y.dateNF,W.match(U)||[]),xe=1),y.cellDates?(J.t="d",J.v=er(W,xe)):(J.t="n",J.v=Sr(er(W,xe))),y.cellText!==!1&&(J.w=Da(J.z,J.v instanceof Date?Sr(J.v):J.v)),y.cellNF||delete J.z}else J.t="s",J.v=W;if(J.t=="z"||(y.dense?(w[_]||(w[_]=[]),w[_][T]=J):w[rt({c:T,r:_})]=J),E=j+1,P=x.charCodeAt(E),b.e.c<T&&(b.e.c=T),b.e.r<_&&(b.e.r=_),A==F)++T;else if(T=0,++_,y.sheetRows&&y.sheetRows<=_)return!0}e:for(;j<x.length;++j)switch(A=x.charCodeAt(j)){case 34:P===34&&(R=!R);break;case F:case 10:case 13:if(!R&&ee())break e;break}return j-E>0&&ee(),w["!ref"]=dt(b),w}function o(x,g){return!(g&&g.PRN)||g.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?l(x,g):Pl(t(x,g),g)}function f(x,g){var y="",S=g.type=="string"?[0,0,0,0]:hx(x,g);switch(g.type){case"base64":y=Ra(x);break;case"binary":y=x;break;case"buffer":g.codepage==65001?y=x.toString("utf8"):g.codepage&&typeof Et<"u"?y=Et.utils.decode(g.codepage,x):y=gt&&Buffer.isBuffer(x)?x.toString("binary"):$s(x);break;case"array":y=Ni(x);break;case"string":y=x;break;default:throw new Error("Unrecognized type "+g.type)}return S[0]==239&&S[1]==187&&S[2]==191?y=Gt(y.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?y=Gt(y):g.type=="binary"&&typeof Et<"u"&&g.codepage&&(y=Et.utils.decode(g.codepage,Et.utils.encode(28591,y))),y.slice(0,19)=="socialcalc:version:"?db.to_sheet(g.type=="string"?y:Gt(y),g):o(y,g)}function m(x,g){return Ys(f(x,g),g)}function h(x){for(var g=[],y=St(x["!ref"]),S,w=Array.isArray(x),b=y.s.r;b<=y.e.r;++b){for(var _=[],T=y.s.c;T<=y.e.c;++T){var N=rt({r:b,c:T});if(S=w?(x[b]||[])[T]:x[N],!S||S.v==null){_.push("          ");continue}for(var E=(S.w||(Fn(S),S.w)||"").slice(0,10);E.length<10;)E+=" ";_.push(E+(T===0?" ":""))}g.push(_.join(""))}return g.join(`
`)}return{to_workbook:m,to_sheet:f,from_sheet:h}}();function W8(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=ub.to_workbook(e,r);return r.WTF=n,s}catch(l){if(r.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return Cl.to_workbook(e,t)}}var gi=function(){function e(D,V,M){if(D){Ur(D,D.l||0);for(var B=M.Enum||z;D.l<D.length;){var K=D.read_shift(2),oe=B[K]||B[65535],ye=D.read_shift(2),_e=D.l+ye,ae=oe.f&&oe.f(D,ye,M);if(D.l=_e,V(ae,oe,K))return}}}function t(D,V){switch(V.type){case"base64":return r(Ca(Ra(D)),V);case"binary":return r(Ca(D),V);case"buffer":case"array":return r(D,V)}throw"Unsupported type "+V.type}function r(D,V){if(!D)return D;var M=V||{},B=M.dense?[]:{},K="Sheet1",oe="",ye=0,_e={},ae=[],He=[],Y={s:{r:0,c:0},e:{r:0,c:0}},ct=M.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)M.Enum=z,e(D,function(Me,vt,De){switch(De){case 0:M.vers=Me,Me>=4096&&(M.qpro=!0);break;case 6:Y=Me;break;case 204:Me&&(oe=Me);break;case 222:oe=Me;break;case 15:case 51:M.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:De==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=M.dateNF||Ze[14],M.cellDates&&(Me[1].t="d",Me[1].v=Ku(Me[1].v))),M.qpro&&Me[3]>ye&&(B["!ref"]=dt(Y),_e[K]=B,ae.push(K),B=M.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ye=Me[3],K=oe||"Sheet"+(ye+1),oe="");var at=M.dense?(B[Me[0].r]||[])[Me[0].c]:B[rt(Me[0])];if(at){at.t=Me[1].t,at.v=Me[1].v,Me[1].z!=null&&(at.z=Me[1].z),Me[1].f!=null&&(at.f=Me[1].f);break}M.dense?(B[Me[0].r]||(B[Me[0].r]=[]),B[Me[0].r][Me[0].c]=Me[1]):B[rt(Me[0])]=Me[1];break}},M);else if(D[2]==26||D[2]==14)M.Enum=te,D[2]==14&&(M.qpro=!0,D.l=0),e(D,function(Me,vt,De){switch(De){case 204:K=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>ye&&(B["!ref"]=dt(Y),_e[K]=B,ae.push(K),B=M.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ye=Me[3],K="Sheet"+(ye+1)),ct>0&&Me[0].r>=ct)break;M.dense?(B[Me[0].r]||(B[Me[0].r]=[]),B[Me[0].r][Me[0].c]=Me[1]):B[rt(Me[0])]=Me[1],Y.e.c<Me[0].c&&(Y.e.c=Me[0].c),Y.e.r<Me[0].r&&(Y.e.r=Me[0].r);break;case 27:Me[14e3]&&(He[Me[14e3][0]]=Me[14e3][1]);break;case 1537:He[Me[0]]=Me[1],Me[0]==ye&&(K=Me[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(B["!ref"]=dt(Y),_e[oe||K]=B,ae.push(oe||K),!He.length)return{SheetNames:ae,Sheets:_e};for(var $e={},xt=[],et=0;et<He.length;++et)_e[ae[et]]?(xt.push(He[et]||ae[et]),$e[He[et]]=_e[He[et]]||_e[ae[et]]):(xt.push(He[et]),$e[He[et]]={"!ref":"A1"});return{SheetNames:xt,Sheets:$e}}function n(D,V){var M=V||{};if(+M.codepage>=0&&Za(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var B=ya(),K=St(D["!ref"]),oe=Array.isArray(D),ye=[];Ie(B,0,l(1030)),Ie(B,6,m(K));for(var _e=Math.min(K.e.r,8191),ae=K.s.r;ae<=_e;++ae)for(var He=cr(ae),Y=K.s.c;Y<=K.e.c;++Y){ae===K.s.r&&(ye[Y]=Jt(Y));var ct=ye[Y]+He,$e=oe?(D[ae]||[])[Y]:D[ct];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?Ie(B,13,S(ae,Y,$e.v)):Ie(B,14,b(ae,Y,$e.v));else{var xt=Fn($e);Ie(B,15,g(ae,Y,xt.slice(0,239)))}}return Ie(B,1),B.end()}function s(D,V){var M=V||{};if(+M.codepage>=0&&Za(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var B=ya();Ie(B,0,o(D));for(var K=0,oe=0;K<D.SheetNames.length;++K)(D.Sheets[D.SheetNames[K]]||{})["!ref"]&&Ie(B,27,re(D.SheetNames[K],oe++));var ye=0;for(K=0;K<D.SheetNames.length;++K){var _e=D.Sheets[D.SheetNames[K]];if(!(!_e||!_e["!ref"])){for(var ae=St(_e["!ref"]),He=Array.isArray(_e),Y=[],ct=Math.min(ae.e.r,8191),$e=ae.s.r;$e<=ct;++$e)for(var xt=cr($e),et=ae.s.c;et<=ae.e.c;++et){$e===ae.s.r&&(Y[et]=Jt(et));var Me=Y[et]+xt,vt=He?(_e[$e]||[])[et]:_e[Me];if(!(!vt||vt.t=="z"))if(vt.t=="n")Ie(B,23,ee($e,et,ye,vt.v));else{var De=Fn(vt);Ie(B,22,A($e,et,ye,De.slice(0,239)))}}++ye}}return Ie(B,1),B.end()}function l(D){var V=Ne(2);return V.write_shift(2,D),V}function o(D){var V=Ne(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var M=0,B=0,K=0,oe=0;oe<D.SheetNames.length;++oe){var ye=D.SheetNames[oe],_e=D.Sheets[ye];if(!(!_e||!_e["!ref"])){++K;var ae=la(_e["!ref"]);M<ae.e.r&&(M=ae.e.r),B<ae.e.c&&(B=ae.e.c)}}return M>8191&&(M=8191),V.write_shift(2,M),V.write_shift(1,K),V.write_shift(1,B),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function f(D,V,M){var B={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&M.qpro?(B.s.c=D.read_shift(1),D.l++,B.s.r=D.read_shift(2),B.e.c=D.read_shift(1),D.l++,B.e.r=D.read_shift(2),B):(B.s.c=D.read_shift(2),B.s.r=D.read_shift(2),V==12&&M.qpro&&(D.l+=2),B.e.c=D.read_shift(2),B.e.r=D.read_shift(2),V==12&&M.qpro&&(D.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function m(D){var V=Ne(8);return V.write_shift(2,D.s.c),V.write_shift(2,D.s.r),V.write_shift(2,D.e.c),V.write_shift(2,D.e.r),V}function h(D,V,M){var B=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(B[0].c=D.read_shift(1),B[3]=D.read_shift(1),B[0].r=D.read_shift(2),D.l+=2):(B[2]=D.read_shift(1),B[0].c=D.read_shift(2),B[0].r=D.read_shift(2)),B}function x(D,V,M){var B=D.l+V,K=h(D,V,M);if(K[1].t="s",M.vers==20768){D.l++;var oe=D.read_shift(1);return K[1].v=D.read_shift(oe,"utf8"),K}return M.qpro&&D.l++,K[1].v=D.read_shift(B-D.l,"cstr"),K}function g(D,V,M){var B=Ne(7+M.length);B.write_shift(1,255),B.write_shift(2,V),B.write_shift(2,D),B.write_shift(1,39);for(var K=0;K<B.length;++K){var oe=M.charCodeAt(K);B.write_shift(1,oe>=128?95:oe)}return B.write_shift(1,0),B}function y(D,V,M){var B=h(D,V,M);return B[1].v=D.read_shift(2,"i"),B}function S(D,V,M){var B=Ne(7);return B.write_shift(1,255),B.write_shift(2,V),B.write_shift(2,D),B.write_shift(2,M,"i"),B}function w(D,V,M){var B=h(D,V,M);return B[1].v=D.read_shift(8,"f"),B}function b(D,V,M){var B=Ne(13);return B.write_shift(1,255),B.write_shift(2,V),B.write_shift(2,D),B.write_shift(8,M,"f"),B}function _(D,V,M){var B=D.l+V,K=h(D,V,M);if(K[1].v=D.read_shift(8,"f"),M.qpro)D.l=B;else{var oe=D.read_shift(2);j(D.slice(D.l,D.l+oe),K),D.l+=oe}return K}function T(D,V,M){var B=V&32768;return V&=-32769,V=(B?D:0)+(V>=8192?V-16384:V),(B?"":"$")+(M?Jt(V):cr(V))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(D,V){Ur(D,0);for(var M=[],B=0,K="",oe="",ye="",_e="";D.l<D.length;){var ae=D[D.l++];switch(ae){case 0:M.push(D.read_shift(8,"f"));break;case 1:oe=T(V[0].c,D.read_shift(2),!0),K=T(V[0].r,D.read_shift(2),!1),M.push(oe+K);break;case 2:{var He=T(V[0].c,D.read_shift(2),!0),Y=T(V[0].r,D.read_shift(2),!1);oe=T(V[0].c,D.read_shift(2),!0),K=T(V[0].r,D.read_shift(2),!1),M.push(He+Y+":"+oe+K)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(D.read_shift(2));break;case 6:{for(var ct="";ae=D[D.l++];)ct+=String.fromCharCode(ae);M.push('"'+ct.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:_e=M.pop(),ye=M.pop(),M.push(["AND","OR"][ae-20]+"("+ye+","+_e+")");break;default:if(ae<32&&E[ae])_e=M.pop(),ye=M.pop(),M.push(ye+E[ae]+_e);else if(N[ae]){if(B=N[ae][1],B==69&&(B=D[D.l++]),B>M.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+M.join("|")+"|");return}var $e=M.slice(-B);M.length-=B,M.push(N[ae][0]+"("+$e.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}M.length==1?V[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function F(D){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=D.read_shift(2),V[3]=D[D.l++],V[0].c=D[D.l++],V}function R(D,V){var M=F(D);return M[1].t="s",M[1].v=D.read_shift(V-4,"cstr"),M}function A(D,V,M,B){var K=Ne(6+B.length);K.write_shift(2,D),K.write_shift(1,M),K.write_shift(1,V),K.write_shift(1,39);for(var oe=0;oe<B.length;++oe){var ye=B.charCodeAt(oe);K.write_shift(1,ye>=128?95:ye)}return K.write_shift(1,0),K}function P(D,V){var M=F(D);M[1].v=D.read_shift(2);var B=M[1].v>>1;if(M[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return M[1].v=B,M}function U(D,V){var M=F(D),B=D.read_shift(4),K=D.read_shift(4),oe=D.read_shift(2);if(oe==65535)return B===0&&K===3221225472?(M[1].t="e",M[1].v=15):B===0&&K===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var ye=oe&32768;return oe=(oe&32767)-16446,M[1].v=(1-ye*2)*(K*Math.pow(2,oe+32)+B*Math.pow(2,oe)),M}function ee(D,V,M,B){var K=Ne(14);if(K.write_shift(2,D),K.write_shift(1,M),K.write_shift(1,V),B==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var oe=0,ye=0,_e=0,ae=0;return B<0&&(oe=1,B=-B),ye=Math.log2(B)|0,B/=Math.pow(2,ye-31),ae=B>>>0,(ae&2147483648)==0&&(B/=2,++ye,ae=B>>>0),B-=ae,ae|=2147483648,ae>>>=0,B*=Math.pow(2,32),_e=B>>>0,K.write_shift(4,_e),K.write_shift(4,ae),ye+=16383+(oe?32768:0),K.write_shift(2,ye),K}function W(D,V){var M=U(D);return D.l+=V-14,M}function J(D,V){var M=F(D),B=D.read_shift(4);return M[1].v=B>>6,M}function xe(D,V){var M=F(D),B=D.read_shift(8,"f");return M[1].v=B,M}function pe(D,V){var M=xe(D);return D.l+=V-10,M}function we(D,V){return D[D.l+V-1]==0?D.read_shift(V,"cstr"):""}function Q(D,V){var M=D[D.l++];M>V-1&&(M=V-1);for(var B="";B.length<M;)B+=String.fromCharCode(D[D.l++]);return B}function ie(D,V,M){if(!(!M.qpro||V<21)){var B=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var K=D.read_shift(V-21,"cstr");return[B,K]}}function Ae(D,V){for(var M={},B=D.l+V;D.l<B;){var K=D.read_shift(2);if(K==14e3){for(M[K]=[0,""],M[K][0]=D.read_shift(2);D[D.l];)M[K][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return M}function re(D,V){var M=Ne(5+D.length);M.write_shift(2,14e3),M.write_shift(2,V);for(var B=0;B<D.length;++B){var K=D.charCodeAt(B);M[M.l++]=K>127?95:K}return M[M.l++]=0,M}var z={0:{n:"BOF",f:yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:J},38:{n:"??"},39:{n:"NUMBER27",f:xe},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function K8(e){var t={},r=e.match(ra),n=0,s=!1;if(r)for(;n!=r.length;++n){var l=it(r[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=km[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return t}var Z8=function(){var e=fo("t"),t=fo("rPr");function r(l){var o=l.match(e);if(!o)return{t:"s",v:""};var f={t:"s",v:Tt(o[1])},m=l.match(t);return m&&(f.s=K8(m[1])),f}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(f){return f.v})}}(),Q8=function(){var t=/(\r\n|\n)/g;function r(s,l,o){var f=[];s.u&&f.push("text-decoration: underline;"),s.uval&&f.push("text-underline-style:"+s.uval+";"),s.sz&&f.push("font-size:"+s.sz+"pt;"),s.outline&&f.push("text-effect: outline;"),s.shadow&&f.push("text-shadow: auto;"),l.push('<span style="'+f.join("")+'">'),s.b&&(l.push("<b>"),o.push("</b>")),s.i&&(l.push("<i>"),o.push("</i>")),s.strike&&(l.push("<s>"),o.push("</s>"));var m=s.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(l.push("<"+m+">"),o.push("</"+m+">")),o.push("</span>"),s}function n(s){var l=[[],s.v,[]];return s.v?(s.s&&r(s.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}}(),J8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,eC=/<(?:\w+:)?r>/,tC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Jm(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Tt(Gt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Gt(e),r&&(n.h=Mm(n.t))):e.match(eC)&&(n.r=Gt(e),n.t=Tt(Gt((e.replace(tC,"").match(J8)||[]).join("").replace(ra,""))),r&&(n.h=Q8(Z8(n.r)))),n):{t:""}}var rC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,aC=/<(?:\w+:)?(?:si|sstItem)>/g,nC=/<\/(?:\w+:)?(?:si|sstItem)>/;function sC(e,t){var r=[],n="";if(!e)return r;var s=e.match(rC);if(s){n=s[2].replace(aC,"").split(nC);for(var l=0;l!=n.length;++l){var o=Jm(n[l].trim(),t);o!=null&&(r[r.length]=o)}s=it(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var iC=/^\s|\s$|[\t\n\r]/;function hb(e,t){if(!t.bookSST)return"";var r=[mr];r[r.length]=Ue("sst",null,{xmlns:Fi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(iC)&&(l+=' xml:space="preserve"'),l+=">"+Ut(s.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function lC(e){return[e.read_shift(4),e.read_shift(4)]}function cC(e,t){var r=[],n=!1;return ss(e,function(l,o,f){switch(f){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}),r}function oC(e,t){return t||(t=Ne(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var uC=wA;function fC(e){var t=ya();Re(t,159,oC(e));for(var r=0;r<e.length;++r)Re(t,19,uC(e[r]));return Re(t,160),t.end()}function mb(e){if(typeof Et<"u")return Et.utils.encode(_i,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Jn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function dC(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Jn(e,4),t.U=Jn(e,4),t.W=Jn(e,4),t}function hC(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function mC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(hC(e));return t}function xC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function pC(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Jn(e,4),t.U=Jn(e,4),t.W=Jn(e,4),t}function gC(e){var t=pC(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function xb(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function pb(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function vC(e){var t=Jn(e);switch(t.Minor){case 2:return[t.Minor,yC(e)];case 3:return[t.Minor,wC()];case 4:return[t.Minor,bC(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function yC(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=xb(e,r),s=pb(e,e.length-e.l);return{t:"Std",h:n,v:s}}function wC(){throw new Error("File is password-protected: ECMA-376 Extensible")}function bC(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ra,function(l){var o=it(l);switch(Rn(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(f){n[f]=o[f]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function _C(e,t){var r={},n=r.EncryptionVersionInfo=Jn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=xb(e,s),t-=s,r.EncryptionVerifier=pb(e,t),r}function SC(e){var t={},r=t.EncryptionVersionInfo=Jn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ex(e){var t=0,r,n=mb(e),s=n.length+1,l,o,f,m,h;for(r=Ps(s),r[0]=n.length,l=1;l!=s;++l)r[l]=n[l-1];for(l=s-1;l>=0;--l)o=r[l],f=(t&16384)===0?0:1,m=t<<1&32767,h=f|m,t=h^o;return t^52811}var gb=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,f){return n(o^f)},l=function(o){for(var f=t[o.length-1],m=104,h=o.length-1;h>=0;--h)for(var x=o[h],g=0;g!=7;++g)x&64&&(f^=r[m]),x*=2,--m;return f};return function(o){for(var f=mb(o),m=l(f),h=f.length,x=Ps(16),g=0;g!=16;++g)x[g]=0;var y,S,w;for((h&1)===1&&(y=m>>8,x[h]=s(e[0],y),--h,y=m&255,S=f[f.length-1],x[h]=s(S,y));h>0;)--h,y=m>>8,x[h]=s(f[h],y),--h,y=m&255,x[h]=s(f[h],y);for(h=15,w=15-f.length;w>0;)y=m>>8,x[h]=s(e[w],y),--h,--w,y=m&255,x[h]=s(f[h],y),--h,--w;return x}}(),NC=function(e,t,r,n,s){s||(s=t),n||(n=gb(e));var l,o;for(l=0;l!=t.length;++l)o=t[l],o^=n[r],o=(o>>5|o<<3)&255,s[l]=o,++r;return[s,r,n]},EC=function(e){var t=0,r=gb(e);return function(n){var s=NC("",n,t,r);return t=s[1],s[0]}};function TC(e,t,r,n){var s={key:yr(e),verificationBytes:yr(e)};return r.password&&(s.verifier=ex(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=EC(r.password)),s}function kC(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=SC(e):n.Data=_C(e,t),n}function AC(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?kC(e,t-2,n):TC(e,r.biff>=8?t:t-2,r,n),n}var vb=function(){function e(s,l){switch(l.type){case"base64":return t(Ra(s),l);case"binary":return t(s,l);case"buffer":return t(gt&&Buffer.isBuffer(s)?s.toString("binary"):$s(s),l);case"array":return t(Ni(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var o=l||{},f=o.dense?[]:{},m=s.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(x,g){Array.isArray(f)&&(f[g]=[]);for(var y=/\\\w+\b/g,S=0,w,b=-1;w=y.exec(x);){switch(w[0]){case"\\cell":var _=x.slice(S,y.lastIndex-w[0].length);if(_[0]==" "&&(_=_.slice(1)),++b,_.length){var T={v:_,t:"s"};Array.isArray(f)?f[g][b]=T:f[rt({r:g,c:b})]=T}break}S=y.lastIndex}b>h.e.c&&(h.e.c=b)}),f["!ref"]=dt(h),f}function r(s,l){return Ys(e(s,l),l)}function n(s){for(var l=["{\\rtf1\\ansi"],o=St(s["!ref"]),f,m=Array.isArray(s),h=o.s.r;h<=o.e.r;++h){l.push("\\trowd\\trautofit1");for(var x=o.s.c;x<=o.e.c;++x)l.push("\\cellx"+(x+1));for(l.push("\\pard\\intbl"),x=o.s.c;x<=o.e.c;++x){var g=rt({r:h,c:x});f=m?(s[h]||[])[x]:s[g],!(!f||f.v==null&&(!f.f||f.F))&&(l.push(" "+(f.w||(Fn(f),f.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function CC(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function po(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function jC(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),l=Math.min(t,r,n),o=s-l;if(o===0)return[0,0,t];var f=0,m=0,h=s+l;switch(m=o/(h>1?2-h:h),s){case t:f=((r-n)/o+6)%6;break;case r:f=(n-t)/o+2;break;case n:f=(t-r)/o+4;break}return[f/6,m,h/2]}function FC(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),l=n-s/2,o=[l,l,l],f=6*t,m;if(r!==0)switch(f|0){case 0:case 6:m=s*f,o[0]+=s,o[1]+=m;break;case 1:m=s*(2-f),o[0]+=m,o[1]+=s;break;case 2:m=s*(f-2),o[1]+=s,o[2]+=m;break;case 3:m=s*(4-f),o[1]+=m,o[2]+=s;break;case 4:m=s*(f-4),o[2]+=s,o[0]+=m;break;case 5:m=s*(6-f),o[2]+=m,o[0]+=s;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function Cu(e,t){if(t===0)return e;var r=jC(CC(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),po(FC(r))}var yb=6,RC=15,DC=1,Wr=yb;function go(e){return Math.floor((e+Math.round(128/Wr)/256)*Wr)}function vo(e){return Math.floor((e-5)/Wr*100+.5)/100}function ju(e){return Math.round((e*Wr+5)/Wr*256)/256}function Ah(e){return ju(vo(go(e)))}function tx(e){var t=Math.abs(e-Ah(e)),r=Wr;if(t>.005)for(Wr=DC;Wr<RC;++Wr)Math.abs(e-Ah(e))<=t&&(t=Math.abs(e-Ah(e)),r=Wr);Wr=r}function zs(e){e.width?(e.wpx=go(e.width),e.wch=vo(e.wpx),e.MDW=Wr):e.wpx?(e.wch=vo(e.wpx),e.width=ju(e.wch),e.MDW=Wr):typeof e.wch=="number"&&(e.width=ju(e.wch),e.wpx=go(e.width),e.MDW=Wr),e.customWidth&&delete e.customWidth}var OC=96,wb=OC;function yo(e){return e*96/wb}function jl(e){return e*wb/96}var MC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function LC(e,t,r,n){t.Borders=[];var s={},l=!1;(e[0].match(ra)||[]).forEach(function(o){var f=it(o);switch(Rn(f[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},f.diagonalUp&&(s.diagonalUp=Qt(f.diagonalUp)),f.diagonalDown&&(s.diagonalDown=Qt(f.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in borders")}})}function BC(e,t,r,n){t.Fills=[];var s={},l=!1;(e[0].match(ra)||[]).forEach(function(o){var f=it(o);switch(Rn(f[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":f.patternType&&(s.patternType=f.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),f.indexed&&(s.bgColor.indexed=parseInt(f.indexed,10)),f.theme&&(s.bgColor.theme=parseInt(f.theme,10)),f.tint&&(s.bgColor.tint=parseFloat(f.tint)),f.rgb&&(s.bgColor.rgb=f.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),f.theme&&(s.fgColor.theme=parseInt(f.theme,10)),f.tint&&(s.fgColor.tint=parseFloat(f.tint)),f.rgb!=null&&(s.fgColor.rgb=f.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fills")}})}function UC(e,t,r,n){t.Fonts=[];var s={},l=!1;(e[0].match(ra)||[]).forEach(function(o){var f=it(o);switch(Rn(f[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":f.val&&(s.name=Gt(f.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=f.val?Qt(f.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=f.val?Qt(f.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(f.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=f.val?Qt(f.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=f.val?Qt(f.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=f.val?Qt(f.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=f.val?Qt(f.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=f.val?Qt(f.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":f.val&&(s.sz=+f.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":f.val&&(s.vertAlign=f.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":f.val&&(s.family=parseInt(f.val,10));break;case"<family/>":case"</family>":break;case"<scheme":f.val&&(s.scheme=f.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(f.val=="1")break;f.codepage=km[parseInt(f.val,10)];break;case"<color":if(s.color||(s.color={}),f.auto&&(s.color.auto=Qt(f.auto)),f.rgb)s.color.rgb=f.rgb.slice(-6);else if(f.indexed){s.color.index=parseInt(f.indexed,10);var m=xi[s.color.index];s.color.index==81&&(m=xi[1]),m||(m=xi[1]),s.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else f.theme&&(s.color.theme=parseInt(f.theme,10),f.tint&&(s.color.tint=parseFloat(f.tint)),f.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Cu(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fonts")}})}function IC(e,t,r){t.NumberFmt=[];for(var n=ur(Ze),s=0;s<n.length;++s)t.NumberFmt[n[s]]=Ze[n[s]];var l=e[0].match(ra);if(l)for(s=0;s<l.length;++s){var o=it(l[s]);switch(Rn(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var f=Tt(Gt(o.formatCode)),m=parseInt(o.numFmtId,10);if(t.NumberFmt[m]=f,m>0){if(m>392){for(m=392;m>60&&t.NumberFmt[m]!=null;--m);t.NumberFmt[m]=f}jn(f,m)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function PC(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ue("numFmt",null,{numFmtId:n,formatCode:Ut(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ue("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var au=["numFmtId","fillId","fontId","borderId","xfId"],nu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zC(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(ra)||[]).forEach(function(l){var o=it(l),f=0;switch(Rn(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],f=0;f<au.length;++f)n[au[f]]&&(n[au[f]]=parseInt(n[au[f]],10));for(f=0;f<nu.length;++f)n[nu[f]]&&(n[nu[f]]=Qt(n[nu[f]]));if(t.NumberFmt&&n.numFmtId>392){for(f=392;f>60;--f)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[f]){n.numFmtId=f;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};o.vertical&&(m.vertical=o.vertical),o.horizontal&&(m.horizontal=o.horizontal),o.textRotation!=null&&(m.textRotation=o.textRotation),o.indent&&(m.indent=o.indent),o.wrapText&&(m.wrapText=Qt(o.wrapText)),n.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function HC(e){var t=[];return t[t.length]=Ue("cellXfs",null),e.forEach(function(r){t[t.length]=Ue("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ue("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var VC=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(f,m,h){var x={};if(!f)return x;f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=f.match(t))&&IC(g,x,h),(g=f.match(s))&&UC(g,x,m,h),(g=f.match(n))&&BC(g,x,m,h),(g=f.match(l))&&LC(g,x,m,h),(g=f.match(r))&&zC(g,x,h),x}}();function bb(e,t){var r=[mr,Ue("styleSheet",null,{xmlns:Fi[0],"xmlns:vt":_r.vt})],n;return e.SSF&&(n=PC(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=HC(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function GC(e,t){var r=e.read_shift(2),n=Jr(e);return[r,n]}function XC(e,t,r){r||(r=Ne(6+4*t.length)),r.write_shift(2,e),Rr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function $C(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=kA(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var f=e.read_shift(1);f>0&&(n.family=f);var m=e.read_shift(1);switch(m>0&&(n.charset=m),e.l++,n.color=TA(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Jr(e),n}function YC(e,t){t||(t=Ne(25+4*32)),t.write_shift(2,e.sz*20),AA(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Tu(e.color,t);var n=0;return n=2,t.write_shift(1,n),Rr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var qC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ch,WC=ea;function jy(e,t){t||(t=Ne(4*3+8*7+16*1)),Ch||(Ch=qu(qC));var r=Ch[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Tu({auto:1},t),Tu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function KC(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function _b(e,t,r){r||(r=Ne(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Hc(e,t){return t||(t=Ne(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ZC=ea;function QC(e,t){return t||(t=Ne(51)),t.write_shift(1,0),Hc(null,t),Hc(null,t),Hc(null,t),Hc(null,t),Hc(null,t),t.length>t.l?t.slice(0,t.l):t}function JC(e,t){return t||(t=Ne(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Eu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function ej(e,t,r){var n=Ne(2052);return n.write_shift(4,e),Eu(t,n),Eu(r,n),n.length>n.l?n.slice(0,n.l):n}function tj(e,t,r){var n={};n.NumberFmt=[];for(var s in Ze)n.NumberFmt[s]=Ze[s];n.CellXf=[],n.Fonts=[];var l=[],o=!1;return ss(e,function(m,h,x){switch(x){case 44:n.NumberFmt[m[0]]=m[1],jn(m[1],m[0]);break;case 43:n.Fonts.push(m),m.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(m.color.rgb=Cu(t.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(x),o=!0;break;case 38:l.pop(),o=!1;break;default:if(h.T>0)l.push(x);else if(h.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),n}function rj(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Re(e,615,fn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Re(e,44,XC(s,t[s]))}),Re(e,616))}}function aj(e){var t=1;Re(e,611,fn(t)),Re(e,43,YC({sz:12,color:{theme:1},name:"Calibri",family:2})),Re(e,612)}function nj(e){var t=2;Re(e,603,fn(t)),Re(e,45,jy({patternType:"none"})),Re(e,45,jy({patternType:"gray125"})),Re(e,604)}function sj(e){var t=1;Re(e,613,fn(t)),Re(e,46,QC()),Re(e,614)}function ij(e){var t=1;Re(e,626,fn(t)),Re(e,47,_b({numFmtId:0},65535)),Re(e,627)}function lj(e,t){Re(e,617,fn(t.length)),t.forEach(function(r){Re(e,47,_b(r,0))}),Re(e,618)}function cj(e){var t=1;Re(e,619,fn(t)),Re(e,48,JC({xfId:0,name:"Normal"})),Re(e,620)}function oj(e){var t=0;Re(e,505,fn(t)),Re(e,506)}function uj(e){var t=0;Re(e,508,ej(t,"TableStyleMedium9","PivotStyleMedium4")),Re(e,509)}function fj(e,t){var r=ya();return Re(r,278),rj(r,e.SSF),aj(r),nj(r),sj(r),ij(r),lj(r,t.cellXfs),cj(r),oj(r),uj(r),Re(r,279),r.end()}var dj=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function hj(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ra)||[]).forEach(function(s){var l=it(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[dj.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function mj(){}function xj(){}var pj=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,gj=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,vj=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function yj(e,t,r){t.themeElements={};var n;[["clrScheme",pj,hj],["fontScheme",gj,mj],["fmtScheme",vj,xj]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var wj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Sb(e,t){(!e||e.length===0)&&(e=rx());var r,n={};if(!(r=e.match(wj)))throw new Error("themeElements not found in theme");return yj(r[0],n,t),n.raw=e,n}function rx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[mr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function bj(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var l=e.slice(e.l);e.l=n;var o;try{o=yw(l,{type:"array"})}catch{return}var f=ja(o,"theme/theme/theme1.xml",!0);if(f)return Sb(f,r)}}function _j(e){return e.read_shift(4)}function Sj(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Nj(e,4);break;case 2:t.xclrValue=rb(e);break;case 3:t.xclrValue=_j(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Nj(e,t){return ea(e,t)}function Ej(e,t){return ea(e,t)}function Tj(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Sj(e);break;case 6:n[1]=Ej(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function kj(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(Tj(e,r-e.l));return{ixfe:n,ext:l}}function Aj(e,t){t.forEach(function(r){r[0]})}function Cj(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Jr(e)}}function jj(e){var t=Ne(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Rr(e.name,t),t.slice(0,t.l)}function Fj(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Rj(e){var t=Ne(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Dj(e,t){var r=Ne(8+2*t.length);return r.write_shift(4,e),Rr(t,r),r.slice(0,r.l)}function Oj(e){return e.l+=4,e.read_shift(4)!=0}function Mj(e,t){var r=Ne(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Lj(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},l=[],o=!1,f=2;return ss(e,function(m,h,x){switch(x){case 335:n.Types.push({name:m.name});break;case 51:m.forEach(function(g){f==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):f==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:f=m?1:0;break;case 338:f=2;break;case 35:l.push(x),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!h.T){if(!o||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),n}function Bj(){var e=ya();return Re(e,332),Re(e,334,fn(1)),Re(e,335,jj({name:"XLDAPR",version:12e4,flags:3496657072})),Re(e,336),Re(e,339,Dj(1,"XLDAPR")),Re(e,52),Re(e,35,fn(514)),Re(e,4096,fn(0)),Re(e,4097,Ka(1)),Re(e,36),Re(e,53),Re(e,340),Re(e,337,Mj(1)),Re(e,51,Rj([[1,0]])),Re(e,338),Re(e,333),e.end()}function Uj(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,l=2,o;return e.replace(ra,function(f){var m=it(f);switch(Rn(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==m.name&&(o=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[m.t-1].name,index:+m.v}):l==0&&n.Value.push({type:n.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+m.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return f}),n}function Nb(){var e=[mr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Ij(e){var t=[];if(!e)return t;var r=1;return(e.match(ra)||[]).forEach(function(n){var s=it(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Pj(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=rt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function zj(e,t,r){var n=[];return ss(e,function(l,o,f){switch(f){case 63:n.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function Hj(e,t,r,n){if(!e)return e;var s=n||{},l=!1;ss(e,function(f,m,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!m.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},s)}function Vj(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var _l=1024;function Eb(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Ue("xml",null,{"xmlns:v":Aa.v,"xmlns:o":Aa.o,"xmlns:x":Aa.x,"xmlns:mv":Aa.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];_l<e*1e3;)_l+=1e3;return t.forEach(function(l){var o=nr(l[0]),f={color2:"#BEFF82",type:"gradient"};f.type=="gradient"&&(f.angle="-180");var m=f.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ue("v:fill",m,f),x={on:"t",obscured:"t"};++_l,s=s.concat(["<v:shape"+ho({id:"_x0000_s"+_l,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ue("v:shadow",null,x),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ir("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ir("x:AutoFill","False"),Ir("x:Row",String(o.r)),Ir("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Fy(e,t,r,n){var s=Array.isArray(e),l;t.forEach(function(o){var f=nr(o.ref);if(s?(e[f.r]||(e[f.r]=[]),l=e[f.r][f.c]):l=e[o.ref],!l){l={t:"z"},s?e[f.r][f.c]=l:e[o.ref]=l;var m=St(e["!ref"]||"BDWGO1000001:A1");m.s.r>f.r&&(m.s.r=f.r),m.e.r<f.r&&(m.e.r=f.r),m.s.c>f.c&&(m.s.c=f.c),m.e.c<f.c&&(m.e.c=f.c);var h=dt(m);h!==e["!ref"]&&(e["!ref"]=h)}l.c||(l.c=[]);var x={a:o.author,t:o.t,r:o.r,T:r};o.h&&(x.h=o.h);for(var g=l.c.length-1;g>=0;--g){if(!r&&l.c[g].T)return;r&&!l.c[g].T&&l.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(x.a==n[g].id){x.a=n[g].name||x.a;break}}l.c.push(x)})}function Gj(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var f=o.match(/<(?:\w+:)?author[^>]*>(.*)/);f&&r.push(f[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var f=o.match(/<(?:\w+:)?comment[^>]*>/);if(f){var m=it(f[0]),h={author:m.authorId&&r[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},x=nr(m.ref);if(!(t.sheetRows&&t.sheetRows<=x.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!g&&!!g[1]&&Jm(g[1])||{r:"",t:"",h:""};h.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),h.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=y.h),n.push(h)}}}}),n}function Tb(e){var t=[mr,Ue("comments",null,{xmlns:Fi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var l=Ut(s.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,l=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(m){m.a&&(s=r.indexOf(Ut(m.a))),l.push(m.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),l.length<=1)t.push(Ir("t",Ut(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,f=1;f<l.length;++f)o+=`Reply:
    `+l[f]+`
`;t.push(Ir("t",Ut(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Xj(e,t){var r=[],n=!1,s={},l=0;return e.replace(ra,function(f,m){var h=it(f);switch(Rn(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":l=m+f.length;break;case"</text>":s.t=e.slice(l,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return f}),r}function $j(e,t,r){var n=[mr,Ue("ThreadedComments",null,{xmlns:_r.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(o,f){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var m={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};f==0?l=m.id:m.parentId=l,o.ID=m.id,o.a&&(m.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Ue("threadedComment",Ir("text",o.t||""),m))})}),n.push("</ThreadedComments>"),n.join("")}function Yj(e,t){var r=[],n=!1;return e.replace(ra,function(l){var o=it(l);switch(Rn(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function qj(e){var t=[mr,Ue("personList",null,{xmlns:_r.TCMNT,"xmlns:x":Fi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Wj(e){var t={};t.iauthor=e.read_shift(4);var r=Mi(e);return t.rfx=r.s,t.ref=rt(r.s),e.l+=16,t}function Kj(e,t){return t==null&&(t=Ne(36)),t.write_shift(4,e[1].iauthor),zl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Zj=Jr;function Qj(e){return Rr(e.slice(0,54))}function Jj(e,t){var r=[],n=[],s={},l=!1;return ss(e,function(f,m,h){switch(h){case 632:n.push(f);break;case 635:s=f;break;case 637:s.t=f.t,s.h=f.h,s.r=f.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function eF(e){var t=ya(),r=[];return Re(t,628),Re(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Re(t,632,Qj(s.a)))})}),Re(t,631),Re(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var l={s:nr(n[0]),e:nr(n[0])};Re(t,635,Kj([l,s])),s.t&&s.t.length>0&&Re(t,637,_A(s)),Re(t,636),delete s.iauthor})}),Re(t,634),Re(t,629),t.end()}var tF="application/vnd.ms-office.vbaProject";function rF(e){var t=We.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");We.utils.cfb_add(t,s,e.FileIndex[n].content)}}),We.write(t)}function aF(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&We.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var kb=["xlsb","xlsm","xlam","biff8","xla"];function nF(){return{"!type":"dialog"}}function sF(){return{"!type":"dialog"}}function iF(){return{"!type":"macro"}}function lF(){return{"!type":"macro"}}var El=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,l,o){var f=!1,m=!1;l.length==0?m=!0:l.charAt(0)=="["&&(m=!0,l=l.slice(1,-1)),o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1));var h=l.length>0?parseInt(l,10)|0:0,x=o.length>0?parseInt(o,10)|0:0;return f?x+=t.c:--x,m?h+=t.r:--h,s+(f?"":"$")+Jt(x)+(m?"":"$")+cr(h)}return function(s,l){return t=l,s.replace(e,r)}}(),ax=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nx=function(){return function(t,r){return t.replace(ax,function(n,s,l,o,f,m){var h=Gm(o)-(l?0:r.c),x=Vm(m)-(f?0:r.r),g=x==0?"":f?x+1:"["+x+"]",y=h==0?"":l?h+1:"["+h+"]";return s+"R"+g+"C"+y})}}();function Ab(e,t){return e.replace(ax,function(r,n,s,l,o,f){return n+(s=="$"?s+l:Jt(Gm(l)+t.c))+(o=="$"?o+f:cr(Vm(f)+t.r))})}function cF(e,t,r){var n=la(t),s=n.s,l=nr(r),o={r:l.r-s.r,c:l.c-s.c};return Ab(e,o)}function oF(e){return e.length!=1}function Ry(e){return e.replace(/_xlfn\./g,"")}function gr(e){e.l+=1}function Hs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Cb(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return jb(e);r.biff==12&&(n=4)}var s=e.read_shift(n),l=e.read_shift(n),o=Hs(e),f=Hs(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:f[0],cRel:f[1],rRel:f[2]}}}function jb(e){var t=Hs(e),r=Hs(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function uF(e,t,r){if(r.biff<8)return jb(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),l=Hs(e),o=Hs(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Fb(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return fF(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Hs(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function fF(e){var t=Hs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function dF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function hF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return mF(e);var s=e.read_shift(n>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,f=(l&32768)>>15;if(l&=16383,f==1)for(;s>524287;)s-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:o,rRel:f}}function mF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function xF(e,t,r){var n=(e[e.l++]&96)>>5,s=Cb(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function pF(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=Cb(e,l,r);return[n,s,o]}function gF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function vF(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,s]}function yF(e,t,r){var n=(e[e.l++]&96)>>5,s=uF(e,t-1,r);return[n,s]}function wF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Dy(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function bF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],l=0;l<=n;++l)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function _F(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function SF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function NF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function EF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Rb(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function TF(e){return e.read_shift(2),Rb(e)}function kF(e){return e.read_shift(2),Rb(e)}function AF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Fb(e,0,r);return[n,s]}function CF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=hF(e,0,r);return[n,s]}function jF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=Fb(e,0,r);return[n,s,l]}function FF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[OR[s],Mb[s],n]}function RF(e,t,r){var n=e[e.l++],s=e.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:DF(e);return[s,(l[0]===0?Mb:DR)[l[1]]]}function DF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function OF(e,t,r){e.l+=r&&r.biff==2?3:4}function MF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function LF(e){return e.l++,is[e.read_shift(1)]}function BF(e){return e.l++,e.read_shift(2)}function UF(e){return e.l++,e.read_shift(1)!==0}function IF(e){return e.l++,Zr(e)}function PF(e,t,r){return e.l++,Do(e,t-1,r)}function zF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=hr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=is[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Zr(e);break;case 2:r[1]=Li(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function HF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],l=0;l!=n;++l)s.push((r.biff==12?Mi:Qu)(e));return s}function VF(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var l=0,o=[];l!=n&&(o[l]=[]);++l)for(var f=0;f!=s;++f)o[l][f]=zF(e,r.biff);return o}function GF(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,l=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function XF(e,t,r){if(r.biff==5)return $F(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[n,s,l]}function $F(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function YF(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function qF(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function WF(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function KF(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,s]}var ZF=ea,QF=ea,JF=ea;function Mo(e,t,r){return e.l+=2,[dF(e)]}function sx(e){return e.l+=6,[]}var eR=Mo,tR=sx,rR=sx,aR=Mo;function Db(e){return e.l+=2,[yr(e),e.read_shift(2)&1]}var nR=Mo,sR=Db,iR=sx,lR=Mo,cR=Mo,oR=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uR(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),o=oR[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:l}}function fR(e){return e.l+=2,[e.read_shift(4)]}function dR(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function hR(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function mR(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function xR(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function pR(e){return e.l+=4,[0,0]}var Oy={1:{n:"PtgExp",f:MF},2:{n:"PtgTbl",f:JF},3:{n:"PtgAdd",f:gr},4:{n:"PtgSub",f:gr},5:{n:"PtgMul",f:gr},6:{n:"PtgDiv",f:gr},7:{n:"PtgPower",f:gr},8:{n:"PtgConcat",f:gr},9:{n:"PtgLt",f:gr},10:{n:"PtgLe",f:gr},11:{n:"PtgEq",f:gr},12:{n:"PtgGe",f:gr},13:{n:"PtgGt",f:gr},14:{n:"PtgNe",f:gr},15:{n:"PtgIsect",f:gr},16:{n:"PtgUnion",f:gr},17:{n:"PtgRange",f:gr},18:{n:"PtgUplus",f:gr},19:{n:"PtgUminus",f:gr},20:{n:"PtgPercent",f:gr},21:{n:"PtgParen",f:gr},22:{n:"PtgMissArg",f:gr},23:{n:"PtgStr",f:PF},26:{n:"PtgSheet",f:dR},27:{n:"PtgEndSheet",f:hR},28:{n:"PtgErr",f:LF},29:{n:"PtgBool",f:UF},30:{n:"PtgInt",f:BF},31:{n:"PtgNum",f:IF},32:{n:"PtgArray",f:wF},33:{n:"PtgFunc",f:FF},34:{n:"PtgFuncVar",f:RF},35:{n:"PtgName",f:GF},36:{n:"PtgRef",f:AF},37:{n:"PtgArea",f:xF},38:{n:"PtgMemArea",f:YF},39:{n:"PtgMemErr",f:ZF},40:{n:"PtgMemNoMem",f:QF},41:{n:"PtgMemFunc",f:qF},42:{n:"PtgRefErr",f:WF},43:{n:"PtgAreaErr",f:gF},44:{n:"PtgRefN",f:CF},45:{n:"PtgAreaN",f:yF},46:{n:"PtgMemAreaN",f:mR},47:{n:"PtgMemNoMemN",f:xR},57:{n:"PtgNameX",f:XF},58:{n:"PtgRef3d",f:jF},59:{n:"PtgArea3d",f:pF},60:{n:"PtgRefErr3d",f:KF},61:{n:"PtgAreaErr3d",f:vF},255:{}},gR={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},vR={1:{n:"PtgElfLel",f:Db},2:{n:"PtgElfRw",f:lR},3:{n:"PtgElfCol",f:eR},6:{n:"PtgElfRwV",f:cR},7:{n:"PtgElfColV",f:aR},10:{n:"PtgElfRadical",f:nR},11:{n:"PtgElfRadicalS",f:iR},13:{n:"PtgElfColS",f:tR},15:{n:"PtgElfColSV",f:rR},16:{n:"PtgElfRadicalLel",f:sR},25:{n:"PtgList",f:uR},29:{n:"PtgSxName",f:fR},255:{}},yR={0:{n:"PtgAttrNoop",f:pR},1:{n:"PtgAttrSemi",f:EF},2:{n:"PtgAttrIf",f:SF},4:{n:"PtgAttrChoose",f:bF},8:{n:"PtgAttrGoto",f:_F},16:{n:"PtgAttrSum",f:OF},32:{n:"PtgAttrBaxcel",f:Dy},33:{n:"PtgAttrBaxcel",f:Dy},64:{n:"PtgAttrSpace",f:TF},65:{n:"PtgAttrSpaceSemi",f:kF},128:{n:"PtgAttrIfError",f:NF},255:{}};function Lo(e,t,r,n){if(n.biff<8)return ea(e,t);for(var s=e.l+t,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=VF(e,0,n),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=HF(e,r[o][1],n),l.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&l.push(ea(e,t)),l}function Bo(e,t,r){for(var n=e.l+t,s,l,o=[];n!=e.l;)t=n-e.l,l=e[e.l],s=Oy[l]||Oy[gR[l]],(l===24||l===25)&&(s=(l===24?vR:yR)[e[e.l+1]]),!s||!s.f?ea(e,t):o.push([s.n,s.f(e,t,r)]);return o}function wR(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],l=0;l<n.length;++l){var o=n[l];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var bR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function _R(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Ob(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function My(e,t,r){var n=Ob(e,t,r);return n=="#REF"?n:_R(n,r)}function qr(e,t,r,n,s){var l=s&&s.biff||8,o={s:{c:0,r:0}},f=[],m,h,x,g=0,y=0,S,w="";if(!e[0]||!e[0][0])return"";for(var b=-1,_="",T=0,N=e[0].length;T<N;++T){var E=e[0][T];switch(E[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=f.pop(),h=f.pop(),b>=0){switch(e[0][b][1][0]){case 0:_=lr(" ",e[0][b][1][1]);break;case 1:_=lr("\r",e[0][b][1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}h=h+_,b=-1}f.push(h+bR[E[0]]+m);break;case"PtgIsect":m=f.pop(),h=f.pop(),f.push(h+" "+m);break;case"PtgUnion":m=f.pop(),h=f.pop(),f.push(h+","+m);break;case"PtgRange":m=f.pop(),h=f.pop(),f.push(h+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=Zc(E[1][1],o,s),f.push(Qc(x,l));break;case"PtgRefN":x=r?Zc(E[1][1],r,s):E[1][1],f.push(Qc(x,l));break;case"PtgRef3d":g=E[1][1],x=Zc(E[1][2],o,s),w=My(n,g,s),f.push(w+"!"+Qc(x,l));break;case"PtgFunc":case"PtgFuncVar":var j=E[1][0],F=E[1][1];j||(j=0),j&=127;var R=j==0?[]:f.slice(-j);f.length-=j,F==="User"&&(F=R.shift()),f.push(F+"("+R.join(",")+")");break;case"PtgBool":f.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(E[1]);break;case"PtgNum":f.push(String(E[1]));break;case"PtgStr":f.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(E[1]);break;case"PtgAreaN":S=uy(E[1][1],r?{s:r}:o,s),f.push(Eh(S,s));break;case"PtgArea":S=uy(E[1][1],o,s),f.push(Eh(S,s));break;case"PtgArea3d":g=E[1][1],S=E[1][2],w=My(n,g,s),f.push(w+"!"+Eh(S,s));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=E[1][2];var A=(n.names||[])[y-1]||(n[0]||[])[y],P=A?A.Name:"SH33TJSNAME"+String(y);P&&P.slice(0,6)=="_xlfn."&&!s.xlfn&&(P=P.slice(6)),f.push(P);break;case"PtgNameX":var U=E[1][1];y=E[1][2];var ee;if(s.biff<=5)U<0&&(U=-U),n[U]&&(ee=n[U][y]);else{var W="";if(((n[U]||[])[0]||[])[0]==14849||(((n[U]||[])[0]||[])[0]==1025?n[U][y]&&n[U][y].itab>0&&(W=n.SheetNames[n[U][y].itab-1]+"!"):W=n.SheetNames[y-1]+"!"),n[U]&&n[U][y])W+=n[U][y].Name;else if(n[0]&&n[0][y])W+=n[0][y].Name;else{var J=(Ob(n,U,s)||"").split(";;");J[y-1]?W=J[y-1]:W+="SH33TJSERRX"}f.push(W);break}ee||(ee={Name:"SH33TJSERRY"}),f.push(ee.Name);break;case"PtgParen":var xe="(",pe=")";if(b>=0){switch(_="",e[0][b][1][0]){case 2:xe=lr(" ",e[0][b][1][1])+xe;break;case 3:xe=lr("\r",e[0][b][1][1])+xe;break;case 4:pe=lr(" ",e[0][b][1][1])+pe;break;case 5:pe=lr("\r",e[0][b][1][1])+pe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}f.push(xe+f.pop()+pe);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":x={c:E[1][1],r:E[1][0]};var we={c:r.c,r:r.r};if(n.sharedf[rt(x)]){var Q=n.sharedf[rt(x)];f.push(qr(Q,o,we,n,s))}else{var ie=!1;for(m=0;m!=n.arrayf.length;++m)if(h=n.arrayf[m],!(x.c<h[0].s.c||x.c>h[0].e.c)&&!(x.r<h[0].s.r||x.r>h[0].e.r)){f.push(qr(h[1],o,we,n,s)),ie=!0;break}ie||f.push(E[1])}break;case"PtgArray":f.push("{"+wR(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var Ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&b>=0&&Ae.indexOf(e[0][T][0])==-1){E=e[0][b];var re=!0;switch(E[1][0]){case 4:re=!1;case 0:_=lr(" ",E[1][1]);break;case 5:re=!1;case 1:_=lr("\r",E[1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}f.push((re?_:"")+f.pop()+(re?"":_)),b=-1}}if(f.length>1&&s.WTF)throw new Error("bad formula stack");return f[0]}function SR(e,t,r){var n=e.l+t,s=r.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],ea(e,t-2)];var f=Bo(e,o,r);return t!==o+s&&(l=Lo(e,t-o-s,f,r)),e.l=n,[f,l]}function NR(e,t,r){var n=e.l+t,s=r.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],ea(e,t-2)];var f=Bo(e,o,r);return t!==o+s&&(l=Lo(e,t-o-s,f,r)),e.l=n,[f,l]}function ER(e,t,r,n){var s=e.l+t,l=Bo(e,n,r),o;return s!==e.l&&(o=Lo(e,s-e.l,l,r)),[l,o]}function TR(e,t,r){var n=e.l+t,s,l=e.read_shift(2),o=Bo(e,l,r);return l==65535?[[],ea(e,t-2)]:(t!==l+2&&(s=Lo(e,n-l-2,o,r)),[o,s])}function kR(e){var t;if(Kn(e,e.l+6)!==65535)return[Zr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function AR(e){if(e==null){var t=Ne(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ei(e);return Ei(0)}function jh(e,t,r){var n=e.l+t,s=Dn(e);r.biff==2&&++e.l;var l=kR(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var f=NR(e,n-e.l,r);return{cell:s,val:l[0],formula:f,shared:o>>3&1,tt:l[1]}}function CR(e,t,r,n,s){var l=ki(t,r,s),o=AR(e.v),f=Ne(6),m=33;f.write_shift(2,m),f.write_shift(4,0);for(var h=Ne(e.bf.length),x=0;x<e.bf.length;++x)h[x]=e.bf[x];var g=Fr([l,o,f,h]);return g}function Ju(e,t,r){var n=e.read_shift(4),s=Bo(e,n,r),l=e.read_shift(4),o=l>0?Lo(e,l,s,r):null;return[s,o]}var jR=Ju,ef=Ju,FR=Ju,RR=Ju,DR={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Mb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},OR={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ly(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function MR(e){var t="of:="+e.replace(ax,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Fh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function LR(e){return e.replace(/\./,"!")}var eo={},Tl={},to=typeof Map<"u";function ix(e,t,r){var n=0,s=e.length;if(r){if(to?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=to?r.get(t):r[t];n<l.length;++n)if(e[l[n]].t===t)return e.Count++,l[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(to?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function tf(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Wr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=vo(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=ju(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function vi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function qs(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,l=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){jn(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===n)return s;return e[l]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function Lb(e,t,r,n,s,l){try{n.cellNF&&(e.z=Ze[t])}catch(f){if(n.WTF)throw f}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=er(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ze[t]==null&&jn(R6[t]||"General",t),e.t==="e")e.w=e.w||is[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=uo(e.v);else if(e.t==="d"){var o=Sr(e.v);(o|0)===o?e.w=o.toString(10):e.w=uo(o)}else{if(e.v===void 0)return"";e.w=Si(e.v,Tl)}else e.t==="d"?e.w=Da(t,Sr(e.v),Tl):e.w=Da(t,e.v,Tl)}catch(f){if(n.WTF)throw f}if(n.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Cu(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Cu(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(f){if(n.WTF&&l.Fills)throw f}}}function BR(e,t,r){if(e&&e["!ref"]){var n=St(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function UR(e,t){var r=St(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=dt(r))}var IR=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,PR=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zR=/<(?:\w:)?hyperlink [^>]*>/mg,HR=/"(\w*:\w*)"/,VR=/<(?:\w:)?col\b[^>]*[\/]?>/g,GR=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,XR=/<(?:\w:)?pageMargins[^>]*\/>/g,Bb=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,$R=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,YR=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function qR(e,t,r,n,s,l,o){if(!e)return e;n||(n={"!id":{}});var f=t.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",x="",g=e.match(PR);g?(h=e.slice(0,g.index),x=e.slice(g.index+g[0].length)):h=x=e;var y=h.match(Bb);y?lx(y[0],f,s,r):(y=h.match($R))&&KR(y[0],y[1]||"",f,s,r);var S=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(S>0){var w=h.slice(S,S+50).match(HR);w&&UR(f,w[1])}var b=h.match(YR);b&&b[1]&&oD(b[1],s);var _=[];if(t.cellStyles){var T=h.match(VR);T&&nD(_,T)}g&&dD(g[1],f,t,m,l,o);var N=x.match(GR);N&&(f["!autofilter"]=iD(N[0]));var E=[],j=x.match(IR);if(j)for(S=0;S!=j.length;++S)E[S]=St(j[S].slice(j[S].indexOf('"')+1));var F=x.match(zR);F&&tD(f,F,n);var R=x.match(XR);if(R&&(f["!margins"]=rD(it(R[0]))),!f["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(f["!ref"]=dt(m)),t.sheetRows>0&&f["!ref"]){var A=St(f["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>m.e.r&&(A.e.r=m.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>m.e.c&&(A.e.c=m.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),f["!fullref"]=f["!ref"],f["!ref"]=dt(A))}return _.length>0&&(f["!cols"]=_),E.length>0&&(f["!merges"]=E),f}function WR(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+dt(e[r])+'"/>';return t+"</mergeCells>"}function lx(e,t,r,n){var s=it(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Tt(Gt(s.codeName)))}function KR(e,t,r,n,s){lx(e.slice(0,e.indexOf(">")),r,n,s)}function ZR(e,t,r,n,s){var l=!1,o={},f=null;if(n.bookType!=="xlsx"&&t.vbaraw){var m=t.SheetNames[r];try{t.Workbook&&(m=t.Workbook.Sheets[r].CodeName||m)}catch{}l=!0,o.codeName=An(Ut(m))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),f=(f||"")+Ue("outlinePr",null,h)}!l&&!f||(s[s.length]=Ue("sheetPr",f,o))}var QR=["objects","scenarios","selectLockedCells","selectUnlockedCells"],JR=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function eD(e){var t={sheet:1};return QR.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),JR.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=ex(e.password).toString(16).toUpperCase()),Ue("sheetProtection",null,t)}function tD(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var l=it(Gt(t[s]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Tt(l.location))):(l.Target="#"+Tt(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var f=St(l.ref),m=f.s.r;m<=f.e.r;++m)for(var h=f.s.c;h<=f.e.c;++h){var x=rt({c:h,r:m});n?(e[m]||(e[m]=[]),e[m][h]||(e[m][h]={t:"z",v:void 0}),e[m][h].l=l):(e[x]||(e[x]={t:"z",v:void 0}),e[x].l=l)}}}function rD(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function aD(e){return vi(e),Ue("pageMargins",null,e)}function nD(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=it(t[n],!0);s.hidden&&(s.hidden=Qt(s.hidden));var l=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,tx(s.width)),zs(s);l<=o;)e[l++]=Yt(s)}}function sD(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Ue("col",null,tf(s,n)));return r[r.length]="</cols>",r.join("")}function iD(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function lD(e,t,r,n){var s=typeof e.ref=="string"?e.ref:dt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=la(s);o.s.r==o.e.r&&(o.e.r=la(t["!ref"]).e.r,s=dt(o));for(var f=0;f<l.length;++f){var m=l[f];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==n){m.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ue("autoFilter",null,{ref:s})}var cD=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function oD(e,t){t.Views||(t.Views=[{}]),(e.match(cD)||[]).forEach(function(r,n){var s=it(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Qt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function uD(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,s),{})}function fD(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=is[e.v];break;case"d":n&&n.cellDates?s=er(e.v,-1).toISOString():(e=Yt(e),e.t="n",s=""+(e.v=Sr(er(e.v)))),typeof e.z>"u"&&(e.z=Ze[14]);break;default:s=e.v;break}var f=Ir("v",Ut(s)),m={r:t},h=qs(n.cellXfs,e,n);switch(h!==0&&(m.s=h),e.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){f=Ir("v",""+ix(n.Strings,e.v,n.revStrings)),m.t="s";break}m.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var x=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;f=Ue("f",Ut(e.f),x)+(e.v!=null?f:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(m.cm=1),Ue("c",f,m)}var dD=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=fo("v"),o=fo("f");return function(m,h,x,g,y,S){for(var w=0,b="",_=[],T=[],N=0,E=0,j=0,F="",R,A,P=0,U=0,ee,W,J=0,xe=0,pe=Array.isArray(S.CellXf),we,Q=[],ie=[],Ae=Array.isArray(h),re=[],z={},te=!1,D=!!x.sheetStubs,V=m.split(t),M=0,B=V.length;M!=B;++M){b=V[M].trim();var K=b.length;if(K!==0){var oe=0;e:for(w=0;w<K;++w)switch(b[w]){case">":if(b[w-1]!="/"){++w;break e}if(x&&x.cellStyles){if(A=it(b.slice(oe,w),!0),P=A.r!=null?parseInt(A.r,10):P+1,U=-1,x.sheetRows&&x.sheetRows<P)continue;z={},te=!1,A.ht&&(te=!0,z.hpt=parseFloat(A.ht),z.hpx=jl(z.hpt)),A.hidden=="1"&&(te=!0,z.hidden=!0),A.outlineLevel!=null&&(te=!0,z.level=+A.outlineLevel),te&&(re[P-1]=z)}break;case"<":oe=w;break}if(oe>=w)break;if(A=it(b.slice(oe,w),!0),P=A.r!=null?parseInt(A.r,10):P+1,U=-1,!(x.sheetRows&&x.sheetRows<P)){g.s.r>P-1&&(g.s.r=P-1),g.e.r<P-1&&(g.e.r=P-1),x&&x.cellStyles&&(z={},te=!1,A.ht&&(te=!0,z.hpt=parseFloat(A.ht),z.hpx=jl(z.hpt)),A.hidden=="1"&&(te=!0,z.hidden=!0),A.outlineLevel!=null&&(te=!0,z.level=+A.outlineLevel),te&&(re[P-1]=z)),_=b.slice(w).split(e);for(var ye=0;ye!=_.length&&_[ye].trim().charAt(0)=="<";++ye);for(_=_.slice(ye),w=0;w!=_.length;++w)if(b=_[w].trim(),b.length!==0){if(T=b.match(r),N=w,E=0,j=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,T!=null&&T.length===2){for(N=0,F=T[1],E=0;E!=F.length&&!((j=F.charCodeAt(E)-64)<1||j>26);++E)N=26*N+j;--N,U=N}else++U;for(E=0;E!=b.length&&b.charCodeAt(E)!==62;++E);if(++E,A=it(b.slice(0,E),!0),A.r||(A.r=rt({r:P-1,c:U})),F=b.slice(E),R={t:""},(T=F.match(l))!=null&&T[1]!==""&&(R.v=Tt(T[1])),x.cellFormula){if((T=F.match(o))!=null&&T[1]!==""){if(R.f=Tt(Gt(T[1])).replace(/\r\n/g,`
`),x.xlfn||(R.f=Ry(R.f)),T[0].indexOf('t="array"')>-1)R.F=(F.match(s)||[])[1],R.F.indexOf(":")>-1&&Q.push([St(R.F),R.F]);else if(T[0].indexOf('t="shared"')>-1){W=it(T[0]);var _e=Tt(Gt(T[1]));x.xlfn||(_e=Ry(_e)),ie[parseInt(W.si,10)]=[W,_e,A.r]}}else(T=F.match(/<f[^>]*\/>/))&&(W=it(T[0]),ie[W.si]&&(R.f=cF(ie[W.si][1],ie[W.si][2],A.r)));var ae=nr(A.r);for(E=0;E<Q.length;++E)ae.r>=Q[E][0].s.r&&ae.r<=Q[E][0].e.r&&ae.c>=Q[E][0].s.c&&ae.c<=Q[E][0].e.c&&(R.F=Q[E][1])}if(A.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(D)R.t="z";else continue;else R.t=A.t||"n";switch(g.s.c>U&&(g.s.c=U),g.e.c<U&&(g.e.c=U),R.t){case"n":if(R.v==""||R.v==null){if(!D)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!D)continue;R.t="z"}else ee=eo[parseInt(R.v,10)],R.v=ee.t,R.r=ee.r,x.cellHTML&&(R.h=ee.h);break;case"str":R.t="s",R.v=R.v!=null?Gt(R.v):"",x.cellHTML&&(R.h=Mm(R.v));break;case"inlineStr":T=F.match(n),R.t="s",T!=null&&(ee=Jm(T[1]))?(R.v=ee.t,x.cellHTML&&(R.h=ee.h)):R.v="";break;case"b":R.v=Qt(R.v);break;case"d":x.cellDates?R.v=er(R.v,1):(R.v=Sr(er(R.v,1)),R.t="n");break;case"e":(!x||x.cellText!==!1)&&(R.w=R.v),R.v=Iw[R.v];break}if(J=xe=0,we=null,pe&&A.s!==void 0&&(we=S.CellXf[A.s],we!=null&&(we.numFmtId!=null&&(J=we.numFmtId),x.cellStyles&&we.fillId!=null&&(xe=we.fillId))),Lb(R,J,xe,x,y,S),x.cellDates&&pe&&R.t=="n"&&ji(Ze[J])&&(R.t="d",R.v=Ku(R.v)),A.cm&&x.xlmeta){var He=(x.xlmeta.Cell||[])[+A.cm-1];He&&He.type=="XLDAPR"&&(R.D=!0)}if(Ae){var Y=nr(A.r);h[Y.r]||(h[Y.r]=[]),h[Y.r][Y.c]=R}else h[A.r]=R}}}}re.length>0&&(h["!rows"]=re)}}();function hD(e,t,r,n){var s=[],l=[],o=St(e["!ref"]),f="",m,h="",x=[],g=0,y=0,S=e["!rows"],w=Array.isArray(e),b={r:h},_,T=-1;for(y=o.s.c;y<=o.e.c;++y)x[y]=Jt(y);for(g=o.s.r;g<=o.e.r;++g){for(l=[],h=cr(g),y=o.s.c;y<=o.e.c;++y){m=x[y]+h;var N=w?(e[g]||[])[y]:e[m];N!==void 0&&(f=fD(N,m,e,t))!=null&&l.push(f)}(l.length>0||S&&S[g])&&(b={r:h},S&&S[g]&&(_=S[g],_.hidden&&(b.hidden=1),T=-1,_.hpx?T=yo(_.hpx):_.hpt&&(T=_.hpt),T>-1&&(b.ht=T,b.customHeight=1),_.level&&(b.outlineLevel=_.level)),s[s.length]=Ue("row",l.join(""),b))}if(S)for(;g<S.length;++g)S&&S[g]&&(b={r:g+1},_=S[g],_.hidden&&(b.hidden=1),T=-1,_.hpx?T=yo(_.hpx):_.hpt&&(T=_.hpt),T>-1&&(b.ht=T,b.customHeight=1),_.level&&(b.outlineLevel=_.level),s[s.length]=Ue("row","",b));return s.join("")}function Ub(e,t,r,n){var s=[mr,Ue("worksheet",null,{xmlns:Fi[0],"xmlns:r":_r.r})],l=r.SheetNames[e],o=0,f="",m=r.Sheets[l];m==null&&(m={});var h=m["!ref"]||"A1",x=St(h);if(x.e.c>16383||x.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575),h=dt(x)}n||(n={}),m["!comments"]=[];var g=[];ZR(m,r,e,t,s),s[s.length]=Ue("dimension",null,{ref:h}),s[s.length]=uD(m,t,e,r),t.sheetFormat&&(s[s.length]=Ue("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),m["!cols"]!=null&&m["!cols"].length>0&&(s[s.length]=sD(m,m["!cols"])),s[o=s.length]="<sheetData/>",m["!links"]=[],m["!ref"]!=null&&(f=hD(m,t),f.length>0&&(s[s.length]=f)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),m["!protect"]&&(s[s.length]=eD(m["!protect"])),m["!autofilter"]!=null&&(s[s.length]=lD(m["!autofilter"],m,r,e)),m["!merges"]!=null&&m["!merges"].length>0&&(s[s.length]=WR(m["!merges"]));var y=-1,S,w=-1;return m["!links"].length>0&&(s[s.length]="<hyperlinks>",m["!links"].forEach(function(b){b[1].Target&&(S={ref:b[0]},b[1].Target.charAt(0)!="#"&&(w=Bt(n,-1,Ut(b[1].Target).replace(/#.*$/,""),wt.HLINK),S["r:id"]="rId"+w),(y=b[1].Target.indexOf("#"))>-1&&(S.location=Ut(b[1].Target.slice(y+1))),b[1].Tooltip&&(S.tooltip=Ut(b[1].Tooltip)),s[s.length]=Ue("hyperlink",null,S))}),s[s.length]="</hyperlinks>"),delete m["!links"],m["!margins"]!=null&&(s[s.length]=aD(m["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Ir("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:h}))),g.length>0&&(w=Bt(n,-1,"../drawings/drawing"+(e+1)+".xml",wt.DRAW),s[s.length]=Ue("drawing",null,{"r:id":"rId"+w}),m["!drawing"]=g),m["!comments"].length>0&&(w=Bt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",wt.VML),s[s.length]=Ue("legacyDrawing",null,{"r:id":"rId"+w}),m["!legacy"]=w),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function mD(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=s/20),r}function xD(e,t,r){var n=Ne(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var l=320;s.hpx?l=yo(s.hpx)*20:s.hpt&&(l=s.hpt*20),n.write_shift(2,l),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var f=0,m=n.l;n.l+=4;for(var h={r:e,c:0},x=0;x<16;++x)if(!(t.s.c>x+1<<10||t.e.c<x<<10)){for(var g=-1,y=-1,S=x<<10;S<x+1<<10;++S){h.c=S;var w=Array.isArray(r)?(r[h.r]||[])[h.c]:r[rt(h)];w&&(g<0&&(g=S),y=S)}g<0||(++f,n.write_shift(4,g),n.write_shift(4,y))}var b=n.l;return n.l=m,n.write_shift(4,f),n.l=b,n.length>n.l?n.slice(0,n.l):n}function pD(e,t,r,n){var s=xD(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Re(e,0,s)}var gD=Mi,vD=zl;function yD(){}function wD(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=SA(e),r}function bD(e,t,r){r==null&&(r=Ne(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Tu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Ow(e,r),r.slice(0,r.l)}function _D(e){var t=en(e);return[t]}function SD(e,t,r){return r==null&&(r=Ne(8)),Ri(t,r)}function ND(e){var t=Di(e);return[t]}function ED(e,t,r){return r==null&&(r=Ne(4)),Oi(t,r)}function TD(e){var t=en(e),r=e.read_shift(1);return[t,r,"b"]}function kD(e,t,r){return r==null&&(r=Ne(9)),Ri(t,r),r.write_shift(1,e.v?1:0),r}function AD(e){var t=Di(e),r=e.read_shift(1);return[t,r,"b"]}function CD(e,t,r){return r==null&&(r=Ne(5)),Oi(t,r),r.write_shift(1,e.v?1:0),r}function jD(e){var t=en(e),r=e.read_shift(1);return[t,r,"e"]}function FD(e,t,r){return r==null&&(r=Ne(9)),Ri(t,r),r.write_shift(1,e.v),r}function RD(e){var t=Di(e),r=e.read_shift(1);return[t,r,"e"]}function DD(e,t,r){return r==null&&(r=Ne(8)),Oi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function OD(e){var t=en(e),r=e.read_shift(4);return[t,r,"s"]}function MD(e,t,r){return r==null&&(r=Ne(12)),Ri(t,r),r.write_shift(4,t.v),r}function LD(e){var t=Di(e),r=e.read_shift(4);return[t,r,"s"]}function BD(e,t,r){return r==null&&(r=Ne(8)),Oi(t,r),r.write_shift(4,t.v),r}function UD(e){var t=en(e),r=Zr(e);return[t,r,"n"]}function ID(e,t,r){return r==null&&(r=Ne(16)),Ri(t,r),Ei(e.v,r),r}function Ib(e){var t=Di(e),r=Zr(e);return[t,r,"n"]}function PD(e,t,r){return r==null&&(r=Ne(12)),Oi(t,r),Ei(e.v,r),r}function zD(e){var t=en(e),r=qm(e);return[t,r,"n"]}function HD(e,t,r){return r==null&&(r=Ne(12)),Ri(t,r),Mw(e.v,r),r}function VD(e){var t=Di(e),r=qm(e);return[t,r,"n"]}function GD(e,t,r){return r==null&&(r=Ne(8)),Oi(t,r),Mw(e.v,r),r}function XD(e){var t=en(e),r=Xm(e);return[t,r,"is"]}function $D(e){var t=en(e),r=Jr(e);return[t,r,"str"]}function YD(e,t,r){return r==null&&(r=Ne(12+4*e.v.length)),Ri(t,r),Rr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function qD(e){var t=Di(e),r=Jr(e);return[t,r,"str"]}function WD(e,t,r){return r==null&&(r=Ne(8+4*e.v.length)),Oi(t,r),Rr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function KD(e,t,r){var n=e.l+t,s=en(e);s.r=r["!row"];var l=e.read_shift(1),o=[s,l,"b"];if(r.cellFormula){e.l+=2;var f=ef(e,n-e.l,r);o[3]=qr(f,null,s,r.supbooks,r)}else e.l=n;return o}function ZD(e,t,r){var n=e.l+t,s=en(e);s.r=r["!row"];var l=e.read_shift(1),o=[s,l,"e"];if(r.cellFormula){e.l+=2;var f=ef(e,n-e.l,r);o[3]=qr(f,null,s,r.supbooks,r)}else e.l=n;return o}function QD(e,t,r){var n=e.l+t,s=en(e);s.r=r["!row"];var l=Zr(e),o=[s,l,"n"];if(r.cellFormula){e.l+=2;var f=ef(e,n-e.l,r);o[3]=qr(f,null,s,r.supbooks,r)}else e.l=n;return o}function JD(e,t,r){var n=e.l+t,s=en(e);s.r=r["!row"];var l=Jr(e),o=[s,l,"str"];if(r.cellFormula){e.l+=2;var f=ef(e,n-e.l,r);o[3]=qr(f,null,s,r.supbooks,r)}else e.l=n;return o}var eO=Mi,tO=zl;function rO(e,t){return t==null&&(t=Ne(4)),t.write_shift(4,e),t}function aO(e,t){var r=e.l+t,n=Mi(e),s=$m(e),l=Jr(e),o=Jr(e),f=Jr(e);e.l=r;var m={rfx:n,relId:s,loc:l,display:f};return o&&(m.Tooltip=o),m}function nO(e,t){var r=Ne(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));zl({s:nr(e[0]),e:nr(e[0])},r),Ym("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Rr(s||"",r),Rr(e[1].Tooltip||"",r),Rr("",r),r.slice(0,r.l)}function sO(){}function iO(e,t,r){var n=e.l+t,s=Lw(e),l=e.read_shift(1),o=[s];if(o[2]=l,r.cellFormula){var f=jR(e,n-e.l,r);o[1]=f}else e.l=n;return o}function lO(e,t,r){var n=e.l+t,s=Mi(e),l=[s];if(r.cellFormula){var o=RR(e,n-e.l,r);l[1]=o,e.l=n}else e.l=n;return l}function cO(e,t,r){r==null&&(r=Ne(18));var n=tf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var Pb=["left","right","top","bottom","header","footer"];function oO(e){var t={};return Pb.forEach(function(r){t[r]=Zr(e)}),t}function uO(e,t){return t==null&&(t=Ne(6*8)),vi(e),Pb.forEach(function(r){Ei(e[r],t)}),t}function fO(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function dO(e,t,r){r==null&&(r=Ne(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function hO(e){var t=Ne(24);return t.write_shift(4,4),t.write_shift(4,1),zl(e,t),t}function mO(e,t){return t==null&&(t=Ne(16*4+2)),t.write_shift(2,e.password?ex(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function xO(){}function pO(){}function gO(e,t,r,n,s,l,o){if(!e)return e;var f=t||{};n||(n={"!id":{}});var m=f.dense?[]:{},h,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,y=!1,S,w,b,_,T,N,E,j,F,R=[];f.biff=12,f["!row"]=0;var A=0,P=!1,U=[],ee={},W=f.supbooks||s.supbooks||[[]];if(W.sharedf=ee,W.arrayf=U,W.SheetNames=s.SheetNames||s.Sheets.map(function(Ae){return Ae.name}),!f.supbooks&&(f.supbooks=W,s.Names))for(var J=0;J<s.Names.length;++J)W[0][J+1]=s.Names[J];var xe=[],pe=[],we=!1;wo[16]={n:"BrtShortReal",f:Ib};var Q;if(ss(e,function(re,z,te){if(!y)switch(te){case 148:h=re;break;case 0:S=re,f.sheetRows&&f.sheetRows<=S.r&&(y=!0),j=cr(_=S.r),f["!row"]=S.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=jl(re.hpt)),pe[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:re[2]},re[2]){case"n":w.v=re[1];break;case"s":E=eo[re[1]],w.v=E.t,w.r=E.r;break;case"b":w.v=!!re[1];break;case"e":w.v=re[1],f.cellText!==!1&&(w.w=is[w.v]);break;case"str":w.t="s",w.v=re[1];break;case"is":w.t="s",w.v=re[1].t;break}if((b=o.CellXf[re[0].iStyleRef])&&Lb(w,b.numFmtId,null,f,l,o),T=re[0].c==-1?T+1:re[0].c,f.dense?(m[_]||(m[_]=[]),m[_][T]=w):m[Jt(T)+j]=w,f.cellFormula){for(P=!1,A=0;A<U.length;++A){var D=U[A];S.r>=D[0].s.r&&S.r<=D[0].e.r&&T>=D[0].s.c&&T<=D[0].e.c&&(w.F=dt(D[0]),P=!0)}!P&&re.length>3&&(w.f=re[3])}if(x.s.r>S.r&&(x.s.r=S.r),x.s.c>T&&(x.s.c=T),x.e.r<S.r&&(x.e.r=S.r),x.e.c<T&&(x.e.c=T),f.cellDates&&b&&w.t=="n"&&ji(Ze[b.numFmtId])){var V=Bs(w.v);V&&(w.t="d",w.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}Q&&(Q.type=="XLDAPR"&&(w.D=!0),Q=void 0);break;case 1:case 12:if(!f.sheetStubs||g)break;w={t:"z",v:void 0},T=re[0].c==-1?T+1:re[0].c,f.dense?(m[_]||(m[_]=[]),m[_][T]=w):m[Jt(T)+j]=w,x.s.r>S.r&&(x.s.r=S.r),x.s.c>T&&(x.s.c=T),x.e.r<S.r&&(x.e.r=S.r),x.e.c<T&&(x.e.c=T),Q&&(Q.type=="XLDAPR"&&(w.D=!0),Q=void 0);break;case 176:R.push(re);break;case 49:Q=((f.xlmeta||{}).Cell||[])[re-1];break;case 494:var M=n["!id"][re.relId];for(M?(re.Target=M.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=M):re.relId==""&&(re.Target="#"+re.loc),_=re.rfx.s.r;_<=re.rfx.e.r;++_)for(T=re.rfx.s.c;T<=re.rfx.e.c;++T)f.dense?(m[_]||(m[_]=[]),m[_][T]||(m[_][T]={t:"z",v:void 0}),m[_][T].l=re):(N=rt({c:T,r:_}),m[N]||(m[N]={t:"z",v:void 0}),m[N].l=re);break;case 426:if(!f.cellFormula)break;U.push(re),F=f.dense?m[_][T]:m[Jt(T)+j],F.f=qr(re[1],x,{r:S.r,c:T},W,f),F.F=dt(re[0]);break;case 427:if(!f.cellFormula)break;ee[rt(re[0].s)]=re[1],F=f.dense?m[_][T]:m[Jt(T)+j],F.f=qr(re[1],x,{r:S.r,c:T},W,f);break;case 60:if(!f.cellStyles)break;for(;re.e>=re.s;)xe[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},we||(we=!0,tx(re.w/256)),zs(xe[re.e+1]);break;case 161:m["!autofilter"]={ref:dt(re)};break;case 476:m["!margins"]=re;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),re.name&&(s.Sheets[r].CodeName=re.name),(re.above||re.left)&&(m["!outline"]={above:re.above,left:re.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),re.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!z.T){if(!g||f.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},f),delete f.supbooks,delete f["!row"],!m["!ref"]&&(x.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(m["!ref"]=dt(h||x)),f.sheetRows&&m["!ref"]){var ie=St(m["!ref"]);f.sheetRows<=+ie.e.r&&(ie.e.r=f.sheetRows-1,ie.e.r>x.e.r&&(ie.e.r=x.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>x.e.c&&(ie.e.c=x.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),m["!fullref"]=m["!ref"],m["!ref"]=dt(ie))}return R.length>0&&(m["!merges"]=R),xe.length>0&&(m["!cols"]=xe),pe.length>0&&(m["!rows"]=pe),m}function vO(e,t,r,n,s,l,o){if(t.v===void 0)return!1;var f="";switch(t.t){case"b":f=t.v?"1":"0";break;case"d":t=Yt(t),t.z=t.z||Ze[14],t.v=Sr(er(t.v)),t.t="n";break;case"n":case"e":f=""+t.v;break;default:f=t.v;break}var m={r,c:n};switch(m.s=qs(s.cellXfs,t,s),t.l&&l["!links"].push([rt(m),t.l]),t.c&&l["!comments"].push([rt(m),t.c]),t.t){case"s":case"str":return s.bookSST?(f=ix(s.Strings,t.v,s.revStrings),m.t="s",m.v=f,o?Re(e,18,BD(t,m)):Re(e,7,MD(t,m))):(m.t="str",o?Re(e,17,WD(t,m)):Re(e,6,YD(t,m))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Re(e,13,GD(t,m)):Re(e,2,HD(t,m)):o?Re(e,16,PD(t,m)):Re(e,5,ID(t,m)),!0;case"b":return m.t="b",o?Re(e,15,CD(t,m)):Re(e,4,kD(t,m)),!0;case"e":return m.t="e",o?Re(e,14,DD(t,m)):Re(e,3,FD(t,m)),!0}return o?Re(e,12,ED(t,m)):Re(e,1,SD(t,m)),!0}function yO(e,t,r,n){var s=St(t["!ref"]||"A1"),l,o="",f=[];Re(e,145);var m=Array.isArray(t),h=s.e.r;t["!rows"]&&(h=Math.max(s.e.r,t["!rows"].length-1));for(var x=s.s.r;x<=h;++x){o=cr(x),pD(e,t,s,x);var g=!1;if(x<=s.e.r)for(var y=s.s.c;y<=s.e.c;++y){x===s.s.r&&(f[y]=Jt(y)),l=f[y]+o;var S=m?(t[x]||[])[y]:t[l];if(!S){g=!1;continue}g=vO(e,S,x,y,n,t,g)}}Re(e,146)}function wO(e,t){!t||!t["!merges"]||(Re(e,177,rO(t["!merges"].length)),t["!merges"].forEach(function(r){Re(e,176,tO(r))}),Re(e,178))}function bO(e,t){!t||!t["!cols"]||(Re(e,390),t["!cols"].forEach(function(r,n){r&&Re(e,60,cO(n,r))}),Re(e,391))}function _O(e,t){!t||!t["!ref"]||(Re(e,648),Re(e,649,hO(St(t["!ref"]))),Re(e,650))}function SO(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Bt(r,-1,n[1].Target.replace(/#.*$/,""),wt.HLINK);Re(e,494,nO(n,s))}}),delete t["!links"]}function NO(e,t,r,n){if(t["!comments"].length>0){var s=Bt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",wt.VML);Re(e,551,Ym("rId"+s)),t["!legacy"]=s}}function EO(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],l=typeof s.ref=="string"?s.ref:dt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,f=la(l);f.s.r==f.e.r&&(f.e.r=la(t["!ref"]).e.r,l=dt(f));for(var m=0;m<o.length;++m){var h=o[m];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+l;break}}m==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+l}),Re(e,161,zl(St(l))),Re(e,162)}}function TO(e,t,r){Re(e,133),Re(e,137,dO(t,r)),Re(e,138),Re(e,134)}function kO(e,t){t["!protect"]&&Re(e,535,mO(t["!protect"]))}function AO(e,t,r,n){var s=ya(),l=r.SheetNames[e],o=r.Sheets[l]||{},f=l;try{r&&r.Workbook&&(f=r.Workbook.Sheets[e].CodeName||f)}catch{}var m=St(o["!ref"]||"A1");if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Re(s,129),(r.vbaraw||o["!outline"])&&Re(s,147,bD(f,o["!outline"])),Re(s,148,vD(m)),TO(s,o,r.Workbook),bO(s,o),yO(s,o,e,t),kO(s,o),EO(s,o,r,e),wO(s,o),SO(s,o,n),o["!margins"]&&Re(s,476,uO(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&_O(s,o),NO(s,o,e,n),Re(s,130),s.end()}function CO(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=Tt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[t,s,n]}function jO(e,t,r,n,s,l){var o=l||{"!type":"chart"};if(!e)return l;var f=0,m=0,h="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var y=CO(g);x.s.r=x.s.c=0,x.e.c=f,h=Jt(f),y[0].forEach(function(S,w){o[h+cr(w)]={t:"n",v:S,z:y[1]},m=w}),x.e.r<m&&(x.e.r=m),++f}),f>0&&(o["!ref"]=dt(x)),o}function FO(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,f=e.match(Bb);return f&&lx(f[0],l,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function RO(e,t){e.l+=10;var r=Jr(e);return{name:r}}function DO(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ss(e,function(m,h,x){switch(x){case 550:l["!rel"]=m;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),m.name&&(s.Sheets[r].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},t),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var cx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],OO=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],MO=[],LO=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function By(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var l=t[s];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=Qt(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function Uy(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Qt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function zb(e){Uy(e.WBProps,cx),Uy(e.CalcPr,LO),By(e.WBView,OO),By(e.Sheets,MO),Tl.date1904=Qt(e.WBProps.date1904)}function BO(e){return!e.Workbook||!e.Workbook.WBProps?"false":Qt(e.Workbook.WBProps.date1904)?"true":"false"}var UO="][*?/\\".split("");function Hb(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return UO.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function IO(e,t,r){e.forEach(function(n,s){Hb(n);for(var l=0;l<s;++l)if(n==e[l])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Vb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];IO(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)BR(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var PO=/<\w+:workbook/;function zO(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",l={},o=0;if(e.replace(ra,function(m,h){var x=it(m);switch(Rn(x[0])){case"<?xml":break;case"<workbook":m.match(PO)&&(s="xmlns"+m.match(/<(\w+):/)[1]),r.xmlns=x[s];break;case"</workbook>":break;case"<fileVersion":delete x[0],r.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":cx.forEach(function(g){if(x[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=Qt(x[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(x[g[0]],10);break;default:r.WBProps[g[0]]=x[g[0]]}}),x.codeName&&(r.WBProps.CodeName=Gt(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],r.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=Tt(Gt(x.name)),delete x[0],r.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=Gt(x.name),x.comment&&(l.Comment=x.comment),x.localSheetId&&(l.Sheet=+x.localSheetId),Qt(x.hidden||"0")&&(l.Hidden=!0),o=h+m.length;break;case"</definedName>":l.Ref=Tt(Gt(e.slice(o,h))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete x[0],r.CalcPr=x;break;case"<calcPr/>":delete x[0],r.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return m}),Fi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return zb(r),r}function Gb(e){var t=[mr];t[t.length]=Ue("workbook",null,{xmlns:Fi[0],"xmlns:r":_r.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(cx.forEach(function(f){e.Workbook.WBProps[f[0]]!=null&&e.Workbook.WBProps[f[0]]!=f[1]&&(n[f[0]]=e.Workbook.WBProps[f[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ue("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:Ut(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ue("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(f){var m={name:f.Name};f.Comment&&(m.comment=f.Comment),f.Sheet!=null&&(m.localSheetId=""+f.Sheet),f.Hidden&&(m.hidden="1"),f.Ref&&(t[t.length]=Ue("definedName",Ut(f.Ref),m))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function HO(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=em(e),r.name=Jr(e),r}function VO(e,t){return t||(t=Ne(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Ym(e.strRelID,t),Rr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function GO(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Jr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function XO(e,t){t||(t=Ne(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Ow(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function $O(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function YO(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),l=NA(e),o=FR(e,0,r),f=$m(e);e.l=n;var m={Name:l,Ptg:o};return s<268435455&&(m.Sheet=s),f&&(m.Comment=f),m}function qO(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],wo[16]={n:"BrtFRTArchID$",f:$O},ss(e,function(m,h,x){switch(x){case 156:o.SheetNames.push(m.name),r.Sheets.push(m);break;case 153:r.WBProps=m;break;case 39:m.Sheet!=null&&(t.SID=m.Sheet),m.Ref=qr(m.Ptg,null,null,o,t),delete t.SID,delete m.Ptg,l.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([x,m]):o[0]=[x,m],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(m),o.XTI=o.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(x),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(x),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!h.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},t),zb(r),r.Names=l,r.supbooks=o,r}function WO(e,t){Re(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Re(e,156,VO(s))}Re(e,144)}function KO(e,t){t||(t=Ne(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Rr("SheetJS",t),Rr(co.version,t),Rr(co.version,t),Rr("7262",t),t.length>t.l?t.slice(0,t.l):t}function ZO(e,t){t||(t=Ne(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function QO(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,l=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&l==-1&&(l=n);l>s||(Re(e,135),Re(e,158,ZO(s)),Re(e,136))}}function JO(e,t){var r=ya();return Re(r,131),Re(r,128,KO()),Re(r,153,XO(e.Workbook&&e.Workbook.WBProps||null)),QO(r,e),WO(r,e),Re(r,132),r.end()}function e7(e,t,r){return t.slice(-4)===".bin"?qO(e,r):zO(e,r)}function t7(e,t,r,n,s,l,o,f){return t.slice(-4)===".bin"?gO(e,n,r,s,l,o,f):qR(e,n,r,s,l,o,f)}function r7(e,t,r,n,s,l,o,f){return t.slice(-4)===".bin"?DO(e,n,r,s,l):FO(e,n,r,s,l)}function a7(e,t,r,n,s,l,o,f){return t.slice(-4)===".bin"?iF():lF()}function n7(e,t,r,n,s,l,o,f){return t.slice(-4)===".bin"?nF():sF()}function s7(e,t,r,n){return t.slice(-4)===".bin"?tj(e,r,n):VC(e,r,n)}function i7(e,t,r){return Sb(e,r)}function l7(e,t,r){return t.slice(-4)===".bin"?cC(e,r):sC(e,r)}function c7(e,t,r){return t.slice(-4)===".bin"?Jj(e,r):Gj(e,r)}function o7(e,t,r){return t.slice(-4)===".bin"?zj(e):Ij(e)}function u7(e,t,r,n){return r.slice(-4)===".bin"?Hj(e,t,r,n):void 0}function f7(e,t,r){return t.slice(-4)===".bin"?Lj(e,t,r):Uj(e,t,r)}function d7(e,t,r){return(t.slice(-4)===".bin"?JO:Gb)(e)}function h7(e,t,r,n,s){return(t.slice(-4)===".bin"?AO:Ub)(e,r,n,s)}function m7(e,t,r){return(t.slice(-4)===".bin"?fj:bb)(e,r)}function x7(e,t,r){return(t.slice(-4)===".bin"?fC:hb)(e,r)}function p7(e,t,r){return(t.slice(-4)===".bin"?eF:Tb)(e)}function g7(e){return(e.slice(-4)===".bin"?Bj:Nb)()}var Xb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,$b=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function cn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(Xb),l,o,f,m;if(s)for(m=0;m!=s.length;++m)l=s[m].match($b),(o=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?f="xmlns"+l[1].slice(6):f=l[1].slice(o+1),n[f]=l[2].slice(1,l[2].length-1));return n}function v7(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Xb),s,l,o,f;if(n)for(f=0;f!=n.length;++f)s=n[f].match($b),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),r[o]=s[2].slice(1,s[2].length-1));return r}var ro;function y7(e,t){var r=ro[e]||Tt(e);return r==="General"?Si(t):Da(r,t)}function w7(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Qt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=er(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Tt(t)]=s}function b7(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||is[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=uo(e.v):e.w=Si(e.v):e.w=y7(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var n=ro[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ji(n)){var s=Bs(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(r.WTF)throw l}}}function _7(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=MC[n.Pattern]||n.Pattern)}e[t.ID]=t}function S7(e,t,r,n,s,l,o,f,m,h){var x="General",g=n.StyleID,y={};h=h||{};var S=[],w=0;for(g===void 0&&f&&(g=f.StyleID),g===void 0&&o&&(g=o.StyleID);l[g]!==void 0&&(l[g].nf&&(x=l[g].nf),l[g].Interior&&S.push(l[g].Interior),!!l[g].Parent);)g=l[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Qt(e);break;case"String":n.t="s",n.r=ty(Tt(e)),n.v=e.indexOf("<")>-1?Tt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(er(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Tt(e):n.v<60&&(n.v=n.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Iw[e],h.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=ty(t||e));break}if(b7(n,x,h),h.cellFormula!==!1)if(n.Formula){var b=Tt(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=El(b,s),delete n.Formula,n.ArrayRange=="RC"?n.F=El("RC:RC",s):n.ArrayRange&&(n.F=El(n.ArrayRange,s),m.push([St(n.F),n.F]))}else for(w=0;w<m.length;++w)s.r>=m[w][0].s.r&&s.r<=m[w][0].e.r&&s.c>=m[w][0].s.c&&s.c<=m[w][0].e.c&&(n.F=m[w][1]);h.cellStyles&&(S.forEach(function(_){!y.patternType&&_.patternType&&(y.patternType=_.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function N7(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Rh(e,t){var r=t||{};Ul();var n=bl(Lm(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Et<"u"?n=Et.utils.decode(65001,yu(n)):n=Gt(n));var s=n.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Yt(r);return o.type="string",Cl.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(vt){s.indexOf("<"+vt)>=0&&(l=!0)}),l)return iM(n,r);ro={"General Number":"General","General Date":Ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ze[15],"Short Date":Ze[14],"Long Time":Ze[19],"Medium Time":Ze[18],"Short Time":Ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ze[2],Standard:Ze[4],Percent:Ze[10],Scientific:Ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var f,m=[],h,x={},g=[],y=r.dense?[]:{},S="",w={},b={},_=cn('<Data ss:Type="String">'),T=0,N=0,E=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},R={},A="",P=0,U=[],ee={},W={},J=0,xe=[],pe=[],we={},Q=[],ie,Ae=!1,re=[],z=[],te={},D=0,V=0,M={Sheets:[],WBProps:{date1904:!1}},B={};mo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";f=mo.exec(n);)switch(f[3]=(K=f[3]).toLowerCase()){case"data":if(K=="data"){if(f[1]==="/"){if((h=m.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&m.push([f[3],!0]);break}if(m[m.length-1][1])break;f[1]==="/"?S7(n.slice(T,f.index),A,_,m[m.length-1][0]=="comment"?we:w,{c:N,r:E},F,Q[N],b,re,r):(A="",_=cn(f[0]),T=f.index+f[0].length);break;case"cell":if(f[1]==="/")if(pe.length>0&&(w.c=pe),(!r.sheetRows||r.sheetRows>E)&&w.v!==void 0&&(r.dense?(y[E]||(y[E]=[]),y[E][N]=w):y[Jt(N)+cr(E)]=w),w.HRef&&(w.l={Target:Tt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(D=N+(parseInt(w.MergeAcross,10)|0),V=E+(parseInt(w.MergeDown,10)|0),U.push({s:{c:N,r:E},e:{c:D,r:V}})),!r.sheetStubs)w.MergeAcross?N=D+1:++N;else if(w.MergeAcross||w.MergeDown){for(var oe=N;oe<=D;++oe)for(var ye=E;ye<=V;++ye)(oe>N||ye>E)&&(r.dense?(y[ye]||(y[ye]=[]),y[ye][oe]={t:"z"}):y[Jt(oe)+cr(ye)]={t:"z"});N=D+1}else++N;else w=v7(f[0]),w.Index&&(N=+w.Index-1),N<j.s.c&&(j.s.c=N),N>j.e.c&&(j.e.c=N),f[0].slice(-2)==="/>"&&++N,pe=[];break;case"row":f[1]==="/"||f[0].slice(-2)==="/>"?(E<j.s.r&&(j.s.r=E),E>j.e.r&&(j.e.r=E),f[0].slice(-2)==="/>"&&(b=cn(f[0]),b.Index&&(E=+b.Index-1)),N=0,++E):(b=cn(f[0]),b.Index&&(E=+b.Index-1),te={},(b.AutoFitHeight=="0"||b.Height)&&(te.hpx=parseInt(b.Height,10),te.hpt=yo(te.hpx),z[E]=te),b.Hidden=="1"&&(te.hidden=!0,z[E]=te));break;case"worksheet":if(f[1]==="/"){if((h=m.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"));g.push(S),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(y["!ref"]=dt(j),r.sheetRows&&r.sheetRows<=j.e.r&&(y["!fullref"]=y["!ref"],j.e.r=r.sheetRows-1,y["!ref"]=dt(j))),U.length&&(y["!merges"]=U),Q.length>0&&(y["!cols"]=Q),z.length>0&&(y["!rows"]=z),x[S]=y}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=N=0,m.push([f[3],!1]),h=cn(f[0]),S=Tt(h.Name),y=r.dense?[]:{},U=[],re=[],z=[],B={name:S,Hidden:0},M.Sheets.push(B);break;case"table":if(f[1]==="/"){if((h=m.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else{if(f[0].slice(-2)=="/>")break;m.push([f[3],!1]),Q=[],Ae=!1}break;case"style":f[1]==="/"?_7(F,R,r):R=cn(f[0]);break;case"numberformat":R.nf=Tt(cn(f[0]).Format||"General"),ro[R.nf]&&(R.nf=ro[R.nf]);for(var _e=0;_e!=392&&Ze[_e]!=R.nf;++_e);if(_e==392){for(_e=57;_e!=392;++_e)if(Ze[_e]==null){jn(R.nf,_e);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(ie=cn(f[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!Ae&&ie.wpx>10){Ae=!0,Wr=yb;for(var ae=0;ae<Q.length;++ae)Q[ae]&&zs(Q[ae])}Ae&&zs(ie),Q[ie.Index-1||Q.length]=ie;for(var He=0;He<+ie.Span;++He)Q[Q.length]=Yt(ie);break;case"namedrange":if(f[1]==="/")break;M.Names||(M.Names=[]);var Y=it(f[0]),ct={Name:Y.Name,Ref:El(Y.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(ct.Sheet=M.Sheets.length-1),M.Names.push(ct);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(f[0].slice(-2)==="/>")break;f[1]==="/"?A+=n.slice(P,f.index):P=f.index+f[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=cn(f[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(f[0].slice(-2)==="/>")break;f[1]==="/"?WA(ee,K,n.slice(J,f.index)):J=f.index+f[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(f[1]==="/"){if((h=m.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else m.push([f[3],!1]);break;case"comment":if(f[1]==="/"){if((h=m.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"));N7(we),pe.push(we)}else m.push([f[3],!1]),h=cn(f[0]),we={a:h.Author};break;case"autofilter":if(f[1]==="/"){if((h=m.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else if(f[0].charAt(f[0].length-2)!=="/"){var $e=cn(f[0]);y["!autofilter"]={ref:El($e.Range).replace(/\$/g,"")},m.push([f[3],!0])}break;case"name":break;case"datavalidation":if(f[1]==="/"){if((h=m.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&m.push([f[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(f[1]==="/"){if((h=m.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&m.push([f[3],!0]);break;case"null":break;default:if(m.length==0&&f[3]=="document"||m.length==0&&f[3]=="uof")return Vy(n,r);var xt=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(f[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:xt=!1}break;case"componentoptions":switch(f[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:xt=!1}break;case"excelworkbook":switch(f[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:xt=!1}break;case"workbookoptions":switch(f[3]){case"owcversion":break;case"height":break;case"width":break;default:xt=!1}break;case"worksheetoptions":switch(f[3]){case"visible":if(f[0].slice(-2)!=="/>")if(f[1]==="/")switch(n.slice(J,f.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else J=f.index+f[0].length;break;case"header":y["!margins"]||vi(y["!margins"]={},"xlml"),isNaN(+it(f[0]).Margin)||(y["!margins"].header=+it(f[0]).Margin);break;case"footer":y["!margins"]||vi(y["!margins"]={},"xlml"),isNaN(+it(f[0]).Margin)||(y["!margins"].footer=+it(f[0]).Margin);break;case"pagemargins":var et=it(f[0]);y["!margins"]||vi(y["!margins"]={},"xlml"),isNaN(+et.Top)||(y["!margins"].top=+et.Top),isNaN(+et.Left)||(y["!margins"].left=+et.Left),isNaN(+et.Right)||(y["!margins"].right=+et.Right),isNaN(+et.Bottom)||(y["!margins"].bottom=+et.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:xt=!1}break;case"pivottable":case"pivotcache":switch(f[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:xt=!1}break;case"pagebreaks":switch(f[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:xt=!1}break;case"autofilter":switch(f[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:xt=!1}break;case"querytable":switch(f[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:xt=!1}break;case"datavalidation":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:xt=!1}break;case"sorting":case"conditionalformatting":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:xt=!1}break;case"mapinfo":case"schema":case"data":switch(f[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:xt=!1}break;case"smarttags":break;default:xt=!1;break}if(xt||f[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+f[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(f[0].slice(-2)==="/>")break;f[1]==="/"?w7(W,K,xe,n.slice(J,f.index)):(xe=f,J=f.index+f[0].length);break}if(r.WTF)throw"Unrecognized tag: "+f[3]+"|"+m.join("|")}var Me={};return!r.bookSheets&&!r.bookProps&&(Me.Sheets=x),Me.SheetNames=g,Me.Workbook=M,Me.SSF=Yt(Ze),Me.Props=ee,Me.Custprops=W,Me}function lm(e,t){switch(fx(t=t||{}),t.type||"base64"){case"base64":return Rh(Ra(e),t);case"binary":case"buffer":case"file":return Rh(e,t);case"array":return Rh($s(e),t)}}function E7(e,t){var r=[];return e.Props&&r.push(KA(e.Props,t)),e.Custprops&&r.push(ZA(e.Props,e.Custprops)),r.join("")}function T7(){return""}function k7(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var l=[];l.push(Ue("NumberFormat",null,{"ss:Format":Ut(Ze[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Ue("Style",l.join(""),o))}),Ue("Styles",r.join(""))}function Yb(e){return Ue("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+nx(e.Ref,{r:0,c:0})})}function A7(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(Yb(s)))}return Ue("Names",r.join(""))}function C7(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,l=[],o=0;o<s.length;++o){var f=s[o];f.Sheet==r&&(f.Name.match(/^_xlfn\./)||l.push(Yb(f)))}return l.join("")}function j7(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ue("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ue("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ue("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Ue("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(n.Workbook.Sheets[l]&&!n.Workbook.Sheets[l].Hidden);++l);l==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Ir("ProtectContents","True")),e["!protect"].objects&&s.push(Ir("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Ir("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Ir("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Ir("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Ue("WorksheetOptions",s.join(""),{xmlns:Aa.x})}function F7(e){return e.map(function(t){var r=J6(t.t||""),n=Ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",n,{"ss:Author":t.a})}).join("")}function R7(e,t,r,n,s,l,o){if(!e||e.v==null&&e.f==null)return"";var f={};if(e.f&&(f["ss:Formula"]="="+Ut(nx(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var m=nr(e.F.slice(t.length+1));f["ss:ArrayRange"]="RC:R"+(m.r==o.r?"":"["+(m.r-o.r)+"]")+"C"+(m.c==o.c?"":"["+(m.c-o.c)+"]")}if(e.l&&e.l.Target&&(f["ss:HRef"]=Ut(e.l.Target),e.l.Tooltip&&(f["x:HRefScreenTip"]=Ut(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],x=0;x!=h.length;++x)h[x].s.c!=o.c||h[x].s.r!=o.r||(h[x].e.c>h[x].s.c&&(f["ss:MergeAcross"]=h[x].e.c-h[x].s.c),h[x].e.r>h[x].s.r&&(f["ss:MergeDown"]=h[x].e.r-h[x].s.r));var g="",y="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",y=String(e.v);break;case"b":g="Boolean",y=e.v?"1":"0";break;case"e":g="Error",y=is[e.v];break;case"d":g="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ze[14]);break;case"s":g="String",y=Q6(e.v||"");break}var S=qs(n.cellXfs,e,n);f["ss:StyleID"]="s"+(21+S),f["ss:Index"]=o.c+1;var w=e.v!=null?y:"",b=e.t=="z"?"":'<Data ss:Type="'+g+'">'+w+"</Data>";return(e.c||[]).length>0&&(b+=F7(e.c)),Ue("Cell",b,f)}function D7(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=jl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function O7(e,t,r,n){if(!e["!ref"])return"";var s=St(e["!ref"]),l=e["!merges"]||[],o=0,f=[];e["!cols"]&&e["!cols"].forEach(function(_,T){zs(_);var N=!!_.width,E=tf(T,_),j={"ss:Index":T+1};N&&(j["ss:Width"]=go(E.width)),_.hidden&&(j["ss:Hidden"]="1"),f.push(Ue("Column",null,j))});for(var m=Array.isArray(e),h=s.s.r;h<=s.e.r;++h){for(var x=[D7(h,(e["!rows"]||[])[h])],g=s.s.c;g<=s.e.c;++g){var y=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>g)&&!(l[o].s.r>h)&&!(l[o].e.c<g)&&!(l[o].e.r<h)){(l[o].s.c!=g||l[o].s.r!=h)&&(y=!0);break}if(!y){var S={r:h,c:g},w=rt(S),b=m?(e[h]||[])[g]:e[w];x.push(R7(b,w,e,t,r,n,S))}}x.push("</Row>"),x.length>2&&f.push(x.join(""))}return f.join("")}function M7(e,t,r){var n=[],s=r.SheetNames[e],l=r.Sheets[s],o=l?C7(l,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=l?O7(l,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(j7(l,t,e,r)),n.join("")}function L7(e,t){t||(t={}),e.SSF||(e.SSF=Yt(Ze)),e.SSF&&(Ul(),Fo(e.SSF),t.revssf=Wu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],qs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(E7(e,t)),r.push(T7()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ue("Worksheet",M7(n,t,e),{"ss:Name":Ut(e.SheetNames[n])}));return r[2]=k7(e,t),r[3]=A7(e),mr+Ue("Workbook",r.join(""),{xmlns:Aa.ss,"xmlns:o":Aa.o,"xmlns:x":Aa.x,"xmlns:ss":Aa.ss,"xmlns:dt":Aa.dt,"xmlns:html":Aa.html})}function B7(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=CA(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=jA(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var U7=[60,1084,2066,2165,2175];function I7(e,t,r,n,s){var l=n,o=[],f=r.slice(r.l,r.l+l);if(s&&s.enc&&s.enc.insitu&&f.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(f)}o.push(f),r.l+=l;for(var m=Kn(r,r.l),h=cm[m],x=0;h!=null&&U7.indexOf(m)>-1;)l=Kn(r,r.l+2),x=r.l+4,m==2066?x+=4:(m==2165||m==2175)&&(x+=12),f=r.slice(x,r.l+4+l),o.push(f),r.l+=4+l,h=cm[m=Kn(r,r.l)];var g=Fr(o);Ur(g,0);var y=0;g.lens=[];for(var S=0;S<o.length;++S)g.lens.push(y),y+=o[S].length;if(g.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+g.length+" < "+n;return t.f(g,g.length,s)}function Nn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ze[n])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||is[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=uo(e.v):e.w=Si(e.v):e.w=Da(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&n&&e.t=="n"&&ji(Ze[n]||String(n))){var s=Bs(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function su(e,t,r){return{v:e,ixfe:t,t:r}}function P7(e,t){var r={opts:{}},n={},s=t.dense?[]:{},l={},o={},f=null,m=[],h="",x={},g,y="",S,w,b,_,T={},N=[],E,j,F=[],R=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},U=function(lt){return lt<8?xi[lt]:lt<64&&R[lt-8]||xi[lt]},ee=function(lt,Xt,zr){var jt=Xt.XF.data;if(!(!jt||!jt.patternType||!zr||!zr.cellStyles)){Xt.s={},Xt.s.patternType=jt.patternType;var Hr;(Hr=po(U(jt.icvFore)))&&(Xt.s.fgColor={rgb:Hr}),(Hr=po(U(jt.icvBack)))&&(Xt.s.bgColor={rgb:Hr})}},W=function(lt,Xt,zr){if(!(te>1)&&!(zr.sheetRows&&lt.r>=zr.sheetRows)){if(zr.cellStyles&&Xt.XF&&Xt.XF.data&&ee(lt,Xt,zr),delete Xt.ixfe,delete Xt.XF,g=lt,y=rt(lt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),lt.r<o.s.r&&(o.s.r=lt.r),lt.c<o.s.c&&(o.s.c=lt.c),lt.r+1>o.e.r&&(o.e.r=lt.r+1),lt.c+1>o.e.c&&(o.e.c=lt.c+1),zr.cellFormula&&Xt.f){for(var jt=0;jt<N.length;++jt)if(!(N[jt][0].s.c>lt.c||N[jt][0].s.r>lt.r)&&!(N[jt][0].e.c<lt.c||N[jt][0].e.r<lt.r)){Xt.F=dt(N[jt][0]),(N[jt][0].s.c!=lt.c||N[jt][0].s.r!=lt.r)&&delete Xt.f,Xt.f&&(Xt.f=""+qr(N[jt][1],o,lt,re,J));break}}zr.dense?(s[lt.r]||(s[lt.r]=[]),s[lt.r][lt.c]=Xt):s[y]=Xt}},J={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(J.password=t.password);var xe,pe=[],we=[],Q=[],ie=[],Ae=!1,re=[];re.SheetNames=J.snames,re.sharedf=J.sharedf,re.arrayf=J.arrayf,re.names=[],re.XTI=[];var z=0,te=0,D=0,V=[],M=[],B;J.codepage=1200,Za(1200);for(var K=!1;e.l<e.length-1;){var oe=e.l,ye=e.read_shift(2);if(ye===0&&z===10)break;var _e=e.l===e.length?0:e.read_shift(2),ae=cm[ye];if(ae&&ae.f){if(t.bookSheets&&z===133&&ye!==133)break;if(z=ye,ae.r===2||ae.r==12){var He=e.read_shift(2);if(_e-=2,!J.enc&&He!==ye&&((He&255)<<8|He>>8)!==ye)throw new Error("rt mismatch: "+He+"!="+ye);ae.r==12&&(e.l+=10,_e-=10)}var Y={};if(ye===10?Y=ae.f(e,_e,J):Y=I7(ye,ae,e,_e,J),te==0&&[9,521,1033,2057].indexOf(z)===-1)continue;switch(ye){case 34:r.opts.Date1904=A.WBProps.date1904=Y;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(J.enc||(e.l=0),J.enc=Y,!t.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:J.lastuser=Y;break;case 66:var ct=Number(Y);switch(ct){case 21010:ct=1200;break;case 32768:ct=1e4;break;case 32769:ct=1252;break}Za(J.codepage=ct),K=!0;break;case 317:J.rrtabid=Y;break;case 25:J.winlocked=Y;break;case 439:r.opts.RefreshAll=Y;break;case 12:r.opts.CalcCount=Y;break;case 16:r.opts.CalcDelta=Y;break;case 17:r.opts.CalcIter=Y;break;case 13:r.opts.CalcMode=Y;break;case 14:r.opts.CalcPrecision=Y;break;case 95:r.opts.CalcSaveRecalc=Y;break;case 15:J.CalcRefMode=Y;break;case 2211:r.opts.FullCalc=Y;break;case 129:Y.fDialog&&(s["!type"]="dialog"),Y.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Y.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:F.push(Y);break;case 430:re.push([Y]),re[re.length-1].XTI=[];break;case 35:case 547:re[re.length-1].push(Y);break;case 24:case 536:B={Name:Y.Name,Ref:qr(Y.rgce,o,null,re,J)},Y.itab>0&&(B.Sheet=Y.itab-1),re.names.push(B),re[0]||(re[0]=[],re[0].XTI=[]),re[re.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(M[Y.itab-1]={ref:dt(Y.rgce[0][0][1][2])});break;case 22:J.ExternCount=Y;break;case 23:re.length==0&&(re[0]=[],re[0].XTI=[]),re[re.length-1].XTI=re[re.length-1].XTI.concat(Y),re.XTI=re.XTI.concat(Y);break;case 2196:if(J.biff<8)break;B!=null&&(B.Comment=Y[1]);break;case 18:s["!protect"]=Y;break;case 19:Y!==0&&J.WTF&&console.error("Password verifier: "+Y);break;case 133:l[Y.pos]=Y,J.snames.push(Y.name);break;case 10:{if(--te)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=dt(o),t.sheetRows&&t.sheetRows<=o.e.r){var $e=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=dt(o),o.e.r=$e}o.e.r++,o.e.c++}pe.length>0&&(s["!merges"]=pe),we.length>0&&(s["!objects"]=we),Q.length>0&&(s["!cols"]=Q),ie.length>0&&(s["!rows"]=ie),A.Sheets.push(P)}h===""?x=s:n[h]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(J.biff===8&&(J.biff={9:2,521:3,1033:4}[ye]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),J.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(J.biff=5,K=!0,Za(J.codepage=28591)),J.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(J.biff=2),te++)break;if(s=t.dense?[]:{},J.biff<8&&!K&&(K=!0,Za(J.codepage=t.codepage||1252)),J.biff<5||Y.BIFFVer==0&&Y.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var xt={pos:e.l-_e,name:h};l[xt.pos]=xt,J.snames.push(h)}else h=(l[oe]||{name:""}).name;Y.dt==32&&(s["!type"]="chart"),Y.dt==64&&(s["!type"]="macro"),pe=[],we=[],J.arrayf=N=[],Q=[],ie=[],Ae=!1,P={Hidden:(l[oe]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[Y.r]||[])[Y.c]:s[rt({c:Y.c,r:Y.r})])&&++Y.c,E={ixfe:Y.ixfe,XF:F[Y.ixfe]||{},v:Y.val,t:"n"},D>0&&(E.z=V[E.ixfe>>8&63]),Nn(E,t,r.opts.Date1904),W({c:Y.c,r:Y.r},E,t);break;case 5:case 517:E={ixfe:Y.ixfe,XF:F[Y.ixfe],v:Y.val,t:Y.t},D>0&&(E.z=V[E.ixfe>>8&63]),Nn(E,t,r.opts.Date1904),W({c:Y.c,r:Y.r},E,t);break;case 638:E={ixfe:Y.ixfe,XF:F[Y.ixfe],v:Y.rknum,t:"n"},D>0&&(E.z=V[E.ixfe>>8&63]),Nn(E,t,r.opts.Date1904),W({c:Y.c,r:Y.r},E,t);break;case 189:for(var et=Y.c;et<=Y.C;++et){var Me=Y.rkrec[et-Y.c][0];E={ixfe:Me,XF:F[Me],v:Y.rkrec[et-Y.c][1],t:"n"},D>0&&(E.z=V[E.ixfe>>8&63]),Nn(E,t,r.opts.Date1904),W({c:et,r:Y.r},E,t)}break;case 6:case 518:case 1030:{if(Y.val=="String"){f=Y;break}if(E=su(Y.val,Y.cell.ixfe,Y.tt),E.XF=F[E.ixfe],t.cellFormula){var vt=Y.formula;if(vt&&vt[0]&&vt[0][0]&&vt[0][0][0]=="PtgExp"){var De=vt[0][0][1][0],at=vt[0][0][1][1],Ce=rt({r:De,c:at});T[Ce]?E.f=""+qr(Y.formula,o,Y.cell,re,J):E.F=((t.dense?(s[De]||[])[at]:s[Ce])||{}).F}else E.f=""+qr(Y.formula,o,Y.cell,re,J)}D>0&&(E.z=V[E.ixfe>>8&63]),Nn(E,t,r.opts.Date1904),W(Y.cell,E,t),f=Y}break;case 7:case 519:if(f)f.val=Y,E=su(Y,f.cell.ixfe,"s"),E.XF=F[E.ixfe],t.cellFormula&&(E.f=""+qr(f.formula,o,f.cell,re,J)),D>0&&(E.z=V[E.ixfe>>8&63]),Nn(E,t,r.opts.Date1904),W(f.cell,E,t),f=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(Y);var Fe=rt(Y[0].s);if(S=t.dense?(s[Y[0].s.r]||[])[Y[0].s.c]:s[Fe],t.cellFormula&&S){if(!f||!Fe||!S)break;S.f=""+qr(Y[1],o,Y[0],re,J),S.F=dt(Y[0])}}break;case 1212:{if(!t.cellFormula)break;if(y){if(!f)break;T[rt(f.cell)]=Y[0],S=t.dense?(s[f.cell.r]||[])[f.cell.c]:s[rt(f.cell)],(S||{}).f=""+qr(Y[0],o,g,re,J)}}break;case 253:E=su(m[Y.isst].t,Y.ixfe,"s"),m[Y.isst].h&&(E.h=m[Y.isst].h),E.XF=F[E.ixfe],D>0&&(E.z=V[E.ixfe>>8&63]),Nn(E,t,r.opts.Date1904),W({c:Y.c,r:Y.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:Y.ixfe,XF:F[Y.ixfe],t:"z"},D>0&&(E.z=V[E.ixfe>>8&63]),Nn(E,t,r.opts.Date1904),W({c:Y.c,r:Y.r},E,t));break;case 190:if(t.sheetStubs)for(var de=Y.c;de<=Y.C;++de){var Te=Y.ixfe[de-Y.c];E={ixfe:Te,XF:F[Te],t:"z"},D>0&&(E.z=V[E.ixfe>>8&63]),Nn(E,t,r.opts.Date1904),W({c:de,r:Y.r},E,t)}break;case 214:case 516:case 4:E=su(Y.val,Y.ixfe,"s"),E.XF=F[E.ixfe],D>0&&(E.z=V[E.ixfe>>8&63]),Nn(E,t,r.opts.Date1904),W({c:Y.c,r:Y.r},E,t);break;case 0:case 512:te===1&&(o=Y);break;case 252:m=Y;break;case 1054:if(J.biff==4){V[D++]=Y[1];for(var qe=0;qe<D+163&&Ze[qe]!=Y[1];++qe);qe>=163&&jn(Y[1],D+163)}else jn(Y[1],Y[0]);break;case 30:{V[D++]=Y;for(var Ke=0;Ke<D+163&&Ze[Ke]!=Y;++Ke);Ke>=163&&jn(Y,D+163)}break;case 229:pe=pe.concat(Y);break;case 93:we[Y.cmo[0]]=J.lastobj=Y;break;case 438:J.lastobj.TxO=Y;break;case 127:J.lastobj.ImData=Y;break;case 440:for(_=Y[0].s.r;_<=Y[0].e.r;++_)for(b=Y[0].s.c;b<=Y[0].e.c;++b)S=t.dense?(s[_]||[])[b]:s[rt({c:b,r:_})],S&&(S.l=Y[1]);break;case 2048:for(_=Y[0].s.r;_<=Y[0].e.r;++_)for(b=Y[0].s.c;b<=Y[0].e.c;++b)S=t.dense?(s[_]||[])[b]:s[rt({c:b,r:_})],S&&S.l&&(S.l.Tooltip=Y[1]);break;case 28:{if(J.biff<=5&&J.biff>=2)break;S=t.dense?(s[Y[0].r]||[])[Y[0].c]:s[rt(Y[0])];var Xe=we[Y[2]];S||(t.dense?(s[Y[0].r]||(s[Y[0].r]=[]),S=s[Y[0].r][Y[0].c]={t:"z"}):S=s[rt(Y[0])]={t:"z"},o.e.r=Math.max(o.e.r,Y[0].r),o.s.r=Math.min(o.s.r,Y[0].r),o.e.c=Math.max(o.e.c,Y[0].c),o.s.c=Math.min(o.s.c,Y[0].c)),S.c||(S.c=[]),w={a:Y[1],t:Xe.TxO.t},S.c.push(w)}break;case 2173:Aj(F[Y.ixfe],Y.ext);break;case 125:{if(!J.cellStyles)break;for(;Y.e>=Y.s;)Q[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},Ae||(Ae=!0,tx(Y.w/256)),zs(Q[Y.e+1])}break;case 520:{var ut={};Y.level!=null&&(ie[Y.r]=ut,ut.level=Y.level),Y.hidden&&(ie[Y.r]=ut,ut.hidden=!0),Y.hpt&&(ie[Y.r]=ut,ut.hpt=Y.hpt,ut.hpx=jl(Y.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||vi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ye]]=Y;break;case 161:s["!margins"]||vi(s["!margins"]={}),s["!margins"].header=Y.header,s["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(A.Views[0].RTL=!0);break;case 146:R=Y;break;case 2198:xe=Y;break;case 140:j=Y;break;case 442:h?P.CodeName=Y||P.name:A.WBProps.CodeName=Y||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+ye.toString(16)),e.l+=_e}return r.SheetNames=ur(l).sort(function(nt,lt){return Number(nt)-Number(lt)}).map(function(nt){return l[nt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&x["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=x)):r.Preamble=x,r.Sheets&&M.forEach(function(nt,lt){r.Sheets[r.SheetNames[lt]]["!autofilter"]=nt}),r.Strings=m,r.SSF=Yt(Ze),J.enc&&(r.Encryption=J.enc),xe&&(r.Themes=xe),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),re.names.length>0&&(A.Names=re.names),r.Workbook=A,r}var ao={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function z7(e,t,r){var n=We.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=yy(n,tm,ao.DSI);for(var l in s)t[l]=s[l]}catch(h){if(r.WTF)throw h}var o=We.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var f=yy(o,rm,ao.SI);for(var m in f)t[m]==null&&(t[m]=f[m])}catch(h){if(r.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(Xw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function H7(e,t){var r=[],n=[],s=[],l=0,o,f=Wv(tm,"n"),m=Wv(rm,"n");if(e.Props)for(o=ur(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(f,o[l])?r:Object.prototype.hasOwnProperty.call(m,o[l])?n:s).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=ur(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(f,o[l])?r:Object.prototype.hasOwnProperty.call(m,o[l])?n:s).push([o[l],e.Custprops[o[l]]]);var h=[];for(l=0;l<s.length;++l)Qw.indexOf(s[l][0])>-1||Gw.indexOf(s[l][0])>-1||s[l][1]!=null&&h.push(s[l]);n.length&&We.utils.cfb_add(t,"/SummaryInformation",wy(n,ao.SI,m,rm)),(r.length||h.length)&&We.utils.cfb_add(t,"/DocumentSummaryInformation",wy(r,ao.DSI,f,tm,h.length?h:null,ao.UDI))}function ox(e,t){t||(t={}),fx(t),Yu(),t.codepage&&$u(t.codepage);var r,n;if(e.FullPaths){if(We.find(e,"/encryption"))throw new Error("File is password-protected");r=We.find(e,"!CompObj"),n=We.find(e,"/Workbook")||We.find(e,"/Book")}else{switch(t.type){case"base64":e=Ca(Ra(e));break;case"binary":e=Ca(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ur(e,0),n={content:e}}var s,l;if(r&&B7(r),t.bookProps&&!t.bookSheets)s={};else{var o=gt?"buffer":"array";if(n&&n.content)s=P7(n.content,t);else if((l=We.find(e,"PerfectOffice_MAIN"))&&l.content)s=gi.to_workbook(l.content,(t.type=o,t));else if((l=We.find(e,"NativeContent_MAIN"))&&l.content)s=gi.to_workbook(l.content,(t.type=o,t));else throw(l=We.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&We.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=rF(e))}var f={};return e.FullPaths&&z7(e,f,t),s.Props=s.Custprops=f,t.bookFiles&&(s.cfb=e),s}function V7(e,t){var r=t||{},n=We.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return We.utils.cfb_add(n,s,qb(e,r)),r.biff==8&&(e.Props||e.Custprops)&&H7(e,n),r.biff==8&&e.vbaraw&&aF(n,We.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var wo={0:{f:mD},1:{f:_D},2:{f:zD},3:{f:jD},4:{f:TD},5:{f:UD},6:{f:$D},7:{f:OD},8:{f:JD},9:{f:QD},10:{f:KD},11:{f:ZD},12:{f:ND},13:{f:VD},14:{f:RD},15:{f:AD},16:{f:Ib},17:{f:qD},18:{f:LD},19:{f:Xm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:YO},40:{},42:{},43:{f:$C},44:{f:GC},45:{f:WC},46:{f:ZC},47:{f:KC},48:{},49:{f:gA},50:{},51:{f:Fj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ob},62:{f:XD},63:{f:Pj},64:{f:xO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ea,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:fO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:wD},148:{f:gD,p:16},151:{f:sO},152:{},153:{f:GO},154:{},155:{},156:{f:HO},157:{},158:{},159:{T:1,f:lC},160:{T:-1},161:{T:1,f:Mi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:eO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Cj},336:{T:-1},337:{f:Oj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:em},357:{},358:{},359:{},360:{T:1},361:{},362:{f:cb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:iO},427:{f:lO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:oO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:yD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:aO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:em},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Zj},633:{T:1},634:{T:-1},635:{T:1,f:Wj},636:{T:-1},637:{f:bA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:RO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:pO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},cm={6:{f:jh},10:{f:Os},12:{f:yr},13:{f:yr},14:{f:hr},15:{f:hr},16:{f:Zr},17:{f:hr},18:{f:hr},19:{f:yr},20:{f:Ty},21:{f:Ty},23:{f:cb},24:{f:Ay},25:{f:hr},26:{},27:{},28:{f:p8},29:{},34:{f:hr},35:{f:ky},38:{f:Zr},39:{f:Zr},40:{f:Zr},41:{f:Zr},42:{f:hr},43:{f:hr},47:{f:AC},49:{f:V5},51:{f:yr},60:{},61:{f:U5},64:{f:hr},65:{f:H5},66:{f:yr},77:{},80:{},81:{},82:{},85:{f:yr},89:{},90:{},91:{},92:{f:k5},93:{f:y8},94:{},95:{f:hr},96:{},97:{},99:{f:hr},125:{f:ob},128:{f:n8},129:{f:C5},130:{f:yr},131:{f:hr},132:{f:hr},133:{f:j5},134:{},140:{f:k8},141:{f:yr},144:{},146:{f:j8},151:{},152:{},153:{},154:{},155:{},156:{f:yr},157:{},158:{},160:{f:B8},161:{f:D8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:e8},190:{f:t8},193:{f:Os},197:{},198:{},199:{},200:{},201:{},202:{f:hr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yr},220:{},221:{f:hr},222:{},224:{f:a8},225:{f:T5},226:{f:Os},227:{},229:{f:g8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:R5},253:{f:X5},255:{f:O5},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Jw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:hr},353:{f:Os},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:o8},431:{f:hr},432:{},433:{},434:{},437:{},438:{f:_8},439:{f:hr},440:{f:S8},441:{},442:{f:Oo},443:{},444:{f:yr},445:{},446:{},448:{f:Os},449:{f:B5,r:2},450:{f:Os},512:{f:Sy},513:{f:L8},515:{f:l8},516:{f:Y5},517:{f:Ey},519:{f:U8},520:{f:M5},523:{},545:{f:Cy},549:{f:_y},566:{},574:{f:P5},638:{f:J5},659:{},1048:{},1054:{f:W5},1084:{},1212:{f:h8},2048:{f:E8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ru},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Os},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:F8,r:12},2173:{f:kj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:hr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:d8,r:12},2197:{},2198:{f:bj,r:12},2199:{},2200:{},2201:{},2202:{f:m8,r:12},2203:{f:Os},2204:{},2205:{},2206:{},2207:{},2211:{f:L5},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:O8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:C8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Sy},1:{},2:{f:V8},3:{f:z8},4:{f:P8},5:{f:Ey},7:{f:X8},8:{},9:{f:ru},11:{},22:{f:yr},30:{f:Z5},31:{},32:{},33:{f:Cy},36:{},37:{f:_y},50:{f:$8},62:{},52:{},67:{},68:{f:yr},69:{},86:{},126:{},127:{f:I8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Y8},223:{},234:{},354:{},421:{},518:{f:jh},521:{f:ru},536:{f:Ay},547:{f:ky},561:{},579:{},1030:{f:jh},1033:{f:ru},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ie(e,t,r,n){var s=t;if(!isNaN(s)){var l=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,l),l>0&&Hm(r)&&e.push(r)}}function G7(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Ie(e,t,r,s);var l=t;if(!isNaN(l)){for(var o=r.parts||[],f=0,m=0,h=0;h+(o[f]||8224)<=8224;)h+=o[f]||8224,f++;var x=e.next(4);for(x.write_shift(2,l),x.write_shift(2,h),e.push(r.slice(m,m+h)),m+=h;m<s;){for(x=e.next(4),x.write_shift(2,60),h=0;h+(o[f]||8224)<=8224;)h+=o[f]||8224,f++;x.write_shift(2,h),e.push(r.slice(m,m+h)),m+=h}}}function Uo(e,t,r){return e||(e=Ne(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function X7(e,t,r,n){var s=Ne(9);return Uo(s,e,t),eb(r,n||"b",s),s}function $7(e,t,r){var n=Ne(8+2*r.length);return Uo(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Y7(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Sr(er(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Ie(e,2,G8(r,n,s)):Ie(e,3,H8(r,n,s));return;case"b":case"e":Ie(e,5,X7(r,n,t.v,t.t));return;case"s":case"str":Ie(e,4,$7(r,n,(t.v||"").slice(0,255)));return}Ie(e,1,Uo(null,r,n))}function q7(e,t,r,n){var s=Array.isArray(t),l=St(t["!ref"]||"A1"),o,f="",m=[];if(l.e.c>255||l.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=dt(l)}for(var h=l.s.r;h<=l.e.r;++h){f=cr(h);for(var x=l.s.c;x<=l.e.c;++x){h===l.s.r&&(m[x]=Jt(x)),o=m[x]+f;var g=s?(t[h]||[])[x]:t[o];g&&Y7(e,g,h,x)}}}function W7(e,t){for(var r=t||{},n=ya(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(s=l);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ie(n,r.biff==4?1033:r.biff==3?521:9,Qm(e,16,r)),q7(n,e.Sheets[e.SheetNames[s]],s,r),Ie(n,10),n.end()}function K7(e,t,r){Ie(e,49,G5({sz:12,name:"Arial"},r))}function Z7(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Ie(e,1054,K5(s,t[s],r))})}function Q7(e,t){var r=Ne(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ie(e,2151,r),r=Ne(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),sb(St(t["!ref"]||"A1"),r),r.write_shift(4,4),Ie(e,2152,r)}function J7(e,t){for(var r=0;r<16;++r)Ie(e,224,Ny({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ie(e,224,Ny(n,0,t))})}function eM(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ie(e,440,N8(n)),n[1].Tooltip&&Ie(e,2048,T8(n))}delete t["!links"]}function tM(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Ie(e,125,R8(tf(s,n),s))})}}function rM(e,t,r,n,s){var l=16+qs(s.cellXfs,t,s);if(t.v==null&&!t.bf){Ie(e,513,ki(r,n,l));return}if(t.bf)Ie(e,6,CR(t,r,n,s,l));else switch(t.t){case"d":case"n":var o=t.t=="d"?Sr(er(t.v)):t.v;Ie(e,515,c8(r,n,o,l));break;case"b":case"e":Ie(e,517,i8(r,n,t.v,l,s,t.t));break;case"s":case"str":if(s.bookSST){var f=ix(s.Strings,t.v,s.revStrings);Ie(e,253,$5(r,n,f,l))}else Ie(e,516,q5(r,n,(t.v||"").slice(0,255),l,s));break;default:Ie(e,513,ki(r,n,l))}}function aM(e,t,r){var n=ya(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=(r||{}).Workbook||{},f=(o.Sheets||[])[e]||{},m=Array.isArray(l),h=t.biff==8,x,g="",y=[],S=St(l["!ref"]||"A1"),w=h?65536:16384;if(S.e.c>255||S.e.r>=w){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");S.e.c=Math.min(S.e.c,255),S.e.r=Math.min(S.e.c,w-1)}Ie(n,2057,Qm(r,16,t)),Ie(n,13,Ka(1)),Ie(n,12,Ka(100)),Ie(n,15,sa(!0)),Ie(n,17,sa(!1)),Ie(n,16,Ei(.001)),Ie(n,95,sa(!0)),Ie(n,42,sa(!1)),Ie(n,43,sa(!1)),Ie(n,130,Ka(1)),Ie(n,128,s8()),Ie(n,131,sa(!1)),Ie(n,132,sa(!1)),h&&tM(n,l["!cols"]),Ie(n,512,Q5(S,t)),h&&(l["!links"]=[]);for(var b=S.s.r;b<=S.e.r;++b){g=cr(b);for(var _=S.s.c;_<=S.e.c;++_){b===S.s.r&&(y[_]=Jt(_)),x=y[_]+g;var T=m?(l[b]||[])[_]:l[x];T&&(rM(n,T,b,_,t),h&&T.l&&l["!links"].push([x,T.l]))}}var N=f.CodeName||f.name||s;return h&&Ie(n,574,z5((o.Views||[])[0])),h&&(l["!merges"]||[]).length&&Ie(n,229,v8(l["!merges"])),h&&eM(n,l),Ie(n,442,tb(N)),h&&Q7(n,l),Ie(n,10),n.end()}function nM(e,t,r){var n=ya(),s=(e||{}).Workbook||{},l=s.Sheets||[],o=s.WBProps||{},f=r.biff==8,m=r.biff==5;if(Ie(n,2057,Qm(e,5,r)),r.bookType=="xla"&&Ie(n,135),Ie(n,225,f?Ka(1200):null),Ie(n,193,i5(2)),m&&Ie(n,191),m&&Ie(n,192),Ie(n,226),Ie(n,92,A5("SheetJS",r)),Ie(n,66,Ka(f?1200:1252)),f&&Ie(n,353,Ka(0)),f&&Ie(n,448),Ie(n,317,M8(e.SheetNames.length)),f&&e.vbaraw&&Ie(n,211),f&&e.vbaraw){var h=o.CodeName||"ThisWorkbook";Ie(n,442,tb(h))}Ie(n,156,Ka(17)),Ie(n,25,sa(!1)),Ie(n,18,sa(!1)),Ie(n,19,Ka(0)),f&&Ie(n,431,sa(!1)),f&&Ie(n,444,Ka(0)),Ie(n,61,I5()),Ie(n,64,sa(!1)),Ie(n,141,Ka(0)),Ie(n,34,sa(BO(e)=="true")),Ie(n,14,sa(!0)),f&&Ie(n,439,sa(!1)),Ie(n,218,Ka(0)),K7(n,e,r),Z7(n,e.SSF,r),J7(n,r),f&&Ie(n,352,sa(!1));var x=n.end(),g=ya();f&&Ie(g,140,A8()),f&&r.Strings&&G7(g,252,D5(r.Strings)),Ie(g,10);var y=g.end(),S=ya(),w=0,b=0;for(b=0;b<e.SheetNames.length;++b)w+=(f?12:11)+(f?2:1)*e.SheetNames[b].length;var _=x.length+w+y.length;for(b=0;b<e.SheetNames.length;++b){var T=l[b]||{};Ie(S,133,F5({pos:_,hs:T.Hidden||0,dt:0,name:e.SheetNames[b]},r)),_+=t[b].length}var N=S.end();if(w!=N.length)throw new Error("BS8 "+w+" != "+N.length);var E=[];return x.length&&E.push(x),N.length&&E.push(N),y.length&&E.push(y),Fr(E)}function sM(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Yt(Ze)),e&&e.SSF&&(Ul(),Fo(e.SSF),r.revssf=Wu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,dx(r),r.cellXfs=[],qs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=aM(s,r,e);return n.unshift(nM(e,n,r)),Fr(n)}function qb(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=la(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return sM(e,t);case 4:case 3:case 2:return W7(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function Iy(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=s.index,f=l&&l.index||e.length,m=G6(e.slice(o,f),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,x=0,g=0,y=0,S={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<m.length;++o){var b=m[o].trim(),_=b.slice(0,3).toLowerCase();if(_=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}x=0;continue}if(!(_!="<td"&&_!="<th")){var T=b.split(/<\/t[dh]>/i);for(f=0;f<T.length;++f){var N=T[f].trim();if(N.match(/<t[dh]/i)){for(var E=N,j=0;E.charAt(0)=="<"&&(j=E.indexOf(">"))>-1;)E=E.slice(j+1);for(var F=0;F<w.length;++F){var R=w[F];R.s.c==x&&R.s.r<h&&h<=R.e.r&&(x=R.e.c+1,F=-1)}var A=it(N.slice(0,N.indexOf(">")));y=A.colspan?+A.colspan:1,((g=+A.rowspan)>1||y>1)&&w.push({s:{r:h,c:x},e:{r:h+(g||1)-1,c:x+y-1}});var P=A.t||A["data-t"]||"";if(!E.length){x+=y;continue}if(E=_w(E),S.s.r>h&&(S.s.r=h),S.e.r<h&&(S.e.r=h),S.s.c>x&&(S.s.c=x),S.e.c<x&&(S.e.c=x),!E.length){x+=y;continue}var U={t:"s",v:E};r.raw||!E.trim().length||P=="s"||(E==="TRUE"?U={t:"b",v:!0}:E==="FALSE"?U={t:"b",v:!1}:isNaN(un(E))?isNaN(Al(E).getDate())||(U={t:"d",v:er(E)},r.cellDates||(U={t:"n",v:Sr(U.v)}),U.z=r.dateNF||Ze[14]):U={t:"n",v:un(E)}),r.dense?(n[h]||(n[h]=[]),n[h][x]=U):n[rt({r:h,c:x})]=U,x+=y}}}}return n["!ref"]=dt(S),w.length&&(n["!merges"]=w),n}function Wb(e,t,r,n){for(var s=e["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var f=0,m=0,h=0;h<s.length;++h)if(!(s[h].s.r>r||s[h].s.c>o)&&!(s[h].e.r<r||s[h].e.c<o)){if(s[h].s.r<r||s[h].s.c<o){f=-1;break}f=s[h].e.r-s[h].s.r+1,m=s[h].e.c-s[h].s.c+1;break}if(!(f<0)){var x=rt({r,c:o}),g=n.dense?(e[r]||[])[o]:e[x],y=g&&g.v!=null&&(g.h||Mm(g.w||(Fn(g),g.w)||""))||"",S={};f>1&&(S.rowspan=f),m>1&&(S.colspan=m),n.editable?y='<span contenteditable="true">'+y+"</span>":g&&(S["data-t"]=g&&g.t||"z",g.v!=null&&(S["data-v"]=g.v),g.z!=null&&(S["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+g.l.Target+'">'+y+"</a>")),S.id=(n.id||"sjs")+"-"+x,l.push(Ue("td",y,S))}}var w="<tr>";return w+l.join("")+"</tr>"}var Kb='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Zb="</body></html>";function iM(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ys(Iy(r[0],t),t);var n=gx();return r.forEach(function(s,l){vx(n,Iy(s,t),"Sheet"+(l+1))}),n}function Qb(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Jb(e,t){var r=t||{},n=r.header!=null?r.header:Kb,s=r.footer!=null?r.footer:Zb,l=[n],o=la(e["!ref"]);r.dense=Array.isArray(e),l.push(Qb(e,o,r));for(var f=o.s.r;f<=o.e.r;++f)l.push(Wb(e,o,f,r));return l.push("</table>"+s),l.join("")}function e_(e,t,r){var n=r||{},s=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?nr(n.origin):n.origin;s=o.r,l=o.c}var f=t.getElementsByTagName("tr"),m=Math.min(n.sheetRows||1e7,f.length),h={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var x=la(e["!ref"]);h.s.r=Math.min(h.s.r,x.s.r),h.s.c=Math.min(h.s.c,x.s.c),h.e.r=Math.max(h.e.r,x.e.r),h.e.c=Math.max(h.e.c,x.e.c),s==-1&&(h.e.r=s=x.e.r+1)}var g=[],y=0,S=e["!rows"]||(e["!rows"]=[]),w=0,b=0,_=0,T=0,N=0,E=0;for(e["!cols"]||(e["!cols"]=[]);w<f.length&&b<m;++w){var j=f[w];if(Py(j)){if(n.display)continue;S[b]={hidden:!0}}var F=j.children;for(_=T=0;_<F.length;++_){var R=F[_];if(!(n.display&&Py(R))){var A=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):_w(R.innerHTML),P=R.getAttribute("data-z")||R.getAttribute("z");for(y=0;y<g.length;++y){var U=g[y];U.s.c==T+l&&U.s.r<b+s&&b+s<=U.e.r&&(T=U.e.c+1-l,y=-1)}E=+R.getAttribute("colspan")||1,((N=+R.getAttribute("rowspan")||1)>1||E>1)&&g.push({s:{r:b+s,c:T+l},e:{r:b+s+(N||1)-1,c:T+l+(E||1)-1}});var ee={t:"s",v:A},W=R.getAttribute("data-t")||R.getAttribute("t")||"";A!=null&&(A.length==0?ee.t=W||"z":n.raw||A.trim().length==0||W=="s"||(A==="TRUE"?ee={t:"b",v:!0}:A==="FALSE"?ee={t:"b",v:!1}:isNaN(un(A))?isNaN(Al(A).getDate())||(ee={t:"d",v:er(A)},n.cellDates||(ee={t:"n",v:Sr(ee.v)}),ee.z=n.dateNF||Ze[14]):ee={t:"n",v:un(A)})),ee.z===void 0&&P!=null&&(ee.z=P);var J="",xe=R.getElementsByTagName("A");if(xe&&xe.length)for(var pe=0;pe<xe.length&&!(xe[pe].hasAttribute("href")&&(J=xe[pe].getAttribute("href"),J.charAt(0)!="#"));++pe);J&&J.charAt(0)!="#"&&(ee.l={Target:J}),n.dense?(e[b+s]||(e[b+s]=[]),e[b+s][T+l]=ee):e[rt({c:T+l,r:b+s})]=ee,h.e.c<T+l&&(h.e.c=T+l),T+=E}}++b}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),h.e.r=Math.max(h.e.r,b-1+s),e["!ref"]=dt(h),b>=m&&(e["!fullref"]=dt((h.e.r=f.length-w+b-1+s,h))),e}function t_(e,t){var r=t||{},n=r.dense?[]:{};return e_(n,e,t)}function lM(e,t){return Ys(t_(e,t),t)}function Py(e){var t="",r=cM(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function cM(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function oM(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Tt(t.replace(/<[^>]*>/g,""));return[r]}var zy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function r_(e,t){var r=t||{},n=Lm(e),s=[],l,o,f={name:""},m="",h=0,x,g,y={},S=[],w=r.dense?[]:{},b,_,T={value:""},N="",E=0,j=[],F=-1,R=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,U={},ee=[],W={},J=0,xe=0,pe=[],we=1,Q=1,ie=[],Ae={Names:[]},re={},z=["",""],te=[],D={},V="",M=0,B=!1,K=!1,oe=0;for(mo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=mo.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?w["!ref"]=dt(A):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(w["!fullref"]=w["!ref"],A.e.r=r.sheetRows-1,w["!ref"]=dt(A)),ee.length&&(w["!merges"]=ee),pe.length&&(w["!rows"]=pe),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),S.push(x.name),y[x.name]=w,K=!1):b[0].charAt(b[0].length-2)!=="/"&&(x=it(b[0],!1),F=R=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,w=r.dense?[]:{},ee=[],pe=[],K=!0);break;case"table-row-group":b[1]==="/"?--P:++P;break;case"table-row":case"":if(b[1]==="/"){F+=we,we=1;break}if(g=it(b[0],!1),g.?F=g.-1:F==-1&&(F=0),we=+g["number-rows-repeated"]||1,we<10)for(oe=0;oe<we;++oe)P>0&&(pe[F+oe]={level:P});R=-1;break;case"covered-table-cell":b[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(w[F]||(w[F]=[]),w[F][R]={t:"z"}):w[rt({r:F,c:R})]={t:"z"}),N="",j=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++R,T=it(b[0],!1),Q=parseInt(T["number-columns-repeated"]||"1",10),_={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(_.f=Ly(Tt(T.formula))),(T.||T["value-type"])=="string"&&(_.t="s",_.v=Tt(T["string-value"]||""),r.dense?(w[F]||(w[F]=[]),w[F][R]=_):w[rt({r:F,c:R})]=_),R+=Q-1;else if(b[1]!=="/"){++R,N="",E=0,j=[],Q=1;var ye=we?F+we-1:F;if(R>A.e.c&&(A.e.c=R),R<A.s.c&&(A.s.c=R),F<A.s.r&&(A.s.r=F),ye>A.e.r&&(A.e.r=ye),T=it(b[0],!1),te=[],D={},_={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=Tt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(J=parseInt(T["number-matrix-rows-spanned"],10)||0,xe=parseInt(T["number-matrix-columns-spanned"],10)||0,W={s:{r:F,c:R},e:{r:F+J-1,c:R+xe-1}},_.F=dt(W),ie.push([W,_.F])),T.formula)_.f=Ly(T.formula);else for(oe=0;oe<ie.length;++oe)F>=ie[oe][0].s.r&&F<=ie[oe][0].e.r&&R>=ie[oe][0].s.c&&R<=ie[oe][0].e.c&&(_.F=ie[oe][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(J=parseInt(T["number-rows-spanned"],10)||0,xe=parseInt(T["number-columns-spanned"],10)||0,W={s:{r:F,c:R},e:{r:F+J-1,c:R+xe-1}},ee.push(W)),T["number-columns-repeated"]&&(Q=parseInt(T["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Qt(T["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(T.value);break;case"percentage":_.t="n",_.v=parseFloat(T.value);break;case"currency":_.t="n",_.v=parseFloat(T.value);break;case"date":_.t="d",_.v=er(T["date-value"]),r.cellDates||(_.t="n",_.v=Sr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=z6(T["time-value"])/86400,r.cellDates&&(_.t="d",_.v=Ku(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(T.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",T["string-value"]!=null&&(N=Tt(T["string-value"]),j=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(B=!1,_.t==="s"&&(_.v=N||"",j.length&&(_.R=j),B=E==0),re.Target&&(_.l=re),te.length>0&&(_.c=te,te=[]),N&&r.cellText!==!1&&(_.w=N),B&&(_.t="z",delete _.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=F))for(var _e=0;_e<we;++_e){if(Q=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(w[F+_e]||(w[F+_e]=[]),w[F+_e][R]=_e==0?_:Yt(_);--Q>0;)w[F+_e][R+Q]=Yt(_);else for(w[rt({r:F+_e,c:R})]=_;--Q>0;)w[rt({r:F+_e,c:R+Q})]=Yt(_);A.e.c<=R&&(A.e.c=R)}Q=parseInt(T["number-columns-repeated"]||"1",10),R+=Q-1,Q=0,_={},N="",j=[]}re={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((l=s.pop())[0]!==b[3])throw"Bad state: "+l}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((l=s.pop())[0]!==b[3])throw"Bad state: "+l;D.t=N,j.length&&(D.R=j),D.a=V,te.push(D)}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!1]);V="",M=0,N="",E=0,j=[];break;case"creator":b[1]==="/"?V=n.slice(M,b.index):M=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((l=s.pop())[0]!==b[3])throw"Bad state: "+l}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!1]);N="",E=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(U[f.name]=m,(l=s.pop())[0]!==b[3])throw"Bad state: "+l}else b[0].charAt(b[0].length-2)!=="/"&&(m="",f=it(b[0],!1),s.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=it(b[0],!1),m+=zy[b[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=it(b[0],!1),m+=zy[b[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":m+=n.slice(h,b.index);break}else h=b.index+b[0].length;break;case"named-range":o=it(b[0],!1),z=Fh(o["cell-range-address"]);var ae={Name:o.name,Ref:z[0]+"!"+z[1]};K&&(ae.Sheet=S.length),Ae.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(b[1]==="/"&&(!T||!T["string-value"])){var He=oM(n.slice(E,b.index));N=(N.length>0?N+`
`:"")+He[0]}else it(b[0],!1),E=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{z=Fh(it(b[0])["target-range-address"]),y[z[0]]["!autofilter"]={ref:z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(re=it(b[0],!1),!re.href)break;re.Target=Tt(re.href),delete re.href,re.Target.charAt(0)=="#"&&re.Target.indexOf(".")>-1?(z=Fh(re.Target.slice(1)),re.Target="#"+z[0]+"!"+z[1]):re.Target.match(/^\.\.[\\\/]/)&&(re.Target=re.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(b)}}var Y={Sheets:y,SheetNames:S,Workbook:Ae};return r.bookSheets&&delete Y.Sheets,Y}function Hy(e,t){t=t||{},Wa(e,"META-INF/manifest.xml")&&zA(vr(e,"META-INF/manifest.xml"),t);var r=ja(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=r_(Gt(r),t);return Wa(e,"meta.xml")&&(n.Props=Hw(vr(e,"meta.xml"))),n}function Vy(e,t){return r_(e,t)}var uM=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ho({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return mr+t}}(),Gy=function(){var e=function(l){return Ut(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(l,o,f){var m=[];m.push('      <table:table table:name="'+Ut(o.SheetNames[f])+`" table:style-name="ta1">
`);var h=0,x=0,g=la(l["!ref"]||"A1"),y=l["!merges"]||[],S=0,w=Array.isArray(l);if(l["!cols"])for(x=0;x<=g.e.c;++x)m.push("        <table:table-column"+(l["!cols"][x]?' table:style-name="co'+l["!cols"][x].ods+'"':"")+`></table:table-column>
`);var b="",_=l["!rows"]||[];for(h=0;h<g.s.r;++h)b=_[h]?' table:style-name="ro'+_[h].ods+'"':"",m.push("        <table:table-row"+b+`></table:table-row>
`);for(;h<=g.e.r;++h){for(b=_[h]?' table:style-name="ro'+_[h].ods+'"':"",m.push("        <table:table-row"+b+`>
`),x=0;x<g.s.c;++x)m.push(t);for(;x<=g.e.c;++x){var T=!1,N={},E="";for(S=0;S!=y.length;++S)if(!(y[S].s.c>x)&&!(y[S].s.r>h)&&!(y[S].e.c<x)&&!(y[S].e.r<h)){(y[S].s.c!=x||y[S].s.r!=h)&&(T=!0),N["table:number-columns-spanned"]=y[S].e.c-y[S].s.c+1,N["table:number-rows-spanned"]=y[S].e.r-y[S].s.r+1;break}if(T){m.push(r);continue}var j=rt({r:h,c:x}),F=w?(l[h]||[])[x]:l[j];if(F&&F.f&&(N["table:formula"]=Ut(MR(F.f)),F.F&&F.F.slice(0,j.length)==j)){var R=la(F.F);N["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,N["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!F){m.push(t);continue}switch(F.t){case"b":E=F.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=F.v?"true":"false";break;case"n":E=F.w||String(F.v||0),N["office:value-type"]="float",N["office:value"]=F.v||0;break;case"s":case"str":E=F.v==null?"":F.v,N["office:value-type"]="string";break;case"d":E=F.w||er(F.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=er(F.v).toISOString(),N["table:style-name"]="ce1";break;default:m.push(t);continue}var A=e(E);if(F.l&&F.l.Target){var P=F.l.Target;P=P.charAt(0)=="#"?"#"+LR(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),A=Ue("text:a",A,{"xlink:href":P.replace(/&/g,"&amp;")})}m.push("          "+Ue("table:table-cell",Ue("text:p",A,{}),N)+`
`)}m.push(`        </table:table-row>
`)}return m.push(`      </table:table>
`),m.join("")},s=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var f=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var x=0;x<h["!cols"].length;++x)if(h["!cols"][x]){var g=h["!cols"][x];if(g.width==null&&g.wpx==null&&g.wch==null)continue;zs(g),g.ods=f;var y=h["!cols"][x].wpx+"px";l.push('  <style:style style:name="co'+f+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),l.push(`  </style:style>
`),++f}}});var m=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var x=0;x<h["!rows"].length;++x)if(h["!rows"][x]){h["!rows"][x].ods=m;var g=h["!rows"][x].hpx+"px";l.push('  <style:style style:name="ro'+m+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),l.push(`  </style:style>
`),++m}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,f){var m=[mr],h=ho({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=ho({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});f.bookType=="fods"?(m.push("<office:document"+h+x+`>
`),m.push(zw().replace(/office:document-meta/g,"office:meta"))):m.push("<office:document-content"+h+`>
`),s(m,o),m.push(`  <office:body>
`),m.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)m.push(n(o.Sheets[o.SheetNames[g]],o,g));return m.push(`    </office:spreadsheet>
`),m.push(`  </office:body>
`),f.bookType=="fods"?m.push("</office:document>"):m.push("</office:document-content>"),m.join("")}}();function a_(e,t){if(t.bookType=="fods")return Gy(e,t);var r=Rm(),n="",s=[],l=[];return n="mimetype",mt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",mt(r,n,Gy(e,t)),s.push([n,"text/xml"]),l.push([n,"ContentFile"]),n="styles.xml",mt(r,n,uM(e,t)),s.push([n,"text/xml"]),l.push([n,"StylesFile"]),n="meta.xml",mt(r,n,mr+zw()),s.push([n,"text/xml"]),l.push([n,"MetadataFile"]),n="manifest.rdf",mt(r,n,GA(l)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",mt(r,n,HA(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ai(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function om(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Gt($s(e))}function fM(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ca(An(e))}function dM(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Vs(e){var t=e.reduce(function(s,l){return s+l.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Xy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function hM(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function mM(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var l=0;s>=1;++l,s/=256)e[t+l]=s&255;e[t+15]|=r>=0?0:128}function bo(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Lt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function or(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ct(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=bo(e,r),l=s&7;s=Math.floor(s/8);var o=0,f;if(s==0)break;switch(l){case 0:{for(var m=r[0];e[r[0]++]>=128;);f=e.slice(m,r[0])}break;case 5:o=4,f=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,f=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=bo(e,r),f=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(n))}var h={data:f,type:l};t[s]==null?t[s]=[h]:t[s].push(h)}return t}function Br(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Lt(n*8+s.type)),s.type==2&&t.push(Lt(s.data.length)),t.push(s.data))})}),Vs(t)}function ux(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Ya(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=bo(e,n),l=Ct(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:or(l[1][0].data),messages:[]};l[2].forEach(function(f){var m=Ct(f.data),h=or(m[3][0].data);o.messages.push({meta:m,data:e.slice(n[0],n[0]+h)}),n[0]+=h}),(t=l[3])!=null&&t[0]&&(o.merge=or(l[3][0].data)>>>0>0),r.push(o)}return r}function vl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Lt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Lt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Lt(o.data.length)}],n[2].push({data:Br(o.meta),type:2})});var l=Br(n);t.push(Lt(l.length)),t.push(l),s.forEach(function(o){return t.push(o)})}),Vs(t)}function xM(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=bo(t,r),s=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var f=o-59;o=t[r[0]],f>1&&(o|=t[r[0]+1]<<8),f>2&&(o|=t[r[0]+2]<<16),f>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=f}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var m=0,h=0;if(l==1?(h=(t[r[0]]>>2&7)+4,m=(t[r[0]++]&224)<<3,m|=t[r[0]++]):(h=(t[r[0]++]>>2)+1,l==2?(m=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(m=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Vs(s)],m==0)throw new Error("Invalid offset 0");if(m>s[0].length)throw new Error("Invalid offset beyond length");if(h>=m)for(s.push(s[0].slice(-m)),h-=m;h>=s[s.length-1].length;)s.push(s[s.length-1]),h-=s[s.length-1].length;s.push(s[0].slice(-m,-m+h))}}var x=Vs(s);if(x.length!=n)throw new Error("Unexpected length: ".concat(x.length," != ").concat(n));return x}function qa(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(xM(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Vs(t)}function yl(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var l=Lt(n),o=l.length;t.push(l),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return Vs(t)}function pM(e,t,r,n){var s=Ai(e),l=s.getUint32(4,!0),o=(n>1?12:8)+Xy(l&(n>1?3470:398))*4,f=-1,m=-1,h=NaN,x=new Date(2001,0,1);l&512&&(f=s.getUint32(o,!0),o+=4),o+=Xy(l&(n>1?12288:4096))*4,l&16&&(m=s.getUint32(o,!0),o+=4),l&32&&(h=s.getFloat64(o,!0),o+=8),l&64&&(x.setTime(x.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var g;switch(e[2]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:t[m]};break;case 5:g={t:"d",v:x};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(f>-1)g={t:"s",v:r[f]};else if(m>-1)g={t:"s",v:t[m]};else if(!isNaN(h))g={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return g}function gM(e,t,r){var n=Ai(e),s=n.getUint32(8,!0),l=12,o=-1,f=-1,m=NaN,h=NaN,x=new Date(2001,0,1);s&1&&(m=hM(e,l),l+=16),s&2&&(h=n.getFloat64(l,!0),l+=8),s&4&&(x.setTime(x.getTime()+n.getFloat64(l,!0)*1e3),l+=8),s&8&&(f=n.getUint32(l,!0),l+=4),s&16&&(o=n.getUint32(l,!0),l+=4);var g;switch(e[1]){case 0:break;case 2:g={t:"n",v:m};break;case 3:g={t:"s",v:t[f]};break;case 5:g={t:"d",v:x};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:g={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return g}function Dh(e,t){var r=new Uint8Array(32),n=Ai(r),s=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,mM(r,s,e.v),l|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,l,!0),r.slice(0,s)}function Oh(e,t){var r=new Uint8Array(32),n=Ai(r),s=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,l,!0),r.slice(0,s)}function vM(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return pM(e,t,r,e[0]);case 5:return gM(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Yr(e){var t=Ct(e);return bo(t[1][0].data)}function $y(e,t){var r=Ct(t.data),n=or(r[1][0].data),s=r[3],l=[];return(s||[]).forEach(function(o){var f=Ct(o.data),m=or(f[1][0].data)>>>0;switch(n){case 1:l[m]=om(f[3][0].data);break;case 8:{var h=e[Yr(f[9][0].data)][0],x=Ct(h.data),g=e[Yr(x[1][0].data)][0],y=or(g.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var S=Ct(g.data);l[m]=S[3].map(function(w){return om(w.data)}).join("")}break}}),l}function yM(e,t){var r,n,s,l,o,f,m,h,x,g,y,S,w,b,_=Ct(e),T=or(_[1][0].data)>>>0,N=or(_[2][0].data)>>>0,E=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&or(_[8][0].data)>0||!1,j,F;if((l=(s=_[7])==null?void 0:s[0])!=null&&l.data&&t!=0)j=(f=(o=_[7])==null?void 0:o[0])==null?void 0:f.data,F=(h=(m=_[6])==null?void 0:m[0])==null?void 0:h.data;else if((g=(x=_[4])==null?void 0:x[0])!=null&&g.data&&t!=1)j=(S=(y=_[4])==null?void 0:y[0])==null?void 0:S.data,F=(b=(w=_[3])==null?void 0:w[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=E?4:1,A=Ai(j),P=[],U=0;U<j.length/2;++U){var ee=A.getUint16(U*2,!0);ee<65535&&P.push([U,ee])}if(P.length!=N)throw"Expected ".concat(N," cells, found ").concat(P.length);var W=[];for(U=0;U<P.length-1;++U)W[P[U][0]]=F.subarray(P[U][1]*R,P[U+1][1]*R);return P.length>=1&&(W[P[P.length-1][0]]=F.subarray(P[P.length-1][1]*R)),{R:T,cells:W}}function wM(e,t){var r,n=Ct(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?or(n[7][0].data)>>>0>0?1:0:-1,l=ux(n[5],function(o){return yM(o,s)});return{nrows:or(n[4][0].data)>>>0,data:l.reduce(function(o,f){return o[f.R]||(o[f.R]=[]),f.cells.forEach(function(m,h){if(o[f.R][h])throw new Error("Duplicate cell r=".concat(f.R," c=").concat(h));o[f.R][h]=m}),o},[])}}function bM(e,t,r){var n,s=Ct(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(or(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(or(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=dt(l);var o=Ct(s[4][0].data),f=$y(e,e[Yr(o[4][0].data)][0]),m=(n=o[17])!=null&&n[0]?$y(e,e[Yr(o[17][0].data)][0]):[],h=Ct(o[3][0].data),x=0;h[1].forEach(function(g){var y=Ct(g.data),S=e[Yr(y[2][0].data)][0],w=or(S.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var b=wM(e,S);b.data.forEach(function(_,T){_.forEach(function(N,E){var j=rt({r:x+T,c:E}),F=vM(N,f,m);F&&(r[j]=F)})}),x+=b.nrows})}function _M(e,t){var r=Ct(t.data),n={"!ref":"A1"},s=e[Yr(r[2][0].data)],l=or(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return bM(e,s[0],n),n}function SM(e,t){var r,n=Ct(t.data),s={name:(r=n[1])!=null&&r[0]?om(n[1][0].data):"",sheets:[]},l=ux(n[2],Yr);return l.forEach(function(o){e[o].forEach(function(f){var m=or(f.meta[1][0].data);m==6e3&&s.sheets.push(_M(e,f))})}),s}function NM(e,t){var r=gx(),n=Ct(t.data),s=ux(n[1],Yr);if(s.forEach(function(l){e[l].forEach(function(o){var f=or(o.meta[1][0].data);if(f==2){var m=SM(e,o);m.sheets.forEach(function(h,x){vx(r,h,x==0?m.name:m.name+"_"+x,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Mh(e){var t,r,n,s,l={},o=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var h;try{h=qa(m.content)}catch(g){return console.log("?? "+m.content.length+" "+(g.message||g))}var x;try{x=Ya(h)}catch(g){return console.log("## "+(g.message||g))}x.forEach(function(g){l[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var f=((s=(n=(r=(t=l==null?void 0:l[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&or(l[1][0].meta[1][0].data)==1&&l[1][0];if(f||o.forEach(function(m){l[m].forEach(function(h){var x=or(h.meta[1][0].data)>>>0;if(x==1)if(!f)f=h;else throw new Error("Document has multiple roots")})}),!f)throw new Error("Cannot find Document root");return NM(l,f)}function EM(e,t,r){var n,s,l,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var f=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&or(e[8][0].data)>0||!1;if(f)throw"Math only works with normal offsets";for(var m=0,h=Ai(e[7][0].data),x=0,g=[],y=Ai(e[4][0].data),S=0,w=[],b=0;b<t.length;++b){if(t[b]==null){h.setUint16(b*2,65535,!0),y.setUint16(b*2,65535);continue}h.setUint16(b*2,x,!0),y.setUint16(b*2,S,!0);var _,T;switch(typeof t[b]){case"string":_=Dh({t:"s",v:t[b]},r),T=Oh({t:"s",v:t[b]},r);break;case"number":_=Dh({t:"n",v:t[b]},r),T=Oh({t:"n",v:t[b]},r);break;case"boolean":_=Dh({t:"b",v:t[b]},r),T=Oh({t:"b",v:t[b]},r);break;default:throw new Error("Unsupported value "+t[b])}g.push(_),x+=_.length,w.push(T),S+=T.length,++m}for(e[2][0].data=Lt(m);b<e[7][0].data.length/2;++b)h.setUint16(b*2,65535,!0),y.setUint16(b*2,65535,!0);return e[6][0].data=Vs(g),e[3][0].data=Vs(w),m}function TM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=la(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(dt(n)));var l=Du(r,{range:n,header:1}),o=["~Sh33tJ5~"];l.forEach(function(V){return V.forEach(function(M){typeof M=="string"&&o.push(M)})});var f={},m=[],h=We.read(t.numbers,{type:"base64"});h.FileIndex.map(function(V,M){return[V,h.FullPaths[M]]}).forEach(function(V){var M=V[0],B=V[1];if(M.type==2&&M.name.match(/\.iwa/)){var K=M.content,oe=qa(K),ye=Ya(oe);ye.forEach(function(_e){m.push(_e.id),f[_e.id]={deps:[],location:B,type:or(_e.messages[0].meta[1][0].data)}})}}),m.sort(function(V,M){return V-M});var x=m.filter(function(V){return V>1}).map(function(V){return[V,Lt(V)]});h.FileIndex.map(function(V,M){return[V,h.FullPaths[M]]}).forEach(function(V){var M=V[0];if(V[1],!!M.name.match(/\.iwa/)){var B=Ya(qa(M.content));B.forEach(function(K){K.messages.forEach(function(oe){x.forEach(function(ye){K.messages.some(function(_e){return or(_e.meta[1][0].data)!=11006&&dM(_e.data,ye[1])})&&f[ye[0]].deps.push(K.id)})})})}});for(var g=We.find(h,f[1].location),y=Ya(qa(g.content)),S,w=0;w<y.length;++w){var b=y[w];b.id==1&&(S=b)}var _=Yr(Ct(S.messages[0].data)[1][0].data);for(g=We.find(h,f[_].location),y=Ya(qa(g.content)),w=0;w<y.length;++w)b=y[w],b.id==_&&(S=b);for(_=Yr(Ct(S.messages[0].data)[2][0].data),g=We.find(h,f[_].location),y=Ya(qa(g.content)),w=0;w<y.length;++w)b=y[w],b.id==_&&(S=b);for(_=Yr(Ct(S.messages[0].data)[2][0].data),g=We.find(h,f[_].location),y=Ya(qa(g.content)),w=0;w<y.length;++w)b=y[w],b.id==_&&(S=b);var T=Ct(S.messages[0].data);{T[6][0].data=Lt(n.e.r+1),T[7][0].data=Lt(n.e.c+1);var N=Yr(T[46][0].data),E=We.find(h,f[N].location),j=Ya(qa(E.content));{for(var F=0;F<j.length&&j[F].id!=N;++F);if(j[F].id!=N)throw"Bad ColumnRowUIDMapArchive";var R=Ct(j[F].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var A=0;A<=n.e.c;++A){var P=[];P[1]=P[2]=[{type:0,data:Lt(A+420690)}],R[1].push({type:2,data:Br(P)}),R[2].push({type:0,data:Lt(A)}),R[3].push({type:0,data:Lt(A)})}R[4]=[],R[5]=[],R[6]=[];for(var U=0;U<=n.e.r;++U)P=[],P[1]=P[2]=[{type:0,data:Lt(U+726270)}],R[4].push({type:2,data:Br(P)}),R[5].push({type:0,data:Lt(U)}),R[6].push({type:0,data:Lt(U)});j[F].messages[0].data=Br(R)}E.content=yl(vl(j)),E.size=E.content.length,delete T[46];var ee=Ct(T[4][0].data);{ee[7][0].data=Lt(n.e.r+1);var W=Ct(ee[1][0].data),J=Yr(W[2][0].data);E=We.find(h,f[J].location),j=Ya(qa(E.content));{if(j[0].id!=J)throw"Bad HeaderStorageBucket";var xe=Ct(j[0].messages[0].data);for(U=0;U<l.length;++U){var pe=Ct(xe[2][0].data);pe[1][0].data=Lt(U),pe[4][0].data=Lt(l[U].length),xe[2][U]={type:xe[2][0].type,data:Br(pe)}}j[0].messages[0].data=Br(xe)}E.content=yl(vl(j)),E.size=E.content.length;var we=Yr(ee[2][0].data);E=We.find(h,f[we].location),j=Ya(qa(E.content));{if(j[0].id!=we)throw"Bad HeaderStorageBucket";for(xe=Ct(j[0].messages[0].data),A=0;A<=n.e.c;++A)pe=Ct(xe[2][0].data),pe[1][0].data=Lt(A),pe[4][0].data=Lt(n.e.r+1),xe[2][A]={type:xe[2][0].type,data:Br(pe)};j[0].messages[0].data=Br(xe)}E.content=yl(vl(j)),E.size=E.content.length;var Q=Yr(ee[4][0].data);(function(){for(var V=We.find(h,f[Q].location),M=Ya(qa(V.content)),B,K=0;K<M.length;++K){var oe=M[K];oe.id==Q&&(B=oe)}var ye=Ct(B.messages[0].data);{ye[3]=[];var _e=[];o.forEach(function(Y,ct){_e[1]=[{type:0,data:Lt(ct)}],_e[2]=[{type:0,data:Lt(1)}],_e[3]=[{type:2,data:fM(Y)}],ye[3].push({type:2,data:Br(_e)})})}B.messages[0].data=Br(ye);var ae=vl(M),He=yl(ae);V.content=He,V.size=V.content.length})();var ie=Ct(ee[3][0].data);{var Ae=ie[1][0];delete ie[2];var re=Ct(Ae.data);{var z=Yr(re[2][0].data);(function(){for(var V=We.find(h,f[z].location),M=Ya(qa(V.content)),B,K=0;K<M.length;++K){var oe=M[K];oe.id==z&&(B=oe)}var ye=Ct(B.messages[0].data);{delete ye[6],delete ie[7];var _e=new Uint8Array(ye[5][0].data);ye[5]=[];for(var ae=0,He=0;He<=n.e.r;++He){var Y=Ct(_e);ae+=EM(Y,l[He],o),Y[1][0].data=Lt(He),ye[5].push({data:Br(Y),type:2})}ye[1]=[{type:0,data:Lt(n.e.c+1)}],ye[2]=[{type:0,data:Lt(n.e.r+1)}],ye[3]=[{type:0,data:Lt(ae)}],ye[4]=[{type:0,data:Lt(n.e.r+1)}]}B.messages[0].data=Br(ye);var ct=vl(M),$e=yl(ct);V.content=$e,V.size=V.content.length})()}Ae.data=Br(re)}ee[3][0].data=Br(ie)}T[4][0].data=Br(ee)}S.messages[0].data=Br(T);var te=vl(y),D=yl(te);return g.content=D,g.size=g.content.length,h}function n_(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function fx(e){n_([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function dx(e){n_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function kM(e){return wt.WS.indexOf(e)>-1?"sheet":e==wt.CS?"chart":e==wt.DS?"dialog":e==wt.MS?"macro":e&&e.length?e:"sheet"}function AM(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,kM(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function CM(e,t,r,n,s,l,o,f,m,h,x,g){try{l[n]=Jc(ja(e,r,!0),t);var y=vr(e,t),S;switch(f){case"sheet":S=t7(y,t,s,m,l[n],h,x,g);break;case"chart":if(S=r7(y,t,s,m,l[n],h,x,g),!S||!S["!drawel"])break;var w=qc(S["!drawel"].Target,t),b=xo(w),_=Vj(ja(e,w,!0),Jc(ja(e,b,!0),w)),T=qc(_,w),N=xo(T);S=jO(ja(e,T,!0),T,m,Jc(ja(e,N,!0),T),h,S);break;case"macro":S=a7(y,t,s,m,l[n],h,x,g);break;case"dialog":S=n7(y,t,s,m,l[n],h,x,g);break;default:throw new Error("Unrecognized sheet type "+f)}o[n]=S;var E=[];l&&l[n]&&ur(l[n]).forEach(function(j){var F="";if(l[n][j].Type==wt.CMNT){F=qc(l[n][j].Target,t);var R=c7(vr(e,F,!0),F,m);if(!R||!R.length)return;Fy(S,R,!1)}l[n][j].Type==wt.TCMNT&&(F=qc(l[n][j].Target,t),E=E.concat(Xj(vr(e,F,!0),m)))}),E&&E.length&&Fy(S,E,!0,m.people||[])}catch(j){if(m.WTF)throw j}}function Xa(e){return e.charAt(0)=="/"?e.slice(1):e}function s_(e,t){if(Ul(),t=t||{},fx(t),Wa(e,"META-INF/manifest.xml")||Wa(e,"objectdata.xml"))return Hy(e,t);if(Wa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Mh<"u"){if(e.FileIndex)return Mh(e);var r=We.utils.cfb_new();return Qv(e).forEach(function(pe){mt(r,pe,$6(e,pe))}),Mh(r)}throw new Error("Unsupported NUMBERS file")}if(!Wa(e,"[Content_Types].xml"))throw Wa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Wa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Qv(e),s=IA(ja(e,"[Content_Types].xml")),l=!1,o,f;if(s.workbooks.length===0&&(f="xl/workbook.xml",vr(e,f,!0)&&s.workbooks.push(f)),s.workbooks.length===0){if(f="xl/workbook.bin",!vr(e,f,!0))throw new Error("Could not find workbook");s.workbooks.push(f),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var m={},h={};if(!t.bookSheets&&!t.bookProps){if(eo=[],s.sst)try{eo=l7(vr(e,Xa(s.sst)),s.sst,t)}catch(pe){if(t.WTF)throw pe}t.cellStyles&&s.themes.length&&(m=i7(ja(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(h=s7(vr(e,Xa(s.style)),s.style,m,t))}s.links.map(function(pe){try{var we=Jc(ja(e,xo(Xa(pe))),pe);return u7(vr(e,Xa(pe)),we,pe,t)}catch{}});var x=e7(vr(e,Xa(s.workbooks[0])),s.workbooks[0],t),g={},y="";s.coreprops.length&&(y=vr(e,Xa(s.coreprops[0]),!0),y&&(g=Hw(y)),s.extprops.length!==0&&(y=vr(e,Xa(s.extprops[0]),!0),y&&$A(y,g,t)));var S={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(y=ja(e,Xa(s.custprops[0]),!0),y&&(S=qA(y,t)));var w={};if((t.bookSheets||t.bookProps)&&(x.Sheets?o=x.Sheets.map(function(we){return we.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),t.bookProps&&(w.Props=g,w.Custprops=S),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var b={};t.bookDeps&&s.calcchain&&(b=o7(vr(e,Xa(s.calcchain)),s.calcchain));var _=0,T={},N,E;{var j=x.Sheets;g.Worksheets=j.length,g.SheetNames=[];for(var F=0;F!=j.length;++F)g.SheetNames[F]=j[F].name}var R=l?"bin":"xml",A=s.workbooks[0].lastIndexOf("/"),P=(s.workbooks[0].slice(0,A+1)+"_rels/"+s.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Wa(e,P)||(P="xl/_rels/workbook."+R+".rels");var U=Jc(ja(e,P,!0),P.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=f7(vr(e,Xa(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=Yj(vr(e,Xa(s.people[0])),t)),U&&(U=AM(U,x.Sheets));var ee=vr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=g.Worksheets;++_){var W="sheet";if(U&&U[_]?(N="xl/"+U[_][1].replace(/[\/]?xl\//,""),Wa(e,N)||(N=U[_][1]),Wa(e,N)||(N=P.replace(/_rels\/.*$/,"")+U[_][1]),W=U[_][2]):(N="xl/worksheets/sheet"+(_+1-ee)+"."+R,N=N.replace(/sheet0\./,"sheet.")),E=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(g.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var J=!1,xe=0;xe!=t.sheets.length;++xe)typeof t.sheets[xe]=="number"&&t.sheets[xe]==_&&(J=1),typeof t.sheets[xe]=="string"&&t.sheets[xe].toLowerCase()==g.SheetNames[_].toLowerCase()&&(J=1);if(!J)continue e}}CM(e,N,E,g.SheetNames[_],_,T,o,W,t,x,m,h)}return w={Directory:s,Workbook:x,Props:g,Custprops:S,Deps:b,Sheets:o,SheetNames:g.SheetNames,Strings:eo,Styles:h,Themes:m,SSF:Yt(Ze)},t&&t.bookFiles&&(e.files?(w.keys=n,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(pe,we){pe=pe.replace(/^Root Entry[\/]/,""),w.keys.push(pe),w.files[pe]=e.FileIndex[we]}))),t&&t.bookVBA&&(s.vba.length>0?w.vbaraw=vr(e,Xa(s.vba[0]),!0):s.defaults&&s.defaults.bin===tF&&(w.vbaraw=vr(e,"xl/vbaProject.bin",!0))),w}function jM(e,t){var r=t||{},n="Workbook",s=We.find(e,n);try{if(n="/!DataSpaces/Version",s=We.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(dC(s.content),n="/!DataSpaces/DataSpaceMap",s=We.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=mC(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=We.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=xC(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=We.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);gC(s.content)}catch{}if(n="/EncryptionInfo",s=We.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var f=vC(s.content);if(n="/EncryptedPackage",s=We.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(f[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(f[1],s.content,r.password||"",r);if(f[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(f[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function FM(e,t){return t.bookType=="ods"?a_(e,t):t.bookType=="numbers"?TM(e,t):t.bookType=="xlsb"?RM(e,t):i_(e,t)}function RM(e,t){_l=1024,e&&!e.SSF&&(e.SSF=Yt(Ze)),e&&e.SSF&&(Ul(),Fo(e.SSF),t.revssf=Wu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,to?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=kb.indexOf(t.bookType)>-1,s=Km();dx(t=t||{});var l=Rm(),o="",f=0;if(t.cellXfs=[],qs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",mt(l,o,Vw(e.Props,t)),s.coreprops.push(o),Bt(t.rels,2,o,wt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&m.push(e.SheetNames[h]);e.Props.SheetNames=m}for(e.Props.Worksheets=e.Props.SheetNames.length,mt(l,o,$w(e.Props)),s.extprops.push(o),Bt(t.rels,3,o,wt.EXT_PROPS),e.Custprops!==e.Props&&ur(e.Custprops||{}).length>0&&(o="docProps/custom.xml",mt(l,o,Yw(e.Custprops)),s.custprops.push(o),Bt(t.rels,4,o,wt.CUST_PROPS)),f=1;f<=e.SheetNames.length;++f){var x={"!id":{}},g=e.Sheets[e.SheetNames[f-1]],y=(g||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+f+"."+r,mt(l,o,h7(f-1,o,t,e,x)),s.sheets.push(o),Bt(t.wbrels,-1,"worksheets/sheet"+f+"."+r,wt.WS[0])}if(g){var S=g["!comments"],w=!1,b="";S&&S.length>0&&(b="xl/comments"+f+"."+r,mt(l,b,p7(S,b)),s.comments.push(b),Bt(x,-1,"../comments"+f+"."+r,wt.CMNT),w=!0),g["!legacy"]&&w&&mt(l,"xl/drawings/vmlDrawing"+f+".vml",Eb(f,g["!comments"])),delete g["!comments"],delete g["!legacy"]}x["!id"].rId1&&mt(l,xo(o),Nl(x))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,mt(l,o,x7(t.Strings,o,t)),s.strs.push(o),Bt(t.wbrels,-1,"sharedStrings."+r,wt.SST)),o="xl/workbook."+r,mt(l,o,d7(e,o)),s.workbooks.push(o),Bt(t.rels,1,o,wt.WB),o="xl/theme/theme1.xml",mt(l,o,rx(e.Themes,t)),s.themes.push(o),Bt(t.wbrels,-1,"theme/theme1.xml",wt.THEME),o="xl/styles."+r,mt(l,o,m7(e,o,t)),s.styles.push(o),Bt(t.wbrels,-1,"styles."+r,wt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",mt(l,o,e.vbaraw),s.vba.push(o),Bt(t.wbrels,-1,"vbaProject.bin",wt.VBA)),o="xl/metadata."+r,mt(l,o,g7(o)),s.metadata.push(o),Bt(t.wbrels,-1,"metadata."+r,wt.XLMETA),mt(l,"[Content_Types].xml",Pw(s,t)),mt(l,"_rels/.rels",Nl(t.rels)),mt(l,"xl/_rels/workbook."+r+".rels",Nl(t.wbrels)),delete t.revssf,delete t.ssf,l}function i_(e,t){_l=1024,e&&!e.SSF&&(e.SSF=Yt(Ze)),e&&e.SSF&&(Ul(),Fo(e.SSF),t.revssf=Wu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,to?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=kb.indexOf(t.bookType)>-1,s=Km();dx(t=t||{});var l=Rm(),o="",f=0;if(t.cellXfs=[],qs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",mt(l,o,Vw(e.Props,t)),s.coreprops.push(o),Bt(t.rels,2,o,wt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&m.push(e.SheetNames[h]);e.Props.SheetNames=m}e.Props.Worksheets=e.Props.SheetNames.length,mt(l,o,$w(e.Props)),s.extprops.push(o),Bt(t.rels,3,o,wt.EXT_PROPS),e.Custprops!==e.Props&&ur(e.Custprops||{}).length>0&&(o="docProps/custom.xml",mt(l,o,Yw(e.Custprops)),s.custprops.push(o),Bt(t.rels,4,o,wt.CUST_PROPS));var x=["SheetJ5"];for(t.tcid=0,f=1;f<=e.SheetNames.length;++f){var g={"!id":{}},y=e.Sheets[e.SheetNames[f-1]],S=(y||{})["!type"]||"sheet";switch(S){case"chart":default:o="xl/worksheets/sheet"+f+"."+r,mt(l,o,Ub(f-1,t,e,g)),s.sheets.push(o),Bt(t.wbrels,-1,"worksheets/sheet"+f+"."+r,wt.WS[0])}if(y){var w=y["!comments"],b=!1,_="";if(w&&w.length>0){var T=!1;w.forEach(function(N){N[1].forEach(function(E){E.T==!0&&(T=!0)})}),T&&(_="xl/threadedComments/threadedComment"+f+"."+r,mt(l,_,$j(w,x,t)),s.threadedcomments.push(_),Bt(g,-1,"../threadedComments/threadedComment"+f+"."+r,wt.TCMNT)),_="xl/comments"+f+"."+r,mt(l,_,Tb(w)),s.comments.push(_),Bt(g,-1,"../comments"+f+"."+r,wt.CMNT),b=!0}y["!legacy"]&&b&&mt(l,"xl/drawings/vmlDrawing"+f+".vml",Eb(f,y["!comments"])),delete y["!comments"],delete y["!legacy"]}g["!id"].rId1&&mt(l,xo(o),Nl(g))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,mt(l,o,hb(t.Strings,t)),s.strs.push(o),Bt(t.wbrels,-1,"sharedStrings."+r,wt.SST)),o="xl/workbook."+r,mt(l,o,Gb(e)),s.workbooks.push(o),Bt(t.rels,1,o,wt.WB),o="xl/theme/theme1.xml",mt(l,o,rx(e.Themes,t)),s.themes.push(o),Bt(t.wbrels,-1,"theme/theme1.xml",wt.THEME),o="xl/styles."+r,mt(l,o,bb(e,t)),s.styles.push(o),Bt(t.wbrels,-1,"styles."+r,wt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",mt(l,o,e.vbaraw),s.vba.push(o),Bt(t.wbrels,-1,"vbaProject.bin",wt.VBA)),o="xl/metadata."+r,mt(l,o,Nb()),s.metadata.push(o),Bt(t.wbrels,-1,"metadata."+r,wt.XLMETA),x.length>1&&(o="xl/persons/person.xml",mt(l,o,qj(x)),s.people.push(o),Bt(t.wbrels,-1,"persons/person.xml",wt.PEOPLE)),mt(l,"[Content_Types].xml",Pw(s,t)),mt(l,"_rels/.rels",Nl(t.rels)),mt(l,"xl/_rels/workbook."+r+".rels",Nl(t.wbrels)),delete t.revssf,delete t.ssf,l}function hx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ra(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function DM(e,t){return We.find(e,"EncryptedPackage")?jM(e,t):ox(e,t)}function OM(e,t){var r,n=e,s=t||{};return s.type||(s.type=gt&&Buffer.isBuffer(e)?"buffer":"base64"),r=yw(n,s),s_(r,s)}function l_(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return lm(e.slice(r),t);default:break e}return Cl.to_workbook(e,t)}function MM(e,t){var r="",n=hx(e,t);switch(t.type){case"base64":r=Ra(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ni(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Gt(r)),t.type="binary",l_(r,t)}function LM(e,t){var r=e;return t.type=="base64"&&(r=Ra(r)),r=Et.utils.decode(1200,r.slice(2),"str"),t.type="binary",l_(r,t)}function BM(e){return e.match(/[^\x00-\x7F]/)?An(e):e}function Lh(e,t,r,n){return n?(r.type="string",Cl.to_workbook(e,r)):Cl.to_workbook(t,r)}function Fu(e,t){Yu();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Fu(new Uint8Array(e),(r=Yt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Tl={},r.dateNF&&(Tl.dateNF=r.dateNF),r.type||(r.type=gt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=gt?"buffer":"binary",n=U6(e),typeof Uint8Array<"u"&&!gt&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,n=BM(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),f=new Uint8Array(o);if(f.foo="bar",!f.foo)return r=Yt(r),r.type="array",Fu(Am(n),r)}switch((s=hx(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return DM(We.read(n,r),r);break;case 9:if(s[1]<=8)return ox(n,r);break;case 60:return lm(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return W8(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return fb.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?OM(n,r):Lh(e,n,r,l);case 239:return s[3]===60?lm(n,r):Lh(e,n,r,l);case 255:if(s[1]===254)return LM(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return gi.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return gi.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return im.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return vb.to_workbook(n,r);break;case 10:case 13:case 32:return MM(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return q8.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?im.to_workbook(n,r):Lh(e,n,r,l)}function Yy(e,t){var r=t||{};return r.type="file",Fu(e,r)}function c_(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ro(t.file,We.write(e,{type:gt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return We.write(e,t)}function UM(e,t){var r=Yt(t||{}),n=FM(e,r);return o_(n,r)}function IM(e,t){var r=Yt(t||{}),n=i_(e,r);return o_(n,r)}function o_(e,t){var r={},n=gt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?We.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(jo(s))}return t.password&&typeof encrypt_agile<"u"?c_(encrypt_agile(s,t.password),t):t.type==="file"?Ro(t.file,s):t.type=="string"?Gt(s):s}function PM(e,t){var r=t||{},n=V7(e,r);return c_(n,r)}function kn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return oo(An(n));case"binary":return An(n);case"string":return e;case"file":return Ro(t.file,n,"utf8");case"buffer":return gt?ns(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):kn(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function zM(e,t){switch(t.type){case"base64":return oo(e);case"binary":return e;case"string":return e;case"file":return Ro(t.file,e,"binary");case"buffer":return gt?ns(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function iu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?oo(r):t.type=="string"?Gt(r):r;case"file":return Ro(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function mx(e,t){Yu(),Vb(e);var r=Yt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=mx(e,r);return r.type="array",jo(n)}return IM(e,r)}function rf(e,t){Yu(),Vb(e);var r=Yt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=rf(e,r);return r.type="array",jo(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return kn(L7(e,r),r);case"slk":case"sylk":return kn(ub.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return kn(Jb(e.Sheets[e.SheetNames[s]],r),r);case"txt":return zM(d_(e.Sheets[e.SheetNames[s]],r),r);case"csv":return kn(px(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return kn(fb.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return iu(im.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return kn(Cl.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return kn(vb.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return kn(db.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return kn(a_(e,r),r);case"wk1":return iu(gi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return iu(gi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),iu(qb(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),PM(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return UM(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function xx(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Ru(e,t,r){var n=r||{};return n.type="file",n.file=t,xx(n),rf(e,n)}function HM(e,t,r){var n=r||{};return n.type="file",n.file=t,xx(n),mx(e,n)}function VM(e,t,r,n){var s=r||{};s.type="file",s.file=e,xx(s),s.type="buffer";var l=n;return l instanceof Function||(l=r),Is.writeFile(e,rf(t,s),l)}function u_(e,t,r,n,s,l,o,f){var m=cr(r),h=f.defval,x=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),g=!0,y=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!o||e[r])for(var S=t.s.c;S<=t.e.c;++S){var w=o?e[r][S]:e[n[S]+m];if(w===void 0||w.t===void 0){if(h===void 0)continue;l[S]!=null&&(y[l[S]]=h);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(l[S]!=null){if(b==null)if(w.t=="e"&&b===null)y[l[S]]=null;else if(h!==void 0)y[l[S]]=h;else if(x&&b===null)y[l[S]]=null;else continue;else y[l[S]]=x&&(w.t!=="n"||w.t==="n"&&f.rawNumbers!==!1)?b:Fn(w,b,f);b!=null&&(g=!1)}}return{row:y,isempty:g}}function Du(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,l=[],o=0,f="",m={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},x=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof x){case"string":m=St(x);break;case"number":m=St(e["!ref"]),m.s.r=x;break;default:m=x}n>0&&(s=0);var g=cr(m.s.r),y=[],S=[],w=0,b=0,_=Array.isArray(e),T=m.s.r,N=0,E={};_&&!e[T]&&(e[T]=[]);var j=h.skipHidden&&e["!cols"]||[],F=h.skipHidden&&e["!rows"]||[];for(N=m.s.c;N<=m.e.c;++N)if(!(j[N]||{}).hidden)switch(y[N]=Jt(N),r=_?e[T][N]:e[y[N]+g],n){case 1:l[N]=N-m.s.c;break;case 2:l[N]=y[N];break;case 3:l[N]=h.header[N-m.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),f=o=Fn(r,null,h),b=E[o]||0,!b)E[o]=1;else{do f=o+"_"+b++;while(E[f]);E[o]=b,E[f]=1}l[N]=f}for(T=m.s.r+s;T<=m.e.r;++T)if(!(F[T]||{}).hidden){var R=u_(e,m,T,y,n,l,_,h);(R.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(S[w++]=R.row)}return S.length=w,S}var qy=/"/g;function f_(e,t,r,n,s,l,o,f){for(var m=!0,h=[],x="",g=cr(r),y=t.s.c;y<=t.e.c;++y)if(n[y]){var S=f.dense?(e[r]||[])[y]:e[n[y]+g];if(S==null)x="";else if(S.v!=null){m=!1,x=""+(f.rawNumbers&&S.t=="n"?S.v:Fn(S,null,f));for(var w=0,b=0;w!==x.length;++w)if((b=x.charCodeAt(w))===s||b===l||b===34||f.forceQuotes){x='"'+x.replace(qy,'""')+'"';break}x=="ID"&&(x='"ID"')}else S.f!=null&&!S.F?(m=!1,x="="+S.f,x.indexOf(",")>=0&&(x='"'+x.replace(qy,'""')+'"')):x="";h.push(x)}return f.blankrows===!1&&m?null:h.join(o)}function px(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=St(e["!ref"]),l=n.FS!==void 0?n.FS:",",o=l.charCodeAt(0),f=n.RS!==void 0?n.RS:`
`,m=f.charCodeAt(0),h=new RegExp((l=="|"?"\\|":l)+"+$"),x="",g=[];n.dense=Array.isArray(e);for(var y=n.skipHidden&&e["!cols"]||[],S=n.skipHidden&&e["!rows"]||[],w=s.s.c;w<=s.e.c;++w)(y[w]||{}).hidden||(g[w]=Jt(w));for(var b=0,_=s.s.r;_<=s.e.r;++_)(S[_]||{}).hidden||(x=f_(e,s,_,g,o,m,l,n),x!=null&&(n.strip&&(x=x.replace(h,"")),(x||n.blankrows!==!1)&&r.push((b++?f:"")+x)));return delete n.dense,r.join("")}function d_(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=px(e,t);if(typeof Et>"u"||t.type=="string")return r;var n=Et.utils.encode(1200,r,"str");return""+n}function GM(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=St(e["!ref"]),l="",o=[],f,m=[],h=Array.isArray(e);for(f=s.s.c;f<=s.e.c;++f)o[f]=Jt(f);for(var x=s.s.r;x<=s.e.r;++x)for(l=cr(x),f=s.s.c;f<=s.e.c;++f)if(t=o[f]+l,r=h?(e[x]||[])[f]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}m[m.length]=t+"="+n}return m}function h_(e,t,r){var n=r||{},s=+!n.skipHeader,l=e||{},o=0,f=0;if(l&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var m=typeof n.origin=="string"?nr(n.origin):n.origin;o=m.r,f=m.c}var h,x={s:{c:0,r:0},e:{c:f,r:o+t.length-1+s}};if(l["!ref"]){var g=St(l["!ref"]);x.e.c=Math.max(x.e.c,g.e.c),x.e.r=Math.max(x.e.r,g.e.r),o==-1&&(o=g.e.r+1,x.e.r=o+t.length-1+s)}else o==-1&&(o=0,x.e.r=t.length-1+s);var y=n.header||[],S=0;t.forEach(function(b,_){ur(b).forEach(function(T){(S=y.indexOf(T))==-1&&(y[S=y.length]=T);var N=b[T],E="z",j="",F=rt({c:f+S,r:o+_+s});h=_o(l,F),N&&typeof N=="object"&&!(N instanceof Date)?l[F]=N:(typeof N=="number"?E="n":typeof N=="boolean"?E="b":typeof N=="string"?E="s":N instanceof Date?(E="d",n.cellDates||(E="n",N=Sr(N)),j=n.dateNF||Ze[14]):N===null&&n.nullError&&(E="e",N=0),h?(h.t=E,h.v=N,delete h.w,delete h.R,j&&(h.z=j)):l[F]=h={t:E,v:N},j&&(h.z=j))})}),x.e.c=Math.max(x.e.c,f+y.length-1);var w=cr(o);if(s)for(S=0;S<y.length;++S)l[Jt(S+f)+w]={t:"s",v:y[S]};return l["!ref"]=dt(x),l}function XM(e,t){return h_(null,e,t)}function _o(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=nr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?_o(e,rt(t)):_o(e,rt({r:t,c:r||0}))}function $M(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function gx(){return{SheetNames:[],Sheets:{}}}function vx(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var o=l&&l[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(Hb(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function YM(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=$M(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function qM(e,t){return e.z=t,e}function m_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function WM(e,t,r){return m_(e,"#"+t,r)}function KM(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function ZM(e,t,r,n){for(var s=typeof t!="string"?t:St(t),l=typeof t=="string"?t:dt(t),o=s.s.r;o<=s.e.r;++o)for(var f=s.s.c;f<=s.e.c;++f){var m=_o(e,o,f);m.t="n",m.F=l,delete m.v,o==s.s.r&&f==s.s.c&&(m.f=r,n&&(m.D=!0))}return e}var yi={encode_col:Jt,encode_row:cr,encode_cell:rt,encode_range:dt,decode_col:Gm,decode_row:Vm,split_cell:pA,decode_cell:nr,decode_range:la,format_cell:Fn,sheet_add_aoa:Dw,sheet_add_json:h_,sheet_add_dom:e_,aoa_to_sheet:Pl,json_to_sheet:XM,table_to_sheet:t_,table_to_book:lM,sheet_to_csv:px,sheet_to_txt:d_,sheet_to_json:Du,sheet_to_html:Jb,sheet_to_formulae:GM,sheet_to_row_object_array:Du,sheet_get_cell:_o,book_new:gx,book_append_sheet:vx,book_set_sheet_visibility:YM,cell_set_number_format:qM,cell_set_hyperlink:m_,cell_set_internal_link:WM,cell_add_comment:KM,sheet_set_array_formula:ZM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},af;function QM(e){af=e}function JM(e,t){var r=af(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var s=St(e["!ref"]),l=n.FS!==void 0?n.FS:",",o=l.charCodeAt(0),f=n.RS!==void 0?n.RS:`
`,m=f.charCodeAt(0),h=new RegExp((l=="|"?"\\|":l)+"+$"),x="",g=[];n.dense=Array.isArray(e);for(var y=n.skipHidden&&e["!cols"]||[],S=n.skipHidden&&e["!rows"]||[],w=s.s.c;w<=s.e.c;++w)(y[w]||{}).hidden||(g[w]=Jt(w));var b=s.s.r,_=!1,T=0;return r._read=function(){if(!_)return _=!0,r.push("\uFEFF");for(;b<=s.e.r;)if(++b,!(S[b-1]||{}).hidden&&(x=f_(e,s,b-1,g,o,m,l,n),x!=null&&(n.strip&&(x=x.replace(h,"")),x||n.blankrows!==!1)))return r.push((T++?f:"")+x);return r.push(null)},r}function e9(e,t){var r=af(),n=t||{},s=n.header!=null?n.header:Kb,l=n.footer!=null?n.footer:Zb;r.push(s);var o=la(e["!ref"]);n.dense=Array.isArray(e),r.push(Qb(e,o,n));var f=o.s.r,m=!1;return r._read=function(){if(f>o.e.r)return m||(m=!0,r.push("</table>"+l)),r.push(null);for(;f<=o.e.r;){r.push(Wb(e,o,f,n)),++f;break}},r}function t9(e,t){var r=af({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},s=0,l=1,o=[],f=0,m="",h={s:{r:0,c:0},e:{r:0,c:0}},x=t||{},g=x.range!=null?x.range:e["!ref"];switch(x.header===1?s=1:x.header==="A"?s=2:Array.isArray(x.header)&&(s=3),typeof g){case"string":h=St(g);break;case"number":h=St(e["!ref"]),h.s.r=g;break;default:h=g}s>0&&(l=0);var y=cr(h.s.r),S=[],w=0,b=Array.isArray(e),_=h.s.r,T=0,N={};b&&!e[_]&&(e[_]=[]);var E=x.skipHidden&&e["!cols"]||[],j=x.skipHidden&&e["!rows"]||[];for(T=h.s.c;T<=h.e.c;++T)if(!(E[T]||{}).hidden)switch(S[T]=Jt(T),n=b?e[_][T]:e[S[T]+y],s){case 1:o[T]=T-h.s.c;break;case 2:o[T]=S[T];break;case 3:o[T]=x.header[T-h.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),m=f=Fn(n,null,x),w=N[f]||0,!w)N[f]=1;else{do m=f+"_"+w++;while(N[m]);N[f]=w,N[m]=1}o[T]=m}return _=h.s.r+l,r._read=function(){for(;_<=h.e.r;)if(!(j[_-1]||{}).hidden){var F=u_(e,h,_,S,s,o,b,x);if(++_,F.isempty===!1||(s===1?x.blankrows!==!1:x.blankrows)){r.push(F.row);return}}return r.push(null)},r}var r9={to_json:t9,to_html:e9,to_csv:JM,set_readable:QM};const a9=co.version,n9=Object.freeze(Object.defineProperty({__proto__:null,CFB:We,SSF:hw,parse_xlscfb:ox,parse_zip:s_,read:Fu,readFile:Yy,readFileSync:Yy,set_cptable:l6,set_fs:L6,stream:r9,utils:yi,version:a9,write:rf,writeFile:Ru,writeFileAsync:VM,writeFileSync:Ru,writeFileXLSX:HM,writeXLSX:mx},Symbol.toStringTag,{value:"Module"})),x_=new Date().getFullYear(),s9=Array.from({length:10},(e,t)=>x_-5+t),i9=Array.from({length:12},(e,t)=>t+1),l9=()=>{const e=ta(),[t,r]=C.useState(new Date().getMonth()+1),[n,s]=C.useState(x_),[l,o]=C.useState(!1),[f,m]=C.useState([]),[h,x]=C.useState(null);C.useEffect(()=>{g()},[t,n]);const g=async()=>{o(!0),x(null);try{const S=await Gs(),w=await Ao(),b=new Map;S.forEach(T=>{b.set(T.name,{medRecComplete:{yes:0,no:0,total:0},bpAtGoal:{yes:0,no:0,total:0},hospitalVisitSinceLastReview:{yes:0,no:0,total:0},a1cAtGoal:{yes:0,no:0,total:0},fallSinceLastVisit:{yes:0,no:0,total:0},useBenzo:{yes:0,no:0,total:0},useOpioids:{yes:0,no:0,total:0},useAntipsychotic:{yes:0,no:0,total:0}})});for(const T of S){const N=w.filter(j=>j.site_name===T.name),E=b.get(T.name);E.medRecComplete.total=N.length,E.bpAtGoal.total=N.length,E.hospitalVisitSinceLastReview.total=N.length,E.a1cAtGoal.total=N.length,E.fallSinceLastVisit.total=N.length,E.useBenzo.total=N.length,E.useOpioids.total=N.length,E.useAntipsychotic.total=N.length;for(const j of N)if(j.id)try{const F=await Sm(j.id);if(F.length>0){const A=F.sort((P,U)=>{const ee=new Date(P.createdAt||"");return new Date(U.createdAt||"").getTime()-ee.getTime()})[0];A.medical_records?E.medRecComplete.yes++:E.medRecComplete.no++,A.bpAtGoal?E.bpAtGoal.yes++:E.bpAtGoal.no++,A.hospitalVisitSinceLastReview?E.hospitalVisitSinceLastReview.yes++:E.hospitalVisitSinceLastReview.no++,A.a1cAtGoal?E.a1cAtGoal.yes++:E.a1cAtGoal.no++,A.fallSinceLastVisit?E.fallSinceLastVisit.yes++:E.fallSinceLastVisit.no++,A.benzodiazepines?E.useBenzo.yes++:E.useBenzo.no++,A.opioids?E.useOpioids.yes++:E.useOpioids.no++,A.antipsychotics?E.useAntipsychotic.yes++:E.useAntipsychotic.no++}else E.medRecComplete.no++,E.bpAtGoal.no++,E.hospitalVisitSinceLastReview.no++,E.a1cAtGoal.no++,E.fallSinceLastVisit.no++,E.useBenzo.no++,E.useOpioids.no++,E.useAntipsychotic.no++}catch(F){console.error(`Error fetching records for patient ${j.id}:`,F),E.medRecComplete.no++,E.bpAtGoal.no++,E.hospitalVisitSinceLastReview.no++,E.a1cAtGoal.no++,E.fallSinceLastVisit.no++,E.useBenzo.no++,E.useOpioids.no++,E.useAntipsychotic.no++}}const _=[{criteriaName:"A1C at Goal",sites:Array.from(b.entries()).map(([T,N])=>({siteName:T,yes:N.a1cAtGoal.yes,no:N.a1cAtGoal.no,total:N.a1cAtGoal.total,percentage:N.a1cAtGoal.total>0?N.a1cAtGoal.yes/N.a1cAtGoal.total*100:0})),total:{siteName:"All",yes:0,no:0,total:0,percentage:0}},{criteriaName:"BP at Goal",sites:Array.from(b.entries()).map(([T,N])=>({siteName:T,yes:N.bpAtGoal.yes,no:N.bpAtGoal.no,total:N.bpAtGoal.total,percentage:N.bpAtGoal.total>0?N.bpAtGoal.yes/N.bpAtGoal.total*100:0})),total:{siteName:"All",yes:0,no:0,total:0,percentage:0}},{criteriaName:"Med Rec Complete",sites:Array.from(b.entries()).map(([T,N])=>({siteName:T,yes:N.medRecComplete.yes,no:N.medRecComplete.no,total:N.medRecComplete.total,percentage:N.medRecComplete.total>0?N.medRecComplete.yes/N.medRecComplete.total*100:0})),total:{siteName:"All",yes:0,no:0,total:0,percentage:0}},{criteriaName:"Hospital Visit Since Last Review",sites:Array.from(b.entries()).map(([T,N])=>({siteName:T,yes:N.hospitalVisitSinceLastReview.yes,no:N.hospitalVisitSinceLastReview.no,total:N.hospitalVisitSinceLastReview.total,percentage:N.hospitalVisitSinceLastReview.total>0?N.hospitalVisitSinceLastReview.yes/N.hospitalVisitSinceLastReview.total*100:0})),total:{siteName:"All",yes:0,no:0,total:0,percentage:0}},{criteriaName:"Fall Since Last Visit",sites:Array.from(b.entries()).map(([T,N])=>({siteName:T,yes:N.fallSinceLastVisit.yes,no:N.fallSinceLastVisit.no,total:N.fallSinceLastVisit.total,percentage:N.fallSinceLastVisit.total>0?N.fallSinceLastVisit.yes/N.fallSinceLastVisit.total*100:0})),total:{siteName:"All",yes:0,no:0,total:0,percentage:0}},{criteriaName:"Use Benzo",sites:Array.from(b.entries()).map(([T,N])=>({siteName:T,yes:N.useBenzo.yes,no:N.useBenzo.no,total:N.useBenzo.total,percentage:N.useBenzo.total>0?N.useBenzo.yes/N.useBenzo.total*100:0})),total:{siteName:"All",yes:0,no:0,total:0,percentage:0}},{criteriaName:"Use Opioids",sites:Array.from(b.entries()).map(([T,N])=>({siteName:T,yes:N.useOpioids.yes,no:N.useOpioids.no,total:N.useOpioids.total,percentage:N.useOpioids.total>0?N.useOpioids.yes/N.useOpioids.total*100:0})),total:{siteName:"All",yes:0,no:0,total:0,percentage:0}},{criteriaName:"Use Antipsychotic",sites:Array.from(b.entries()).map(([T,N])=>({siteName:T,yes:N.useAntipsychotic.yes,no:N.useAntipsychotic.no,total:N.useAntipsychotic.total,percentage:N.useAntipsychotic.total>0?N.useAntipsychotic.yes/N.useAntipsychotic.total*100:0})),total:{siteName:"All",yes:0,no:0,total:0,percentage:0}}];_.forEach(T=>{T.total=T.sites.reduce((N,E)=>({siteName:"All",yes:N.yes+E.yes,no:N.no+E.no,total:N.total+E.total,percentage:0}),{siteName:"All",yes:0,no:0,total:0,percentage:0}),T.total.percentage=T.total.total>0?T.total.yes/T.total.total*100:0}),m(_)}catch(S){console.error("Error generating reports:",S),x("Failed to generate reports")}finally{o(!1)}},y=()=>{var S;if(console.log("Export function called",{criteriaDataLength:f.length}),f.length===0){alert("No data to export");return}try{console.log("Starting export process...");const w=yi.book_new(),b=((S=f[0])==null?void 0:S.sites.map(F=>F.siteName))||[],_=[];_.push(["Overall Outcomes Report"]),_.push([`Month: ${t}, Year: ${n}`]),_.push([""]);const T=["Criteria",...b,"All Sites"];_.push(T),f.forEach(F=>{const R=[F.criteriaName,...b.map(()=>""),""];_.push(R);const A=["Yes"];F.sites.forEach(W=>{A.push(W.yes)}),A.push(F.total.yes),_.push(A);const P=["No"];F.sites.forEach(W=>{P.push(W.no)}),P.push(F.total.no),_.push(P);const U=["Total"];F.sites.forEach(W=>{U.push(W.total)}),U.push(F.total.total),_.push(U);const ee=["Percentage"];F.sites.forEach(W=>{ee.push(W.percentage.toFixed(4)+"%")}),ee.push(F.total.percentage.toFixed(4)+"%"),_.push(ee),_.push(["",...b.map(()=>""),""])});const N=yi.aoa_to_sheet(_);yi.book_append_sheet(w,N,"Overall Outcomes");const E=new Date().toISOString().split("T")[0],j=`Overall_Outcomes_${t}_${n}_${E}.xlsx`;console.log("About to save file:",j),Ru(w,j),console.log("File saved successfully")}catch(w){console.error("Error exporting data:",w),alert("Failed to export data. Please try again.")}};return u.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:u.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Overall Outcomes"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[u.jsx("button",{onClick:y,disabled:l||f.length===0,className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Export Data"}),u.jsx("button",{onClick:()=>e("/site-reports"),className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer",children:"Site Reports"}),u.jsx("button",{onClick:()=>e("/patient-reports"),className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer",children:"Patient Reports"})]})]}),u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-6",children:u.jsx("div",{className:"flex flex-col space-y-3",children:u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-3",children:[u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Month"}),u.jsx("div",{className:"relative",children:u.jsx("select",{id:"month",value:t,onChange:S=>r(Number(S.target.value)),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:i9.map(S=>u.jsx("option",{value:S,children:S},S))})})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Year"}),u.jsx("div",{className:"relative",children:u.jsx("select",{id:"year",value:n,onChange:S=>s(Number(S.target.value)),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:s9.map(S=>u.jsx("option",{value:S,children:S},S))})})]})]})})}),l&&u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),u.jsx("p",{className:"mt-2 text-gray-600",children:"Generating reports..."})]}),h&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:u.jsx("p",{className:"text-red-800",children:h})}),!l&&f.length>0&&u.jsx("div",{className:"space-y-8",children:f.map((S,w)=>u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[u.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:u.jsx("h2",{className:"text-lg font-medium text-gray-900",children:S.criteriaName})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Site"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Yes"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"No"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"})]})}),u.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[S.sites.map((b,_)=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:b.siteName}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.yes}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.no}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.total}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[b.percentage.toFixed(4)," %"]})]},_)),S.total.total>0&&u.jsxs("tr",{className:"bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900",children:"All"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900",children:S.total.yes}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900",children:S.total.no}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900",children:S.total.total}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900",children:[S.total.percentage.toFixed(4)," %"]})]})]})]})})]},w))})]})})},c9="modulepreload",o9=function(e){return"/"+e},Wy={},u9=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let o=function(h){return Promise.all(h.map(x=>Promise.resolve(x).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));s=o(r.map(h=>{if(h=o9(h),h in Wy)return;Wy[h]=!0;const x=h.endsWith(".css"),g=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const y=document.createElement("link");if(y.rel=x?"stylesheet":c9,x||(y.as="script"),y.crossOrigin="",y.href=h,m&&y.setAttribute("nonce",m),document.head.appendChild(y),x)return new Promise((S,w)=>{y.addEventListener("load",S),y.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(o){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=o,window.dispatchEvent(f),!f.defaultPrevented)throw o}return s.then(o=>{for(const f of o||[])f.status==="rejected"&&l(f.reason);return t().catch(l)})},p_=new Date().getFullYear(),f9=Array.from({length:10},(e,t)=>p_-5+t),d9=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],h9=()=>{const e=ta(),[t,r]=C.useState([]),[n,s]=C.useState(""),[l,o]=C.useState(new Date().getMonth()+1),[f,m]=C.useState(p_),[h,x]=C.useState(!1),[g,y]=C.useState(null),[S,w]=C.useState(null);C.useEffect(()=>{b()},[]),C.useEffect(()=>{n&&_()},[n,l,f]);const b=async()=>{try{const N=await Gs();r(N),N.length>0&&s(N[0].name)}catch(N){console.error("Error fetching sites:",N),w("Failed to load sites")}},_=async()=>{if(n){x(!0),w(null);try{const E=(await Ao()).filter(F=>F.site_name===n);if(E.length===0){y({siteName:n,medRecComplete:{yes:0,no:0,total:0,percentage:0},bpAtGoal:{yes:0,no:0,total:0,percentage:0},hospitalVisitSinceLastReview:{yes:0,no:0,total:0,percentage:0},a1cAtGoal:{yes:0,no:0,total:0,percentage:0},fallSinceLastVisit:{yes:0,no:0,total:0,percentage:0},useBenzo:{yes:0,no:0,total:0,percentage:0},useOpioids:{yes:0,no:0,total:0,percentage:0},useAntipsychotic:{yes:0,no:0,total:0,percentage:0}}),x(!1);return}const j={siteName:n,medRecComplete:{yes:0,no:0,total:E.length,percentage:0},bpAtGoal:{yes:0,no:0,total:E.length,percentage:0},hospitalVisitSinceLastReview:{yes:0,no:0,total:E.length,percentage:0},a1cAtGoal:{yes:0,no:0,total:E.length,percentage:0},fallSinceLastVisit:{yes:0,no:0,total:E.length,percentage:0},useBenzo:{yes:0,no:0,total:E.length,percentage:0},useOpioids:{yes:0,no:0,total:E.length,percentage:0},useAntipsychotic:{yes:0,no:0,total:E.length,percentage:0}};for(const F of E)if(F.id)try{const R=await Sm(F.id);if(R.length>0){const P=R.sort((U,ee)=>{const W=new Date(U.createdAt||"");return new Date(ee.createdAt||"").getTime()-W.getTime()})[0];P.medical_records?j.medRecComplete.yes++:j.medRecComplete.no++,P.bpAtGoal?j.bpAtGoal.yes++:j.bpAtGoal.no++,P.hospitalVisitSinceLastReview?j.hospitalVisitSinceLastReview.yes++:j.hospitalVisitSinceLastReview.no++,P.a1cAtGoal?j.a1cAtGoal.yes++:j.a1cAtGoal.no++,P.fallSinceLastVisit?j.fallSinceLastVisit.yes++:j.fallSinceLastVisit.no++,P.benzodiazepines?j.useBenzo.yes++:j.useBenzo.no++,P.opioids?j.useOpioids.yes++:j.useOpioids.no++,P.antipsychotics?j.useAntipsychotic.yes++:j.useAntipsychotic.no++}else j.medRecComplete.no++,j.bpAtGoal.no++,j.hospitalVisitSinceLastReview.no++,j.a1cAtGoal.no++,j.fallSinceLastVisit.no++,j.useBenzo.no++,j.useOpioids.no++,j.useAntipsychotic.no++}catch(R){console.error(`Error fetching records for patient ${F.id}:`,R),j.medRecComplete.no++,j.bpAtGoal.no++,j.hospitalVisitSinceLastReview.no++,j.a1cAtGoal.no++,j.fallSinceLastVisit.no++,j.useBenzo.no++,j.useOpioids.no++,j.useAntipsychotic.no++}Object.keys(j).forEach(F=>{if(F!=="siteName"&&F!=="siteId"){const R=j[F];R.percentage=R.total>0?R.yes/R.total*100:0}}),y(j)}catch(N){console.error("Error fetching report data:",N),w("Failed to load report data")}finally{x(!1)}}},T=async()=>{if(!g){alert("No data to export");return}try{const N=await u9(()=>Promise.resolve().then(()=>n9),[]),E=[["Criteria","Yes","No","Total","Percentage"],["Med Rec Complete",g.medRecComplete.yes,g.medRecComplete.no,g.medRecComplete.total,g.medRecComplete.percentage.toFixed(4)+"%"],["BP at Goal",g.bpAtGoal.yes,g.bpAtGoal.no,g.bpAtGoal.total,g.bpAtGoal.percentage.toFixed(4)+"%"],["Hospital Visit Since Last Review",g.hospitalVisitSinceLastReview.yes,g.hospitalVisitSinceLastReview.no,g.hospitalVisitSinceLastReview.total,g.hospitalVisitSinceLastReview.percentage.toFixed(4)+"%"],["A1C at Goal",g.a1cAtGoal.yes,g.a1cAtGoal.no,g.a1cAtGoal.total,g.a1cAtGoal.percentage.toFixed(4)+"%"],["Fall Since Last Visit",g.fallSinceLastVisit.yes,g.fallSinceLastVisit.no,g.fallSinceLastVisit.total,g.fallSinceLastVisit.percentage.toFixed(4)+"%"],["Use Benzo",g.useBenzo.yes,g.useBenzo.no,g.useBenzo.total,g.useBenzo.percentage.toFixed(4)+"%"],["Use Opioids",g.useOpioids.yes,g.useOpioids.no,g.useOpioids.total,g.useOpioids.percentage.toFixed(4)+"%"],["Use Antipsychotic",g.useAntipsychotic.yes,g.useAntipsychotic.no,g.useAntipsychotic.total,g.useAntipsychotic.percentage.toFixed(4)+"%"]],j=N.utils.book_new(),F=N.utils.aoa_to_sheet(E);N.utils.book_append_sheet(j,F,"Site Report");const R=new Date().toISOString().split("T")[0],P=`Site_Report_${n.replace(/[^a-zA-Z0-9]/g,"_")}_${l}_${f}_${R}.xlsx`;N.writeFile(j,P)}catch(N){console.error("Error exporting data:",N),alert("Failed to export data. Please try again.")}};return u.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:u.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Site Report"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[u.jsx("button",{onClick:T,disabled:h||!g,className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Export Data"}),u.jsx("button",{onClick:()=>e("/reports"),className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer",children:"Overall Reports"}),u.jsx("button",{onClick:()=>e("/patient-reports"),className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer",children:"Patient Reports"})]})]}),u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-6",children:u.jsx("div",{className:"flex flex-col space-y-3",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Site"}),u.jsx("div",{className:"relative",children:u.jsx("select",{value:n,onChange:N=>s(N.target.value),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:t.map(N=>u.jsx("option",{value:N.name,children:N.name},N.id))})})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Month"}),u.jsx("div",{className:"relative",children:u.jsx("select",{value:l,onChange:N=>o(Number(N.target.value)),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:d9.map(N=>u.jsx("option",{value:N.value,children:N.value},N.value))})})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Year"}),u.jsx("div",{className:"relative",children:u.jsx("select",{value:f,onChange:N=>m(Number(N.target.value)),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:f9.map(N=>u.jsx("option",{value:N,children:N},N))})})]})]})})}),h&&u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),u.jsx("p",{className:"mt-2 text-gray-600",children:"Loading report data..."})]}),S&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:u.jsx("p",{className:"text-red-800",children:S})}),g&&!h&&u.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Criteria"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Yes"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"No"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"})]})}),u.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Med Rec Complete"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.medRecComplete.yes}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.medRecComplete.no}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.medRecComplete.total}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.medRecComplete.percentage.toFixed(4)," %"]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"BP at Goal"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.bpAtGoal.yes}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.bpAtGoal.no}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.bpAtGoal.total}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.bpAtGoal.percentage.toFixed(4)," %"]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Hospital Visit Since Last Review"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.hospitalVisitSinceLastReview.yes}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.hospitalVisitSinceLastReview.no}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.hospitalVisitSinceLastReview.total}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.hospitalVisitSinceLastReview.percentage.toFixed(4)," %"]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"A1C at Goal"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.a1cAtGoal.yes}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.a1cAtGoal.no}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.a1cAtGoal.total}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.a1cAtGoal.percentage.toFixed(4)," %"]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Fall Since Last Visit"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.fallSinceLastVisit.yes}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.fallSinceLastVisit.no}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.fallSinceLastVisit.total}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.fallSinceLastVisit.percentage.toFixed(4)," %"]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Use Benzo"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.useBenzo.yes}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.useBenzo.no}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.useBenzo.total}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.useBenzo.percentage.toFixed(4)," %"]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Use Opioids"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.useOpioids.yes}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.useOpioids.no}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.useOpioids.total}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.useOpioids.percentage.toFixed(4)," %"]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Use Antipsychotic"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.useAntipsychotic.yes}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.useAntipsychotic.no}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.useAntipsychotic.total}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.useAntipsychotic.percentage.toFixed(4)," %"]})]})]})]})})})]})})},m9=e=>e===0?"0.00 minutes":e<60?`${e.toFixed(2)} minutes`:`${(e/60).toFixed(2)} hours`,x9=(e,t,r)=>{const n=e.service_datetime||e.created_at;if(!n)return!1;try{const s=new Date(n);return isNaN(s.getTime())?!1:s.getMonth()+1===t&&s.getFullYear()===r}catch(s){return console.error("Error parsing activity date:",s),!1}},p9=()=>{const e=ta(),[t,r]=C.useState(new Date().getMonth()+1),[n,s]=C.useState(new Date().getFullYear()),[l,o]=C.useState(!1),[f,m]=C.useState([]),[h,x]=C.useState(null),[g,y]=C.useState(!1),[S,w]=C.useState(!0),b=Array.from({length:12},(j,F)=>F+1),_=Array.from({length:10},(j,F)=>new Date().getFullYear()-F),T=async()=>{o(!0),x(null),m([]);try{const[j,F,R]=await Promise.all([Gs(),Ao(),Y2()]),A=[];for(const P of j){const U=F.filter(pe=>pe.site_name===P.name),ee=[];let W=0,J=0;for(const pe of U)if(pe.id)try{const Q=R.filter(re=>re.patient_id===pe.id).map(re=>({...re,time_spent:re.duration_minutes})).filter(re=>x9(re,t,n)),ie=Q.reduce((re,z)=>{const te=z.time_spent,D=z.duration_minutes;let V=0;return te!=null&&!isNaN(Number(te))?V=Number(te):D!=null&&!isNaN(Number(D))&&(V=Number(D)),re+V},0),Ae=ie/60;ee.push({patientId:pe.id,patientName:`${pe.first_name} ${pe.last_name}`,totalMinutes:ie,totalHours:Ae,activityCount:Q.length}),W+=ie,J+=Q.length}catch(we){console.error(`Error processing activities for patient ${pe.id}:`,we),ee.push({patientId:pe.id,patientName:`${pe.first_name} ${pe.last_name}`,totalMinutes:0,totalHours:0,activityCount:0})}const xe=W/60;A.push({siteName:P.name,siteId:P.id,patients:ee,totalSiteMinutes:W,totalSiteHours:xe,totalSiteActivities:J})}m(A)}catch(j){console.error("Error generating patient reports:",j),x("Failed to generate patient reports")}finally{o(!1)}};C.useEffect(()=>{T()},[]);const N=C.useMemo(()=>{if(S)return f.map(j=>({...j,patients:g?j.patients.filter(F=>F.totalMinutes<20):j.patients,totalSiteMinutes:g?j.patients.filter(F=>F.totalMinutes<20).reduce((F,R)=>F+R.totalMinutes,0):j.totalSiteMinutes,totalSiteHours:g?j.patients.filter(F=>F.totalMinutes<20).reduce((F,R)=>F+R.totalHours,0):j.totalSiteHours,totalSiteActivities:g?j.patients.filter(F=>F.totalMinutes<20).reduce((F,R)=>F+R.activityCount,0):j.totalSiteActivities}));{const j=f.flatMap(R=>R.patients.map(A=>({...A,siteName:R.siteName}))),F=g?j.filter(R=>R.totalMinutes<20):j;return[{siteName:"All Sites",patients:F,totalSiteMinutes:F.reduce((R,A)=>R+A.totalMinutes,0),totalSiteHours:F.reduce((R,A)=>R+A.totalHours,0),totalSiteActivities:F.reduce((R,A)=>R+A.activityCount,0)}]}},[f,S,g]),E=()=>{if(N.length===0){alert("No data to export");return}const j=[];j.push(["Patient Reports"]),j.push([`Month: ${t}, Year: ${n}`]),g&&j.push(["Filter: Showing only patients under 20 minutes"]),S||j.push(["View: All patients (ungrouped by site)"]),j.push([""]);const F=["Patient Name"];S||F.push("Site"),F.push("Total Hours","Total Minutes","Activity Count"),j.push(F),N.forEach(ee=>{if(S&&ee.siteName!=="All Sites"&&j.push([`--- ${ee.siteName} ---`,"","","",""]),ee.patients.forEach(W=>{const J=[W.patientName];S||J.push(W.siteName),J.push(W.totalHours.toFixed(2),W.totalMinutes.toFixed(2),W.activityCount),j.push(J)}),S&&ee.siteName!=="All Sites"){const W=[`Total for ${ee.siteName}`];S||W.push(""),W.push((ee.totalSiteMinutes/60).toFixed(2),ee.totalSiteMinutes.toFixed(2),ee.totalSiteActivities),j.push(W),j.push([""])}});const R=yi.book_new(),A=yi.aoa_to_sheet(j);yi.book_append_sheet(R,A,"Patient Reports");const P=new Date().toISOString().split("T")[0],U=`Patient_Reports_${t}_${n}_${P}.xlsx`;Ru(R,U)};return u.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:u.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Patient Reports"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[u.jsx("button",{onClick:E,disabled:l||N.length===0,className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Export Data"}),u.jsx("button",{onClick:()=>e("/reports"),className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer",children:"Overall Reports"}),u.jsx("button",{onClick:()=>e("/site-reports"),className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer",children:"Site Reports"})]})]}),u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-6",children:u.jsxs("div",{className:"flex flex-col space-y-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Month"}),u.jsx("div",{className:"relative",children:u.jsx("select",{value:t,onChange:j=>r(Number(j.target.value)),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:b.map(j=>u.jsx("option",{value:j,children:j},j))})})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Year"}),u.jsx("div",{className:"relative",children:u.jsx("select",{value:n,onChange:j=>s(Number(j.target.value)),className:"block w-full pl-3 pr-8 py-1.5 text-sm border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md bg-white border appearance-none",children:_.map(j=>u.jsx("option",{value:j,children:j},j))})})]}),u.jsx("div",{className:"flex items-end",children:u.jsx("button",{onClick:T,disabled:l,className:"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Generating...":"Generate Reports"})})]}),u.jsxs("div",{className:"flex flex-wrap gap-4 mt-2",children:[u.jsxs("label",{className:"inline-flex items-center",children:[u.jsx("input",{type:"checkbox",checked:S,onChange:j=>w(j.target.checked),className:"form-checkbox h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),u.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Group by Site"})]}),u.jsxs("label",{className:"inline-flex items-center",children:[u.jsx("input",{type:"checkbox",checked:g,onChange:j=>y(j.target.checked),className:"form-checkbox h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),u.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Show Only Patients Under 20 Minutes"})]})]})]})}),l&&u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),u.jsx("p",{className:"mt-2 text-gray-600",children:"Generating patient reports..."})]}),h&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:u.jsx("p",{className:"text-red-800",children:h})}),!l&&N.length>0&&u.jsx("div",{className:"space-y-8",children:N.map((j,F)=>u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[u.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("h2",{className:"text-lg font-medium text-gray-900",children:j.siteName}),u.jsxs("div",{className:"text-sm text-gray-600",children:["Total: ",m9(j.totalSiteMinutes)," | ",j.totalSiteActivities," activities"]})]})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient Name"}),!S&&u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Site"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Hours"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Minutes"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activity Count"})]})}),u.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[j.patients.map((R,A)=>u.jsxs("tr",{className:R.totalMinutes===0?"bg-gray-50":"",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:R.patientName}),!S&&u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.siteName}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[R.totalHours.toFixed(2)," hours"]}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[R.totalMinutes.toFixed(2)," minutes"]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.activityCount})]},A)),j.patients.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:S?4:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No patients found for this site"})})]})]})})]},F))}),!l&&N.length===0&&!h&&u.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:u.jsx("p",{className:"text-gray-600",children:'No patient activity data found for the selected month and year. Try selecting a different month or year and click "Generate Reports".'})})]})})},g9=e=>e.toLowerCase().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),v9=({isOpen:e,onClose:t,siteId:r,onBuildingAdded:n})=>{const[s,l]=C.useState(""),[o,f]=C.useState(!1),[m,h]=C.useState(null),x=C.useRef(e);C.useEffect(()=>{x.current&&!e&&(l(""),h(null),f(!1)),x.current=e},[e]),C.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]);const g=async S=>{if(S.preventDefault(),h(null),!s.trim()){h("Building name is required");return}f(!0);try{await LT({name:s.trim(),site_id:r,is_active:!0}),n(),t()}catch(w){h(w instanceof Error?w.message:"An error occurred")}finally{f(!1)}},y=()=>{t()};return e?u.jsx("div",{className:"fixed inset-0 backdrop-blur-[2px] bg-gray-500/30 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] flex flex-col overflow-hidden",children:[u.jsx("div",{className:"p-4 sm:p-6",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(bi,{className:"h-6 w-6 text-gray-400"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Add New Building"}),u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Create a new building for this site"})]})]}),u.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-500 transition-colors cursor-pointer",children:u.jsx(Ja,{className:"h-6 w-6"})})]})}),u.jsx("div",{className:"p-4 sm:p-6 pt-0 overflow-y-auto flex-1",children:u.jsxs("form",{onSubmit:g,className:"space-y-6",children:[m&&u.jsx("div",{className:"p-3 rounded-lg bg-red-50 border border-red-200",children:u.jsx("p",{className:"text-sm text-red-600",children:m})}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Building Name"}),u.jsx("input",{type:"text",value:s,onChange:S=>l(g9(S.target.value)),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0,placeholder:"Enter building name"})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:y,disabled:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center min-w-[100px]",children:o?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Adding..."]}):"Add Building"})]})]})})]})}):null},y9=e=>e.toLowerCase().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),w9=({isOpen:e,onClose:t,building:r,onBuildingUpdated:n})=>{const[s,l]=C.useState(""),[o,f]=C.useState(!1),[m,h]=C.useState(null),x=C.useRef(e);C.useEffect(()=>{x.current&&!e&&(h(null),f(!1)),x.current=e},[e]),C.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),C.useEffect(()=>{l(r?r.name:""),h(null)},[r]);const g=async S=>{if(S.preventDefault(),h(null),!r){h("No building selected for editing");return}if(!s.trim()){h("Building name is required");return}f(!0);try{await BT(r.id,{name:s.trim()}),n(),t()}catch(w){h(w instanceof Error?w.message:"An error occurred")}finally{f(!1)}},y=()=>{t()};return e?u.jsx("div",{className:"fixed inset-0 backdrop-blur-[2px] bg-gray-500/30 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] flex flex-col overflow-hidden",children:[u.jsx("div",{className:"p-4 sm:p-6",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(bi,{className:"h-6 w-6 text-gray-400"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Building"}),u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Modify building details"})]})]}),u.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-500 transition-colors cursor-pointer",children:u.jsx(Ja,{className:"h-6 w-6"})})]})}),u.jsx("div",{className:"p-4 sm:p-6 pt-0 overflow-y-auto flex-1",children:u.jsxs("form",{onSubmit:g,className:"space-y-6",children:[m&&u.jsx("div",{className:"p-3 rounded-lg bg-red-50 border border-red-200",children:u.jsx("p",{className:"text-sm text-red-600",children:m})}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Building Name"}),u.jsx("input",{type:"text",value:s,onChange:S=>l(y9(S.target.value)),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-colors duration-200",required:!0,placeholder:"Enter building name"})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:y,disabled:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center min-w-[100px]",children:o?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Updating..."]}):"Update Building"})]})]})})]})}):null},b9=({siteId:e,expanded:t,onToggle:r})=>{const[n,s]=C.useState(!1),[l,o]=C.useState([]),[f,m]=C.useState(""),[h,x]=C.useState(!1),[g,y]=C.useState(!1),[S,w]=C.useState(null),[b,_]=C.useState(!1),[T,N]=C.useState(null),[E,j]=C.useState(!1);C.useEffect(()=>{t&&e&&!isNaN(parseInt(e))&&F()},[t,e]);const F=async()=>{if(!(!e||isNaN(parseInt(e)))){s(!0);try{const W=await Vu(parseInt(e));o(W)}catch(W){console.error("Error fetching buildings:",W)}finally{s(!1)}}},R=W=>{w(W),y(!0)},A=()=>{y(!1),w(null)},P=()=>{F()},U=async()=>{if(T){j(!0);try{await UT(T.id),await F(),_(!1),N(null)}catch(W){console.error("Error deleting building:",W),alert("Failed to delete building. Please try again.")}finally{j(!1)}}},ee=l.filter(W=>W.name.toLowerCase().includes(f.toLowerCase()));return u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 mb-4",children:[u.jsx("div",{className:`p-6 ${t?"border-b border-gray-200":""}`,children:u.jsxs("div",{className:"flex flex-col gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:r,children:[u.jsx(qE,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Buildings"}),t?u.jsx(ia,{className:"w-5 h-5 text-gray-500 flex-shrink-0"}):u.jsx(_m,{className:"w-5 h-5 text-gray-500 flex-shrink-0"})]}),t&&u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:items-center",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(ts,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search buildings...",value:f,onChange:W=>m(W.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),u.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer w-full sm:w-auto",children:[u.jsx(hn,{className:"h-4 w-4 mr-2"}),"Add Building"]})]})]})}),t&&u.jsxs("div",{className:"flex flex-col max-h-[60vh] min-h-0",children:[u.jsx("div",{className:"flex-1 overflow-auto min-h-0 table-container",children:u.jsxs("table",{className:"min-w-full",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Building Name"}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n?u.jsx("tr",{children:u.jsx("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-gray-500",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),u.jsx("span",{className:"ml-2",children:"Loading buildings..."})]})})}):ee.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-gray-500",children:f?"No buildings found matching your search":"No buildings found"})}):ee.map(W=>u.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:W.name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(W.created_at).toLocaleDateString()}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{onClick:()=>R(W),className:"text-blue-600 hover:text-blue-900 transition-colors cursor-pointer",title:"Edit building",children:u.jsx(Ll,{className:"h-4 w-4"})}),u.jsx("button",{onClick:()=>{N(W),_(!0)},className:"text-red-600 hover:text-red-900 transition-colors cursor-pointer",title:"Delete building",children:u.jsx(ko,{className:"h-4 w-4"})})]})})]},W.id))})]})}),u.jsxs("div",{className:"flex-shrink-0 bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200",children:[u.jsx("div",{className:"flex-1 flex justify-between sm:hidden",children:u.jsx("span",{className:"text-sm text-gray-700",children:"Buildings"})}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",u.jsx("span",{className:"font-medium",children:ee.length})," of"," ",u.jsx("span",{className:"font-medium",children:ee.length})," buildings"]})}),u.jsx("div",{children:u.jsx("p",{className:"text-xs text-gray-500",children:"Scroll to view more buildings"})})]})]})]}),u.jsx(v9,{isOpen:h,onClose:()=>x(!1),siteId:parseInt(e||"0"),onBuildingAdded:F}),u.jsx(w9,{isOpen:g,onClose:A,building:S,onBuildingUpdated:P}),u.jsx(Bl,{isOpen:b,onClose:()=>{_(!1),N(null)},onConfirm:U,isDeleting:E,itemName:T?`building ${T.name}`:"building"})]})},_9=({siteId:e,siteName:t,expanded:r,onToggle:n})=>{const{user:s}=Pr(),[l,o]=C.useState(!1),[f,m]=C.useState([]),[h,x]=C.useState(""),[g,y]=C.useState(!1),[S,w]=C.useState(!1),[b,_]=C.useState(null),[T,N]=C.useState(!1),[E,j]=C.useState(null),[F,R]=C.useState(!1),A=pe=>s&&pe.email===s.email,P=pe=>pe.charAt(0).toUpperCase()+pe.slice(1),U=(pe,we)=>pe.primary_site===we?"Primary":pe.assigned_sites&&pe.assigned_sites.includes(we)?"Assigned":"Unknown",ee=()=>{e&&!isNaN(parseInt(e))&&qh(parseInt(e)).then(m)},W=pe=>{var re;const we=pe.name.split(" "),Q=we[0]||"",ie=we.slice(1).join(" ")||"",Ae={id:(re=pe.id)==null?void 0:re.toString(),firstName:Q,lastName:ie,email:pe.email,role:pe.role,primarySite:pe.primary_site,assignedSites:pe.assigned_sites};_(Ae),w(!0)},J=async()=>{if(E!=null&&E.id){R(!0);try{await K2(E.id),await ee(),N(!1),j(null)}catch(pe){console.error("Error deleting user:",pe),alert("Failed to delete user. Please try again.")}finally{R(!1)}}},xe=f.filter(pe=>pe.name.toLowerCase().includes(h.toLowerCase())||pe.email.toLowerCase().includes(h.toLowerCase())).sort((pe,we)=>{const Q=A(pe),ie=A(we);return Q&&!ie?-1:!Q&&ie?1:pe.name.localeCompare(we.name)});return Cn.useEffect(()=>{(async()=>{if(!(!e||!r||isNaN(parseInt(e)))){o(!0);try{const we=await qh(parseInt(e));m(we)}catch(we){console.error("Error fetching users:",we)}finally{o(!1)}}})()},[e,r]),u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 mb-4",children:[u.jsx("div",{className:`p-6 ${r?"border-b border-gray-200":""}`,children:u.jsxs("div",{className:"flex flex-col gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:n,children:[u.jsx(xu,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Users"}),r?u.jsx(ia,{className:"w-5 h-5 text-gray-500 flex-shrink-0"}):u.jsx(_m,{className:"w-5 h-5 text-gray-500 flex-shrink-0"})]}),r&&u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:items-center",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(ts,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search users...",value:h,onChange:pe=>x(pe.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),u.jsxs("button",{onClick:()=>y(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer w-full sm:w-auto",children:[u.jsx(hn,{className:"h-4 w-4 mr-2"}),"Add User"]})]})]})}),r&&u.jsxs("div",{className:"flex flex-col max-h-[60vh] min-h-0",children:[u.jsx("div",{className:"flex-1 overflow-auto min-h-0 table-container",children:u.jsxs("table",{className:"min-w-full",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Site Type"}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l?u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),u.jsx("span",{className:"ml-2",children:"Loading users..."})]})})}):xe.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:h?"No users found matching your search":"No users found"})}):xe.map(pe=>u.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${A(pe)?"bg-blue-50":""}`,children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u.jsxs("div",{className:"flex items-center",children:[pe.name,A(pe)&&u.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"You"})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:pe.email}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:P(pe.role)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t?U(pe,t):"Unknown"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{onClick:()=>W(pe),className:"text-blue-600 hover:text-blue-900 transition-colors cursor-pointer",title:"Edit user",children:u.jsx(Ll,{className:"h-4 w-4"})}),!A(pe)&&u.jsx("button",{onClick:()=>{j(pe),N(!0)},className:"text-red-600 hover:text-red-900 transition-colors cursor-pointer",title:"Delete user",children:u.jsx(ko,{className:"h-4 w-4"})})]})})]},pe.id))})]})}),u.jsxs("div",{className:"flex-shrink-0 bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200",children:[u.jsx("div",{className:"flex-1 flex justify-between sm:hidden",children:u.jsx("span",{className:"text-sm text-gray-700",children:"Users"})}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",u.jsx("span",{className:"font-medium",children:xe.length})," of"," ",u.jsx("span",{className:"font-medium",children:xe.length})," users"]})}),u.jsx("div",{children:u.jsx("p",{className:"text-xs text-gray-500",children:"Scroll to view more users"})})]})]})]}),u.jsx(Z2,{isOpen:g,onClose:()=>y(!1),onUserAdded:ee,defaultPrimarySiteId:e?parseInt(e):void 0}),u.jsx(Q2,{isOpen:S,onClose:()=>{w(!1),_(null)},user:b,onUserUpdated:ee}),u.jsx(Bl,{isOpen:T,onClose:()=>{N(!1),j(null)},onConfirm:J,isDeleting:F,itemName:E?`user ${E.name}`:"user"})]})},S9=({siteName:e,expanded:t,onToggle:r})=>{const n=ta(),[s,l]=C.useState(!1),[o,f]=C.useState([]),[m,h]=C.useState(""),[x,g]=C.useState("all"),[y,S]=C.useState(!1);C.useEffect(()=>{(async()=>{if(!(!e||!t)){l(!0);try{const T=await Rv(e);f(T)}catch(T){console.error("Error fetching patients:",T)}finally{l(!1)}}})()},[e,t]);const w=()=>{e&&(async()=>{l(!0);try{const T=await Rv(e);f(T)}catch(T){console.error("Error fetching patients:",T)}finally{l(!1)}})()},b=o.filter(_=>{const T=`${_.first_name} ${_.last_name}`.toLowerCase().includes(m.toLowerCase()),N=x==="all"||x==="active"&&_.is_active||x==="inactive"&&!_.is_active;return T&&N});return u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[u.jsx("div",{className:`p-6 ${t?"border-b border-gray-200":""}`,children:u.jsxs("div",{className:"flex flex-col gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:r,children:[u.jsx(hT,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Patients"}),t?u.jsx(ia,{className:"w-5 h-5 text-gray-500 flex-shrink-0"}):u.jsx(_m,{className:"w-5 h-5 text-gray-500 flex-shrink-0"})]}),t&&u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:items-center",children:[u.jsxs("div",{className:"relative flex-1 sm:max-w-xs",children:[u.jsxs("select",{value:x,onChange:_=>g(_.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md bg-white border appearance-none",children:[u.jsx("option",{value:"all",children:"All Patients"}),u.jsx("option",{value:"active",children:"Active Only"}),u.jsx("option",{value:"inactive",children:"Inactive Only"})]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:u.jsx(ia,{className:"h-4 w-4 text-gray-500"})})]}),u.jsxs("div",{className:"relative flex-1",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(ts,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search patients...",value:m,onChange:_=>h(_.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),u.jsxs("button",{onClick:()=>S(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer w-full sm:w-auto whitespace-nowrap",children:[u.jsx(hn,{className:"h-4 w-4 mr-2"}),"Add Patient"]})]})]})}),t&&u.jsxs("div",{className:"flex flex-col max-h-[60vh] min-h-0",children:[u.jsx("div",{className:"flex-1 overflow-auto min-h-0 table-container",children:u.jsxs("table",{className:"min-w-full",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Building"}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),u.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Activity"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s?u.jsx("tr",{children:u.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-sm text-gray-500",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),u.jsx("span",{className:"ml-2",children:"Loading patients..."})]})})}):b.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-sm text-gray-500",children:m||x!=="all"?"No patients found matching your search criteria":"No patients found for this site"})}):b.map(_=>u.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u.jsx("button",{onClick:()=>n(`/patientdetails/${_.id}`),className:"text-blue-600 hover:text-blue-900 hover:underline transition-colors duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer",children:`${_.first_name} ${_.last_name}`})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.building||"Not assigned"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_.is_active?"Active":"Inactive"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.created_at?new Date(_.created_at).toLocaleDateString():"N/A"})]},_.id))})]})}),u.jsxs("div",{className:"flex-shrink-0 bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200",children:[u.jsx("div",{className:"flex-1 flex justify-between sm:hidden",children:u.jsx("span",{className:"text-sm text-gray-700",children:"Patients"})}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",u.jsx("span",{className:"font-medium",children:b.length})," of"," ",u.jsx("span",{className:"font-medium",children:b.length})," patients"]})}),u.jsx("div",{children:u.jsx("p",{className:"text-xs text-gray-500",children:"Scroll to view more patients"})})]})]})]}),u.jsx(V2,{isOpen:y,onClose:()=>S(!1),onPatientAdded:w,defaultSite:e})]})},Vc=Cn.memo(({icon:e,label:t,value:r,isEditing:n=!1,onEdit:s,editType:l="text",editOptions:o=[],className:f=""})=>{const m=()=>r==null?"N/A":typeof r=="boolean"?r?"Yes":"No":r,h=()=>{if(!n||l==="readonly")return u.jsx("p",{className:`text-gray-900 ${f}`,children:m()});switch(l){case"text":return u.jsx("input",{type:"text",value:r||"",onChange:x=>s&&s(x.target.value),className:"block w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"});case"select":return u.jsx("select",{value:r||"",onChange:x=>s&&s(x.target.value),className:"block w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:o.map(x=>u.jsx("option",{value:x,children:x},x))});case"checkbox":return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm text-gray-600",children:t}),u.jsx("input",{type:"checkbox",checked:r,onChange:x=>s&&s(x.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})]});default:return u.jsx("p",{className:`text-gray-900 ${f}`,children:m()})}};return l==="checkbox"&&n?h():u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium text-gray-500 block",children:t}),u.jsx("div",{className:"mt-1",children:h()})]})});function N9(){const e=ta(),{siteId:t}=mm(),{user:r}=Pr(),[n,s]=C.useState(!0),[l,o]=C.useState(null),[f,m]=C.useState(null),[h,x]=C.useState(null),[g,y]=C.useState(!1),[S,w]=C.useState(!1),[b,_]=C.useState(!1),[T,N]=C.useState(!1),[E,j]=C.useState(null),[F,R]=C.useState([]),[A,P]=C.useState(!1),[U,ee]=C.useState(""),[W,J]=C.useState(!1),[xe,pe]=C.useState(null),[we,Q]=C.useState(!1),[ie,Ae]=C.useState([]),[re,z]=C.useState(!1),[te,D]=C.useState(""),[V,M]=C.useState(!1),[B,K]=C.useState(!1),[oe,ye]=C.useState(null),[_e,ae]=C.useState(null),[He,Y]=C.useState(!1),[ct,$e]=C.useState([]),[xt,et]=C.useState(!1),[Me,vt]=C.useState(""),[De,at]=C.useState("all"),[Ce,Fe]=C.useState(!1),[de,Te]=C.useState(!1),[qe,Ke]=C.useState(!1),[Xe,ut]=C.useState({buildings:!1,users:!1,patients:!1}),nt=tt=>r&&tt.email===r.email;ie.filter(tt=>tt.name.toLowerCase().includes(te.toLowerCase())||tt.email.toLowerCase().includes(te.toLowerCase())).sort((tt,Dt)=>{const Dr=nt(tt),tn=nt(Dt);return Dr&&!tn?-1:!Dr&&tn?1:tt.name.localeCompare(Dt.name)}),C.useEffect(()=>{(async()=>{if(!(!t||!Xe.patients||isNaN(parseInt(t)))){et(!0);try{const Dt=await CT(parseInt(t));$e(Dt)}catch(Dt){console.error("Error fetching patients:",Dt)}finally{et(!1)}}})()},[t,Xe.patients]),ct.filter(tt=>{const Dt=`${tt.first_name} ${tt.last_name}`.toLowerCase().includes(Me.toLowerCase()),Dr=De==="all"||De==="active"&&tt.is_active||De==="inactive"&&!tt.is_active;return Dt&&Dr}),C.useEffect(()=>{(async()=>{if(!t){o("No site ID provided"),s(!1);return}s(!0),o(null);try{const Dt=await DT(parseInt(t,10));m(Dt)}catch(Dt){console.error("Error fetching site data:",Dt),o("Failed to load site data. Please try again.")}finally{s(!1)}})()},[t]),C.useEffect(()=>{t&&Xe.buildings&&Oa()},[t,Xe.buildings]),C.useEffect(()=>{(async()=>{if(!(!t||!Xe.users||isNaN(parseInt(t)))){z(!0);try{const Dt=await qh(parseInt(t));Ae(Dt)}catch(Dt){console.error("Error fetching users:",Dt)}finally{z(!1)}}})()},[t,Xe.users]);const lt=()=>{y(!0),x(f)},Xt=()=>{y(!1),x(f)},zr=async()=>{var tt,Dt,Dr,tn;if(!(!t||!h)){w(!0);try{const ca={name:h.name,address:h.address,city:h.city,state:h.state,zip:h.zip,is_active:h.is_active};console.log("Updating site with data:",ca);const Vr=await OT(parseInt(t,10),ca);console.log("Site updated successfully:",Vr),m(Vr),x(Vr),y(!1)}catch(ca){console.error("Error updating site:",ca);let Vr="Failed to update site. Please try again.";((tt=ca.response)==null?void 0:tt.status)===404?Vr="Site not found. Please refresh the page and try again.":((Dt=ca.response)==null?void 0:Dt.status)===400?Vr="Invalid site data. Please check your inputs and try again.":(tn=(Dr=ca.response)==null?void 0:Dr.data)!=null&&tn.message&&(Vr=`Failed to update site: ${ca.response.data.message}`),alert(Vr)}finally{w(!1)}}},jt=(tt,Dt)=>{h&&x(Dr=>Dr&&{...Dr,[tt]:Dt})},Hr=tt=>{ut(Dt=>({...Dt,[tt]:!Dt[tt]}))},Oa=async()=>{if(!(!t||isNaN(parseInt(t)))){P(!0);try{const tt=await Vu(parseInt(t));R(tt)}catch(tt){console.error("Error fetching buildings:",tt)}finally{P(!1)}}};F.filter(tt=>tt.name.toLowerCase().includes(U.toLowerCase()));const ls=async()=>{if(t){Ke(!0);try{await MT(parseInt(t,10)),e("/sites")}catch(tt){console.error("Error deleting site:",tt),alert("Failed to delete site. Please try again.")}finally{Ke(!1)}}};return n?u.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-gray-50 to-gray-100",children:u.jsxs("div",{className:"px-4 py-6 max-w-7xl mx-auto w-full",children:[u.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:()=>e("/sites"),className:"p-1.5 rounded-full text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer",title:"Back to All Sites",children:u.jsx(Wc,{className:"h-5 w-5"})}),u.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900",children:"Site Details"})]})}),u.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-8 flex justify-center items-center max-h-[60vh]",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),u.jsx("div",{className:"text-gray-500",children:"Loading site data..."})]})})]})}):l||!f?u.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-gray-50 to-gray-100",children:u.jsxs("div",{className:"px-4 py-6 max-w-7xl mx-auto w-full",children:[u.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:()=>e("/sites"),className:"p-1.5 rounded-full text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer",title:"Back to All Sites",children:u.jsx(Wc,{className:"h-5 w-5"})}),u.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900",children:"Site Details"})]})}),u.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-lg p-4 max-h-[60vh] flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-red-600 mb-4 text-5xl",children:"!"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Site"}),u.jsx("p",{className:"text-gray-600 mb-4",children:l||"Site data not found"}),u.jsx("button",{onClick:()=>e("/sites"),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Return to Sites List"})]})})]})}):u.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-gray-50 to-gray-100",children:[u.jsxs("div",{className:"px-4 py-6 max-w-7xl mx-auto w-full",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:()=>e("/sites"),className:"p-1.5 rounded-full text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer",title:"Back to All Sites",children:u.jsx(Wc,{className:"h-5 w-5"})}),u.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900",children:"Site Details"})]}),u.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:g?u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:zr,disabled:S,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto",children:[u.jsx(B2,{className:"h-4 w-4 mr-2"}),S?"Saving...":"Save Changes"]}),u.jsxs("button",{onClick:()=>Te(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors cursor-pointer w-full sm:w-auto",children:[u.jsx(ko,{className:"h-4 w-4 mr-2"}),"Delete Site"]}),u.jsxs("button",{onClick:Xt,className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors cursor-pointer w-full sm:w-auto",children:[u.jsx(Ja,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):u.jsxs("button",{onClick:lt,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors cursor-pointer w-full sm:w-auto",children:[u.jsx(Ll,{className:"w-4 h-4 mr-2"}),"Edit Site"]})})]}),u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-4",children:u.jsx("div",{className:"space-y-6",children:u.jsxs("div",{children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 mb-4",children:[u.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[u.jsx(bi,{className:"w-5 h-5 text-blue-600"}),"Basic Information"]}),g?u.jsxs("div",{className:"flex items-center gap-2 justify-center sm:justify-end",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Inactive"}),u.jsx("button",{type:"button",role:"switch","aria-checked":h==null?void 0:h.is_active,onClick:()=>jt("is_active",!(h!=null&&h.is_active)),className:`${h!=null&&h.is_active?"bg-blue-600":"bg-gray-200"} relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2`,children:u.jsx("span",{"aria-hidden":"true",className:`${h!=null&&h.is_active?"translate-x-5":"translate-x-0"} pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out`})}),u.jsx("span",{className:"text-sm text-gray-600",children:"Active"})]}):u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium self-start sm:self-center ${f.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:f.is_active?"Active":"Inactive"})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.jsx(Vc,{label:"Name",value:g?h==null?void 0:h.name:f.name,isEditing:g,editType:"text",onEdit:tt=>jt("name",tt)}),u.jsx(Vc,{label:"Address",value:g?h==null?void 0:h.address:f.address,isEditing:g,editType:"text",onEdit:tt=>jt("address",tt)}),u.jsx(Vc,{label:"City",value:g?h==null?void 0:h.city:f.city,isEditing:g,editType:"text",onEdit:tt=>jt("city",tt)}),u.jsx(Vc,{label:"State",value:g?h==null?void 0:h.state:f.state,isEditing:g,editType:"text",onEdit:tt=>jt("state",tt)}),u.jsx(Vc,{label:"ZIP",value:g?h==null?void 0:h.zip:f.zip,isEditing:g,editType:"text",onEdit:tt=>jt("zip",tt)})]})]})})}),u.jsx(b9,{siteId:t||"",expanded:Xe.buildings,onToggle:()=>Hr("buildings")}),u.jsx(_9,{siteId:t||"",siteName:f.name,expanded:Xe.users,onToggle:()=>Hr("users")}),u.jsx(S9,{siteName:f.name,expanded:Xe.patients,onToggle:()=>Hr("patients")})]}),u.jsx(Bl,{isOpen:de,onClose:()=>Te(!1),onConfirm:ls,isDeleting:qe,itemName:`site "${f==null?void 0:f.name}"`})]})}const g_=()=>{const[e,t]=C.useState(!1),[r,n]=C.useState(!1);ta();const s=as(),{logout:l,isAdmin:o,isNurse:f,isPharmacist:m,user:h}=Pr(),x=C.useRef(null),g=()=>{t(!e)},y=()=>{n(!r)},S=()=>{l(),n(!1)},w=_=>_==="/patients"||_==="/"?s.pathname==="/"||s.pathname==="/patients"||s.pathname.startsWith("/patientdetails"):_==="/reports"?s.pathname==="/reports"||s.pathname==="/site-reports"||s.pathname==="/patient-reports":s.pathname.startsWith(_),b=(_,T=!1)=>`${T?"block px-3 py-2 rounded-md text-base font-medium flex items-center gap-2":"px-3 py-2 rounded-md text-sm font-medium transition-colors flex items-center gap-2"} ${w(_)?"text-blue-600":"text-gray-700 hover:text-blue-600"}`;return C.useEffect(()=>{const _=T=>{x.current&&!x.current.contains(T.target)&&n(!1)};return document.addEventListener("click",_),()=>{document.removeEventListener("click",_)}},[]),u.jsxs("nav",{className:"bg-white shadow-md w-full",children:[u.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between h-16",children:[u.jsx("div",{className:"flex items-center",children:u.jsx(ma,{to:"/",className:"flex-shrink-0 flex items-center",children:u.jsx("img",{src:"/logoNavbar.png",alt:"MediTrack Time Logo",className:"h-8 w-auto"})})}),u.jsxs("div",{className:"hidden lg:flex items-center space-x-4",children:[u.jsxs(ma,{to:"/patients",className:b("/patients"),children:[u.jsx(jv,{className:"w-5 h-5"}),"Patients"]}),!m&&!f&&u.jsxs(ma,{to:"/sites",className:b("/sites"),children:[u.jsx(bi,{className:"w-5 h-5"}),"Sites"]}),u.jsxs(ma,{to:"/medical-activities",className:b("/medical-activities"),children:[u.jsx(Xh,{className:"w-5 h-5"}),"Medical Activities"]}),!m&&!f&&u.jsxs(ma,{to:"/reports",className:b("/reports"),children:[u.jsx(Yh,{className:"w-5 h-5"}),"Reports"]}),o&&u.jsxs(ma,{to:"/users",className:b("/users"),children:[u.jsx(xu,{className:"w-5 h-5"}),"Manage Users"]}),u.jsxs("div",{className:"relative",ref:x,children:[u.jsxs("button",{onClick:y,className:"flex items-center space-x-2 text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors focus:outline-none cursor-pointer",children:[u.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx(lo,{className:"w-5 h-5 text-blue-600"})}),u.jsx(ia,{className:"w-4 h-4"})]}),r&&u.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-50",children:u.jsxs("div",{className:"py-1",children:[u.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[u.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[h==null?void 0:h.first_name," ",h==null?void 0:h.last_name]}),u.jsx("p",{className:"text-sm text-gray-500",children:h==null?void 0:h.email}),o&&u.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 mt-1",children:"Administrator"}),f&&u.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 mt-1",children:"Nurse"}),m&&u.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800 mt-1",children:"Pharmacist"})]}),u.jsxs("button",{onClick:S,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[u.jsx(Av,{className:"w-4 h-4"}),"Sign out"]})]})})]})]}),u.jsx("div",{className:"lg:hidden flex items-center",children:u.jsxs("button",{onClick:g,className:"inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-blue-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500","aria-expanded":"false",children:[u.jsx("span",{className:"sr-only",children:"Open main menu"}),e?u.jsx(Ja,{className:"block h-6 w-6","aria-hidden":"true"}):u.jsx(iT,{className:"block h-6 w-6","aria-hidden":"true"})]})})]})}),e&&u.jsx("div",{className:"lg:hidden",children:u.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:[u.jsxs(ma,{to:"/patients",className:b("/patients",!0),onClick:g,children:[u.jsx(jv,{className:"w-5 h-5"}),"Patients"]}),!m&&!f&&u.jsxs(ma,{to:"/sites",className:b("/sites",!0),onClick:g,children:[u.jsx(bi,{className:"w-5 h-5"}),"Sites"]}),u.jsxs(ma,{to:"/medical-activities",className:b("/medical-activities",!0),onClick:g,children:[u.jsx(Xh,{className:"w-5 h-5"}),"Medical Activities"]}),!m&&!f&&u.jsxs(ma,{to:"/reports",className:b("/reports",!0),onClick:g,children:[u.jsx(Yh,{className:"w-5 h-5"}),"Reports"]}),o&&u.jsxs(ma,{to:"/users",className:b("/users",!0),onClick:g,children:[u.jsx(xu,{className:"w-5 h-5"}),"Manage Users"]}),u.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[u.jsx("div",{className:"px-3 py-2",children:u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx(lo,{className:"w-6 h-6 text-blue-600"})}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("p",{className:"text-base font-medium text-gray-900",children:[h==null?void 0:h.first_name," ",h==null?void 0:h.last_name]}),u.jsx("p",{className:"text-sm text-gray-500",children:h==null?void 0:h.email}),o&&u.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 mt-1",children:"Administrator"}),f&&u.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 mt-1",children:"Nurse"}),m&&u.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800 mt-1",children:"Pharmacist"})]})]})}),u.jsxs("button",{onClick:()=>{g(),S()},className:"w-full text-left px-3 py-2 text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-100 flex items-center gap-2 cursor-pointer",children:[u.jsx(Av,{className:"w-5 h-5"}),"Sign out"]})]})]})})]})},En=({children:e})=>{const{isAuthenticated:t,isLoading:r}=Pr();return r?u.jsx(Xu,{}):t?u.jsxs(u.Fragment,{children:[u.jsx(g_,{}),e]}):u.jsx(kl,{to:"/login",replace:!0})},E9=({children:e})=>{const{isAuthenticated:t,isAdmin:r,isLoading:n}=Pr();return n?u.jsx(Xu,{}):t?r?u.jsxs(u.Fragment,{children:[u.jsx(g_,{}),e]}):u.jsx(kl,{to:"/",replace:!0}):u.jsx(kl,{to:"/login",replace:!0})},T9=({children:e})=>{const{isAuthenticated:t,isLoading:r}=Pr();return r?u.jsx(Xu,{}):t?u.jsx(kl,{to:"/",replace:!0}):u.jsx(u.Fragment,{children:e})},Gc=({children:e})=>{const{isPharmacist:t}=Pr();return t?u.jsx(kl,{to:"/patients",replace:!0}):u.jsx(u.Fragment,{children:e})},Xc=({children:e})=>{const{isNurse:t}=Pr();return t?u.jsx(kl,{to:"/",replace:!0}):u.jsx(u.Fragment,{children:e})},k9=()=>u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:u.jsxs("div",{className:"text-center p-8 bg-white rounded-lg shadow-md",children:[u.jsx("h1",{className:"text-6xl font-bold text-gray-800 mb-4",children:"404"}),u.jsx("h2",{className:"text-2xl font-semibold text-gray-600 mb-4",children:"Page Not Found"}),u.jsx("p",{className:"text-gray-500 mb-6",children:"The page you are looking for doesn't exist or has been moved."}),u.jsx(ma,{to:"/",className:"inline-block px-6 py-3 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Go Back Home"})]})});function A9(){const{isLoading:e}=Pr();return e?u.jsx(Xu,{}):u.jsx(ck,{children:u.jsxs(E3,{children:[u.jsx(ha,{path:"/login",element:u.jsx(T9,{children:u.jsx(BE,{})})}),u.jsx(ha,{path:"/",element:u.jsx(En,{children:u.jsx(Uv,{})})}),u.jsx(ha,{path:"/patients",element:u.jsx(En,{children:u.jsx(Uv,{})})}),u.jsx(ha,{path:"/patientdetails/:patientId",element:u.jsx(En,{children:u.jsx(hk,{})})}),u.jsx(ha,{path:"/activity/:activityId",element:u.jsx(En,{children:u.jsx(mk,{})})}),u.jsx(ha,{path:"/users",element:u.jsx(E9,{children:u.jsx(vk,{})})}),u.jsx(ha,{path:"/sites",element:u.jsx(En,{children:u.jsx(Gc,{children:u.jsx(Xc,{children:u.jsx(e6,{})})})})}),u.jsx(ha,{path:"/sites/:siteId",element:u.jsx(En,{children:u.jsx(Gc,{children:u.jsx(Xc,{children:u.jsx(N9,{})})})})}),u.jsx(ha,{path:"/medical-activities",element:u.jsx(En,{children:u.jsx(a6,{})})}),u.jsx(ha,{path:"/reports",element:u.jsx(En,{children:u.jsx(Gc,{children:u.jsx(Xc,{children:u.jsx(l9,{})})})})}),u.jsx(ha,{path:"/site-reports",element:u.jsx(En,{children:u.jsx(Gc,{children:u.jsx(Xc,{children:u.jsx(h9,{})})})})}),u.jsx(ha,{path:"/patient-reports",element:u.jsx(En,{children:u.jsx(Gc,{children:u.jsx(Xc,{children:u.jsx(p9,{})})})})}),u.jsx(ha,{path:"*",element:u.jsx(k9,{})})]})})}MS.createRoot(document.getElementById("root")).render(u.jsx(Cn.StrictMode,{children:u.jsx(W3,{children:u.jsx(LE,{children:u.jsx(A9,{})})})}));
